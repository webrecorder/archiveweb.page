(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsCore=(()=>{var RAe=Object.create;var Jm=Object.defineProperty;var PAe=Object.getOwnPropertyDescriptor;var CAe=Object.getOwnPropertyNames;var OAe=Object.getPrototypeOf,kAe=Object.prototype.hasOwnProperty;var $k=t=>Jm(t,"__esModule",{value:!0});var oa=t=>{if(typeof require!="undefined")return require(t);throw new Error('Dynamic require of "'+t+'" is not supported')};var xe=(t,e)=>()=>(t&&(e=t(t=0)),e);var y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ut=(t,e)=>{$k(t);for(var r in e)Jm(t,r,{get:e[r],enumerable:!0})},qAe=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of CAe(e))!kAe.call(t,i)&&i!=="default"&&Jm(t,i,{get:()=>e[i],enumerable:!(r=PAe(e,i))||r.enumerable});return t},Wt=t=>qAe($k(Jm(t!=null?RAe(OAe(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Yk=y(ev=>{f();"use strict";ev.byteLength=NAe;ev.toByteArray=MAe;ev.fromByteArray=FAe;var aa=[],Ss=[],DAe=typeof Uint8Array!="undefined"?Uint8Array:Array,wx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ef=0,Gk=wx.length;ef<Gk;++ef)aa[ef]=wx[ef],Ss[wx.charCodeAt(ef)]=ef;var ef,Gk;Ss["-".charCodeAt(0)]=62;Ss["_".charCodeAt(0)]=63;function Wk(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function NAe(t){var e=Wk(t),r=e[0],i=e[1];return(r+i)*3/4-i}function BAe(t,e,r){return(e+r)*3/4-r}function MAe(t){var e,r=Wk(t),i=r[0],n=r[1],s=new DAe(BAe(t,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=Ss[t.charCodeAt(c)]<<18|Ss[t.charCodeAt(c+1)]<<12|Ss[t.charCodeAt(c+2)]<<6|Ss[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=Ss[t.charCodeAt(c)]<<2|Ss[t.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=Ss[t.charCodeAt(c)]<<10|Ss[t.charCodeAt(c+1)]<<4|Ss[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function LAe(t){return aa[t>>18&63]+aa[t>>12&63]+aa[t>>6&63]+aa[t&63]}function UAe(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),n.push(LAe(i));return n.join("")}function FAe(t){for(var e,r=t.length,i=r%3,n=[],s=16383,o=0,a=r-i;o<a;o+=s)n.push(UAe(t,o,o+s>a?a:o+s));return i===1?(e=t[r-1],n.push(aa[e>>2]+aa[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(aa[e>>10]+aa[e>>4&63]+aa[e<<2&63]+"=")),n.join("")}});var Xk=y(_x=>{f();_x.read=function(t,e,r,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?n-1:0,h=r?-1:1,p=t[e+d];for(d+=h,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=s*256+t[e+d],d+=h,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=o*256+t[e+d],d+=h,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(p?-1:1)*o*Math.pow(2,s-i)};_x.write=function(t,e,r,i,n,s){var o,a,c,u=s*8-n-1,l=(1<<u)-1,d=l>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,g=i?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=l?(a=0,o=l):o+d>=1?(a=(e*c-1)*Math.pow(2,n),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;t[r+p]=a&255,p+=g,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[r+p]=o&255,p+=g,o/=256,u-=8);t[r+p-g]|=m*128}});var Vt=y(eh=>{f();"use strict";var Ex=Yk(),Qd=Xk(),Qk=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;eh.Buffer=le;eh.SlowBuffer=$Ae;eh.INSPECT_MAX_BYTES=50;var tv=2147483647;eh.kMaxLength=tv;le.TYPED_ARRAY_SUPPORT=KAe();!le.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function KAe(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(le.prototype,"parent",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.buffer}});Object.defineProperty(le.prototype,"offset",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.byteOffset}});function vc(t){if(t>tv)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,le.prototype),e}function le(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Sx(t)}return Zk(t,e,r)}le.poolSize=8192;function Zk(t,e,r){if(typeof t=="string")return VAe(t,e);if(ArrayBuffer.isView(t))return zAe(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(ca(t,ArrayBuffer)||t&&ca(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ca(t,SharedArrayBuffer)||t&&ca(t.buffer,SharedArrayBuffer)))return Ax(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(i!=null&&i!==t)return le.from(i,e,r);let n=HAe(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return le.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}le.from=function(t,e,r){return Zk(t,e,r)};Object.setPrototypeOf(le.prototype,Uint8Array.prototype);Object.setPrototypeOf(le,Uint8Array);function Jk(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function jAe(t,e,r){return Jk(t),t<=0?vc(t):e!==void 0?typeof r=="string"?vc(t).fill(e,r):vc(t).fill(e):vc(t)}le.alloc=function(t,e,r){return jAe(t,e,r)};function Sx(t){return Jk(t),vc(t<0?0:Ix(t)|0)}le.allocUnsafe=function(t){return Sx(t)};le.allocUnsafeSlow=function(t){return Sx(t)};function VAe(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!le.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=eq(t,e)|0,i=vc(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function xx(t){let e=t.length<0?0:Ix(t.length)|0,r=vc(e);for(let i=0;i<e;i+=1)r[i]=t[i]&255;return r}function zAe(t){if(ca(t,Uint8Array)){let e=new Uint8Array(t);return Ax(e.buffer,e.byteOffset,e.byteLength)}return xx(t)}function Ax(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&r===void 0?i=new Uint8Array(t):r===void 0?i=new Uint8Array(t,e):i=new Uint8Array(t,e,r),Object.setPrototypeOf(i,le.prototype),i}function HAe(t){if(le.isBuffer(t)){let e=Ix(t.length)|0,r=vc(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||Px(t.length)?vc(0):xx(t);if(t.type==="Buffer"&&Array.isArray(t.data))return xx(t.data)}function Ix(t){if(t>=tv)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+tv.toString(16)+" bytes");return t|0}function $Ae(t){return+t!=t&&(t=0),le.alloc(+t)}le.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==le.prototype};le.compare=function(e,r){if(ca(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),ca(r,Uint8Array)&&(r=le.from(r,r.offset,r.byteLength)),!le.isBuffer(e)||!le.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let i=e.length,n=r.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};le.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};le.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return le.alloc(0);let i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;let n=le.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){let o=e[i];if(ca(o,Uint8Array))s+o.length>n.length?(le.isBuffer(o)||(o=le.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(le.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function eq(t,e){if(le.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||ca(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&r===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Rx(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return dq(t).length;default:if(n)return i?-1:Rx(t).length;e=(""+e).toLowerCase(),n=!0}}le.byteLength=eq;function GAe(t,e,r){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return iIe(this,e,r);case"utf8":case"utf-8":return iq(this,e,r);case"ascii":return tIe(this,e,r);case"latin1":case"binary":return rIe(this,e,r);case"base64":return JAe(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nIe(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}le.prototype._isBuffer=!0;function tf(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}le.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)tf(this,r,r+1);return this};le.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)tf(this,r,r+3),tf(this,r+1,r+2);return this};le.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)tf(this,r,r+7),tf(this,r+1,r+6),tf(this,r+2,r+5),tf(this,r+3,r+4);return this};le.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?iq(this,0,e):GAe.apply(this,arguments)};le.prototype.toLocaleString=le.prototype.toString;le.prototype.equals=function(e){if(!le.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:le.compare(this,e)===0};le.prototype.inspect=function(){let e="",r=eh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Qk&&(le.prototype[Qk]=le.prototype.inspect);le.prototype.compare=function(e,r,i,n,s){if(ca(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),!le.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-r,c=Math.min(o,a),u=this.slice(n,s),l=e.slice(r,i);for(let d=0;d<c;++d)if(u[d]!==l[d]){o=u[d],a=l[d];break}return o<a?-1:a<o?1:0};function tq(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Px(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=le.from(e,i)),le.isBuffer(e))return e.length===0?-1:rq(t,e,r,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):rq(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function rq(t,e,r,i,n){let s=1,o=t.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(l,d){return s===1?l[d]:l.readUInt16BE(d*s)}let u;if(n){let l=-1;for(u=r;u<o;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){let l=!0;for(let d=0;d<a;d++)if(c(t,u+d)!==c(e,d)){l=!1;break}if(l)return u}return-1}le.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};le.prototype.indexOf=function(e,r,i){return tq(this,e,r,i,!0)};le.prototype.lastIndexOf=function(e,r,i){return tq(this,e,r,i,!1)};function WAe(t,e,r,i){r=Number(r)||0;let n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(Px(a))return o;t[r+o]=a}return o}function YAe(t,e,r,i){return rv(Rx(e,t.length-r),t,r,i)}function XAe(t,e,r,i){return rv(cIe(e),t,r,i)}function QAe(t,e,r,i){return rv(dq(e),t,r,i)}function ZAe(t,e,r,i){return rv(uIe(e,t.length-r),t,r,i)}le.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return WAe(this,e,r,i);case"utf8":case"utf-8":return YAe(this,e,r,i);case"ascii":case"latin1":case"binary":return XAe(this,e,r,i);case"base64":return QAe(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ZAe(this,e,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function JAe(t,e,r){return e===0&&r===t.length?Ex.fromByteArray(t):Ex.fromByteArray(t.slice(e,r))}function iq(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let s=t[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=r){let c,u,l,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[n+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=t[n+1],u=t[n+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=t[n+1],u=t[n+2],l=t[n+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,d>65535&&d<1114112&&(o=d))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return eIe(i)}var nq=4096;function eIe(t){let e=t.length;if(e<=nq)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=nq));return r}function tIe(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function rIe(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function iIe(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let s=e;s<r;++s)n+=lIe[t[s]];return n}function nIe(t,e,r){let i=t.slice(e,r),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}le.prototype.slice=function(e,r){let i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);let n=this.subarray(e,r);return Object.setPrototypeOf(n,le.prototype),n};function Ci(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}le.prototype.readUintLE=le.prototype.readUIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ci(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return n};le.prototype.readUintBE=le.prototype.readUIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ci(e,r,this.length);let n=this[e+--r],s=1;for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n};le.prototype.readUint8=le.prototype.readUInt8=function(e,r){return e=e>>>0,r||Ci(e,1,this.length),this[e]};le.prototype.readUint16LE=le.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Ci(e,2,this.length),this[e]|this[e+1]<<8};le.prototype.readUint16BE=le.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Ci(e,2,this.length),this[e]<<8|this[e+1]};le.prototype.readUint32LE=le.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Ci(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};le.prototype.readUint32BE=le.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Ci(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};le.prototype.readBigUInt64LE=Iu(function(e){e=e>>>0,Jd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&jy(e,this.length-8);let n=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});le.prototype.readBigUInt64BE=Iu(function(e){e=e>>>0,Jd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&jy(e,this.length-8);let n=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});le.prototype.readIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ci(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};le.prototype.readIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ci(e,r,this.length);let n=r,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};le.prototype.readInt8=function(e,r){return e=e>>>0,r||Ci(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};le.prototype.readInt16LE=function(e,r){e=e>>>0,r||Ci(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};le.prototype.readInt16BE=function(e,r){e=e>>>0,r||Ci(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};le.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Ci(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};le.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Ci(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};le.prototype.readBigInt64LE=Iu(function(e){e=e>>>0,Jd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&jy(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});le.prototype.readBigInt64BE=Iu(function(e){e=e>>>0,Jd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&jy(e,this.length-8);let n=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});le.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Ci(e,4,this.length),Qd.read(this,e,!0,23,4)};le.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Ci(e,4,this.length),Qd.read(this,e,!1,23,4)};le.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Ci(e,8,this.length),Qd.read(this,e,!0,52,8)};le.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Ci(e,8,this.length),Qd.read(this,e,!1,52,8)};function Mn(t,e,r,i,n,s){if(!le.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}le.prototype.writeUintLE=le.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Mn(this,e,r,i,a,0)}let s=1,o=0;for(this[r]=e&255;++o<i&&(s*=256);)this[r+o]=e/s&255;return r+i};le.prototype.writeUintBE=le.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Mn(this,e,r,i,a,0)}let s=i-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+i};le.prototype.writeUint8=le.prototype.writeUInt8=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,1,255,0),this[r]=e&255,r+1};le.prototype.writeUint16LE=le.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};le.prototype.writeUint16BE=le.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};le.prototype.writeUint32LE=le.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};le.prototype.writeUint32BE=le.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function sq(t,e,r,i,n){fq(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function oq(t,e,r,i,n){fq(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}le.prototype.writeBigUInt64LE=Iu(function(e,r=0){return sq(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeBigUInt64BE=Iu(function(e,r=0){return oq(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);Mn(this,e,r,i,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+i};le.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);Mn(this,e,r,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+i};le.prototype.writeInt8=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};le.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};le.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};le.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};le.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||Mn(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};le.prototype.writeBigInt64LE=Iu(function(e,r=0){return sq(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});le.prototype.writeBigInt64BE=Iu(function(e,r=0){return oq(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function aq(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function cq(t,e,r,i,n){return e=+e,r=r>>>0,n||aq(t,e,r,4,34028234663852886e22,-34028234663852886e22),Qd.write(t,e,r,i,23,4),r+4}le.prototype.writeFloatLE=function(e,r,i){return cq(this,e,r,!0,i)};le.prototype.writeFloatBE=function(e,r,i){return cq(this,e,r,!1,i)};function uq(t,e,r,i,n){return e=+e,r=r>>>0,n||aq(t,e,r,8,17976931348623157e292,-17976931348623157e292),Qd.write(t,e,r,i,52,8),r+8}le.prototype.writeDoubleLE=function(e,r,i){return uq(this,e,r,!0,i)};le.prototype.writeDoubleBE=function(e,r,i){return uq(this,e,r,!1,i)};le.prototype.copy=function(e,r,i,n){if(!le.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),r),s};le.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!le.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{let o=le.isBuffer(e)?e:le.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=o[s%a]}return this};var Zd={};function Tx(t,e,r){Zd[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Tx("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Tx("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);Tx("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=lq(String(r)):typeof r=="bigint"&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=lq(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function lq(t){let e="",r=t.length,i=t[0]==="-"?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function sIe(t,e,r){Jd(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&jy(e,t.length-(r+1))}function fq(t,e,r,i,n,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new Zd.ERR_OUT_OF_RANGE("value",a,t)}sIe(i,n,s)}function Jd(t,e){if(typeof t!="number")throw new Zd.ERR_INVALID_ARG_TYPE(e,"number",t)}function jy(t,e,r){throw Math.floor(t)!==t?(Jd(t,r),new Zd.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new Zd.ERR_BUFFER_OUT_OF_BOUNDS:new Zd.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var oIe=/[^+/0-9A-Za-z-_]/g;function aIe(t){if(t=t.split("=")[0],t=t.trim().replace(oIe,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function Rx(t,e){e=e||1/0;let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function cIe(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function uIe(t,e){let r,i,n,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function dq(t){return Ex.toByteArray(aIe(t))}function rv(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function ca(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function Px(t){return t!==t}var lIe=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let i=r*16;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function Iu(t){return typeof BigInt=="undefined"?fIe:t}function fIe(){throw new Error("BigInt not supported")}});var bq=y((s3t,gq)=>{f();var Zr=gq.exports={},ua,la;function Cx(){throw new Error("setTimeout has not been defined")}function Ox(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ua=setTimeout:ua=Cx}catch(t){ua=Cx}try{typeof clearTimeout=="function"?la=clearTimeout:la=Ox}catch(t){la=Ox}})();function hq(t){if(ua===setTimeout)return setTimeout(t,0);if((ua===Cx||!ua)&&setTimeout)return ua=setTimeout,setTimeout(t,0);try{return ua(t,0)}catch(e){try{return ua.call(null,t,0)}catch(r){return ua.call(this,t,0)}}}function dIe(t){if(la===clearTimeout)return clearTimeout(t);if((la===Ox||!la)&&clearTimeout)return la=clearTimeout,clearTimeout(t);try{return la(t)}catch(e){try{return la.call(null,t)}catch(r){return la.call(this,t)}}}var wc=[],th=!1,rf,iv=-1;function hIe(){!th||!rf||(th=!1,rf.length?wc=rf.concat(wc):iv=-1,wc.length&&pq())}function pq(){if(!th){var t=hq(hIe);th=!0;for(var e=wc.length;e;){for(rf=wc,wc=[];++iv<e;)rf&&rf[iv].run();iv=-1,e=wc.length}rf=null,th=!1,dIe(t)}}Zr.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];wc.push(new yq(t,e)),wc.length===1&&!th&&hq(pq)};function yq(t,e){this.fun=t,this.array=e}yq.prototype.run=function(){this.fun.apply(null,this.array)};Zr.title="browser";Zr.browser=!0;Zr.env={};Zr.argv=[];Zr.version="";Zr.versions={};function _c(){}Zr.on=_c;Zr.addListener=_c;Zr.once=_c;Zr.off=_c;Zr.removeListener=_c;Zr.removeAllListeners=_c;Zr.emit=_c;Zr.prependListener=_c;Zr.prependOnceListener=_c;Zr.listeners=function(t){return[]};Zr.binding=function(t){throw new Error("process.binding is not supported")};Zr.cwd=function(){return"/"};Zr.chdir=function(t){throw new Error("process.chdir is not supported")};Zr.umask=function(){return 0}});var Buffer,process,f=xe(()=>{({Buffer}=Vt()),process=bq()});var kx=y(()=>{f()});var qx=y(nv=>{f();"use strict";var mq=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};nv.TimeoutError=mq;var vq=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};nv.AbortError=vq;var wq=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};nv.HTTPError=wq});var Dx=y((l3t,_q)=>{f();function pIe(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}_q.exports=pIe});var zy=y((f3t,Eq)=>{f();"use strict";var yIe=Dx(),sv=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Vy=yIe(),gIe=sv&&!Vy,bIe=Vy&&!sv,mIe=Vy&&sv,vIe=typeof oa=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!Vy,wIe=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,_Ie=typeof process!="undefined"&&typeof process.env!="undefined"&&!1,EIe=typeof navigator!="undefined"&&navigator.product==="ReactNative";Eq.exports={isTest:_Ie,isElectron:Vy,isElectronMain:bIe,isElectronRenderer:mIe,isNode:vIe,isBrowser:gIe,isWebWorker:wIe,isEnvWithDom:sv,isReactNative:EIe}});var Sq=y(()=>{f()});var Hy=y((rh,xq)=>{f();"use strict";var SIe=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Ec!="undefined")return Ec;throw new Error("unable to locate global object")},Ec=SIe();xq.exports=rh=Ec.fetch;Ec.fetch&&(rh.default=Ec.fetch.bind(Ec));rh.Headers=Ec.Headers;rh.Request=Ec.Request;rh.Response=Ec.Response});var Bx=y((p3t,Nx)=>{f();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?Nx.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:Nx.exports={default:Hy().default,Headers:Hy().Headers,Request:Hy().Request,Response:Hy().Response}});var Aq=y((y3t,Mx)=>{f();"use strict";var{isElectronMain:xIe}=zy();xIe?Mx.exports=Sq():Mx.exports=Bx()});var Pq=y((g3t,Rq)=>{f();"use strict";var{TimeoutError:AIe,AbortError:IIe}=qx(),{Response:Iq,Request:TIe,Headers:Lx,default:RIe}=Aq(),PIe=(t,e={})=>{let r=new XMLHttpRequest;r.open(e.method||"GET",t.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(r.timeout=i),e.overrideMimeType!=null&&r.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new Lx(n))r.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>r.abort()),e.onUploadProgress&&(r.upload.onprogress=e.onUploadProgress),r.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(Iq.error());break}case"load":{s(new Tq(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:kIe(r.getAllResponseHeaders())}));break}case"timeout":{o(new AIe);break}case"abort":{o(new IIe);break}default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(e.body)})},CIe=RIe,OIe=(t,e={})=>e.onUploadProgress!=null?PIe(t,e):CIe(t,e),kIe=t=>{let e=new Lx;for(let r of t.trim().split(/[\r\n]+/)){let i=r.indexOf(": ");i>0&&e.set(r.slice(0,i),r.slice(i+1))}return e},Tq=class extends Iq{constructor(e,r,i){super(r,i);Object.defineProperty(this,"url",{value:e})}};Rq.exports={fetch:OIe,Request:TIe,Headers:Lx}});var Oq=y((b3t,Cq)=>{f();"use strict";Cq.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var gr=y((Nq,Bq)=>{f();"use strict";var ov=Oq(),{hasOwnProperty:kq}=Object.prototype,{propertyIsEnumerable:qIe}=Object,ih=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),DIe=Nq,qq={concatArrays:!1,ignoreUndefined:!1},av=t=>{let e=[];for(let r in t)kq.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let i of r)qIe.call(t,i)&&e.push(i)}return e};function nh(t){return Array.isArray(t)?NIe(t):ov(t)?BIe(t):t}function NIe(t){let e=t.slice(0,0);return av(t).forEach(r=>{ih(e,r,nh(t[r]))}),e}function BIe(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return av(t).forEach(r=>{ih(e,r,nh(t[r]))}),e}var Dq=(t,e,r,i)=>(r.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?ih(t,n,Ux(t[n],e[n],i)):ih(t,n,nh(e[n])))}),t),MIe=(t,e,r)=>{let i=t.slice(0,0),n=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!kq.call(s,a)||(o.push(String(a)),s===t?ih(i,n++,s[a]):ih(i,n++,nh(s[a])));i=Dq(i,s,av(s).filter(a=>!o.includes(a)),r)}),i};function Ux(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?MIe(t,e,r):!ov(e)||!ov(t)?nh(e):Dq(t,e,av(e),r)}Bq.exports=function(...t){let e=Ux(nh(qq),this!==DIe&&this||{},qq),r={_:{}};for(let i of t)if(i!==void 0){if(!ov(i))throw new TypeError("`"+i+"` is not an Option Object");r=Ux(r,{_:i},e)}return r._}});var Fx=y((m3t,Uq)=>{f();"use strict";var LIe=typeof navigator!="undefined"&&navigator.product==="ReactNative";function UIe(){return LIe?"http://localhost":self.location.protocol+"//"+self.location.host}var $y=self.URL,Mq=UIe(),Lq=class{constructor(e="",r=Mq){this.super=new $y(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return $y.createObjectURL(e)}static revokeObjectURL(e){$y.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function FIe(t){if(typeof t=="string")return new $y(t).toString();if(!(t instanceof $y)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",i=t.port?":"+t.port:"",n=t.protocol?t.protocol+"//":"",s=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"",l=t.path||u+a;return`${n}${e||r}${s||o+i}${l}${c}`}}Uq.exports={URLWithLegacySupport:Lq,URLSearchParams:self.URLSearchParams,defaultBase:Mq,format:FIe}});var jq=y((v3t,Kq)=>{f();"use strict";var{URLWithLegacySupport:Fq,format:KIe}=Fx();Kq.exports=(t,e={},r={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(r[n]||i||n)+":";let s;try{s=new Fq(t)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new Fq(t,KIe(o)).toString()}});var cv=y((w3t,Vq)=>{f();"use strict";var{URLWithLegacySupport:jIe,format:VIe,URLSearchParams:zIe,defaultBase:HIe}=Fx(),$Ie=jq();Vq.exports={URL:jIe,URLSearchParams:zIe,format:VIe,relative:$Ie,defaultBase:HIe}});var nf=y((_3t,uv)=>{f();"use strict";var{AbortController:zq,AbortSignal:GIe}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;uv.exports=zq;uv.exports.AbortSignal=GIe;uv.exports.default=zq});var nn=y((E3t,Hq)=>{f();"use strict";var lv;globalThis.AbortController&&globalThis.AbortSignal?lv=globalThis:lv=nf();Hq.exports={AbortController:lv.AbortController,AbortSignal:lv.AbortSignal}});var Tu=y((S3t,Kx)=>{f();var{AbortController:WIe}=nn();function $q(t){let e=new WIe;function r(){e.abort();for(let i of t)!i||!i.removeEventListener||i.removeEventListener("abort",r)}for(let i of t)if(!(!i||!i.addEventListener)){if(i.aborted){r();break}i.addEventListener("abort",r)}return e.signal}Kx.exports=$q;Kx.exports.anySignal=$q});var Gy=y((x3t,Zq)=>{f();"use strict";var{fetch:YIe,Request:XIe,Headers:QIe}=Pq(),{TimeoutError:jx,HTTPError:Gq}=qx(),Wq=gr().bind({ignoreUndefined:!0}),{URL:Yq,URLSearchParams:Xq}=cv(),{AbortController:ZIe}=nn(),JIe=Tu(),e4e=(t,e,r)=>{if(e===void 0)return t;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new jx),r.abort())},e),c=u=>d=>{if(clearTimeout(a),n()){o(new jx);return}u(d)};t.then(c(s),c(o))})},t4e={throwHttpErrors:!0,credentials:"same-origin"},Sn=class{constructor(e={}){this.opts=Wq(t4e,e)}async fetch(e,r={}){let i=Wq(this.opts,r),n=new QIe(i.headers);if(typeof e!="string"&&!(e instanceof Yq||e instanceof XIe))throw new TypeError("`resource` must be a string, URL, or Request");let s=new Yq(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new Xq(i.searchParams)):s.search=new Xq(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let u=new ZIe,l=JIe([u.signal,i.signal]),d=await e4e(YIe(s.toString(),{...i,signal:l,timeout:void 0,headers:n}),i.timeout,u);if(!d.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(d),new Gq(d);return d.iterator=function(){return Qq(d.body)},d.ndjson=async function*(){for await(let h of r4e(d.iterator()))r.transform?yield r.transform(h):yield h},d}post(e,r={}){return this.fetch(e,{...r,method:"POST"})}get(e,r={}){return this.fetch(e,{...r,method:"GET"})}put(e,r={}){return this.fetch(e,{...r,method:"PUT"})}delete(e,r={}){return this.fetch(e,{...r,method:"DELETE"})}options(e,r={}){return this.fetch(e,{...r,method:"OPTIONS"})}},r4e=async function*(t){let e=new TextDecoder,r="";for await(let i of t){r+=e.decode(i,{stream:!0});let n=r.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}r=n[n.length-1]}r+=e.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},Qq=t=>{if(s4e(t)){let e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(r){return t.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:r})}}}}}if(n4e(t)){let e=t.getReader();return async function*(){try{for(;;){let{done:r,value:i}=await e.read();if(r)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(i4e(t))return t;throw new TypeError("Body can't be converted to AsyncIterable")},i4e=t=>typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function",n4e=t=>t&&typeof t.getReader=="function",s4e=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable");Sn.HTTPError=Gq;Sn.TimeoutError=jx;Sn.streamToAsyncIterator=Qq;Sn.post=(t,e)=>new Sn(e).post(t,e);Sn.get=(t,e)=>new Sn(e).get(t,e);Sn.put=(t,e)=>new Sn(e).put(t,e);Sn.delete=(t,e)=>new Sn(e).delete(t,e);Sn.options=(t,e)=>new Sn(e).options(t,e);Zq.exports=Sn});var Vx=y((A3t,Jq)=>{f();"use strict";var o4e=Gy(),a4e=(t,e)=>({path:decodeURIComponent(new URL(t).pathname.split("/").pop()||""),content:c4e(t,e)});async function*c4e(t,e){yield*(await new o4e().get(t,e)).iterator()}Jq.exports=a4e});function tD(t,e,r){e=e||[],r=r||0;for(var i=r;t>=d4e;)e[r++]=t&255|eD,t/=128;for(;t&f4e;)e[r++]=t&255|eD,t>>>=7;return e[r]=t|0,tD.bytes=r-i+1,e}function zx(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw zx.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&rD)<<i:(s&rD)*Math.pow(2,i),i+=7}while(s>=p4e);return zx.bytes=n-e,r}var u4e,eD,l4e,f4e,d4e,h4e,p4e,rD,y4e,g4e,b4e,m4e,v4e,w4e,_4e,E4e,S4e,x4e,A4e,I4e,Wy,iD=xe(()=>{f();u4e=tD,eD=128,l4e=127,f4e=~l4e,d4e=Math.pow(2,31);h4e=zx,p4e=128,rD=127;y4e=Math.pow(2,7),g4e=Math.pow(2,14),b4e=Math.pow(2,21),m4e=Math.pow(2,28),v4e=Math.pow(2,35),w4e=Math.pow(2,42),_4e=Math.pow(2,49),E4e=Math.pow(2,56),S4e=Math.pow(2,63),x4e=function(t){return t<y4e?1:t<g4e?2:t<b4e?3:t<m4e?4:t<v4e?5:t<w4e?6:t<_4e?7:t<E4e?8:t<S4e?9:10},A4e={encode:u4e,decode:h4e,encodingLength:x4e},I4e=A4e,Wy=I4e});var Yy={};ut(Yy,{decode:()=>sh,encodeTo:()=>sf,encodingLength:()=>of});var sh,sf,of,fv=xe(()=>{f();iD();sh=t=>[Wy.decode(t),Wy.decode.bytes],sf=(t,e,r=0)=>(Wy.encode(t,e,r),e),of=t=>Wy.encodingLength(t)});var Sc={};ut(Sc,{coerce:()=>yo,empty:()=>nD,equals:()=>Hx,fromHex:()=>R4e,fromString:()=>$x,isBinary:()=>P4e,toHex:()=>T4e,toString:()=>Gx});var nD,T4e,R4e,Hx,yo,P4e,$x,Gx,Ru=xe(()=>{f();nD=new Uint8Array(0),T4e=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),""),R4e=t=>{let e=t.match(/../g);return e?new Uint8Array(e.map(r=>parseInt(r,16))):nD},Hx=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},yo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},P4e=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),$x=t=>new TextEncoder().encode(t),Gx=t=>new TextDecoder().decode(t)});var Ln={};ut(Ln,{Digest:()=>oh,create:()=>Xy,decode:()=>Pu,equals:()=>Wx});var Xy,Pu,Wx,oh,xn=xe(()=>{f();Ru();fv();Xy=(t,e)=>{let r=e.byteLength,i=of(t),n=i+of(r),s=new Uint8Array(n+r);return sf(t,s,0),sf(r,s,i),s.set(e,n),new oh(t,r,e,s)},Pu=t=>{let e=yo(t),[r,i]=sh(e),[n,s]=sh(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new oh(r,n,o,e)},Wx=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&Hx(t.bytes,e.bytes),oh=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}});function C4e(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var m=0,E=0,v=0,A=g.length;v!==A&&g[v]===0;)v++,m++;for(var R=(A-v)*l+1>>>0,F=new Uint8Array(R);v!==A;){for(var q=g[v],D=0,z=R-1;(q!==0||D<E)&&z!==-1;z--,D++)q+=256*F[z]>>>0,F[z]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");E=D,v++}for(var G=R-E;G!==R&&F[G]===0;)G++;for(var Y=c.repeat(m);G<R;++G)Y+=t.charAt(F[G]);return Y}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var m=0;if(g[m]!==" "){for(var E=0,v=0;g[m]===c;)E++,m++;for(var A=(g.length-m)*u+1>>>0,R=new Uint8Array(A);g[m];){var F=r[g.charCodeAt(m)];if(F===255)return;for(var q=0,D=A-1;(F!==0||q<v)&&D!==-1;D--,q++)F+=a*R[D]>>>0,R[D]=F%256>>>0,F=F/256>>>0;if(F!==0)throw new Error("Non-zero carry");v=q,m++}if(g[m]!==" "){for(var z=A-v;z!==A&&R[z]===0;)z++;for(var G=new Uint8Array(E+(A-z)),Y=E;z!==A;)G[Y++]=R[z++];return G}}}function p(g){var m=h(g);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var O4e,k4e,sD,oD=xe(()=>{f();O4e=C4e,k4e=O4e,sD=k4e});var aD,cD,dv,uD,hv,Cu,q4e,D4e,Kr,fa=xe(()=>{f();oD();Ru();aD=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},cD=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let r={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new dv(r)}},dv=class{constructor(e){this.decoders=e}or(e){let r=e.decoders||{[e.prefix]:e};return new dv({...this.decoders,...r})}decode(e){let r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},uD=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new aD(e,r,i),this.decoder=new cD(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},hv=({name:t,prefix:e,encode:r,decode:i})=>new uD(t,e,r,i),Cu=({prefix:t,name:e,alphabet:r})=>{let{encode:i,decode:n}=sD(r,e);return hv({prefix:t,name:e,encode:i,decode:s=>yo(n(s))})},q4e=(t,e,r,i)=>{let n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let d=n[t[l]];if(d===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},D4e=(t,e,r)=>{let i=e[e.length-1]==="=",n=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Kr=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>hv({prefix:e,name:t,encode(n){return D4e(n,i,r)},decode(n){return q4e(n,i,r,t)}})});var Jr={};ut(Jr,{base58btc:()=>da,base58flickr:()=>N4e});var da,N4e,ei=xe(()=>{f();fa();da=Cu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),N4e=Cu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var sn={};ut(sn,{base32:()=>ah,base32hex:()=>U4e,base32hexpad:()=>K4e,base32hexpadupper:()=>j4e,base32hexupper:()=>F4e,base32pad:()=>M4e,base32padupper:()=>L4e,base32upper:()=>B4e,base32z:()=>V4e});var ah,B4e,M4e,L4e,U4e,F4e,K4e,j4e,V4e,on=xe(()=>{f();fa();ah=Kr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),B4e=Kr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),M4e=Kr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),L4e=Kr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),U4e=Kr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),F4e=Kr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),K4e=Kr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j4e=Kr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V4e=Kr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Ne={};ut(Ne,{CID:()=>We});var We,z4e,H4e,$4e,Qy,G4e,lD,fD,pv,yv,W4e,Y4e,X4e,Ie=xe(()=>{f();fv();xn();ei();on();Ru();We=class{constructor(e,r,i,n){this.code=r,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:yv,byteLength:yv,code:pv,version:pv,multihash:pv,bytes:pv,_baseCache:yv,asCID:yv})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Qy)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==G4e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return We.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,i=Xy(e,r);return We.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Wx(this.multihash,e.multihash)}toString(e){let{bytes:r,version:i,_baseCache:n}=this;switch(i){case 0:return H4e(r,n,e||da.encoder);default:return $4e(r,n,e||ah.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Y4e(/^0\.0/,X4e),!!(e&&(e[fD]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof We)return e;if(e!=null&&e.asCID===e){let{version:r,code:i,multihash:n,bytes:s}=e;return new We(r,i,n,s||lD(r,i,n.bytes))}else if(e!=null&&e[fD]===!0){let{version:r,multihash:i,code:n}=e,s=Pu(i);return We.create(r,n,s)}else return null}static create(e,r,i){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Qy)throw new Error(`Version 0 CID must use dag-pb (code: ${Qy}) block encoding`);return new We(e,r,i,i.bytes)}case 1:{let n=lD(e,r,i.bytes);return new We(e,r,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return We.create(0,Qy,e)}static createV1(e,r){return We.create(1,e,r)}static decode(e){let[r,i]=We.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=We.inspectBytes(e),i=r.size-r.multihashSize,n=yo(e.subarray(i,i+r.multihashSize));if(n.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=n.subarray(r.multihashSize-r.digestSize),o=new oh(r.multihashCode,r.digestSize,s,n);return[r.version===0?We.createV0(o):We.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,i=()=>{let[d,h]=sh(e.subarray(r));return r+=h,d},n=i(),s=Qy;if(n===18?(n=0,r=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=r,a=i(),c=i(),u=r+c,l=u-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[i,n]=z4e(e,r),s=We.decode(n);return s._baseCache.set(i,e),s}},z4e=(t,e)=>{switch(t[0]){case"Q":{let r=e||da;return[da.prefix,r.decode(`${da.prefix}${t}`)]}case da.prefix:{let r=e||da;return[da.prefix,r.decode(t)]}case ah.prefix:{let r=e||ah;return[ah.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},H4e=(t,e,r)=>{let{prefix:i}=r;if(i!==da.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let n=e.get(i);if(n==null){let s=r.encode(t).slice(1);return e.set(i,s),s}else return n},$4e=(t,e,r)=>{let{prefix:i}=r,n=e.get(i);if(n==null){let s=r.encode(t);return e.set(i,s),s}else return n},Qy=112,G4e=18,lD=(t,e,r)=>{let i=of(t),n=i+of(e),s=new Uint8Array(n+r.byteLength);return sf(t,s,0),sf(e,s,i),s.set(r,n),s},fD=Symbol.for("@ipld/js-cid/CID"),pv={writable:!1,configurable:!1,enumerable:!0},yv={writable:!1,enumerable:!1,configurable:!1},W4e="0.0.0-dev",Y4e=(t,e)=>{if(t.test(W4e))console.warn(e);else throw new Error(e)},X4e=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var gv={};ut(gv,{base36:()=>Q4e,base36upper:()=>Z4e});var Q4e,Z4e,Yx=xe(()=>{f();fa();Q4e=Cu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Z4e=Cu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var ch={};ut(ch,{base64:()=>J4e,base64pad:()=>eTe,base64url:()=>tTe,base64urlpad:()=>rTe});var J4e,eTe,tTe,rTe,Zy=xe(()=>{f();fa();J4e=Kr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),eTe=Kr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),tTe=Kr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rTe=Kr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var bv={};ut(bv,{base16:()=>iTe,base16upper:()=>nTe});var iTe,nTe,Xx=xe(()=>{f();fa();iTe=Kr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),nTe=Kr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var hD=y((z3t,dD)=>{f();"use strict";dD.exports=sTe;function sTe(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(a,c){r[i]=function(l){if(s)if(s=!1,l)c(l);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];a.apply(null,d)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var bD=y(gD=>{f();"use strict";var mv=gD;mv.length=function(e){var r=e.length;if(!r)return 0;for(var i=0;--r%4>1&&e.charAt(r)==="=";)++i;return Math.ceil(e.length*3)/4-i};var uh=new Array(64),pD=new Array(123);for(go=0;go<64;)pD[uh[go]=go<26?go+65:go<52?go+71:go<62?go-4:go-59|43]=go++;var go;mv.encode=function(e,r,i){for(var n=null,s=[],o=0,a=0,c;r<i;){var u=e[r++];switch(a){case 0:s[o++]=uh[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=uh[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=uh[c|u>>6],s[o++]=uh[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=uh[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var yD="invalid encoding";mv.decode=function(e,r,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=pD[c])===void 0)throw Error(yD);switch(s){case 0:o=c,s=1;break;case 1:r[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(yD);return i-n};mv.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var vD=y(($3t,mD)=>{f();"use strict";mD.exports=vv;function vv(){this._listeners={}}vv.prototype.on=function(e,r,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:i||this}),this};vv.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===r?i.splice(n,1):++n;return this};vv.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}});var ID=y((G3t,AD)=>{f();"use strict";AD.exports=wD(wD);function wD(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),i=r[3]===128;function n(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=i?n:s,t.writeFloatBE=i?s:n;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=i?o:a,t.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,_D),t.writeFloatBE=e.bind(null,ED);function r(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,SD),t.readFloatBE=r.bind(null,xD)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),i=r[7]===128;function n(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=i?n:s,t.writeDoubleBE=i?s:n;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=i?o:a,t.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,i(l>>>0,a,c+n),i((u<<31|l/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),l=o*Math.pow(2,-d),i(l*4503599627370496>>>0,a,c+n),i((u<<31|d+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,_D,0,4),t.writeDoubleBE=e.bind(null,ED,4,0);function r(i,n,s,o,a){var c=i(o,a+n),u=i(o,a+s),l=(u>>31)*2+1,d=u>>>20&2047,h=4294967296*(u&1048575)+c;return d===2047?h?NaN:l*(1/0):d===0?l*5e-324*h:l*Math.pow(2,d-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,SD,0,4),t.readDoubleBE=r.bind(null,xD,4,0)}(),t}function _D(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function ED(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function SD(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function xD(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var TD=y((exports,module)=>{f();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var PD=y(RD=>{f();"use strict";var Qx=RD;Qx.length=function(e){for(var r=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?r+=1:i<2048?r+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,r+=4):r+=3;return r};Qx.read=function(e,r,i){var n=i-r;if(n<1)return"";for(var s=null,o=[],a=0,c;r<i;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Qx.write=function(e,r,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128);return i-n}});var OD=y((Y3t,CD)=>{f();"use strict";CD.exports=oTe;function oTe(t,e,r){var i=r||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return t(c);o+c>i&&(s=t(i),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var qD=y((X3t,kD)=>{f();"use strict";kD.exports=Oi;var Jy=ku();function Oi(t,e){this.lo=t>>>0,this.hi=e>>>0}var af=Oi.zero=new Oi(0,0);af.toNumber=function(){return 0};af.zzEncode=af.zzDecode=function(){return this};af.length=function(){return 1};var aTe=Oi.zeroHash="\0\0\0\0\0\0\0\0";Oi.fromNumber=function(e){if(e===0)return af;var r=e<0;r&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return r&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Oi(i,n)};Oi.from=function(e){if(typeof e=="number")return Oi.fromNumber(e);if(Jy.isString(e))if(Jy.Long)e=Jy.Long.fromString(e);else return Oi.fromNumber(parseInt(e,10));return e.low||e.high?new Oi(e.low>>>0,e.high>>>0):af};Oi.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;return r||(i=i+1>>>0),-(r+i*4294967296)}return this.lo+this.hi*4294967296};Oi.prototype.toLong=function(e){return Jy.Long?new Jy.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Ou=String.prototype.charCodeAt;Oi.fromHash=function(e){return e===aTe?af:new Oi((Ou.call(e,0)|Ou.call(e,1)<<8|Ou.call(e,2)<<16|Ou.call(e,3)<<24)>>>0,(Ou.call(e,4)|Ou.call(e,5)<<8|Ou.call(e,6)<<16|Ou.call(e,7)<<24)>>>0)};Oi.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Oi.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Oi.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Oi.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}});var ku=y(Zx=>{f();"use strict";var $e=Zx;$e.asPromise=hD();$e.base64=bD();$e.EventEmitter=vD();$e.float=ID();$e.inquire=TD();$e.utf8=PD();$e.pool=OD();$e.LongBits=qD();$e.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);$e.global=$e.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Zx;$e.emptyArray=Object.freeze?Object.freeze([]):[];$e.emptyObject=Object.freeze?Object.freeze({}):{};$e.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};$e.isString=function(e){return typeof e=="string"||e instanceof String};$e.isObject=function(e){return e&&typeof e=="object"};$e.isset=$e.isSet=function(e,r){var i=e[r];return i!=null&&e.hasOwnProperty(r)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};$e.Buffer=function(){try{var t=$e.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();$e._Buffer_from=null;$e._Buffer_allocUnsafe=null;$e.newBuffer=function(e){return typeof e=="number"?$e.Buffer?$e._Buffer_allocUnsafe(e):new $e.Array(e):$e.Buffer?$e._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};$e.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;$e.Long=$e.global.dcodeIO&&$e.global.dcodeIO.Long||$e.global.Long||$e.inquire("long");$e.key2Re=/^true|false|0|1$/;$e.key32Re=/^-?(?:0|[1-9][0-9]*)$/;$e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;$e.longToHash=function(e){return e?$e.LongBits.from(e).toHash():$e.LongBits.zeroHash};$e.longFromHash=function(e,r){var i=$e.LongBits.fromHash(e);return $e.Long?$e.Long.fromBits(i.lo,i.hi,r):i.toNumber(Boolean(r))};function DD(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)(t[i[n]]===void 0||!r)&&(t[i[n]]=e[i[n]]);return t}$e.merge=DD;$e.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ND(t){function e(r,i){if(!(this instanceof e))return new e(r,i);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&DD(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}$e.newError=ND;$e.ProtocolError=ND("ProtocolError");$e.oneOfGetter=function(e){for(var r={},i=0;i<e.length;++i)r[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(r[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};$e.oneOfSetter=function(e){return function(r){for(var i=0;i<e.length;++i)e[i]!==r&&delete this[e[i]]}};$e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};$e._configure=function(){var t=$e.Buffer;if(!t){$e._Buffer_from=$e._Buffer_allocUnsafe=null;return}$e._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,i){return new t(r,i)},$e._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var s6=y((Z3t,UD)=>{f();"use strict";UD.exports=kt;var xs=ku(),Jx,wv=xs.LongBits,BD=xs.base64,MD=xs.utf8;function eg(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function e6(){}function cTe(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function kt(){this.len=0,this.head=new eg(e6,0,0),this.tail=this.head,this.states=null}var LD=function(){return xs.Buffer?function(){return(kt.create=function(){return new Jx})()}:function(){return new kt}};kt.create=LD();kt.alloc=function(e){return new xs.Array(e)};xs.Array!==Array&&(kt.alloc=xs.pool(kt.alloc,xs.Array.prototype.subarray));kt.prototype._push=function(e,r,i){return this.tail=this.tail.next=new eg(e,r,i),this.len+=r,this};function t6(t,e,r){e[r]=t&255}function uTe(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function r6(t,e){this.len=t,this.next=void 0,this.val=e}r6.prototype=Object.create(eg.prototype);r6.prototype.fn=uTe;kt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new r6((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};kt.prototype.int32=function(e){return e<0?this._push(i6,10,wv.fromNumber(e)):this.uint32(e)};kt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function i6(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}kt.prototype.uint64=function(e){var r=wv.from(e);return this._push(i6,r.length(),r)};kt.prototype.int64=kt.prototype.uint64;kt.prototype.sint64=function(e){var r=wv.from(e).zzEncode();return this._push(i6,r.length(),r)};kt.prototype.bool=function(e){return this._push(t6,1,e?1:0)};function n6(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}kt.prototype.fixed32=function(e){return this._push(n6,4,e>>>0)};kt.prototype.sfixed32=kt.prototype.fixed32;kt.prototype.fixed64=function(e){var r=wv.from(e);return this._push(n6,4,r.lo)._push(n6,4,r.hi)};kt.prototype.sfixed64=kt.prototype.fixed64;kt.prototype.float=function(e){return this._push(xs.float.writeFloatLE,4,e)};kt.prototype.double=function(e){return this._push(xs.float.writeDoubleLE,8,e)};var lTe=xs.Array.prototype.set?function(e,r,i){r.set(e,i)}:function(e,r,i){for(var n=0;n<e.length;++n)r[i+n]=e[n]};kt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(t6,1,0);if(xs.isString(e)){var i=kt.alloc(r=BD.length(e));BD.decode(e,i,0),e=i}return this.uint32(r)._push(lTe,r,e)};kt.prototype.string=function(e){var r=MD.length(e);return r?this.uint32(r)._push(MD.write,r,e):this._push(t6,1,0)};kt.prototype.fork=function(){return this.states=new cTe(this),this.head=this.tail=new eg(e6,0,0),this.len=0,this};kt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new eg(e6,0,0),this.len=0),this};kt.prototype.ldelim=function(){var e=this.head,r=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=r,this.len+=i),this};kt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,r,i),i+=e.len,e=e.next;return r};kt._configure=function(t){Jx=t,kt.create=LD(),Jx._configure()}});var jD=y((J3t,KD)=>{f();"use strict";KD.exports=ha;var FD=s6();(ha.prototype=Object.create(FD.prototype)).constructor=ha;var qu=ku();function ha(){FD.call(this)}ha._configure=function(){ha.alloc=qu._Buffer_allocUnsafe,ha.writeBytesBuffer=qu.Buffer&&qu.Buffer.prototype instanceof Uint8Array&&qu.Buffer.prototype.set.name==="set"?function(e,r,i){r.set(e,i)}:function(e,r,i){if(e.copy)e.copy(r,i,0,e.length);else for(var n=0;n<e.length;)r[i++]=e[n++]}};ha.prototype.bytes=function(e){qu.isString(e)&&(e=qu._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(ha.writeBytesBuffer,r,e),this};function fTe(t,e,r){t.length<40?qu.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}ha.prototype.string=function(e){var r=qu.Buffer.byteLength(e);return this.uint32(r),r&&this._push(fTe,r,e),this};ha._configure()});var c6=y((ext,GD)=>{f();"use strict";GD.exports=ti;var pa=ku(),o6,VD=pa.LongBits,dTe=pa.utf8;function bo(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ti(t){this.buf=t,this.pos=0,this.len=t.length}var zD=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ti(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ti(e);throw Error("illegal buffer")},HD=function(){return pa.Buffer?function(r){return(ti.create=function(n){return pa.Buffer.isBuffer(n)?new o6(n):zD(n)})(r)}:zD};ti.create=HD();ti.prototype._slice=pa.Array.prototype.subarray||pa.Array.prototype.slice;ti.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,bo(this,10);return e}}();ti.prototype.int32=function(){return this.uint32()|0};ti.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function a6(){var t=new VD(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw bo(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw bo(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ti.prototype.bool=function(){return this.uint32()!==0};function _v(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ti.prototype.fixed32=function(){if(this.pos+4>this.len)throw bo(this,4);return _v(this.buf,this.pos+=4)};ti.prototype.sfixed32=function(){if(this.pos+4>this.len)throw bo(this,4);return _v(this.buf,this.pos+=4)|0};function $D(){if(this.pos+8>this.len)throw bo(this,8);return new VD(_v(this.buf,this.pos+=4),_v(this.buf,this.pos+=4))}ti.prototype.float=function(){if(this.pos+4>this.len)throw bo(this,4);var e=pa.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ti.prototype.double=function(){if(this.pos+8>this.len)throw bo(this,4);var e=pa.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ti.prototype.bytes=function(){var e=this.uint32(),r=this.pos,i=this.pos+e;if(i>this.len)throw bo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,i):r===i?new this.buf.constructor(0):this._slice.call(this.buf,r,i)};ti.prototype.string=function(){var e=this.bytes();return dTe.read(e,0,e.length)};ti.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw bo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw bo(this);while(this.buf[this.pos++]&128);return this};ti.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ti._configure=function(t){o6=t,ti.create=HD(),o6._configure();var e=pa.Long?"toLong":"toNumber";pa.merge(ti.prototype,{int64:function(){return a6.call(this)[e](!1)},uint64:function(){return a6.call(this)[e](!0)},sint64:function(){return a6.call(this).zzDecode()[e](!1)},fixed64:function(){return $D.call(this)[e](!0)},sfixed64:function(){return $D.call(this)[e](!1)}})}});var QD=y((txt,XD)=>{f();"use strict";XD.exports=cf;var WD=c6();(cf.prototype=Object.create(WD.prototype)).constructor=cf;var YD=ku();function cf(t){WD.call(this,t)}cf._configure=function(){YD.Buffer&&(cf.prototype._slice=YD.Buffer.prototype.slice)};cf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};cf._configure()});var JD=y((rxt,ZD)=>{f();"use strict";ZD.exports=tg;var u6=ku();(tg.prototype=Object.create(u6.EventEmitter.prototype)).constructor=tg;function tg(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");u6.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}tg.prototype.rpcCall=function t(e,r,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return u6.asPromise(t,o,e,r,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};tg.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var tN=y(eN=>{f();"use strict";var hTe=eN;hTe.Service=JD()});var iN=y((nxt,rN)=>{f();"use strict";rN.exports={}});var oN=y(sN=>{f();"use strict";var Un=sN;Un.build="minimal";Un.Writer=s6();Un.BufferWriter=jD();Un.Reader=c6();Un.BufferReader=QD();Un.util=ku();Un.rpc=tN();Un.roots=iN();Un.configure=nN;function nN(){Un.util._configure(),Un.Writer._configure(Un.BufferWriter),Un.Reader._configure(Un.BufferReader)}nN()});var ki=y((oxt,aN)=>{f();"use strict";aN.exports=oN()});var Sv=y((axt,uN)=>{f();"use strict";var uf=ki(),Ev=uf.Reader,cN=uf.Writer,an=uf.util,As=uf.roots["libp2p-crypto-keys"]||(uf.roots["libp2p-crypto-keys"]={});As.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();As.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=an.newBuffer([]),t.encode=function(r,i){return i||(i=cN.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Ev||(r=Ev.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new As.PublicKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw an.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw an.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof As.PublicKey)return r;var i=new As.PublicKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?an.base64.decode(r.Data,i.Data=an.newBuffer(an.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=an.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?As.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?an.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,uf.util.toJSONOptions)},t}();As.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=an.newBuffer([]),t.encode=function(r,i){return i||(i=cN.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Ev||(r=Ev.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new As.PrivateKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw an.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw an.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof As.PrivateKey)return r;var i=new As.PrivateKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?an.base64.decode(r.Data,i.Data=an.newBuffer(an.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=an.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?As.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?an.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,uf.util.toJSONOptions)},t}();uN.exports=As});var dt=y((cxt,lN)=>{f();lN.exports={options:{usePureJavaScript:!1}}});var hN=y((uxt,dN)=>{f();var l6={};dN.exports=l6;var fN={};l6.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(t instanceof Uint8Array))i=pTe(t,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<t.length;++n){for(var c=0,u=t[n];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(n=0;t[n]===0&&n<t.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(r){var l=new RegExp(".{1,"+r+"}","g");i=i.match(l).join(`\r
`)}return i};l6.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=fN[e];if(!r){r=fN[e]=[];for(var i=0;i<e.length;++i)r[e.charCodeAt(i)]=i}t=t.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<t.length;i++){var a=r[t.charCodeAt(i)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*n,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function pTe(t,e){var r=0,i=e.length,n=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=n;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Qt=y((lxt,bN)=>{f();var pN=dt(),yN=hN(),re=bN.exports=pN.util=pN.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){re.nextTick=process.nextTick,typeof setImmediate=="function"?re.setImmediate=setImmediate:re.setImmediate=re.nextTick;return}if(typeof setImmediate=="function"){re.setImmediate=function(){return setImmediate.apply(void 0,arguments)},re.nextTick=function(a){return setImmediate(a)};return}if(re.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,t="forge.setImmediate",e=[];re.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=re.setImmediate;re.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}re.nextTick=re.setImmediate})();re.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;re.globalScope=function(){return re.isNodejs?globalThis:typeof self=="undefined"?window:self}();re.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};re.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};re.isArrayBufferView=function(t){return t&&re.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function rg(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}re.ByteBuffer=f6;function f6(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(re.isArrayBuffer(t)||re.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof f6||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}re.ByteStringBuffer=f6;var yTe=4096;re.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>yTe&&(this.data.substr(0,1),this._constructedStringLength=0)};re.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};re.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};re.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};re.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};re.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};re.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(re.encodeUtf8(t))};re.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};re.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};re.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};re.ByteStringBuffer.prototype.putInt=function(t,e){rg(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};re.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};re.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};re.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};re.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};re.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};re.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};re.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};re.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};re.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};re.ByteStringBuffer.prototype.getInt=function(t){rg(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};re.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};re.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};re.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};re.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};re.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};re.ByteStringBuffer.prototype.copy=function(){var t=re.createBuffer(this.data);return t.read=this.read,t};re.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};re.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};re.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};re.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};re.ByteStringBuffer.prototype.toString=function(){return re.decodeUtf8(this.bytes())};function gTe(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=re.isArrayBuffer(t),i=re.isArrayBufferView(t);if(r||i){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}re.DataBuffer=gTe;re.DataBuffer.prototype.length=function(){return this.write-this.read};re.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};re.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this};re.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};re.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};re.DataBuffer.prototype.putBytes=function(t,e){if(re.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(r),this.write+=i,this}if(re.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof re.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&re.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var n=new Uint8Array(t.data.byteLength,this.write);return n.set(r),this.write+=r.byteLength,this}if(t instanceof re.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=re.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=re.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};re.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};re.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};re.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};re.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};re.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};re.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};re.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};re.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};re.DataBuffer.prototype.putInt=function(t,e){rg(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};re.DataBuffer.prototype.putSignedInt=function(t,e){return rg(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};re.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};re.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};re.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};re.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};re.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};re.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};re.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};re.DataBuffer.prototype.getInt=function(t){rg(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};re.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};re.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};re.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};re.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};re.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};re.DataBuffer.prototype.copy=function(){return new re.DataBuffer(this)};re.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};re.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};re.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};re.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};re.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return re.binary.raw.encode(e);if(t==="hex")return re.binary.hex.encode(e);if(t==="base64")return re.binary.base64.encode(e);if(t==="utf8")return re.text.utf8.decode(e);if(t==="utf16")return re.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};re.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=re.encodeUtf8(t)),new re.ByteBuffer(t)};re.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};re.xorBytes=function(t,e,r){for(var i="",n="",s="",o=0,a=0;r>0;--r,++o)n=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};re.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};re.bytesToHex=function(t){return re.createBuffer(t).toHex()};re.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Du="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Nu=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],gN="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";re.encode64=function(t,e){for(var r="",i="",n,s,o,a=0;a<t.length;)n=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=Du.charAt(n>>2),r+=Du.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Du.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Du.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};re.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,i,n,s,o=0;o<t.length;)r=Nu[t.charCodeAt(o++)-43],i=Nu[t.charCodeAt(o++)-43],n=Nu[t.charCodeAt(o++)-43],s=Nu[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};re.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};re.decodeUtf8=function(t){return decodeURIComponent(escape(t))};re.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:yN.encode,decode:yN.decode}};re.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};re.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};re.binary.hex.encode=re.bytesToHex;re.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,s=r;for(t.length&1&&(n=1,i[s++]=parseInt(t[0],16));n<t.length;n+=2)i[s++]=parseInt(t.substr(n,2),16);return e?s-r:i};re.binary.base64.encode=function(t,e){for(var r="",i="",n,s,o,a=0;a<t.byteLength;)n=t[a++],s=t[a++],o=t[a++],r+=Du.charAt(n>>2),r+=Du.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Du.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Du.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};re.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,s,o,a,c=0,u=r;c<t.length;)n=Nu[t.charCodeAt(c++)-43],s=Nu[t.charCodeAt(c++)-43],o=Nu[t.charCodeAt(c++)-43],a=Nu[t.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,a!==64&&(i[u++]=(o&3)<<6|a));return e?u-r:i.subarray(0,u)};re.binary.base58.encode=function(t,e){return re.binary.baseN.encode(t,gN,e)};re.binary.base58.decode=function(t,e){return re.binary.baseN.decode(t,gN,e)};re.text={utf8:{},utf16:{}};re.text.utf8.encode=function(t,e,r){t=re.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};re.text.utf8.decode=function(t){return re.decodeUtf8(String.fromCharCode.apply(null,t))};re.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length*2));var n=new Uint16Array(i.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)n[o++]=t.charCodeAt(a),s+=2;return e?s-r:i};re.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};re.deflate=function(t,e,r){if(e=re.decode64(t.deflate(re.encode64(e)).rval),r){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};re.inflate=function(t,e,r){var i=t.inflate(re.encode64(e)).rval;return i===null?null:re.decode64(i)};var d6=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(r===null?i=t.removeItem(e):(r=re.encode64(JSON.stringify(r)),i=t.setItem(e,r)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},h6=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(re.decode64(r))),r},bTe=function(t,e,r,i){var n=h6(t,e);n===null&&(n={}),n[r]=i,d6(t,e,n)},mTe=function(t,e,r){var i=h6(t,e);return i!==null&&(i=r in i?i[r]:null),i},vTe=function(t,e,r){var i=h6(t,e);if(i!==null&&r in i){delete i[r];var n=!0;for(var s in i){n=!1;break}n&&(i=null),d6(t,e,i)}},wTe=function(t,e){d6(t,e,null)},xv=function(t,e,r){var i=null;typeof r=="undefined"&&(r=["web","flash"]);var n,s=!1,o=null;for(var a in r){n=r[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=t.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};re.setItem=function(t,e,r,i,n){xv(bTe,arguments,n)};re.getItem=function(t,e,r,i){return xv(mTe,arguments,i)};re.removeItem=function(t,e,r,i){xv(vTe,arguments,i)};re.clearItems=function(t,e,r){xv(wTe,arguments,r)};re.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),i=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var Av=null;re.getQueryVariables=function(t){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,u;a>0?(c=s[o].substring(0,a),u=s[o].substring(a+1)):(c=s[o],u=null),c in n||(n[c]=[]),!(c in Object.prototype)&&u!==null&&n[c].push(unescape(u))}return n},r;return typeof t=="undefined"?(Av===null&&(typeof window!="undefined"&&window.location&&window.location.search?Av=e(window.location.search.substring(1)):Av={}),r=Av):r=e(t),r};re.parseFragment=function(t){var e=t,r="",i=t.indexOf("?");i>0&&(e=t.substring(0,i),r=t.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=r===""?{}:re.getQueryVariables(r);return{pathString:e,queryString:r,path:n,query:s}};re.makeRequest=function(t){var e=re.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=r.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return r};re.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var i=jQuery.param(e||{});return r=r||"",t+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")};re.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};re.format=function(t){for(var e=/%./g,r,i,n=0,s=[],o=0;r=e.exec(t);){i=t.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};re.formatNumber=function(t,e,r,i){var n=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};re.formatSize=function(t){return t>=1073741824?t=re.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=re.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=re.formatNumber(t/1024,0)+" KiB":t=re.formatNumber(t,0)+" bytes",t};re.bytesFromIP=function(t){return t.indexOf(".")!==-1?re.bytesFromIPv4(t):t.indexOf(":")!==-1?re.bytesFromIPv6(t):null};re.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=re.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};re.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,i=re.createBuffer(),n=0;n<8;++n){if(!t[n]||t[n].length===0){i.fillWithByte(0,r),r=0;continue}var s=re.hexToBytes(t[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};re.bytesToIP=function(t){return t.length===4?re.bytesToIPv4(t):t.length===16?re.bytesToIPv6(t):null};re.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};re.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var s=re.bytesToHex(t[n]+t[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[i].end-r[i].start&&(i=r.length-1))}e.push(s)}if(r.length>0){var c=r[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};re.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in re&&!t.update)return e(null,re.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return re.cores=navigator.hardwareConcurrency,e(null,re.cores);if(typeof Worker=="undefined")return re.cores=1,e(null,re.cores);if(typeof Blob=="undefined")return re.cores=2,e(null,re.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,d){return l+d},0)/o.length);return re.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,re.cores)}n(c,function(l,d){o.push(s(c,d)),i(o,a-1,c)})}function n(o,a){for(var c=[],u=[],l=0;l<o;++l){var d=new Worker(r);d.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(d)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],d=c[u]=[],h=0;h<o;++h)if(u!==h){var p=a[h];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&d.push(h)}return c.reduce(function(g,m){return Math.max(g,m.length)},0)}}});var lh=y((fxt,mN)=>{f();var ig=dt();ig.pki=ig.pki||{};var p6=mN.exports=ig.pki.oids=ig.oids=ig.oids||{};function Ae(t,e){p6[t]=e,p6[e]=t}function Ht(t,e){p6[t]=e}Ae("1.2.840.113549.1.1.1","rsaEncryption");Ae("1.2.840.113549.1.1.4","md5WithRSAEncryption");Ae("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Ae("1.2.840.113549.1.1.7","RSAES-OAEP");Ae("1.2.840.113549.1.1.8","mgf1");Ae("1.2.840.113549.1.1.9","pSpecified");Ae("1.2.840.113549.1.1.10","RSASSA-PSS");Ae("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Ae("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Ae("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Ae("1.3.101.112","EdDSA25519");Ae("1.2.840.10040.4.3","dsa-with-sha1");Ae("1.3.14.3.2.7","desCBC");Ae("1.3.14.3.2.26","sha1");Ae("2.16.840.1.101.3.4.2.1","sha256");Ae("2.16.840.1.101.3.4.2.2","sha384");Ae("2.16.840.1.101.3.4.2.3","sha512");Ae("1.2.840.113549.2.5","md5");Ae("1.2.840.113549.1.7.1","data");Ae("1.2.840.113549.1.7.2","signedData");Ae("1.2.840.113549.1.7.3","envelopedData");Ae("1.2.840.113549.1.7.4","signedAndEnvelopedData");Ae("1.2.840.113549.1.7.5","digestedData");Ae("1.2.840.113549.1.7.6","encryptedData");Ae("1.2.840.113549.1.9.1","emailAddress");Ae("1.2.840.113549.1.9.2","unstructuredName");Ae("1.2.840.113549.1.9.3","contentType");Ae("1.2.840.113549.1.9.4","messageDigest");Ae("1.2.840.113549.1.9.5","signingTime");Ae("1.2.840.113549.1.9.6","counterSignature");Ae("1.2.840.113549.1.9.7","challengePassword");Ae("1.2.840.113549.1.9.8","unstructuredAddress");Ae("1.2.840.113549.1.9.14","extensionRequest");Ae("1.2.840.113549.1.9.20","friendlyName");Ae("1.2.840.113549.1.9.21","localKeyId");Ae("1.2.840.113549.1.9.22.1","x509Certificate");Ae("1.2.840.113549.1.12.10.1.1","keyBag");Ae("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Ae("1.2.840.113549.1.12.10.1.3","certBag");Ae("1.2.840.113549.1.12.10.1.4","crlBag");Ae("1.2.840.113549.1.12.10.1.5","secretBag");Ae("1.2.840.113549.1.12.10.1.6","safeContentsBag");Ae("1.2.840.113549.1.5.13","pkcs5PBES2");Ae("1.2.840.113549.1.5.12","pkcs5PBKDF2");Ae("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Ae("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Ae("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Ae("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Ae("1.2.840.113549.2.7","hmacWithSHA1");Ae("1.2.840.113549.2.8","hmacWithSHA224");Ae("1.2.840.113549.2.9","hmacWithSHA256");Ae("1.2.840.113549.2.10","hmacWithSHA384");Ae("1.2.840.113549.2.11","hmacWithSHA512");Ae("1.2.840.113549.3.7","des-EDE3-CBC");Ae("2.16.840.1.101.3.4.1.2","aes128-CBC");Ae("2.16.840.1.101.3.4.1.22","aes192-CBC");Ae("2.16.840.1.101.3.4.1.42","aes256-CBC");Ae("2.5.4.3","commonName");Ae("2.5.4.5","serialName");Ae("2.5.4.6","countryName");Ae("2.5.4.7","localityName");Ae("2.5.4.8","stateOrProvinceName");Ae("2.5.4.9","streetAddress");Ae("2.5.4.10","organizationName");Ae("2.5.4.11","organizationalUnitName");Ae("2.5.4.13","description");Ae("2.5.4.15","businessCategory");Ae("2.5.4.17","postalCode");Ae("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Ae("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Ae("2.16.840.1.113730.1.1","nsCertType");Ae("2.16.840.1.113730.1.13","nsComment");Ht("2.5.29.1","authorityKeyIdentifier");Ht("2.5.29.2","keyAttributes");Ht("2.5.29.3","certificatePolicies");Ht("2.5.29.4","keyUsageRestriction");Ht("2.5.29.5","policyMapping");Ht("2.5.29.6","subtreesConstraint");Ht("2.5.29.7","subjectAltName");Ht("2.5.29.8","issuerAltName");Ht("2.5.29.9","subjectDirectoryAttributes");Ht("2.5.29.10","basicConstraints");Ht("2.5.29.11","nameConstraints");Ht("2.5.29.12","policyConstraints");Ht("2.5.29.13","basicConstraints");Ae("2.5.29.14","subjectKeyIdentifier");Ae("2.5.29.15","keyUsage");Ht("2.5.29.16","privateKeyUsagePeriod");Ae("2.5.29.17","subjectAltName");Ae("2.5.29.18","issuerAltName");Ae("2.5.29.19","basicConstraints");Ht("2.5.29.20","cRLNumber");Ht("2.5.29.21","cRLReason");Ht("2.5.29.22","expirationDate");Ht("2.5.29.23","instructionCode");Ht("2.5.29.24","invalidityDate");Ht("2.5.29.25","cRLDistributionPoints");Ht("2.5.29.26","issuingDistributionPoint");Ht("2.5.29.27","deltaCRLIndicator");Ht("2.5.29.28","issuingDistributionPoint");Ht("2.5.29.29","certificateIssuer");Ht("2.5.29.30","nameConstraints");Ae("2.5.29.31","cRLDistributionPoints");Ae("2.5.29.32","certificatePolicies");Ht("2.5.29.33","policyMappings");Ht("2.5.29.34","policyConstraints");Ae("2.5.29.35","authorityKeyIdentifier");Ht("2.5.29.36","policyConstraints");Ae("2.5.29.37","extKeyUsage");Ht("2.5.29.46","freshestCRL");Ht("2.5.29.54","inhibitAnyPolicy");Ae("1.3.6.1.4.1.11129.2.4.2","timestampList");Ae("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Ae("1.3.6.1.5.5.7.3.1","serverAuth");Ae("1.3.6.1.5.5.7.3.2","clientAuth");Ae("1.3.6.1.5.5.7.3.3","codeSigning");Ae("1.3.6.1.5.5.7.3.4","emailProtection");Ae("1.3.6.1.5.5.7.3.8","timeStamping")});var xc=y((dxt,wN)=>{f();var br=dt();Qt();lh();var Me=wN.exports=br.asn1=br.asn1||{};Me.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Me.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Me.create=function(t,e,r,i,n){if(br.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:t,type:e,constructed:r,composed:r||br.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Me.copy(a)),a};Me.copy=function(t,e){var r;if(br.util.isArray(t)){r=[];for(var i=0;i<t.length;++i)r.push(Me.copy(t[i],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Me.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Me.equals=function(t,e,r){if(br.util.isArray(t)){if(!br.util.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!Me.equals(t[i],e[i]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var n=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Me.equals(t.value,e.value);return r&&r.includeBitStringContents&&(n=n&&t.bitStringContents===e.bitStringContents),n};Me.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,i=e&128;return i?r=t.getInt((e&127)<<3):r=e,r}};function ng(t,e,r){if(r>e){var i=new Error("Too few bytes to parse DER.");throw i.available=t.length(),i.remaining=e,i.requested=r,i}}var _Te=function(t,e){var r=t.getByte();if(e--,r!==128){var i,n=r&128;if(!n)i=r;else{var s=r&127;ng(t,e,s),i=t.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Me.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=br.util.createBuffer(t)),Iv(t,t.length(),0,e)};function Iv(t,e,r,i){var n;ng(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;n=t.length();var c=_Te(t,e);if(e-=n-t.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,d,h=(s&32)==32;if(h)if(l=[],c===void 0)for(;;){if(ng(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}n=t.length(),l.push(Iv(t,e,r+1,i)),e-=n-t.length()}else for(;c>0;)n=t.length(),l.push(Iv(t,c,r+1,i)),e-=n-t.length(),c-=n-t.length();if(l===void 0&&o===Me.Class.UNIVERSAL&&a===Me.Type.BITSTRING&&(d=t.bytes(c)),l===void 0&&i.decodeBitStrings&&o===Me.Class.UNIVERSAL&&a===Me.Type.BITSTRING&&c>1){var p=t.read,g=e,m=0;if(a===Me.Type.BITSTRING&&(ng(t,e,1),m=t.getByte(),e--),m===0)try{n=t.length();var E={verbose:i.verbose,strict:!0,decodeBitStrings:!0},v=Iv(t,e,r+1,E),A=n-t.length();e-=A,a==Me.Type.BITSTRING&&A++;var R=v.tagClass;A===c&&(R===Me.Class.UNIVERSAL||R===Me.Class.CONTEXT_SPECIFIC)&&(l=[v])}catch(q){}l===void 0&&(t.read=p,e=g)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Me.Type.BMPSTRING)for(l="";c>0;c-=2)ng(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c)}var F=d===void 0?null:{bitStringContents:d};return Me.create(o,a,h,l,F)}Me.toDer=function(t){var e=br.util.createBuffer(),r=t.tagClass|t.type,i=br.util.createBuffer(),n=!1;if("bitStringContents"in t&&(n=!0,t.original&&(n=Me.equals(t,t.original))),n)i.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:i.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&i.putBuffer(Me.toDer(t.value[s]))}else if(t.type===Me.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)i.putInt16(t.value.charCodeAt(s));else t.type===Me.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?i.putBytes(t.value.substr(1)):i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Me.oidToDer=function(t){var e=t.split("."),r=br.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)r.putByte(n[c])}return r};Me.derToOid=function(t){var e;typeof t=="string"&&(t=br.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i=i<<7,r&128?i+=r&127:(e+="."+(i+r),i=0);return e};Me.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),d=parseInt(t.substr(u+4,2),10),h=l*60+d;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};Me.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var d=t.length-5,h=t.charAt(d);if(h==="+"||h==="-"){var p=parseInt(t.substr(d+1,2),10),g=parseInt(t.substr(d+4,2),10);u=p*60+g,u*=6e4,h==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,i,n),e.setHours(s,o,a,c)),e};Me.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};Me.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};Me.integerToDer=function(t){var e=br.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Me.derToInteger=function(t){typeof t=="string"&&(t=br.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Me.validate=function(t,e,r,i){var n=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&br.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,t.value[s]&&(n=Me.validate(t.value[s],e.value[o],r,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(n&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else i&&(t.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return n};var vN=/[^\\u0000-\\u00ff]/;Me.prettyPrint=function(t,e,r){var i="";e=e||0,r=r||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*r;++s)n+=" ";switch(i+=n+"Tag: ",t.tagClass){case Me.Class.UNIVERSAL:i+="Universal:";break;case Me.Class.APPLICATION:i+="Application:";break;case Me.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Me.Class.PRIVATE:i+="Private:";break}if(t.tagClass===Me.Class.UNIVERSAL)switch(i+=t.type,t.type){case Me.Type.NONE:i+=" (None)";break;case Me.Type.BOOLEAN:i+=" (Boolean)";break;case Me.Type.INTEGER:i+=" (Integer)";break;case Me.Type.BITSTRING:i+=" (Bit string)";break;case Me.Type.OCTETSTRING:i+=" (Octet string)";break;case Me.Type.NULL:i+=" (Null)";break;case Me.Type.OID:i+=" (Object Identifier)";break;case Me.Type.ODESC:i+=" (Object Descriptor)";break;case Me.Type.EXTERNAL:i+=" (External or Instance of)";break;case Me.Type.REAL:i+=" (Real)";break;case Me.Type.ENUMERATED:i+=" (Enumerated)";break;case Me.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Me.Type.UTF8:i+=" (UTF8)";break;case Me.Type.ROID:i+=" (Relative Object Identifier)";break;case Me.Type.SEQUENCE:i+=" (Sequence)";break;case Me.Type.SET:i+=" (Set)";break;case Me.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Me.Type.IA5String:i+=" (IA5String (ASCII))";break;case Me.Type.UTCTIME:i+=" (UTC time)";break;case Me.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Me.Type.BMPSTRING:i+=" (BMP String)";break}else i+=t.type;if(i+=`
`,i+=n+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=Me.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",t.type===Me.Type.OID){var c=Me.derToOid(t.value);i+=c,br.pki&&br.pki.oids&&c in br.pki.oids&&(i+=" ("+br.pki.oids[c]+") ")}if(t.type===Me.Type.INTEGER)try{i+=Me.derToInteger(t.value)}catch(l){i+="0x"+br.util.bytesToHex(t.value)}else if(t.type===Me.Type.BITSTRING){if(t.value.length>1?i+="0x"+br.util.bytesToHex(t.value.slice(1)):i+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else t.type===Me.Type.OCTETSTRING?(vN.test(t.value)||(i+="("+t.value+") "),i+="0x"+br.util.bytesToHex(t.value)):t.type===Me.Type.UTF8?i+=br.util.decodeUtf8(t.value):t.type===Me.Type.PRINTABLESTRING||t.type===Me.Type.IA5String?i+=t.value:vN.test(t.value)?i+="0x"+br.util.bytesToHex(t.value):t.value.length===0?i+="[null]":i+=t.value}return i}});var g6=y((hxt,_N)=>{f();var qi=dt();Qt();_N.exports=qi.cipher=qi.cipher||{};qi.cipher.algorithms=qi.cipher.algorithms||{};qi.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=qi.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new qi.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};qi.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=qi.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new qi.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};qi.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),qi.cipher.algorithms[t]=e};qi.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in qi.cipher.algorithms?qi.cipher.algorithms[t]:null};var y6=qi.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};y6.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=qi.util.createBuffer(),this.output=t.output||qi.util.createBuffer(),this.mode.start(e)};y6.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};y6.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var m6=y((pxt,EN)=>{f();var Di=dt();Qt();Di.cipher=Di.cipher||{};var vt=EN.exports=Di.cipher.modes=Di.cipher.modes||{};vt.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};vt.ecb.prototype.start=function(t){};vt.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};vt.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};vt.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};vt.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};vt.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};vt.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Tv(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};vt.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};vt.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};vt.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};vt.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};vt.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0};vt.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Tv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};vt.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};vt.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};vt.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0};vt.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Tv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};vt.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};vt.ofb.prototype.decrypt=vt.ofb.prototype.encrypt;vt.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0};vt.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Tv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};vt.ctr.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}Rv(this._inBlock)};vt.ctr.prototype.decrypt=vt.ctr.prototype.encrypt;vt.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Di.util.createBuffer(),this._partialBytes=0,this._R=3774873600};vt.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Di.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Di.util.createBuffer(t.additionalData):r=Di.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Di.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(b6(i*8)))}this._inBlock=this._j0.slice(0),Rv(this._inBlock),this._partialBytes=0,r=Di.util.createBuffer(r),this._aDataLength=b6(r.length()*8);var n=r.length()%this.blockSize;for(n&&r.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};vt.gcm.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s<=0||r){if(r){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Rv(this._inBlock)};vt.gcm.prototype.decrypt=function(t,e,r){var i=t.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Rv(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};vt.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Di.util.createBuffer();var i=this._aDataLength.concat(b6(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};vt.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=t[n/32|0]&1<<31-n%32;s&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r};vt.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,i=3;i>0;--i)e[i]=t[i]>>>1|(t[i-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};vt.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var i=r/8|0,n=t[i]>>>(7-r%8)*4&15,s=this._m[r][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};vt.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};vt.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,u=(i-1-o%i)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};vt.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<r;++s){var u=n[s^i];n[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return n};function Tv(t,e){if(typeof t=="string"&&(t=Di.util.createBuffer(t)),Di.util.isArray(t)&&t.length>4){var r=t;t=Di.util.createBuffer();for(var i=0;i<r.length;++i)t.putByte(r[i])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Di.util.isArray(t)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(t.getInt32());t=n}return t}function Rv(t){t[t.length-1]=t[t.length-1]+1&4294967295}function b6(t){return[t/4294967296|0,t&4294967295]}});var hh=y((yxt,IN)=>{f();var sr=dt();g6();m6();Qt();IN.exports=sr.aes=sr.aes||{};sr.aes.startEncrypting=function(t,e,r,i){var n=Pv({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n};sr.aes.createEncryptionCipher=function(t,e){return Pv({key:t,output:null,decrypt:!1,mode:e})};sr.aes.startDecrypting=function(t,e,r,i){var n=Pv({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n};sr.aes.createDecryptionCipher=function(t,e){return Pv({key:t,output:null,decrypt:!0,mode:e})};sr.aes.Algorithm=function(t,e){v6||xN();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return _6(r._w,i,n,!1)},decrypt:function(i,n){return _6(r._w,i,n,!0)}}}),r._init=!1};sr.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=sr.util.createBuffer(e);else if(sr.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=sr.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(!sr.util.isArray(e)){r=e,e=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(r.getInt32())}}if(!sr.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=AN(e,t.decrypt&&!o),this._init=!0}};sr.aes._expandKey=function(t,e){return v6||xN(),AN(t,e)};sr.aes._updateBlock=_6;fh("AES-ECB",sr.cipher.modes.ecb);fh("AES-CBC",sr.cipher.modes.cbc);fh("AES-CFB",sr.cipher.modes.cfb);fh("AES-OFB",sr.cipher.modes.ofb);fh("AES-CTR",sr.cipher.modes.ctr);fh("AES-GCM",sr.cipher.modes.gcm);function fh(t,e){var r=function(){return new sr.aes.Algorithm(t,e)};sr.cipher.registerAlgorithm(t,r)}var v6=!1,dh=4,An,w6,SN,lf,mo;function xN(){v6=!0,SN=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;An=new Array(256),w6=new Array(256),lf=new Array(4),mo=new Array(4);for(var e=0;e<4;++e)lf[e]=new Array(256),mo[e]=new Array(256);for(var r=0,i=0,n,s,o,a,c,u,l,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,An[r]=a,w6[a]=r,c=t[a],n=t[r],s=t[n],o=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(n^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^n^o);for(var d=0;d<4;++d)lf[d][r]=u,mo[d][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=i=1:(r=n^t[t[t[n^o]]],i^=t[t[i]])}}function AN(t,e){for(var r=t.slice(0),i,n=1,s=r.length,o=s+6+1,a=dh*o,c=s;c<a;++c)i=r[c-1],c%s==0?(i=An[i>>>16&255]<<24^An[i>>>8&255]<<16^An[i&255]<<8^An[i>>>24]^SN[n]<<24,n++):s>6&&c%s==4&&(i=An[i>>>24]<<24^An[i>>>16&255]<<16^An[i>>>8&255]<<8^An[i&255]),r[c]=r[c-s]^i;if(e){var u,l=mo[0],d=mo[1],h=mo[2],p=mo[3],g=r.slice(0);a=r.length;for(var c=0,m=a-dh;c<a;c+=dh,m-=dh)if(c===0||c===a-dh)g[c]=r[m],g[c+1]=r[m+3],g[c+2]=r[m+2],g[c+3]=r[m+1];else for(var E=0;E<dh;++E)u=r[m+E],g[c+(3&-E)]=l[An[u>>>24]]^d[An[u>>>16&255]]^h[An[u>>>8&255]]^p[An[u&255]];r=g}return r}function _6(t,e,r,i){var n=t.length/4-1,s,o,a,c,u;i?(s=mo[0],o=mo[1],a=mo[2],c=mo[3],u=w6):(s=lf[0],o=lf[1],a=lf[2],c=lf[3],u=An);var l,d,h,p,g,m,E;l=e[0]^t[0],d=e[i?3:1]^t[1],h=e[2]^t[2],p=e[i?1:3]^t[3];for(var v=3,A=1;A<n;++A)g=s[l>>>24]^o[d>>>16&255]^a[h>>>8&255]^c[p&255]^t[++v],m=s[d>>>24]^o[h>>>16&255]^a[p>>>8&255]^c[l&255]^t[++v],E=s[h>>>24]^o[p>>>16&255]^a[l>>>8&255]^c[d&255]^t[++v],p=s[p>>>24]^o[l>>>16&255]^a[d>>>8&255]^c[h&255]^t[++v],l=g,d=m,h=E;r[0]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^t[++v],r[i?3:1]=u[d>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^t[++v],r[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^t[++v],r[i?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[h&255]^t[++v]}function Pv(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,i;t.decrypt?i=sr.cipher.createDecipher(r,t.key):i=sr.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof sr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var Ov=y((gxt,RN)=>{f();var mr=dt();g6();m6();Qt();RN.exports=mr.des=mr.des||{};mr.des.startEncrypting=function(t,e,r,i){var n=Cv({key:t,output:r,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};mr.des.createEncryptionCipher=function(t,e){return Cv({key:t,output:null,decrypt:!1,mode:e})};mr.des.startDecrypting=function(t,e,r,i){var n=Cv({key:t,output:r,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};mr.des.createDecryptionCipher=function(t,e){return Cv({key:t,output:null,decrypt:!0,mode:e})};mr.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return TN(r._keys,i,n,!1)},decrypt:function(i,n){return TN(r._keys,i,n,!0)}}}),r._init=!1};mr.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=mr.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=CTe(e),this._init=!0}};ya("DES-ECB",mr.cipher.modes.ecb);ya("DES-CBC",mr.cipher.modes.cbc);ya("DES-CFB",mr.cipher.modes.cfb);ya("DES-OFB",mr.cipher.modes.ofb);ya("DES-CTR",mr.cipher.modes.ctr);ya("3DES-ECB",mr.cipher.modes.ecb);ya("3DES-CBC",mr.cipher.modes.cbc);ya("3DES-CFB",mr.cipher.modes.cfb);ya("3DES-OFB",mr.cipher.modes.ofb);ya("3DES-CTR",mr.cipher.modes.ctr);function ya(t,e){var r=function(){return new mr.des.Algorithm(t,e)};mr.cipher.registerAlgorithm(t,r)}var ETe=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],STe=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],xTe=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],ATe=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],ITe=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],TTe=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],RTe=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],PTe=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function CTe(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=t.length()>8?3:1,E=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,R,F=0;F<m;F++){var q=t.getInt32(),D=t.getInt32();R=(q>>>4^D)&252645135,D^=R,q^=R<<4,R=(D>>>-16^q)&65535,q^=R,D^=R<<-16,R=(q>>>2^D)&858993459,D^=R,q^=R<<2,R=(D>>>-16^q)&65535,q^=R,D^=R<<-16,R=(q>>>1^D)&1431655765,D^=R,q^=R<<1,R=(D>>>8^q)&16711935,q^=R,D^=R<<8,R=(q>>>1^D)&1431655765,D^=R,q^=R<<1,R=q<<8|D>>>20&240,q=D<<24|D<<8&16711680|D>>>8&65280|D>>>24&240,D=R;for(var z=0;z<v.length;++z){v[z]?(q=q<<2|q>>>26,D=D<<2|D>>>26):(q=q<<1|q>>>27,D=D<<1|D>>>27),q&=-15,D&=-15;var G=e[q>>>28]|r[q>>>24&15]|i[q>>>20&15]|n[q>>>16&15]|s[q>>>12&15]|o[q>>>8&15]|a[q>>>4&15],Y=c[D>>>28]|u[D>>>24&15]|l[D>>>20&15]|d[D>>>16&15]|h[D>>>12&15]|p[D>>>8&15]|g[D>>>4&15];R=(Y>>>16^G)&65535,E[A++]=G^R,E[A++]=Y^R<<16}}return E}function TN(t,e,r,i){var n=t.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var l=s[u+1],d=s[u+2],h=s[u];h!=l;h+=d){var p=c^t[h],g=(c>>>4|c<<28)^t[h+1];o=a,a=c,c=o^(STe[p>>>24&63]|ATe[p>>>16&63]|TTe[p>>>8&63]|PTe[p&63]|ETe[g>>>24&63]|xTe[g>>>16&63]|ITe[g>>>8&63]|RTe[g&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function Cv(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,i;t.decrypt?i=mr.cipher.createDecipher(r,t.key):i=mr.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof mr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var Bu=y((bxt,PN)=>{f();var kv=dt();PN.exports=kv.md=kv.md||{};kv.md.algorithms=kv.md.algorithms||{}});var ON=y((mxt,CN)=>{f();var Ac=dt();Bu();Qt();var OTe=CN.exports=Ac.hmac=Ac.hmac||{};OTe.create=function(){var t=null,e=null,r=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Ac.md.algorithms)e=Ac.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Ac.util.createBuffer(o);else if(Ac.util.isArray(o)){var a=o;o=Ac.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Ac.util.createBuffer(),i=Ac.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),i.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),i.putByte(92);t=o,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var ph=y(()=>{f()});var E6=y((_xt,kN)=>{f();var In=dt();ON();Bu();Qt();var kTe=In.pkcs5=In.pkcs5||{},Ic;In.util.isNodejs&&!In.options.usePureJavaScript&&(Ic=ph());kN.exports=In.pbkdf2=kTe.pbkdf2=function(t,e,r,i,n,s){if(typeof n=="function"&&(s=n,n=null),In.util.isNodejs&&!In.options.usePureJavaScript&&Ic.pbkdf2&&(n===null||typeof n!="object")&&(Ic.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Ic.pbkdf2Sync.length===4?Ic.pbkdf2(t,e,r,i,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):Ic.pbkdf2(t,e,r,i,n,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):Ic.pbkdf2Sync.length===4?Ic.pbkdf2Sync(t,e,r,i).toString("binary"):Ic.pbkdf2Sync(t,e,r,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in In.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=In.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),u=i-(c-1)*o,l=In.hmac.create();l.start(n,t);var d="",h,p,g;if(!s){for(var m=1;m<=c;++m){l.start(null,null),l.update(e),l.update(In.util.int32ToBytes(m)),h=g=l.digest().getBytes();for(var E=2;E<=r;++E)l.start(null,null),l.update(g),p=l.digest().getBytes(),h=In.util.xorBytes(h,p,o),g=p;d+=m<c?h:h.substr(0,u)}return d}var m=1,E;function v(){if(m>c)return s(null,d);l.start(null,null),l.update(e),l.update(In.util.int32ToBytes(m)),h=g=l.digest().getBytes(),E=2,A()}function A(){if(E<=r)return l.start(null,null),l.update(g),p=l.digest().getBytes(),h=In.util.xorBytes(h,p,o),g=p,++E,In.util.setImmediate(A);d+=m<c?h:h.substr(0,u),++m,v()}v()}});var Nv=y((Ext,DN)=>{f();var qv=dt();Qt();var qN=DN.exports=qv.pem=qv.pem||{};qN.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,i;if(t.procType&&(i={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Dv(i)),t.contentDomain&&(i={name:"Content-Domain",values:[t.contentDomain]},r+=Dv(i)),t.dekInfo&&(i={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&i.values.push(t.dekInfo.parameters),r+=Dv(i)),t.headers)for(var n=0;n<t.headers.length;++n)r+=Dv(t.headers[n]);return t.procType&&(r+=`\r
`),r+=qv.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};qN.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:qv.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(n),c=0;s&&c<a.length;){for(var u=a[c].replace(/\s+$/,""),l=c+1;l<a.length;++l){var d=a[l];if(!/\s/.test(d[0]))break;u+=d,c=l}if(s=u.match(i),s){for(var h={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)h.values.push(qTe(p[g]));if(o.procType)if(!o.contentDomain&&h.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&h.name==="DEK-Info"){if(h.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(h);else{if(h.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(h.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Dv(t){for(var e=t.name+": ",r=[],i=function(c,u){return" "+u},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function qTe(t){return t.replace(/^\s+/,"")}});var FN=y((Sxt,UN)=>{f();var ga=dt();Bu();Qt();var NN=UN.exports=ga.sha256=ga.sha256||{};ga.md.sha256=ga.md.algorithms.sha256=NN;NN.create=function(){BN||DTe();var t=null,e=ga.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=ga.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=ga.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),LN(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=ga.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(S6.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};LN(d,r,n);var h=ga.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h.putInt32(d.h5),h.putInt32(d.h6),h.putInt32(d.h7),h},i};var S6=null,BN=!1,MN=null;function DTe(){S6=String.fromCharCode(128),S6+=ga.util.fillString(String.fromCharCode(0),64),MN=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],BN=!0}function LN(t,e,r){for(var i,n,s,o,a,c,u,l,d,h,p,g,m,E,v,A=r.length();A>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(l=t.h0,d=t.h1,h=t.h2,p=t.h3,g=t.h4,m=t.h5,E=t.h6,v=t.h7,u=0;u<64;++u)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),a=E^g&(m^E),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&d|h&(l^d),i=v+o+a+MN[u]+e[u],n=s+c,v=E,E=m,m=g,g=p+i>>>0,p=h,h=d,d=l,l=i+n>>>0;t.h0=t.h0+l|0,t.h1=t.h1+d|0,t.h2=t.h2+h|0,t.h3=t.h3+p|0,t.h4=t.h4+g|0,t.h5=t.h5+m|0,t.h6=t.h6+E|0,t.h7=t.h7+v|0,A-=64}}});var jN=y((xxt,KN)=>{f();var ba=dt();Qt();var Bv=null;ba.util.isNodejs&&!ba.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Bv=ph());var NTe=KN.exports=ba.prng=ba.prng||{};NTe.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();e.pools=i,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var d=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,g=e.plugin.formatSeed,m=ba.util.createBuffer();e.key=null,E();function E(v){if(v)return l(v);if(m.length()>=u)return l(null,m.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return ba.util.nextTick(function(){s(E)});var A=d(e.key,e.seed);e.generated+=A.length,m.putBytes(A),e.key=p(d(e.key,h(e.seed))),e.seed=g(d(e.key,e.seed)),ba.util.setImmediate(E)}},e.generateSync=function(u){var l=e.plugin.cipher,d=e.plugin.increment,h=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var g=ba.util.createBuffer();g.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var m=l(e.key,e.seed);e.generated+=m.length,g.putBytes(m),e.key=h(l(e.key,d(e.seed))),e.seed=p(l(e.key,e.seed))}return g.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(d,h){if(d)return u(d);e.collect(h),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,d=0;d<32;++d)e.reseeds%l==0&&(u.update(e.pools[d].digest().getBytes()),e.pools[d].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,d=ba.util.globalScope,h=d.crypto||d.msCrypto;h&&h.getRandomValues&&(l=function(q){return h.getRandomValues(q)});var p=ba.util.createBuffer();if(l)for(;p.length()<u;){var g=Math.max(1,Math.min(u-p.length(),65536)/4),m=new Uint32Array(Math.floor(g));try{l(m);for(var E=0;E<m.length;++E)p.putInt32(m[E])}catch(q){if(!(typeof QuotaExceededError!="undefined"&&q instanceof QuotaExceededError))throw q}}if(p.length()<u)for(var v,A,R,F=Math.floor(Math.random()*65536);p.length()<u;){A=16807*(F&65535),v=16807*(F>>16),A+=(v&32767)<<16,A+=v>>15,A=(A&2147483647)+(A>>31),F=A&4294967295;for(var E=0;E<3;++E)R=F>>>(E<<3),R^=Math.floor(Math.random()*256),p.putByte(String.fromCharCode(R&255))}return p.getBytes(u)}return Bv?(e.seedFile=function(u,l){Bv.randomBytes(u,function(d,h){if(d)return l(d);l(null,h.toString())})},e.seedFileSync=function(u){return Bv.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(d){l(d)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,d=0;d<l;++d)e.pools[e.pool].update(u.substr(d,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var d="",h=0;h<l;h+=8)d+=String.fromCharCode(u>>h&255);e.collect(d)},e.registerWorker=function(u){if(u===self)e.seedFile=function(d,h){function p(g){var m=g.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",p),h(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:d}}})};else{var l=function(d){var h=d.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(p,g){u.postMessage({forge:{prng:{err:p,bytes:g}}})})};u.addEventListener("message",l)}},e}});var Mu=y((Axt,x6)=>{f();var Ni=dt();hh();FN();jN();Qt();(function(){if(Ni.random&&Ni.random.getBytes){x6.exports=Ni.random;return}(function(t){var e={},r=new Array(4),i=Ni.util.createBuffer();e.formatKey=function(d){var h=Ni.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),Ni.aes._expandKey(d,!1)},e.formatSeed=function(d){var h=Ni.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),d},e.cipher=function(d,h){return Ni.aes._updateBlock(d,h,r,!1),i.putInt32(r[0]),i.putInt32(r[1]),i.putInt32(r[2]),i.putInt32(r[3]),i.getBytes()},e.increment=function(d){return++d[3],d},e.md=Ni.md.sha256;function n(){var d=Ni.prng.create(e);return d.getBytes=function(h,p){return d.generate(h,p)},d.getBytesSync=function(h){return d.generate(h)},d}var s=n(),o=null,a=Ni.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(d){return c.getRandomValues(d)}),Ni.options.usePureJavaScript||!Ni.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(d){}s.collect(u),u=null}t&&(t().mousemove(function(d){s.collectInt(d.clientX,16),s.collectInt(d.clientY,16)}),t().keypress(function(d){s.collectInt(d.charCode,8)}))}if(!Ni.random)Ni.random=s;else for(var l in s)Ni.random[l]=s[l];Ni.random.createInstance=n,x6.exports=Ni.random})(typeof jQuery!="undefined"?jQuery:null)})()});var $N=y((Ixt,HN)=>{f();var Fn=dt();Qt();var A6=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],VN=[1,2,3,5],BTe=function(t,e){return t<<e&65535|(t&65535)>>16-e},MTe=function(t,e){return(t&65535)>>e|t<<16-e&65535};HN.exports=Fn.rc2=Fn.rc2||{};Fn.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Fn.util.createBuffer(t)),e=e||128;var r=t,i=t.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)r.putByte(A6[r.at(a-1)+r.at(a-i)&255]);for(r.setAt(128-s,A6[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,A6[r.at(a+1)^r.at(a+s)]);return r};var zN=function(t,e,r){var i=!1,n=null,s=null,o=null,a,c,u,l,d=[];for(t=Fn.rc2.expandKey(t,e),u=0;u<64;u++)d.push(t.getInt16Le());r?(a=function(g){for(u=0;u<4;u++)g[u]+=d[l]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),g[u]=BTe(g[u],VN[u]),l++},c=function(g){for(u=0;u<4;u++)g[u]+=d[g[(u+3)%4]&63]}):(a=function(g){for(u=3;u>=0;u--)g[u]=MTe(g[u],VN[u]),g[u]-=d[l]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),l--},c=function(g){for(u=3;u>=0;u--)g[u]-=d[g[(u+3)%4]&63]});var h=function(g){var m=[];for(u=0;u<4;u++){var E=n.getInt16Le();o!==null&&(r?E^=o.getInt16Le():o.putInt16Le(E)),m.push(E&65535)}l=r?0:63;for(var v=0;v<g.length;v++)for(var A=0;A<g[v][0];A++)g[v][1](m);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(m[u]):m[u]^=o.getInt16Le()),s.putInt16Le(m[u])},p=null;return p={start:function(g,m){g&&typeof g=="string"&&(g=Fn.util.createBuffer(g)),i=!1,n=Fn.util.createBuffer(),s=m||new Fn.util.createBuffer,o=g,p.output=s},update:function(g){for(i||n.putBuffer(g);n.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(g){var m=!0;if(r)if(g)m=g(8,n,!r);else{var E=n.length()===8?8:8-n.length();n.fillWithByte(E,E)}if(m&&(i=!0,p.update()),!r&&(m=n.length()===0,m))if(g)m=g(8,s,!r);else{var v=s.length(),A=s.at(v-1);A>v?m=!1:s.truncate(A)}return m}},p};Fn.rc2.startEncrypting=function(t,e,r){var i=Fn.rc2.createEncryptionCipher(t,128);return i.start(e,r),i};Fn.rc2.createEncryptionCipher=function(t,e){return zN(t,e,!0)};Fn.rc2.startDecrypting=function(t,e,r){var i=Fn.rc2.createDecryptionCipher(t,128);return i.start(e,r),i};Fn.rc2.createDecryptionCipher=function(t,e){return zN(t,e,!1)}});var og=y((Txt,eB)=>{f();var I6=dt();eB.exports=I6.jsbn=I6.jsbn||{};var Tc,LTe=244837814094590,GN=(LTe&16777215)==15715070;function we(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}I6.jsbn.BigInteger=we;function qt(){return new we(null)}function UTe(t,e,r,i,n,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[i]+n;n=Math.floor(o/67108864),r.data[i++]=o&67108863}return n}function FTe(t,e,r,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+r.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+a*u+(n>>>30),r.data[i++]=c&1073741823}return n}function WN(t,e,r,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+r.data[i]+n,n=(c>>28)+(l>>14)+a*u,r.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(we.prototype.am=WN,Tc=28):GN&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=FTe,Tc=30):GN&&navigator.appName!="Netscape"?(we.prototype.am=UTe,Tc=26):(we.prototype.am=WN,Tc=28);we.prototype.DB=Tc;we.prototype.DM=(1<<Tc)-1;we.prototype.DV=1<<Tc;var T6=52;we.prototype.FV=Math.pow(2,T6);we.prototype.F1=T6-Tc;we.prototype.F2=2*Tc-T6;var KTe="0123456789abcdefghijklmnopqrstuvwxyz",Mv=new Array,yh,Is;yh="0".charCodeAt(0);for(Is=0;Is<=9;++Is)Mv[yh++]=Is;yh="a".charCodeAt(0);for(Is=10;Is<36;++Is)Mv[yh++]=Is;yh="A".charCodeAt(0);for(Is=10;Is<36;++Is)Mv[yh++]=Is;function YN(t){return KTe.charAt(t)}function XN(t,e){var r=Mv[t.charCodeAt(e)];return r??-1}function jTe(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function VTe(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Lu(t){var e=qt();return e.fromInt(t),e}function zTe(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var o=r==8?t[i]&255:XN(t,i);if(o<0){t.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&we.ZERO.subTo(this,this)}function HTe(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function $Te(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=YN(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=YN(i));return n?s:"0"}function GTe(){var t=qt();return we.ZERO.subTo(this,t),t}function WTe(){return this.s<0?this.negate():this}function YTe(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Lv(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function XTe(){return this.t<=0?0:this.DB*(this.t-1)+Lv(this.data[this.t-1]^this.s&this.DM)}function QTe(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function ZTe(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function JTe(t,e){var r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function e5e(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<n,e.data[o-r]=this.data[o]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function t5e(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function r5e(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&we.ZERO.subTo(e,e)}function i5e(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function n5e(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=qt());var s=qt(),o=this.s,a=t.s,c=this.DB-Lv(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,r)):(i.copyTo(s),n.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var d=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,g=1<<this.F2,m=r.t,E=m-u,v=e??qt();for(s.dlShiftTo(E,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),we.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--E>=0;){var A=r.data[--m]==l?this.DM:Math.floor(r.data[m]*h+(r.data[m-1]+g)*p);if((r.data[m]+=s.am(0,A,r,E,0,u))<A)for(s.dlShiftTo(E,v),r.subTo(v,r);r.data[m]<--A;)r.subTo(v,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&we.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&we.ZERO.subTo(r,r)}}}function s5e(t){var e=qt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&t.subTo(e,e),e}function ff(t){this.m=t}function o5e(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function a5e(t){return t}function c5e(t){t.divRemTo(this.m,null,t)}function u5e(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function l5e(t,e){t.squareTo(e),this.reduce(e)}ff.prototype.convert=o5e;ff.prototype.revert=a5e;ff.prototype.reduce=c5e;ff.prototype.mulTo=u5e;ff.prototype.sqrTo=l5e;function f5e(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function df(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function d5e(t){var e=qt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function h5e(t){var e=qt();return t.copyTo(e),this.reduce(e),e}function p5e(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function y5e(t,e){t.squareTo(e),this.reduce(e)}function g5e(t,e,r){t.multiplyTo(e,r),this.reduce(r)}df.prototype.convert=d5e;df.prototype.revert=h5e;df.prototype.reduce=p5e;df.prototype.mulTo=g5e;df.prototype.sqrTo=y5e;function b5e(){return(this.t>0?this.data[0]&1:this.s)==0}function m5e(t,e){if(t>4294967295||t<1)return we.ONE;var r=qt(),i=qt(),n=e.convert(this),s=Lv(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var o=r;r=i,i=o}return e.revert(r)}function v5e(t,e){var r;return t<256||e.isEven()?r=new ff(e):r=new df(e),this.exp(t,r)}we.prototype.copyTo=jTe;we.prototype.fromInt=VTe;we.prototype.fromString=zTe;we.prototype.clamp=HTe;we.prototype.dlShiftTo=QTe;we.prototype.drShiftTo=ZTe;we.prototype.lShiftTo=JTe;we.prototype.rShiftTo=e5e;we.prototype.subTo=t5e;we.prototype.multiplyTo=r5e;we.prototype.squareTo=i5e;we.prototype.divRemTo=n5e;we.prototype.invDigit=f5e;we.prototype.isEven=b5e;we.prototype.exp=m5e;we.prototype.toString=$Te;we.prototype.negate=GTe;we.prototype.abs=WTe;we.prototype.compareTo=YTe;we.prototype.bitLength=XTe;we.prototype.mod=s5e;we.prototype.modPowInt=v5e;we.ZERO=Lu(0);we.ONE=Lu(1);function w5e(){var t=qt();return this.copyTo(t),t}function _5e(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function E5e(){return this.t==0?this.s:this.data[0]<<24>>24}function S5e(){return this.t==0?this.s:this.data[0]<<16>>16}function x5e(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function A5e(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function I5e(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=Lu(r),n=qt(),s=qt(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(t)+o}function T5e(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,o=0,a=0;a<t.length;++a){var c=XN(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&we.ZERO.subTo(this,this)}function R5e(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(we.ONE.shiftLeft(t-1),R6,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(we.ONE.shiftLeft(t-1),this);else{var i=new Array,n=t&7;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function P5e(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,i,n=0;if(t-- >0)for(r<this.DB&&(i=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this.data[t]&(1<<r)-1)<<8-r,i|=this.data[--t]>>(r+=this.DB-8)):(i=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function C5e(t){return this.compareTo(t)==0}function O5e(t){return this.compareTo(t)<0?this:t}function k5e(t){return this.compareTo(t)>0?this:t}function q5e(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function D5e(t,e){return t&e}function N5e(t){var e=qt();return this.bitwiseTo(t,D5e,e),e}function R6(t,e){return t|e}function B5e(t){var e=qt();return this.bitwiseTo(t,R6,e),e}function QN(t,e){return t^e}function M5e(t){var e=qt();return this.bitwiseTo(t,QN,e),e}function ZN(t,e){return t&~e}function L5e(t){var e=qt();return this.bitwiseTo(t,ZN,e),e}function U5e(){for(var t=qt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function F5e(t){var e=qt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function K5e(t){var e=qt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function j5e(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function V5e(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+j5e(this.data[t]);return this.s<0?this.t*this.DB:-1}function z5e(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function H5e(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=z5e(this.data[r]^e);return t}function $5e(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function G5e(t,e){var r=we.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function W5e(t){return this.changeBit(t,R6)}function Y5e(t){return this.changeBit(t,ZN)}function X5e(t){return this.changeBit(t,QN)}function Q5e(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function Z5e(t){var e=qt();return this.addTo(t,e),e}function J5e(t){var e=qt();return this.subTo(t,e),e}function eRe(t){var e=qt();return this.multiplyTo(t,e),e}function tRe(t){var e=qt();return this.divRemTo(t,e,null),e}function rRe(t){var e=qt();return this.divRemTo(t,null,e),e}function iRe(t){var e=qt(),r=qt();return this.divRemTo(t,e,r),new Array(e,r)}function nRe(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function sRe(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function sg(){}function JN(t){return t}function oRe(t,e,r){t.multiplyTo(e,r)}function aRe(t,e){t.squareTo(e)}sg.prototype.convert=JN;sg.prototype.revert=JN;sg.prototype.mulTo=oRe;sg.prototype.sqrTo=aRe;function cRe(t){return this.exp(t,new sg)}function uRe(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function lRe(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function gh(t){this.r2=qt(),this.q3=qt(),we.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function fRe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=qt();return t.copyTo(e),this.reduce(e),e}function dRe(t){return t}function hRe(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function pRe(t,e){t.squareTo(e),this.reduce(e)}function yRe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}gh.prototype.convert=fRe;gh.prototype.revert=dRe;gh.prototype.reduce=hRe;gh.prototype.mulTo=yRe;gh.prototype.sqrTo=pRe;function gRe(t,e){var r=t.bitLength(),i,n=Lu(1),s;if(r<=0)return n;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?s=new ff(e):e.isEven()?s=new gh(e):s=new df(e);var o=new Array,a=3,c=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var l=qt();for(s.sqrTo(o[1],l);a<=u;)o[a]=qt(),s.mulTo(l,o[a-2],o[a]),a+=2}var d=t.t-1,h,p=!0,g=qt(),m;for(r=Lv(t.data[d])-1;d>=0;){for(r>=c?h=t.data[d]>>r-c&u:(h=(t.data[d]&(1<<r+1)-1)<<c-r,d>0&&(h|=t.data[d-1]>>this.DB+r-c)),a=i;(h&1)==0;)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--d),p)o[h].copyTo(n),p=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(m=n,n=g,g=m),s.mulTo(g,o[h],n)}for(;d>=0&&(t.data[d]&1<<r)==0;)s.sqrTo(n,g),m=n,n=g,g=m,--r<0&&(r=this.DB-1,--d)}return s.revert(n)}function bRe(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function mRe(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function vRe(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return we.ZERO;for(var r=t.clone(),i=this.clone(),n=Lu(1),s=Lu(0),o=Lu(0),a=Lu(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(r,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(we.ONE)!=0)return we.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var vo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],wRe=(1<<26)/vo[vo.length-1];function _Re(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=vo[vo.length-1]){for(e=0;e<vo.length;++e)if(r.data[0]==vo[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<vo.length;){for(var i=vo[e],n=e+1;n<vo.length&&i<wRe;)i*=vo[n++];for(i=r.modInt(i);e<n;)if(i%vo[e++]==0)return!1}return r.millerRabin(t)}function ERe(t){var e=this.subtract(we.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i=e.shiftRight(r),n=SRe(),s,o=0;o<t;++o){do s=new we(this.bitLength(),n);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(we.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(we.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function SRe(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=x5e;we.prototype.toRadix=I5e;we.prototype.fromRadix=T5e;we.prototype.fromNumber=R5e;we.prototype.bitwiseTo=q5e;we.prototype.changeBit=G5e;we.prototype.addTo=Q5e;we.prototype.dMultiply=nRe;we.prototype.dAddOffset=sRe;we.prototype.multiplyLowerTo=uRe;we.prototype.multiplyUpperTo=lRe;we.prototype.modInt=mRe;we.prototype.millerRabin=ERe;we.prototype.clone=w5e;we.prototype.intValue=_5e;we.prototype.byteValue=E5e;we.prototype.shortValue=S5e;we.prototype.signum=A5e;we.prototype.toByteArray=P5e;we.prototype.equals=C5e;we.prototype.min=O5e;we.prototype.max=k5e;we.prototype.and=N5e;we.prototype.or=B5e;we.prototype.xor=M5e;we.prototype.andNot=L5e;we.prototype.not=U5e;we.prototype.shiftLeft=F5e;we.prototype.shiftRight=K5e;we.prototype.getLowestSetBit=V5e;we.prototype.bitCount=H5e;we.prototype.testBit=$5e;we.prototype.setBit=W5e;we.prototype.clearBit=Y5e;we.prototype.flipBit=X5e;we.prototype.add=Z5e;we.prototype.subtract=J5e;we.prototype.multiply=eRe;we.prototype.divide=tRe;we.prototype.remainder=rRe;we.prototype.divideAndRemainder=iRe;we.prototype.modPow=gRe;we.prototype.modInverse=vRe;we.prototype.pow=cRe;we.prototype.gcd=bRe;we.prototype.isProbablePrime=_Re});var sB=y((Rxt,nB)=>{f();var ma=dt();Bu();Qt();var tB=nB.exports=ma.sha1=ma.sha1||{};ma.md.sha1=ma.md.algorithms.sha1=tB;tB.create=function(){rB||xRe();var t=null,e=ma.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=ma.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=ma.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),iB(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=ma.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(P6.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};iB(d,r,n);var h=ma.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h},i};var P6=null,rB=!1;function xRe(){P6=String.fromCharCode(128),P6+=ma.util.fillString(String.fromCharCode(0),64),rB=!0}function iB(t,e,r){for(var i,n,s,o,a,c,u,l,d=r.length();d>=64;){for(n=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)i=r.getInt32(),e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s&o|a&(s^o),i=(n<<5|n>>>27)+u+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,d-=64}}});var cB=y((Pxt,aB)=>{f();var va=dt();Qt();Mu();sB();var oB=aB.exports=va.pkcs1=va.pkcs1||{};oB.encode_rsa_oaep=function(t,e,r){var i,n,s,o;typeof r=="string"?(i=r,n=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,n=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=va.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var l=s.digest(),d="",h=c-e.length,p=0;p<h;p++)d+="\0";var g=l.getBytes()+d+""+e;if(!n)n=va.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var m=Uv(n,a-s.digestLength-1,o),E=va.util.xorBytes(g,m,g.length),v=Uv(E,s.digestLength,o),A=va.util.xorBytes(n,v,n.length);return"\0"+A+E};oB.decode_rsa_oaep=function(t,e,r){var i,n,s;typeof r=="string"?(i=r,n=arguments[3]||void 0):r&&(i=r.label||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=e.length,E.expectedLength=o,E}if(n===void 0?n=va.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),d=Uv(l,n.digestLength,s),h=va.util.xorBytes(u,d,u.length),p=Uv(h,o-n.digestLength-1,s),g=va.util.xorBytes(l,p,l.length),m=g.substring(0,n.digestLength),E=c!=="\0",v=0;v<n.digestLength;++v)E|=a.charAt(v)!==m.charAt(v);for(var A=1,R=n.digestLength,F=n.digestLength;F<g.length;F++){var q=g.charCodeAt(F),D=q&1^1,z=A?65534:0;E|=q&z,A=A&D,R+=A}if(E||g.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(R+1)};function Uv(t,e,r){r||(r=va.md.sha1.create());for(var i="",n=Math.ceil(e/r.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),i+=r.digest().getBytes()}return i.substring(0,e)}});var uB=y((Cxt,C6)=>{f();var Uu=dt();Qt();og();Mu();(function(){if(Uu.prime){C6.exports=Uu.prime;return}var t=C6.exports=Uu.prime=Uu.prime||{},e=Uu.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(d,h){return d|h};t.generateProbablePrime=function(d,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var g=h.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var m=h.prng||Uu.random,E={nextBytes:function(v){for(var A=m.getBytesSync(v.length),R=0;R<v.length;++R)v[R]=A.charCodeAt(R)}};if(g.name==="PRIMEINC")return s(d,E,g.options,p);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(d,h,p,g){return"workers"in p?c(d,h,p,g):o(d,h,p,g)}function o(d,h,p,g){var m=u(d,h),E=0,v=l(m.bitLength());"millerRabinTests"in p&&(v=p.millerRabinTests);var A=10;"maxBlockTime"in p&&(A=p.maxBlockTime),a(m,d,h,E,v,A,g)}function a(d,h,p,g,m,E,v){var A=+new Date;do{if(d.bitLength()>h&&(d=u(h,p)),d.isProbablePrime(m))return v(null,d);d.dAddOffset(r[g++%8],0)}while(E<0||+new Date-A<E);Uu.util.setImmediate(function(){a(d,h,p,g,m,E,v)})}function c(d,h,p,g){if(typeof Worker=="undefined")return o(d,h,p,g);var m=u(d,h),E=p.workers,v=p.workLoad||100,A=v*30/8,R=p.workerScript||"forge/prime.worker.js";if(E===-1)return Uu.util.estimateCores(function(q,D){q&&(D=2),E=D-1,F()});F();function F(){E=Math.max(1,E);for(var q=[],D=0;D<E;++D)q[D]=new Worker(R);for(var z=E,D=0;D<E;++D)q[D].addEventListener("message",Y);var G=!1;function Y(P){if(!G){--z;var b=P.data;if(b.found){for(var w=0;w<q.length;++w)q[w].terminate();return G=!0,g(null,new e(b.prime,16))}m.bitLength()>d&&(m=u(d,h));var S=m.toString(16);P.target.postMessage({hex:S,workLoad:v}),m.dAddOffset(A,0)}}}}function u(d,h){var p=new e(d,h),g=d-1;return p.testBit(g)||p.bitwiseTo(e.ONE.shiftLeft(g),n,p),p.dAddOffset(31-p.mod(i).byteValue(),0),p}function l(d){return d<=100?27:d<=150?18:d<=200?15:d<=250?12:d<=300?9:d<=350?8:d<=400?7:d<=500?6:d<=600?5:d<=800?4:d<=1250?3:2}})()});var ag=y((Oxt,gB)=>{f();var at=dt();xc();og();lh();cB();uB();Mu();Qt();typeof Pt=="undefined"&&(Pt=at.jsbn.BigInteger);var Pt,O6=at.util.isNodejs?ph():null,se=at.asn1,Ts=at.util;at.pki=at.pki||{};gB.exports=at.pki.rsa=at.rsa=at.rsa||{};var ct=at.pki,ARe=[6,4,2,4,2,4,6,2],IRe={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},TRe={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},RRe={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},PRe=at.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},CRe=function(t){var e;if(t.algorithm in ct.oids)e=ct.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var i=se.oidToDer(e).getBytes(),n=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,i)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var o=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(s),n.value.push(o),se.toDer(n).getBytes()},lB=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Pt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Pt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new Pt(at.util.bytesToHex(at.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(Pt.ONE));t=t.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};ct.rsa.encrypt=function(t,e,r){var i=r,n,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(i=r===2,n=fB(t,e,r)):(n=at.util.createBuffer(),n.putBytes(t));for(var o=new Pt(n.toHex(),16),a=lB(o,e,i),c=a.toString(16),u=at.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(at.util.hexToBytes(c)),u.getBytes()};ct.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=n,s}var o=new Pt(at.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=lB(o,e,r),c=a.toString(16),u=at.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(at.util.hexToBytes(c)),i!==!1?Fv(u.getBytes(),e,r):u.getBytes()};ct.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||at.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:n,eInt:e||65537,e:new Pt(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};ct.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Pt(null);r.fromInt(30);for(var i=0,n=function(d,h){return d|h},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new Pt(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Pt.ONE.shiftLeft(u),n,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(kRe(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(ARe[i++%8],0):t.pqState===2?t.pqState=t.num.subtract(Pt.ONE).gcd(t.e).compareTo(Pt.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Pt.ONE),t.q1=t.q.subtract(Pt.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Pt.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:ct.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:ct.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};ct.rsa.generateKeyPair=function(t,e,r,i){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(i=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,i=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!at.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(i){if(dB("generateKeyPair"))return O6.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return i(a);i(null,{privateKey:ct.privateKeyFromPem(u),publicKey:ct.publicKeyFromPem(c)})});if(hB("generateKey")&&hB("exportKey"))return Ts.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:yB(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Ts.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=ct.privateKeyFromAsn1(se.fromDer(at.util.createBuffer(a)));i(null,{privateKey:c,publicKey:ct.setRsaPublicKey(c.n,c.e)})}});if(pB("generateKey")&&pB("exportKey")){var n=Ts.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:yB(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,u=Ts.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var d=l.target.result,h=ct.privateKeyFromAsn1(se.fromDer(at.util.createBuffer(d)));i(null,{privateKey:h,publicKey:ct.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){i(l)}},n.onerror=function(a){i(a)};return}}else if(dB("generateKeyPairSync")){var s=O6.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ct.privateKeyFromPem(s.privateKey),publicKey:ct.publicKeyFromPem(s.publicKey)}}}var o=ct.rsa.createKeyPairGenerationState(t,e,r);if(!i)return ct.rsa.stepKeyPairGenerationState(o,0),o.keys;ORe(o,r,i)};ct.setRsaPublicKey=ct.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,u){return fB(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return at.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,r,!0);return ct.rsa.encrypt(o,r,!0)},r.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=Fv(c,r,!0);var u=se.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=Fv(c,r,!0),a===c}});var o=ct.rsa.decrypt(n,r,!0,!1);return s.verify(i,o,r.n.bitLength())},r};ct.setRsaPrivateKey=ct.rsa.setPrivateKey=function(t,e,r,i,n,s,o,a){var c={n:t,e,d:r,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,d){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=ct.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:Fv};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,g){return at.pkcs1.decode_rsa_oaep(g,p,d)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var d=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:CRe},d=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},d=1);var h=l.encode(u,c.n.bitLength());return ct.rsa.encrypt(h,c,d)},c};ct.wrapRsaPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(ct.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(t).getBytes())])};ct.privateKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,IRe,e,r)&&(t=se.fromDer(at.util.createBuffer(e.privateKey))),e={},r=[],!se.validate(t,TRe,e,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var n,s,o,a,c,u,l,d;return n=at.util.createBuffer(e.privateKeyModulus).toHex(),s=at.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=at.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=at.util.createBuffer(e.privateKeyPrime1).toHex(),c=at.util.createBuffer(e.privateKeyPrime2).toHex(),u=at.util.createBuffer(e.privateKeyExponent1).toHex(),l=at.util.createBuffer(e.privateKeyExponent2).toHex(),d=at.util.createBuffer(e.privateKeyCoefficient).toHex(),ct.setRsaPrivateKey(new Pt(n,16),new Pt(s,16),new Pt(o,16),new Pt(a,16),new Pt(c,16),new Pt(u,16),new Pt(l,16),new Pt(d,16))};ct.privateKeyToAsn1=ct.privateKeyToRSAPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.qInv))])};ct.publicKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,PRe,e,r)){var i=se.derToOid(e.publicKeyOid);if(i!==ct.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}t=e.rsaPublicKey}if(r=[],!se.validate(t,RRe,e,r)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=r,n}var s=at.util.createBuffer(e.publicKeyModulus).toHex(),o=at.util.createBuffer(e.publicKeyExponent).toHex();return ct.setRsaPublicKey(new Pt(s,16),new Pt(o,16))};ct.publicKeyToAsn1=ct.publicKeyToSubjectPublicKeyInfo=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(ct.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[ct.publicKeyToRSAPublicKey(t)])])};ct.publicKeyToRSAPublicKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,wa(t.e))])};function fB(t,e,r){var i=at.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(t.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=n-11,s}i.putByte(0),i.putByte(r);var o=n-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var u=0,l=at.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:i.putByte(a);o=u}return i.putByte(0),i.putBytes(t),i}function Fv(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8),s=at.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function ORe(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){at.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Pt.ONE).gcd(t.e).compareTo(Pt.ONE)!==0){t.p=null,n();return}if(t.q.subtract(Pt.ONE).gcd(t.e).compareTo(Pt.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Pt.ONE),t.q1=t.q.subtract(Pt.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Pt.ONE)!==0){t.p=t.q=null,n();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:ct.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:ct.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function wa(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=at.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function kRe(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function dB(t){return at.util.isNodejs&&typeof O6[t]=="function"}function hB(t){return typeof Ts.globalScope!="undefined"&&typeof Ts.globalScope.crypto=="object"&&typeof Ts.globalScope.crypto.subtle=="object"&&typeof Ts.globalScope.crypto.subtle[t]=="function"}function pB(t){return typeof Ts.globalScope!="undefined"&&typeof Ts.globalScope.msCrypto=="object"&&typeof Ts.globalScope.msCrypto.subtle=="object"&&typeof Ts.globalScope.msCrypto.subtle[t]=="function"}function yB(t){for(var e=at.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r}});var k6=y((kxt,_B)=>{f();var Ue=dt();hh();xc();Ov();Bu();lh();E6();Nv();Mu();$N();ag();Qt();typeof bB=="undefined"&&(bB=Ue.jsbn.BigInteger);var bB,fe=Ue.asn1,lt=Ue.pki=Ue.pki||{};_B.exports=lt.pbe=Ue.pbe=Ue.pbe||{};var hf=lt.oids,qRe={name:"EncryptedPrivateKeyInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},DRe={name:"PBES2Algorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},NRe={name:"pkcs-12PbeParams",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"iterations"}]};lt.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=Ue.random.getBytesSync(r.saltSize),n=r.count,s=fe.integerToDer(n),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,d;switch(r.algorithm){case"aes128":o=16,u=16,l=hf["aes128-CBC"],d=Ue.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=hf["aes192-CBC"],d=Ue.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=hf["aes256-CBC"],d=Ue.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=hf.desCBC,d=Ue.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),g=wB(p),m=Ue.pkcs5.pbkdf2(e,i,n,o,g),E=Ue.random.getBytesSync(u),v=d(m);v.start(E),v.update(fe.toDer(t)),v.finish(),c=v.output.getBytes();var A=BRe(i,s,o,p);a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(hf.pkcs5PBES2).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(hf.pkcs5PBKDF2).getBytes()),A]),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(l).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,E)])])])}else if(r.algorithm==="3des"){o=24;var R=new Ue.util.ByteBuffer(i),m=lt.pbe.generatePkcs12Key(e,R,1,n,o),E=lt.pbe.generatePkcs12Key(e,R,2,n,o),v=Ue.des.createEncryptionCipher(m);v.start(E),v.update(fe.toDer(t)),v.finish(),c=v.output.getBytes(),a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(hf["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,i),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var F=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[a,fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,c)]);return F};lt.decryptPrivateKeyInfo=function(t,e){var r=null,i={},n=[];if(!fe.validate(t,qRe,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=fe.derToOid(i.encryptionOid),a=lt.pbe.getCipher(o,i.encryptionParams,e),c=Ue.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(r=fe.fromDer(a.output)),r};lt.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:fe.toDer(t).getBytes()};return Ue.pem.encode(r,{maxline:e})};lt.encryptedPrivateKeyFromPem=function(t){var e=Ue.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return fe.fromDer(e.body)};lt.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var i=lt.wrapRsaPrivateKey(lt.privateKeyToAsn1(t));return i=lt.encryptPrivateKeyInfo(i,e,r),lt.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(r.algorithm){case"aes128":n="AES-128-CBC",o=16,s=Ue.random.getBytesSync(16),a=Ue.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=Ue.random.getBytesSync(16),a=Ue.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=Ue.random.getBytesSync(16),a=Ue.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=Ue.random.getBytesSync(8),a=Ue.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=Ue.random.getBytesSync(8),a=Ue.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=Ue.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(fe.toDer(lt.privateKeyToAsn1(t))),l.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:Ue.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return Ue.pem.encode(d)};lt.decryptRsaPrivateKey=function(t,e){var r=null,i=Ue.pem.decode(t)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=Ue.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=Ue.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=Ue.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=Ue.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=Ue.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(d){return Ue.rc2.createDecryptionCipher(d,40)};break;case"RC2-64-CBC":s=8,o=function(d){return Ue.rc2.createDecryptionCipher(d,64)};break;case"RC2-128-CBC":s=16,o=function(d){return Ue.rc2.createDecryptionCipher(d,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=Ue.util.hexToBytes(i.dekInfo.parameters),c=Ue.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(Ue.util.createBuffer(i.body)),u.finish())r=u.output.getBytes();else return r}else r=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?r=lt.decryptPrivateKeyInfo(fe.fromDer(r),e):r=fe.fromDer(r),r!==null&&(r=lt.privateKeyFromAsn1(r)),r};lt.pbe.generatePkcs12Key=function(t,e,r,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in Ue.md))throw new Error('"sha1" hash algorithm unavailable.');s=Ue.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new Ue.util.ByteBuffer,d=new Ue.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)d.putInt16(t.charCodeAt(a));d.putInt16(0)}var h=d.length(),p=e.length(),g=new Ue.util.ByteBuffer;g.fillWithByte(r,u);var m=u*Math.ceil(p/u),E=new Ue.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(e.at(a%p));var v=u*Math.ceil(h/u),A=new Ue.util.ByteBuffer;for(a=0;a<v;a++)A.putByte(d.at(a%h));var R=E;R.putBuffer(A);for(var F=Math.ceil(n/c),q=1;q<=F;q++){var D=new Ue.util.ByteBuffer;D.putBytes(g.bytes()),D.putBytes(R.bytes());for(var z=0;z<i;z++)s.start(),s.update(D.getBytes()),D=s.digest();var G=new Ue.util.ByteBuffer;for(a=0;a<u;a++)G.putByte(D.at(a%c));var Y=Math.ceil(p/u)+Math.ceil(h/u),P=new Ue.util.ByteBuffer;for(o=0;o<Y;o++){var b=new Ue.util.ByteBuffer(R.getBytes(u)),w=511;for(a=G.length()-1;a>=0;a--)w=w>>8,w+=G.at(a)+b.at(a),b.setAt(a,w&255);P.putBuffer(b)}R=P,l.putBuffer(D)}return l.truncate(l.length()-n),l};lt.pbe.getCipher=function(t,e,r){switch(t){case lt.oids.pkcs5PBES2:return lt.pbe.getCipherForPBES2(t,e,r);case lt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case lt.oids["pbewithSHAAnd40BitRC2-CBC"]:return lt.pbe.getCipherForPKCS12PBE(t,e,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=t,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};lt.pbe.getCipherForPBES2=function(t,e,r){var i={},n=[];if(!fe.validate(e,DRe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(t=fe.derToOid(i.kdfOid),t!==lt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=fe.derToOid(i.encOid),t!==lt.oids["aes128-CBC"]&&t!==lt.oids["aes192-CBC"]&&t!==lt.oids["aes256-CBC"]&&t!==lt.oids["des-EDE3-CBC"]&&t!==lt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=Ue.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(lt.oids[t]){case"aes128-CBC":c=16,u=Ue.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=Ue.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=Ue.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=Ue.des.createDecryptionCipher;break;case"desCBC":c=8,u=Ue.des.createDecryptionCipher;break}var l=vB(i.prfOid),d=Ue.pkcs5.pbkdf2(r,o,a,c,l),h=i.encIv,p=u(d);return p.start(h),p};lt.pbe.getCipherForPKCS12PBE=function(t,e,r){var i={},n=[];if(!fe.validate(e,NRe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=Ue.util.createBuffer(i.salt),a=Ue.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case lt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=Ue.des.startDecrypting;break;case lt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(m,E){var v=Ue.rc2.createDecryptionCipher(m,40);return v.start(E,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var d=vB(i.prfOid),h=lt.pbe.generatePkcs12Key(r,o,1,a,c,d);d.start();var p=lt.pbe.generatePkcs12Key(r,o,2,a,u,d);return l(h,p)};lt.pbe.opensslDeriveBytes=function(t,e,r,i){if(typeof i=="undefined"||i===null){if(!("md5"in Ue.md))throw new Error('"md5" hash algorithm unavailable.');i=Ue.md.md5.create()}e===null&&(e="");for(var n=[mB(i,t+e)],s=16,o=1;s<r;++o,s+=16)n.push(mB(i,n[o-1]+t+e));return n.join("").substr(0,r)};function mB(t,e){return t.start().update(e).digest().getBytes()}function vB(t){var e;if(!t)e="hmacWithSHA1";else if(e=lt.oids[fe.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return wB(e)}function wB(t){var e=Ue.md;switch(t){case"hmacWithSHA224":e=Ue.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function BRe(t,e,r,i){var n=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,t),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,Ue.util.hexToBytes(r.toString(16))),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(lt.oids[i]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.NULL,!1,"")])),n}});var ue=y((qxt,SB)=>{f();"use strict";function EB(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function MRe(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return EB(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),EB(new n,r)}}SB.exports=MRe});var q6={};ut(q6,{identity:()=>LRe});var LRe,xB=xe(()=>{f();fa();Ru();LRe=hv({prefix:"\0",name:"identity",encode:t=>Gx(t),decode:t=>$x(t)})});var D6={};ut(D6,{base2:()=>URe});var URe,AB=xe(()=>{f();fa();URe=Kr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var N6={};ut(N6,{base8:()=>FRe});var FRe,IB=xe(()=>{f();fa();FRe=Kr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var B6={};ut(B6,{base10:()=>KRe});var KRe,TB=xe(()=>{f();fa();KRe=Cu({prefix:"9",name:"base10",alphabet:"0123456789"})});var cg={};ut(cg,{Hasher:()=>M6,from:()=>Rc});var Rc,M6,ug=xe(()=>{f();xn();Rc=({name:t,code:e,encode:r})=>new M6(t,e,r),M6=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return Xy(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var li={};ut(li,{sha256:()=>bh,sha512:()=>jRe});var RB,bh,jRe,ri=xe(()=>{f();ug();RB=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),bh=Rc({name:"sha2-256",code:18,encode:RB("SHA-256")}),jRe=Rc({name:"sha2-512",code:19,encode:RB("SHA-512")})});var Pc={};ut(Pc,{identity:()=>L6});var L6,Cc=xe(()=>{f();ug();Ru();L6=Rc({name:"identity",code:0,encode:t=>yo(t)})});var wo={};ut(wo,{code:()=>Oc,decode:()=>HRe,encode:()=>zRe,name:()=>VRe});var PB,VRe,Oc,zRe,HRe,Rs=xe(()=>{f();Ru();PB=t=>yo(t),{name:VRe,code:Oc,encode:zRe,decode:HRe}={name:"raw",code:85,decode:PB,encode:PB}});var Kv={};ut(Kv,{code:()=>GRe,decode:()=>YRe,encode:()=>WRe,name:()=>$Re});var $Re,GRe,WRe,YRe,U6=xe(()=>{f();({name:$Re,code:GRe,encode:WRe,decode:YRe}={name:"json",code:512,encode:t=>new TextEncoder().encode(JSON.stringify(t)),decode:t=>JSON.parse(new TextDecoder().decode(t))})});var mh={};ut(mh,{CID:()=>We,bytes:()=>Sc,digest:()=>Ln,hasher:()=>cg,varint:()=>Yy});var kc=xe(()=>{f();Ie();fv();Ru();ug();xn()});var F6={};ut(F6,{CID:()=>We,bases:()=>jv,bytes:()=>Sc,codecs:()=>QRe,digest:()=>Ln,hasher:()=>cg,hashes:()=>XRe,varint:()=>Yy});var jv,XRe,QRe,Vv=xe(()=>{f();xB();AB();IB();TB();Xx();on();Yx();ei();Zy();ri();Cc();Rs();U6();kc();jv={...q6,...D6,...N6,...B6,...bv,...sn,...gv,...Jr,...ch},XRe={...li,...Pc},QRe={raw:wo,json:Kv}});function CB(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}var OB,K6,ZRe,zv,j6=xe(()=>{f();Vv();OB=CB("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),K6=CB("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),ZRe={utf8:OB,"utf-8":OB,hex:jv.base16,latin1:K6,ascii:K6,binary:K6,...jv},zv=ZRe});var ht={};ut(ht,{fromString:()=>V6});function V6(t,e="utf8"){let r=zv[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var ft=xe(()=>{f();j6()});var cn={};ut(cn,{concat:()=>JRe});function JRe(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));let r=new Uint8Array(e),i=0;for(let n of t)r.set(n,i),i+=n.length;return r}var un=xe(()=>{f()});var lg=y(kB=>{f();"use strict";kB.get=(t=self)=>{let e=t.crypto||t.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var z6=y((Xxt,DB)=>{f();"use strict";var{concat:e8e}=(un(),cn),{fromString:qB}=(ft(),ht),t8e=lg();function r8e({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=t8e.get();r*=8;async function a(u,l){let d=o.getRandomValues(new Uint8Array(n)),h=o.getRandomValues(new Uint8Array(e)),p={name:t,iv:h},g={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},m=await o.subtle.importKey("raw",qB(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),E=await o.subtle.deriveKey(g,m,{name:t,length:r},!0,["encrypt"]),v=await o.subtle.encrypt(p,E,u);return e8e([d,p.iv,new Uint8Array(v)])}async function c(u,l){let d=u.slice(0,n),h=u.slice(n,n+e),p=u.slice(n+e),g={name:t,iv:h},m={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},E=await o.subtle.importKey("raw",qB(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(m,E,{name:t,length:r},!0,["decrypt"]),A=await o.subtle.decrypt(g,v,p);return new Uint8Array(A)}return{encrypt:a,decrypt:c}}DB.exports={create:r8e}});var BB=y((Qxt,NB)=>{f();"use strict";var{base64:i8e}=(Zy(),ch),n8e=z6();NB.exports={import:async function(t,e){let r=i8e.decode(t);return await n8e.create().decrypt(r,e)}}});var fi={};ut(fi,{equals:()=>s8e});function s8e(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var di=xe(()=>{f()});var et={};ut(et,{toString:()=>o8e});function o8e(t,e="utf8"){let r=zv[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var tt=xe(()=>{f();j6()});var Hv=y((Jxt,FB)=>{f();var pr=dt();Bu();Qt();var fg=FB.exports=pr.sha512=pr.sha512||{};pr.md.sha512=pr.md.algorithms.sha512=fg;var MB=pr.sha384=pr.sha512.sha384=pr.sha512.sha384||{};MB.create=function(){return fg.create("SHA-384")};pr.md.sha384=pr.md.algorithms.sha384=MB;pr.sha512.sha256=pr.sha512.sha256||{create:function(){return fg.create("SHA-512/256")}};pr.md["sha512/256"]=pr.md.algorithms["sha512/256"]=pr.sha512.sha256;pr.sha512.sha224=pr.sha512.sha224||{create:function(){return fg.create("SHA-512/224")}};pr.md["sha512/224"]=pr.md.algorithms["sha512/224"]=pr.sha512.sha224;fg.create=function(t){if(LB||a8e(),typeof t=="undefined"&&(t="SHA-512"),!(t in pf))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=pf[t],r=null,i=pr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);i=pr.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=pr.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var d=a.fullMessageLength.length-1;d>=0;--d)a.fullMessageLength[d]+=l[1],l[1]=l[0]+(a.fullMessageLength[d]/4294967296>>>0),a.fullMessageLength[d]=a.fullMessageLength[d]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),UB(r,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=pr.util.createBuffer();c.putBytes(i.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(H6.substr(0,a.blockLength-l));for(var d,h,p=a.fullMessageLength[0]*8,g=0;g<a.fullMessageLength.length-1;++g)d=a.fullMessageLength[g+1]*8,h=d/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=d>>>0;c.putInt32(p);for(var m=new Array(r.length),g=0;g<r.length;++g)m[g]=r[g].slice(0);UB(m,n,c);var E=pr.util.createBuffer(),v;t==="SHA-512"?v=m.length:t==="SHA-384"?v=m.length-2:v=m.length-4;for(var g=0;g<v;++g)E.putInt32(m[g][0]),(g!==v-1||t!=="SHA-512/224")&&E.putInt32(m[g][1]);return E},a};var H6=null,LB=!1,$6=null,pf=null;function a8e(){H6=String.fromCharCode(128),H6+=pr.util.fillString(String.fromCharCode(0),128),$6=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],pf={},pf["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],pf["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],pf["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],pf["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],LB=!0}function UB(t,e,r){for(var i,n,s,o,a,c,u,l,d,h,p,g,m,E,v,A,R,F,q,D,z,G,Y,P,b,w,S,C,B,W,j,M,_,L,ae,X=r.length();X>=128;){for(B=0;B<16;++B)e[B][0]=r.getInt32()>>>0,e[B][1]=r.getInt32()>>>0;for(;B<80;++B)M=e[B-2],W=M[0],j=M[1],i=((W>>>19|j<<13)^(j>>>29|W<<3)^W>>>6)>>>0,n=((W<<13|j>>>19)^(j<<3|W>>>29)^(W<<26|j>>>6))>>>0,L=e[B-15],W=L[0],j=L[1],s=((W>>>1|j<<31)^(W>>>8|j<<24)^W>>>7)>>>0,o=((W<<31|j>>>1)^(W<<24|j>>>8)^(W<<25|j>>>7))>>>0,_=e[B-7],ae=e[B-16],j=n+_[1]+o+ae[1],e[B][0]=i+_[0]+s+ae[0]+(j/4294967296>>>0)>>>0,e[B][1]=j>>>0;for(m=t[0][0],E=t[0][1],v=t[1][0],A=t[1][1],R=t[2][0],F=t[2][1],q=t[3][0],D=t[3][1],z=t[4][0],G=t[4][1],Y=t[5][0],P=t[5][1],b=t[6][0],w=t[6][1],S=t[7][0],C=t[7][1],B=0;B<80;++B)u=((z>>>14|G<<18)^(z>>>18|G<<14)^(G>>>9|z<<23))>>>0,l=((z<<18|G>>>14)^(z<<14|G>>>18)^(G<<23|z>>>9))>>>0,d=(b^z&(Y^b))>>>0,h=(w^G&(P^w))>>>0,a=((m>>>28|E<<4)^(E>>>2|m<<30)^(E>>>7|m<<25))>>>0,c=((m<<4|E>>>28)^(E<<30|m>>>2)^(E<<25|m>>>7))>>>0,p=(m&v|R&(m^v))>>>0,g=(E&A|F&(E^A))>>>0,j=C+l+h+$6[B][1]+e[B][1],i=S+u+d+$6[B][0]+e[B][0]+(j/4294967296>>>0)>>>0,n=j>>>0,j=c+g,s=a+p+(j/4294967296>>>0)>>>0,o=j>>>0,S=b,C=w,b=Y,w=P,Y=z,P=G,j=D+n,z=q+i+(j/4294967296>>>0)>>>0,G=j>>>0,q=R,D=F,R=v,F=A,v=m,A=E,j=n+o,m=i+s+(j/4294967296>>>0)>>>0,E=j>>>0;j=t[0][1]+E,t[0][0]=t[0][0]+m+(j/4294967296>>>0)>>>0,t[0][1]=j>>>0,j=t[1][1]+A,t[1][0]=t[1][0]+v+(j/4294967296>>>0)>>>0,t[1][1]=j>>>0,j=t[2][1]+F,t[2][0]=t[2][0]+R+(j/4294967296>>>0)>>>0,t[2][1]=j>>>0,j=t[3][1]+D,t[3][0]=t[3][0]+q+(j/4294967296>>>0)>>>0,t[3][1]=j>>>0,j=t[4][1]+G,t[4][0]=t[4][0]+z+(j/4294967296>>>0)>>>0,t[4][1]=j>>>0,j=t[5][1]+P,t[5][0]=t[5][0]+Y+(j/4294967296>>>0)>>>0,t[5][1]=j>>>0,j=t[6][1]+w,t[6][0]=t[6][0]+b+(j/4294967296>>>0)>>>0,t[6][1]=j>>>0,j=t[7][1]+C,t[7][0]=t[7][0]+S+(j/4294967296>>>0)>>>0,t[7][1]=j>>>0,X-=128}}});var KB=y(G6=>{f();var c8e=dt();xc();var Bi=c8e.asn1;G6.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};G6.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var rA=y((t6t,JB)=>{f();var Wi=dt();og();Mu();Hv();Qt();var jB=KB(),u8e=jB.publicKeyValidator,l8e=jB.privateKeyValidator;typeof VB=="undefined"&&(VB=Wi.jsbn.BigInteger);var VB,W6=Wi.util.ByteBuffer,Kn=typeof Buffer=="undefined"?Uint8Array:Buffer;Wi.pki=Wi.pki||{};JB.exports=Wi.pki.ed25519=Wi.ed25519=Wi.ed25519||{};var wt=Wi.ed25519;wt.constants={};wt.constants.PUBLIC_KEY_BYTE_LENGTH=32;wt.constants.PRIVATE_KEY_BYTE_LENGTH=64;wt.constants.SEED_BYTE_LENGTH=32;wt.constants.SIGN_BYTE_LENGTH=64;wt.constants.HASH_BYTE_LENGTH=64;wt.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=Wi.random.getBytesSync(wt.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==wt.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+wt.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=qc({message:e,encoding:"binary"});for(var r=new Kn(wt.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Kn(wt.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return p8e(r,i),{publicKey:r,privateKey:i}};wt.privateKeyFromAsn1=function(t){var e={},r=[],i=Wi.asn1.validate(t,l8e,e,r);if(!i){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=Wi.asn1.derToOid(e.privateKeyOid),o=Wi.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,c=qc({message:Wi.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};wt.publicKeyFromAsn1=function(t){var e={},r=[],i=Wi.asn1.validate(t,u8e,e,r);if(!i){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=Wi.asn1.derToOid(e.publicKeyOid),o=Wi.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==wt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return qc({message:a,encoding:"binary"})};wt.publicKeyFromPrivateKey=function(t){t=t||{};var e=qc({message:t.privateKey,encoding:"binary"});if(e.length!==wt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+wt.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Kn(wt.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<r.length;++i)r[i]=e[32+i];return r};wt.sign=function(t){t=t||{};var e=qc(t),r=qc({message:t.privateKey,encoding:"binary"});if(r.length===wt.constants.SEED_BYTE_LENGTH){var i=wt.generateKeyPair({seed:r});r=i.privateKey}else if(r.length!==wt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+wt.constants.SEED_BYTE_LENGTH+" or "+wt.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Kn(wt.constants.SIGN_BYTE_LENGTH+e.length);y8e(n,e,e.length,r);for(var s=new Kn(wt.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=n[o];return s};wt.verify=function(t){t=t||{};var e=qc(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=qc({message:t.signature,encoding:"binary"});if(r.length!==wt.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+wt.constants.SIGN_BYTE_LENGTH);var i=qc({message:t.publicKey,encoding:"binary"});if(i.length!==wt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+wt.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Kn(wt.constants.SIGN_BYTE_LENGTH+e.length),s=new Kn(wt.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<wt.constants.SIGN_BYTE_LENGTH;++o)n[o]=r[o];for(o=0;o<e.length;++o)n[o+wt.constants.SIGN_BYTE_LENGTH]=e[o];return g8e(s,n,n.length,i)>=0};function qc(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Kn)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,r);e=new W6(e,r)}else if(!(e instanceof W6))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Kn(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var Y6=Xe(),$v=Xe([1]),f8e=Xe([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d8e=Xe([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),zB=Xe([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),HB=Xe([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),X6=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),h8e=Xe([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function dg(t,e){var r=Wi.md.sha512.create(),i=new W6(t);r.update(i.getBytes(e),"binary");var n=r.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Kn(wt.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=n.charCodeAt(o);return s}function p8e(t,e){var r=[Xe(),Xe(),Xe(),Xe()],i,n=dg(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,eA(r,n),J6(t,r),i=0;i<32;++i)e[i+32]=t[i];return 0}function y8e(t,e,r,i){var n,s,o=new Float64Array(64),a=[Xe(),Xe(),Xe(),Xe()],c=dg(i,32);c[0]&=248,c[31]&=127,c[31]|=64;var u=r+64;for(n=0;n<r;++n)t[64+n]=e[n];for(n=0;n<32;++n)t[32+n]=c[32+n];var l=dg(t.subarray(32),r+32);for(Q6(l),eA(a,l),J6(t,a),n=32;n<64;++n)t[n]=i[n];var d=dg(t,r+64);for(Q6(d),n=32;n<64;++n)o[n]=0;for(n=0;n<32;++n)o[n]=l[n];for(n=0;n<32;++n)for(s=0;s<32;s++)o[n+s]+=d[n]*c[s];return $B(t.subarray(32),o),u}function g8e(t,e,r,i){var n,s,o=new Kn(32),a=[Xe(),Xe(),Xe(),Xe()],c=[Xe(),Xe(),Xe(),Xe()];if(s=-1,r<64||b8e(c,i))return-1;for(n=0;n<r;++n)t[n]=e[n];for(n=0;n<32;++n)t[n+32]=i[n];var u=dg(t,r);if(Q6(u),QB(a,c,u),eA(c,e.subarray(32)),Z6(a,c),J6(o,a),r-=64,YB(e,0,o,0)){for(n=0;n<r;++n)t[n]=0;return-1}for(n=0;n<r;++n)t[n]=e[n+64];return s=r,s}function $B(t,e){var r,i,n,s;for(i=63;i>=32;--i){for(r=0,n=i-32,s=i-12;n<s;++n)e[n]+=r-16*e[i]*X6[n-(i-32)],r=e[n]+128>>8,e[n]-=r*256;e[n]+=r,e[i]=0}for(r=0,n=0;n<32;++n)e[n]+=r-(e[31]>>4)*X6[n],r=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=r*X6[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,t[i]=e[i]&255}function Q6(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;$B(t,e)}function Z6(t,e){var r=Xe(),i=Xe(),n=Xe(),s=Xe(),o=Xe(),a=Xe(),c=Xe(),u=Xe(),l=Xe();wh(r,t[1],t[0]),wh(l,e[1],e[0]),Zt(r,r,l),vh(i,t[0],t[1]),vh(l,e[0],e[1]),Zt(i,i,l),Zt(n,t[3],e[3]),Zt(n,n,d8e),Zt(s,t[2],e[2]),vh(s,s,s),wh(o,i,r),wh(a,s,n),vh(c,s,n),vh(u,i,r),Zt(t[0],o,a),Zt(t[1],u,c),Zt(t[2],c,a),Zt(t[3],o,u)}function GB(t,e,r){for(var i=0;i<4;++i)ZB(t[i],e[i],r)}function J6(t,e){var r=Xe(),i=Xe(),n=Xe();_8e(n,e[2]),Zt(r,e[0],n),Zt(i,e[1],n),Gv(t,i),t[31]^=XB(r)<<7}function Gv(t,e){var r,i,n,s=Xe(),o=Xe();for(r=0;r<16;++r)o[r]=e[r];for(tA(o),tA(o),tA(o),i=0;i<2;++i){for(s[0]=o[0]-65517,r=1;r<15;++r)s[r]=o[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,ZB(o,s,1-n)}for(r=0;r<16;r++)t[2*r]=o[r]&255,t[2*r+1]=o[r]>>8}function b8e(t,e){var r=Xe(),i=Xe(),n=Xe(),s=Xe(),o=Xe(),a=Xe(),c=Xe();return Fu(t[2],$v),m8e(t[1],e),yf(n,t[1]),Zt(s,n,f8e),wh(n,n,t[2]),vh(s,t[2],s),yf(o,s),yf(a,o),Zt(c,a,o),Zt(r,c,n),Zt(r,r,s),v8e(r,r),Zt(r,r,n),Zt(r,r,s),Zt(r,r,s),Zt(t[0],r,s),yf(i,t[0]),Zt(i,i,s),WB(i,n)&&Zt(t[0],t[0],h8e),yf(i,t[0]),Zt(i,i,s),WB(i,n)?-1:(XB(t[0])===e[31]>>7&&wh(t[0],Y6,t[0]),Zt(t[3],t[0],t[1]),0)}function m8e(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function v8e(t,e){var r=Xe(),i;for(i=0;i<16;++i)r[i]=e[i];for(i=250;i>=0;--i)yf(r,r),i!==1&&Zt(r,r,e);for(i=0;i<16;++i)t[i]=r[i]}function WB(t,e){var r=new Kn(32),i=new Kn(32);return Gv(r,t),Gv(i,e),YB(r,0,i,0)}function YB(t,e,r,i){return w8e(t,e,r,i,32)}function w8e(t,e,r,i,n){var s,o=0;for(s=0;s<n;++s)o|=t[e+s]^r[i+s];return(1&o-1>>>8)-1}function XB(t){var e=new Kn(32);return Gv(e,t),e[0]&1}function QB(t,e,r){var i,n;for(Fu(t[0],Y6),Fu(t[1],$v),Fu(t[2],$v),Fu(t[3],Y6),n=255;n>=0;--n)i=r[n/8|0]>>(n&7)&1,GB(t,e,i),Z6(e,t),Z6(t,t),GB(t,e,i)}function eA(t,e){var r=[Xe(),Xe(),Xe(),Xe()];Fu(r[0],zB),Fu(r[1],HB),Fu(r[2],$v),Zt(r[3],zB,HB),QB(t,r,e)}function Fu(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function _8e(t,e){var r=Xe(),i;for(i=0;i<16;++i)r[i]=e[i];for(i=253;i>=0;--i)yf(r,r),i!==2&&i!==4&&Zt(r,r,e);for(i=0;i<16;++i)t[i]=r[i]}function tA(t){var e,r,i=1;for(e=0;e<16;++e)r=t[e]+i+65535,i=Math.floor(r/65536),t[e]=r-i*65536;t[0]+=i-1+37*(i-1)}function ZB(t,e,r){for(var i,n=~(r-1),s=0;s<16;++s)i=n&(t[s]^e[s]),t[s]^=i,e[s]^=i}function Xe(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function vh(t,e,r){for(var i=0;i<16;++i)t[i]=e[i]+r[i]}function wh(t,e,r){for(var i=0;i<16;++i)t[i]=e[i]-r[i]}function yf(t,e){Zt(t,e,e)}function Zt(t,e,r){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,p=0,g=0,m=0,E=0,v=0,A=0,R=0,F=0,q=0,D=0,z=0,G=0,Y=0,P=0,b=0,w=0,S=0,C=0,B=0,W=0,j=0,M=0,_=0,L=r[0],ae=r[1],X=r[2],ne=r[3],oe=r[4],he=r[5],pe=r[6],_e=r[7],k=r[8],K=r[9],$=r[10],Z=r[11],I=r[12],U=r[13],V=r[14],N=r[15];i=e[0],s+=i*L,o+=i*ae,a+=i*X,c+=i*ne,u+=i*oe,l+=i*he,d+=i*pe,h+=i*_e,p+=i*k,g+=i*K,m+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*N,i=e[1],o+=i*L,a+=i*ae,c+=i*X,u+=i*ne,l+=i*oe,d+=i*he,h+=i*pe,p+=i*_e,g+=i*k,m+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*N,i=e[2],a+=i*L,c+=i*ae,u+=i*X,l+=i*ne,d+=i*oe,h+=i*he,p+=i*pe,g+=i*_e,m+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,D+=i*N,i=e[3],c+=i*L,u+=i*ae,l+=i*X,d+=i*ne,h+=i*oe,p+=i*he,g+=i*pe,m+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,D+=i*V,z+=i*N,i=e[4],u+=i*L,l+=i*ae,d+=i*X,h+=i*ne,p+=i*oe,g+=i*he,m+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,D+=i*U,z+=i*V,G+=i*N,i=e[5],l+=i*L,d+=i*ae,h+=i*X,p+=i*ne,g+=i*oe,m+=i*he,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,D+=i*I,z+=i*U,G+=i*V,Y+=i*N,i=e[6],d+=i*L,h+=i*ae,p+=i*X,g+=i*ne,m+=i*oe,E+=i*he,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,D+=i*Z,z+=i*I,G+=i*U,Y+=i*V,P+=i*N,i=e[7],h+=i*L,p+=i*ae,g+=i*X,m+=i*ne,E+=i*oe,v+=i*he,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,D+=i*$,z+=i*Z,G+=i*I,Y+=i*U,P+=i*V,b+=i*N,i=e[8],p+=i*L,g+=i*ae,m+=i*X,E+=i*ne,v+=i*oe,A+=i*he,R+=i*pe,F+=i*_e,q+=i*k,D+=i*K,z+=i*$,G+=i*Z,Y+=i*I,P+=i*U,b+=i*V,w+=i*N,i=e[9],g+=i*L,m+=i*ae,E+=i*X,v+=i*ne,A+=i*oe,R+=i*he,F+=i*pe,q+=i*_e,D+=i*k,z+=i*K,G+=i*$,Y+=i*Z,P+=i*I,b+=i*U,w+=i*V,S+=i*N,i=e[10],m+=i*L,E+=i*ae,v+=i*X,A+=i*ne,R+=i*oe,F+=i*he,q+=i*pe,D+=i*_e,z+=i*k,G+=i*K,Y+=i*$,P+=i*Z,b+=i*I,w+=i*U,S+=i*V,C+=i*N,i=e[11],E+=i*L,v+=i*ae,A+=i*X,R+=i*ne,F+=i*oe,q+=i*he,D+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,P+=i*$,b+=i*Z,w+=i*I,S+=i*U,C+=i*V,B+=i*N,i=e[12],v+=i*L,A+=i*ae,R+=i*X,F+=i*ne,q+=i*oe,D+=i*he,z+=i*pe,G+=i*_e,Y+=i*k,P+=i*K,b+=i*$,w+=i*Z,S+=i*I,C+=i*U,B+=i*V,W+=i*N,i=e[13],A+=i*L,R+=i*ae,F+=i*X,q+=i*ne,D+=i*oe,z+=i*he,G+=i*pe,Y+=i*_e,P+=i*k,b+=i*K,w+=i*$,S+=i*Z,C+=i*I,B+=i*U,W+=i*V,j+=i*N,i=e[14],R+=i*L,F+=i*ae,q+=i*X,D+=i*ne,z+=i*oe,G+=i*he,Y+=i*pe,P+=i*_e,b+=i*k,w+=i*K,S+=i*$,C+=i*Z,B+=i*I,W+=i*U,j+=i*V,M+=i*N,i=e[15],F+=i*L,q+=i*ae,D+=i*X,z+=i*ne,G+=i*oe,Y+=i*he,P+=i*pe,b+=i*_e,w+=i*k,S+=i*K,C+=i*$,B+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*N,s+=38*q,o+=38*D,a+=38*z,c+=38*G,u+=38*Y,l+=38*P,d+=38*b,h+=38*w,p+=38*S,g+=38*C,m+=38*B,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=d,t[7]=h,t[8]=p,t[9]=g,t[10]=m,t[11]=E,t[12]=v,t[13]=A,t[14]=R,t[15]=F}});var tM=y((r6t,eM)=>{f();"use strict";var Wv=65536;function E8e(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>Wv)for(;r<t;)r+Wv>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+Wv)),r+=Wv);else crypto.getRandomValues(e);return e}eM.exports=E8e});var hg=y((i6t,rM)=>{f();"use strict";var S8e=tM(),x8e=ue();rM.exports=function(t){if(isNaN(t)||t<=0)throw x8e(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return S8e(t)}});var Yv=y(pg=>{f();"use strict";Qt();og();var A8e=dt(),{fromString:I8e}=(ft(),ht),{toString:iM}=(tt(),et),{concat:nM}=(un(),cn);pg.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=nM([new Uint8Array(e-r.length),r])}return iM(r,"base64url")};pg.base64urlToBigInteger=t=>{let e=pg.base64urlToBuffer(t);return new A8e.jsbn.BigInteger(iM(e,"base16"),16)};pg.base64urlToBuffer=(t,e)=>{let r=I8e(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=nM([new Uint8Array(e-r.length),r])}return r}});var aM=y(yg=>{f();"use strict";xc();ag();var Ku=dt(),{bigIntegerToUintBase64url:_a,base64urlToBigInteger:Ea}=Yv(),{fromString:sM}=(ft(),ht),{toString:oM}=(tt(),et);yg.pkcs1ToJwk=function(t){let e=Ku.asn1.fromDer(oM(t,"ascii")),r=Ku.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:_a(r.n),e:_a(r.e),d:_a(r.d),p:_a(r.p),q:_a(r.q),dp:_a(r.dP),dq:_a(r.dQ),qi:_a(r.qInv),alg:"RS256",kid:"2011-04-29"}};yg.jwkToPkcs1=function(t){let e=Ku.pki.privateKeyToAsn1({n:Ea(t.n),e:Ea(t.e),d:Ea(t.d),p:Ea(t.p),q:Ea(t.q),dP:Ea(t.dp),dQ:Ea(t.dq),qInv:Ea(t.qi)});return sM(Ku.asn1.toDer(e).getBytes(),"ascii")};yg.pkixToJwk=function(t){let e=Ku.asn1.fromDer(oM(t,"ascii")),r=Ku.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:_a(r.n),e:_a(r.e),alg:"RS256",kid:"2011-04-29"}};yg.jwkToPkix=function(t){let e=Ku.pki.publicKeyToAsn1({n:Ea(t.n),e:Ea(t.e)});return sM(Ku.asn1.toDer(e).getBytes(),"ascii")}});var fM=y((o6t,lM)=>{f();"use strict";ag();var cM=dt(),{base64urlToBigInteger:T8e}=Yv();function uM(t,e){return e.map(r=>T8e(t[r]))}function R8e(t){return cM.pki.setRsaPrivateKey(...uM(t,["n","e","d","p","q","dp","dq","qi"]))}function P8e(t){return cM.pki.setRsaPublicKey(...uM(t,["n","e"]))}lM.exports={jwk2pub:P8e,jwk2priv:R8e}});var pM=y(Nc=>{f();"use strict";var Dc=lg(),C8e=hg(),{toString:O8e}=(tt(),et),{fromString:k8e}=(ft(),ht);Nc.utils=aM();Nc.generateKey=async function(t){let e=await Dc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await dM(e);return{privateKey:r[0],publicKey:r[1]}};Nc.unmarshalPrivateKey=async function(t){let r=[await Dc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await q8e(t)],i=await dM({privateKey:r[0],publicKey:r[1]});return{privateKey:i[0],publicKey:i[1]}};Nc.getRandomValues=C8e;Nc.hashAndSign=async function(t,e){let r=await Dc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Dc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};Nc.hashAndVerify=async function(t,e,r){let i=await Dc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Dc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,r)};function dM(t){return Promise.all([Dc.get().subtle.exportKey("jwk",t.privateKey),Dc.get().subtle.exportKey("jwk",t.publicKey)])}function q8e(t){return Dc.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:D8e,jwk2priv:N8e}=fM();function hM(t,e,r,i){let n=e?D8e(t):N8e(t),s=O8e(Uint8Array.from(r),"ascii"),o=i(s,n);return k8e(o,"ascii")}Nc.encrypt=function(t,e){return hM(t,!0,e,(r,i)=>i.encrypt(r))};Nc.decrypt=function(t,e){return hM(t,!1,e,(r,i)=>i.decrypt(r))}});var Xv=y((c6t,yM)=>{f();"use strict";var{base64:B8e}=(Zy(),ch),M8e=z6();yM.exports={export:async function(t,e){let i=await M8e.create().encrypt(t,e);return B8e.encode(i)}}});var wM=y((u6t,vM)=>{f();"use strict";var{sha256:gM}=(ri(),li),bM=ue(),{equals:mM}=(di(),fi),{toString:L8e}=(tt(),et);Hv();rA();var Qv=dt(),Ps=pM(),Zv=Sv(),U8e=Xv(),Jv=class{constructor(e){this._key=e}async verify(e,r){return Ps.hashAndVerify(this._key,r,e)}marshal(){return Ps.utils.jwkToPkix(this._key)}get bytes(){return Zv.PublicKey.encode({Type:Zv.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Ps.encrypt(this._key,e)}equals(e){return mM(this.bytes,e.bytes)}async hash(){let{bytes:e}=await gM.digest(this.bytes);return e}},gg=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ps.getRandomValues(16)}async sign(e){return Ps.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw bM(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Jv(this._publicKey)}decrypt(e){return Ps.decrypt(this._key,e)}marshal(){return Ps.utils.jwkToPkcs1(this._key)}get bytes(){return Zv.PrivateKey.encode({Type:Zv.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return mM(this.bytes,e.bytes)}async hash(){let{bytes:e}=await gM.digest(this.bytes);return e}async id(){let e=await this.public.hash();return L8e(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let i=new Qv.util.ByteBuffer(this.marshal()),n=Qv.asn1.fromDer(i),s=Qv.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Qv.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return U8e.export(this.bytes,e);throw bM(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function F8e(t){let e=Ps.utils.pkcs1ToJwk(t),r=await Ps.unmarshalPrivateKey(e);return new gg(r.privateKey,r.publicKey)}function K8e(t){let e=Ps.utils.pkixToJwk(t);return new Jv(e)}async function j8e(t){let e=await Ps.unmarshalPrivateKey(t);return new gg(e.privateKey,e.publicKey)}async function V8e(t){let e=await Ps.generateKey(t);return new gg(e.privateKey,e.publicKey)}vM.exports={RsaPublicKey:Jv,RsaPrivateKey:gg,unmarshalRsaPublicKey:K8e,unmarshalRsaPrivateKey:F8e,generateKeyPair:V8e,fromJwk:j8e}});var _M=y(gf=>{f();"use strict";rA();var _h=dt();gf.publicKeyLength=_h.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;gf.privateKeyLength=_h.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;gf.generateKey=async function(){return _h.pki.ed25519.generateKeyPair()};gf.generateKeyFromSeed=async function(t){return _h.pki.ed25519.generateKeyPair({seed:t})};gf.hashAndSign=async function(t,e){return _h.pki.ed25519.sign({message:e,privateKey:t})};gf.hashAndVerify=async function(t,e,r){return _h.pki.ed25519.verify({signature:e,message:r,publicKey:t})}});var IM=y((f6t,AM)=>{f();"use strict";var EM=ue(),{equals:SM}=(di(),fi),{sha256:xM}=(ri(),li),{base58btc:z8e}=(ei(),Jr),{identity:H8e}=(Cc(),Pc),ln=_M(),ew=Sv(),$8e=Xv(),tw=class{constructor(e){this._key=Sh(e,ln.publicKeyLength)}async verify(e,r){return ln.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return ew.PublicKey.encode({Type:ew.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return SM(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xM.digest(this.bytes);return e}},Eh=class{constructor(e,r){this._key=Sh(e,ln.privateKeyLength),this._publicKey=Sh(r,ln.publicKeyLength)}async sign(e){return ln.hashAndSign(this._key,e)}get public(){return new tw(this._publicKey)}marshal(){return this._key}get bytes(){return ew.PrivateKey.encode({Type:ew.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return SM(this.bytes,e.bytes)}async hash(){let{bytes:e}=await xM.digest(this.bytes);return e}async id(){let e=await H8e.digest(this.public.bytes);return z8e.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return $8e.export(this.bytes,e);throw EM(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function G8e(t){if(t.length>ln.privateKeyLength){t=Sh(t,ln.privateKeyLength+ln.publicKeyLength);let i=t.slice(0,ln.privateKeyLength),n=t.slice(ln.privateKeyLength,t.length);return new Eh(i,n)}t=Sh(t,ln.privateKeyLength);let e=t.slice(0,ln.privateKeyLength),r=t.slice(ln.publicKeyLength);return new Eh(e,r)}function W8e(t){return t=Sh(t,ln.publicKeyLength),new tw(t)}async function Y8e(){let{privateKey:t,publicKey:e}=await ln.generateKey();return new Eh(t,e)}async function X8e(t){let{privateKey:e,publicKey:r}=await ln.generateKeyFromSeed(t);return new Eh(e,r)}function Sh(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw EM(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}AM.exports={Ed25519PublicKey:tw,Ed25519PrivateKey:Eh,unmarshalEd25519PrivateKey:G8e,unmarshalEd25519PublicKey:W8e,generateKeyPair:Y8e,generateKeyPairFromSeed:X8e}});var RM=y((d6t,TM)=>{f();var Bt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function Cs(t,e){if(!t)throw new Error(e)}function Ct(t,e,r){if(Cs(e instanceof Uint8Array,`Expected ${t} to be an Uint8Array`),r!==void 0)if(Array.isArray(r)){let i=r.join(", "),n=`Expected ${t} to be an Uint8Array with length [${i}]`;Cs(r.includes(e.length),n)}else{let i=`Expected ${t} to be an Uint8Array with length ${r}`;Cs(e.length===r,i)}}function bf(t){Cs(xh(t)==="Boolean","Expected compressed to be a Boolean")}function _o(t=r=>new Uint8Array(r),e){return typeof t=="function"&&(t=t(e)),Ct("output",t,e),t}function xh(t){return Object.prototype.toString.call(t).slice(8,-1)}TM.exports=t=>({contextRandomize(e){switch(Cs(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&Ct("seed",e,32),t.contextRandomize(e)){case 1:throw new Error(Bt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return Ct("private key",e,32),t.privateKeyVerify(e)===0},privateKeyNegate(e){switch(Ct("private key",e,32),t.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(Bt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,r){switch(Ct("private key",e,32),Ct("tweak",r,32),t.privateKeyTweakAdd(e,r)){case 0:return e;case 1:throw new Error(Bt.TWEAK_ADD)}},privateKeyTweakMul(e,r){switch(Ct("private key",e,32),Ct("tweak",r,32),t.privateKeyTweakMul(e,r)){case 0:return e;case 1:throw new Error(Bt.TWEAK_MUL)}},publicKeyVerify(e){return Ct("public key",e,[33,65]),t.publicKeyVerify(e)===0},publicKeyCreate(e,r=!0,i){switch(Ct("private key",e,32),bf(r),i=_o(i,r?33:65),t.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(Bt.SECKEY_INVALID);case 2:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyConvert(e,r=!0,i){switch(Ct("public key",e,[33,65]),bf(r),i=_o(i,r?33:65),t.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyNegate(e,r=!0,i){switch(Ct("public key",e,[33,65]),bf(r),i=_o(i,r?33:65),t.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE);case 3:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyCombine(e,r=!0,i){Cs(Array.isArray(e),"Expected public keys to be an Array"),Cs(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)Ct("public key",n,[33,65]);switch(bf(r),i=_o(i,r?33:65),t.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.PUBKEY_COMBINE);case 3:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,r,i=!0,n){switch(Ct("public key",e,[33,65]),Ct("tweak",r,32),bf(i),n=_o(n,i?33:65),t.publicKeyTweakAdd(n,e,r)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.TWEAK_ADD)}},publicKeyTweakMul(e,r,i=!0,n){switch(Ct("public key",e,[33,65]),Ct("tweak",r,32),bf(i),n=_o(n,i?33:65),t.publicKeyTweakMul(n,e,r)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.TWEAK_MUL)}},signatureNormalize(e){switch(Ct("signature",e,64),t.signatureNormalize(e)){case 0:return e;case 1:throw new Error(Bt.SIG_PARSE)}},signatureExport(e,r){Ct("signature",e,64),r=_o(r,72);let i={output:r,outputlen:72};switch(t.signatureExport(i,e)){case 0:return r.slice(0,i.outputlen);case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},signatureImport(e,r){switch(Ct("signature",e),r=_o(r,64),t.signatureImport(r,e)){case 0:return r;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdsaSign(e,r,i={},n){Ct("message",e,32),Ct("private key",r,32),Cs(xh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Ct("options.data",i.data),i.noncefn!==void 0&&Cs(xh(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=_o(n,64);let s={signature:n,recid:null};switch(t.ecdsaSign(s,e,r,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(Bt.SIGN);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdsaVerify(e,r,i){switch(Ct("signature",e,64),Ct("message",r,32),Ct("public key",i,[33,65]),t.ecdsaVerify(e,r,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.PUBKEY_PARSE)}},ecdsaRecover(e,r,i,n=!0,s){switch(Ct("signature",e,64),Cs(xh(r)==="Number"&&r>=0&&r<=3,"Expected recovery id to be a Number within interval [0, 3]"),Ct("message",i,32),bf(n),s=_o(s,n?33:65),t.ecdsaRecover(s,e,r,i)){case 0:return s;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.RECOVER);case 3:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdh(e,r,i={},n){switch(Ct("public key",e,[33,65]),Ct("private key",r,32),Cs(xh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Ct("options.data",i.data),i.hashfn!==void 0?(Cs(xh(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&Ct("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&Ct("options.ybuf",i.ybuf,32),Ct("output",n)):n=_o(n,32),t.ecdh(n,e,r,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.ECDH)}}})});var PM=y((h6t,Q8e)=>{Q8e.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var CM=y(()=>{f()});var Sa=y((OM,iA)=>{f();(function(t,e){"use strict";function r(P,b){if(!P)throw new Error(b||"Assertion failed")}function i(P,b){P.super_=b;var w=function(){};w.prototype=b.prototype,P.prototype=new w,P.prototype.constructor=P}function n(P,b,w){if(n.isBN(P))return P;this.negative=0,this.words=null,this.length=0,this.red=null,P!==null&&((b==="le"||b==="be")&&(w=b,b=10),this._init(P||0,b||10,w||"be"))}typeof t=="object"?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?s=window.Buffer:s=CM().Buffer}catch(P){}n.isBN=function(b){return b instanceof n?!0:b!==null&&typeof b=="object"&&b.constructor.wordSize===n.wordSize&&Array.isArray(b.words)},n.max=function(b,w){return b.cmp(w)>0?b:w},n.min=function(b,w){return b.cmp(w)<0?b:w},n.prototype._init=function(b,w,S){if(typeof b=="number")return this._initNumber(b,w,S);if(typeof b=="object")return this._initArray(b,w,S);w==="hex"&&(w=16),r(w===(w|0)&&w>=2&&w<=36),b=b.toString().replace(/\s+/g,"");var C=0;b[0]==="-"&&(C++,this.negative=1),C<b.length&&(w===16?this._parseHex(b,C,S):(this._parseBase(b,w,C),S==="le"&&this._initArray(this.toArray(),w,S)))},n.prototype._initNumber=function(b,w,S){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(r(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),w,S)},n.prototype._initArray=function(b,w,S){if(r(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var B,W,j=0;if(S==="be")for(C=b.length-1,B=0;C>=0;C-=3)W=b[C]|b[C-1]<<8|b[C-2]<<16,this.words[B]|=W<<j&67108863,this.words[B+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,B++);else if(S==="le")for(C=0,B=0;C<b.length;C+=3)W=b[C]|b[C+1]<<8|b[C+2]<<16,this.words[B]|=W<<j&67108863,this.words[B+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,B++);return this.strip()};function o(P,b){var w=P.charCodeAt(b);return w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:w-48&15}function a(P,b,w){var S=o(P,w);return w-1>=b&&(S|=o(P,w-1)<<4),S}n.prototype._parseHex=function(b,w,S){this.length=Math.ceil((b.length-w)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var B=0,W=0,j;if(S==="be")for(C=b.length-1;C>=w;C-=2)j=a(b,w,C)<<B,this.words[W]|=j&67108863,B>=18?(B-=18,W+=1,this.words[W]|=j>>>26):B+=8;else{var M=b.length-w;for(C=M%2==0?w+1:w;C<b.length;C+=2)j=a(b,w,C)<<B,this.words[W]|=j&67108863,B>=18?(B-=18,W+=1,this.words[W]|=j>>>26):B+=8}this.strip()};function c(P,b,w,S){for(var C=0,B=Math.min(P.length,w),W=b;W<B;W++){var j=P.charCodeAt(W)-48;C*=S,j>=49?C+=j-49+10:j>=17?C+=j-17+10:C+=j}return C}n.prototype._parseBase=function(b,w,S){this.words=[0],this.length=1;for(var C=0,B=1;B<=67108863;B*=w)C++;C--,B=B/w|0;for(var W=b.length-S,j=W%C,M=Math.min(W,W-j)+S,_=0,L=S;L<M;L+=C)_=c(b,L,L+C,w),this.imuln(B),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_);if(j!==0){var ae=1;for(_=c(b,L,b.length,w),L=0;L<j;L++)ae*=w;this.imuln(ae),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_)}this.strip()},n.prototype.copy=function(b){b.words=new Array(this.length);for(var w=0;w<this.length;w++)b.words[w]=this.words[w];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,w){b=b||10,w=w|0||1;var S;if(b===16||b==="hex"){S="";for(var C=0,B=0,W=0;W<this.length;W++){var j=this.words[W],M=((j<<C|B)&16777215).toString(16);B=j>>>24-C&16777215,B!==0||W!==this.length-1?S=u[6-M.length]+M+S:S=M+S,C+=2,C>=26&&(C-=26,W--)}for(B!==0&&(S=B.toString(16)+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(b===(b|0)&&b>=2&&b<=36){var _=l[b],L=d[b];S="";var ae=this.clone();for(ae.negative=0;!ae.isZero();){var X=ae.modn(L).toString(b);ae=ae.idivn(L),ae.isZero()?S=X+S:S=u[_-X.length]+X+S}for(this.isZero()&&(S="0"+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=this.words[1]*67108864:this.length===3&&this.words[2]===1?b+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(b,w){return r(typeof s!="undefined"),this.toArrayLike(s,b,w)},n.prototype.toArray=function(b,w){return this.toArrayLike(Array,b,w)},n.prototype.toArrayLike=function(b,w,S){var C=this.byteLength(),B=S||Math.max(1,C);r(C<=B,"byte array longer than desired length"),r(B>0,"Requested array length <= 0"),this.strip();var W=w==="le",j=new b(B),M,_,L=this.clone();if(W){for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[_]=M;for(;_<B;_++)j[_]=0}else{for(_=0;_<B-C;_++)j[_]=0;for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[B-_-1]=M}return j},Math.clz32?n.prototype._countBits=function(b){return 32-Math.clz32(b)}:n.prototype._countBits=function(b){var w=b,S=0;return w>=4096&&(S+=13,w>>>=13),w>=64&&(S+=7,w>>>=7),w>=8&&(S+=4,w>>>=4),w>=2&&(S+=2,w>>>=2),S+w},n.prototype._zeroBits=function(b){if(b===0)return 26;var w=b,S=0;return(w&8191)==0&&(S+=13,w>>>=13),(w&127)==0&&(S+=7,w>>>=7),(w&15)==0&&(S+=4,w>>>=4),(w&3)==0&&(S+=2,w>>>=2),(w&1)==0&&S++,S},n.prototype.bitLength=function(){var b=this.words[this.length-1],w=this._countBits(b);return(this.length-1)*26+w};function h(P){for(var b=new Array(P.bitLength()),w=0;w<b.length;w++){var S=w/26|0,C=w%26;b[w]=(P.words[S]&1<<C)>>>C}return b}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,w=0;w<this.length;w++){var S=this._zeroBits(this.words[w]);if(b+=S,S!==26)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},n.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var w=0;w<b.length;w++)this.words[w]=this.words[w]|b.words[w];return this.strip()},n.prototype.ior=function(b){return r((this.negative|b.negative)==0),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var w;this.length>b.length?w=b:w=this;for(var S=0;S<w.length;S++)this.words[S]=this.words[S]&b.words[S];return this.length=w.length,this.strip()},n.prototype.iand=function(b){return r((this.negative|b.negative)==0),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var w,S;this.length>b.length?(w=this,S=b):(w=b,S=this);for(var C=0;C<S.length;C++)this.words[C]=w.words[C]^S.words[C];if(this!==w)for(;C<w.length;C++)this.words[C]=w.words[C];return this.length=w.length,this.strip()},n.prototype.ixor=function(b){return r((this.negative|b.negative)==0),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.inotn=function(b){r(typeof b=="number"&&b>=0);var w=Math.ceil(b/26)|0,S=b%26;this._expand(w),S>0&&w--;for(var C=0;C<w;C++)this.words[C]=~this.words[C]&67108863;return S>0&&(this.words[C]=~this.words[C]&67108863>>26-S),this.strip()},n.prototype.notn=function(b){return this.clone().inotn(b)},n.prototype.setn=function(b,w){r(typeof b=="number"&&b>=0);var S=b/26|0,C=b%26;return this._expand(S+1),w?this.words[S]=this.words[S]|1<<C:this.words[S]=this.words[S]&~(1<<C),this.strip()},n.prototype.iadd=function(b){var w;if(this.negative!==0&&b.negative===0)return this.negative=0,w=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,w=this.isub(b),b.negative=1,w._normSign();var S,C;this.length>b.length?(S=this,C=b):(S=b,C=this);for(var B=0,W=0;W<C.length;W++)w=(S.words[W]|0)+(C.words[W]|0)+B,this.words[W]=w&67108863,B=w>>>26;for(;B!==0&&W<S.length;W++)w=(S.words[W]|0)+B,this.words[W]=w&67108863,B=w>>>26;if(this.length=S.length,B!==0)this.words[this.length]=B,this.length++;else if(S!==this)for(;W<S.length;W++)this.words[W]=S.words[W];return this},n.prototype.add=function(b){var w;return b.negative!==0&&this.negative===0?(b.negative=0,w=this.sub(b),b.negative^=1,w):b.negative===0&&this.negative!==0?(this.negative=0,w=b.sub(this),this.negative=1,w):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var w=this.iadd(b);return b.negative=1,w._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var S=this.cmp(b);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var C,B;S>0?(C=this,B=b):(C=b,B=this);for(var W=0,j=0;j<B.length;j++)w=(C.words[j]|0)-(B.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;for(;W!==0&&j<C.length;j++)w=(C.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;if(W===0&&j<C.length&&C!==this)for(;j<C.length;j++)this.words[j]=C.words[j];return this.length=Math.max(this.length,j),C!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};function p(P,b,w){w.negative=b.negative^P.negative;var S=P.length+b.length|0;w.length=S,S=S-1|0;var C=P.words[0]|0,B=b.words[0]|0,W=C*B,j=W&67108863,M=W/67108864|0;w.words[0]=j;for(var _=1;_<S;_++){for(var L=M>>>26,ae=M&67108863,X=Math.min(_,b.length-1),ne=Math.max(0,_-P.length+1);ne<=X;ne++){var oe=_-ne|0;C=P.words[oe]|0,B=b.words[ne]|0,W=C*B+ae,L+=W/67108864|0,ae=W&67108863}w.words[_]=ae|0,M=L|0}return M!==0?w.words[_]=M|0:w.length--,w.strip()}var g=function(b,w,S){var C=b.words,B=w.words,W=S.words,j=0,M,_,L,ae=C[0]|0,X=ae&8191,ne=ae>>>13,oe=C[1]|0,he=oe&8191,pe=oe>>>13,_e=C[2]|0,k=_e&8191,K=_e>>>13,$=C[3]|0,Z=$&8191,I=$>>>13,U=C[4]|0,V=U&8191,N=U>>>13,Q=C[5]|0,ee=Q&8191,J=Q>>>13,ce=C[6]|0,ge=ce&8191,be=ce>>>13,je=C[7]|0,Re=je&8191,Ve=je>>>13,Je=C[8]|0,He=Je&8191,ze=Je>>>13,gt=C[9]|0,Yt=gt&8191,ir=gt>>>13,En=B[0]|0,zt=En&8191,At=En>>>13,Qr=B[1]|0,nt=Qr&8191,xr=Qr>>>13,jm=B[2]|0,Ir=jm&8191,Tr=jm>>>13,Vm=B[3]|0,Rr=Vm&8191,Pr=Vm>>>13,zm=B[4]|0,Cr=zm&8191,Or=zm>>>13,Hm=B[5]|0,kr=Hm&8191,qr=Hm>>>13,$m=B[6]|0,Dr=$m&8191,Nr=$m>>>13,Gm=B[7]|0,Br=Gm&8191,Mr=Gm>>>13,Wm=B[8]|0,Lr=Wm&8191,Ur=Wm>>>13,Ym=B[9]|0,Fr=Ym&8191,nr=Ym>>>13;S.negative=b.negative^w.negative,S.length=19,M=Math.imul(X,zt),_=Math.imul(X,At),_=_+Math.imul(ne,zt)|0,L=Math.imul(ne,At);var Xd=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Xd>>>26)|0,Xd&=67108863,M=Math.imul(he,zt),_=Math.imul(he,At),_=_+Math.imul(pe,zt)|0,L=Math.imul(pe,At),M=M+Math.imul(X,nt)|0,_=_+Math.imul(X,xr)|0,_=_+Math.imul(ne,nt)|0,L=L+Math.imul(ne,xr)|0;var Iy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Iy>>>26)|0,Iy&=67108863,M=Math.imul(k,zt),_=Math.imul(k,At),_=_+Math.imul(K,zt)|0,L=Math.imul(K,At),M=M+Math.imul(he,nt)|0,_=_+Math.imul(he,xr)|0,_=_+Math.imul(pe,nt)|0,L=L+Math.imul(pe,xr)|0,M=M+Math.imul(X,Ir)|0,_=_+Math.imul(X,Tr)|0,_=_+Math.imul(ne,Ir)|0,L=L+Math.imul(ne,Tr)|0;var Ty=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ty>>>26)|0,Ty&=67108863,M=Math.imul(Z,zt),_=Math.imul(Z,At),_=_+Math.imul(I,zt)|0,L=Math.imul(I,At),M=M+Math.imul(k,nt)|0,_=_+Math.imul(k,xr)|0,_=_+Math.imul(K,nt)|0,L=L+Math.imul(K,xr)|0,M=M+Math.imul(he,Ir)|0,_=_+Math.imul(he,Tr)|0,_=_+Math.imul(pe,Ir)|0,L=L+Math.imul(pe,Tr)|0,M=M+Math.imul(X,Rr)|0,_=_+Math.imul(X,Pr)|0,_=_+Math.imul(ne,Rr)|0,L=L+Math.imul(ne,Pr)|0;var Ry=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ry>>>26)|0,Ry&=67108863,M=Math.imul(V,zt),_=Math.imul(V,At),_=_+Math.imul(N,zt)|0,L=Math.imul(N,At),M=M+Math.imul(Z,nt)|0,_=_+Math.imul(Z,xr)|0,_=_+Math.imul(I,nt)|0,L=L+Math.imul(I,xr)|0,M=M+Math.imul(k,Ir)|0,_=_+Math.imul(k,Tr)|0,_=_+Math.imul(K,Ir)|0,L=L+Math.imul(K,Tr)|0,M=M+Math.imul(he,Rr)|0,_=_+Math.imul(he,Pr)|0,_=_+Math.imul(pe,Rr)|0,L=L+Math.imul(pe,Pr)|0,M=M+Math.imul(X,Cr)|0,_=_+Math.imul(X,Or)|0,_=_+Math.imul(ne,Cr)|0,L=L+Math.imul(ne,Or)|0;var Py=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Py>>>26)|0,Py&=67108863,M=Math.imul(ee,zt),_=Math.imul(ee,At),_=_+Math.imul(J,zt)|0,L=Math.imul(J,At),M=M+Math.imul(V,nt)|0,_=_+Math.imul(V,xr)|0,_=_+Math.imul(N,nt)|0,L=L+Math.imul(N,xr)|0,M=M+Math.imul(Z,Ir)|0,_=_+Math.imul(Z,Tr)|0,_=_+Math.imul(I,Ir)|0,L=L+Math.imul(I,Tr)|0,M=M+Math.imul(k,Rr)|0,_=_+Math.imul(k,Pr)|0,_=_+Math.imul(K,Rr)|0,L=L+Math.imul(K,Pr)|0,M=M+Math.imul(he,Cr)|0,_=_+Math.imul(he,Or)|0,_=_+Math.imul(pe,Cr)|0,L=L+Math.imul(pe,Or)|0,M=M+Math.imul(X,kr)|0,_=_+Math.imul(X,qr)|0,_=_+Math.imul(ne,kr)|0,L=L+Math.imul(ne,qr)|0;var Cy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Cy>>>26)|0,Cy&=67108863,M=Math.imul(ge,zt),_=Math.imul(ge,At),_=_+Math.imul(be,zt)|0,L=Math.imul(be,At),M=M+Math.imul(ee,nt)|0,_=_+Math.imul(ee,xr)|0,_=_+Math.imul(J,nt)|0,L=L+Math.imul(J,xr)|0,M=M+Math.imul(V,Ir)|0,_=_+Math.imul(V,Tr)|0,_=_+Math.imul(N,Ir)|0,L=L+Math.imul(N,Tr)|0,M=M+Math.imul(Z,Rr)|0,_=_+Math.imul(Z,Pr)|0,_=_+Math.imul(I,Rr)|0,L=L+Math.imul(I,Pr)|0,M=M+Math.imul(k,Cr)|0,_=_+Math.imul(k,Or)|0,_=_+Math.imul(K,Cr)|0,L=L+Math.imul(K,Or)|0,M=M+Math.imul(he,kr)|0,_=_+Math.imul(he,qr)|0,_=_+Math.imul(pe,kr)|0,L=L+Math.imul(pe,qr)|0,M=M+Math.imul(X,Dr)|0,_=_+Math.imul(X,Nr)|0,_=_+Math.imul(ne,Dr)|0,L=L+Math.imul(ne,Nr)|0;var lo=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(lo>>>26)|0,lo&=67108863,M=Math.imul(Re,zt),_=Math.imul(Re,At),_=_+Math.imul(Ve,zt)|0,L=Math.imul(Ve,At),M=M+Math.imul(ge,nt)|0,_=_+Math.imul(ge,xr)|0,_=_+Math.imul(be,nt)|0,L=L+Math.imul(be,xr)|0,M=M+Math.imul(ee,Ir)|0,_=_+Math.imul(ee,Tr)|0,_=_+Math.imul(J,Ir)|0,L=L+Math.imul(J,Tr)|0,M=M+Math.imul(V,Rr)|0,_=_+Math.imul(V,Pr)|0,_=_+Math.imul(N,Rr)|0,L=L+Math.imul(N,Pr)|0,M=M+Math.imul(Z,Cr)|0,_=_+Math.imul(Z,Or)|0,_=_+Math.imul(I,Cr)|0,L=L+Math.imul(I,Or)|0,M=M+Math.imul(k,kr)|0,_=_+Math.imul(k,qr)|0,_=_+Math.imul(K,kr)|0,L=L+Math.imul(K,qr)|0,M=M+Math.imul(he,Dr)|0,_=_+Math.imul(he,Nr)|0,_=_+Math.imul(pe,Dr)|0,L=L+Math.imul(pe,Nr)|0,M=M+Math.imul(X,Br)|0,_=_+Math.imul(X,Mr)|0,_=_+Math.imul(ne,Br)|0,L=L+Math.imul(ne,Mr)|0;var Oy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Oy>>>26)|0,Oy&=67108863,M=Math.imul(He,zt),_=Math.imul(He,At),_=_+Math.imul(ze,zt)|0,L=Math.imul(ze,At),M=M+Math.imul(Re,nt)|0,_=_+Math.imul(Re,xr)|0,_=_+Math.imul(Ve,nt)|0,L=L+Math.imul(Ve,xr)|0,M=M+Math.imul(ge,Ir)|0,_=_+Math.imul(ge,Tr)|0,_=_+Math.imul(be,Ir)|0,L=L+Math.imul(be,Tr)|0,M=M+Math.imul(ee,Rr)|0,_=_+Math.imul(ee,Pr)|0,_=_+Math.imul(J,Rr)|0,L=L+Math.imul(J,Pr)|0,M=M+Math.imul(V,Cr)|0,_=_+Math.imul(V,Or)|0,_=_+Math.imul(N,Cr)|0,L=L+Math.imul(N,Or)|0,M=M+Math.imul(Z,kr)|0,_=_+Math.imul(Z,qr)|0,_=_+Math.imul(I,kr)|0,L=L+Math.imul(I,qr)|0,M=M+Math.imul(k,Dr)|0,_=_+Math.imul(k,Nr)|0,_=_+Math.imul(K,Dr)|0,L=L+Math.imul(K,Nr)|0,M=M+Math.imul(he,Br)|0,_=_+Math.imul(he,Mr)|0,_=_+Math.imul(pe,Br)|0,L=L+Math.imul(pe,Mr)|0,M=M+Math.imul(X,Lr)|0,_=_+Math.imul(X,Ur)|0,_=_+Math.imul(ne,Lr)|0,L=L+Math.imul(ne,Ur)|0;var ky=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(ky>>>26)|0,ky&=67108863,M=Math.imul(Yt,zt),_=Math.imul(Yt,At),_=_+Math.imul(ir,zt)|0,L=Math.imul(ir,At),M=M+Math.imul(He,nt)|0,_=_+Math.imul(He,xr)|0,_=_+Math.imul(ze,nt)|0,L=L+Math.imul(ze,xr)|0,M=M+Math.imul(Re,Ir)|0,_=_+Math.imul(Re,Tr)|0,_=_+Math.imul(Ve,Ir)|0,L=L+Math.imul(Ve,Tr)|0,M=M+Math.imul(ge,Rr)|0,_=_+Math.imul(ge,Pr)|0,_=_+Math.imul(be,Rr)|0,L=L+Math.imul(be,Pr)|0,M=M+Math.imul(ee,Cr)|0,_=_+Math.imul(ee,Or)|0,_=_+Math.imul(J,Cr)|0,L=L+Math.imul(J,Or)|0,M=M+Math.imul(V,kr)|0,_=_+Math.imul(V,qr)|0,_=_+Math.imul(N,kr)|0,L=L+Math.imul(N,qr)|0,M=M+Math.imul(Z,Dr)|0,_=_+Math.imul(Z,Nr)|0,_=_+Math.imul(I,Dr)|0,L=L+Math.imul(I,Nr)|0,M=M+Math.imul(k,Br)|0,_=_+Math.imul(k,Mr)|0,_=_+Math.imul(K,Br)|0,L=L+Math.imul(K,Mr)|0,M=M+Math.imul(he,Lr)|0,_=_+Math.imul(he,Ur)|0,_=_+Math.imul(pe,Lr)|0,L=L+Math.imul(pe,Ur)|0,M=M+Math.imul(X,Fr)|0,_=_+Math.imul(X,nr)|0,_=_+Math.imul(ne,Fr)|0,L=L+Math.imul(ne,nr)|0;var qy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(qy>>>26)|0,qy&=67108863,M=Math.imul(Yt,nt),_=Math.imul(Yt,xr),_=_+Math.imul(ir,nt)|0,L=Math.imul(ir,xr),M=M+Math.imul(He,Ir)|0,_=_+Math.imul(He,Tr)|0,_=_+Math.imul(ze,Ir)|0,L=L+Math.imul(ze,Tr)|0,M=M+Math.imul(Re,Rr)|0,_=_+Math.imul(Re,Pr)|0,_=_+Math.imul(Ve,Rr)|0,L=L+Math.imul(Ve,Pr)|0,M=M+Math.imul(ge,Cr)|0,_=_+Math.imul(ge,Or)|0,_=_+Math.imul(be,Cr)|0,L=L+Math.imul(be,Or)|0,M=M+Math.imul(ee,kr)|0,_=_+Math.imul(ee,qr)|0,_=_+Math.imul(J,kr)|0,L=L+Math.imul(J,qr)|0,M=M+Math.imul(V,Dr)|0,_=_+Math.imul(V,Nr)|0,_=_+Math.imul(N,Dr)|0,L=L+Math.imul(N,Nr)|0,M=M+Math.imul(Z,Br)|0,_=_+Math.imul(Z,Mr)|0,_=_+Math.imul(I,Br)|0,L=L+Math.imul(I,Mr)|0,M=M+Math.imul(k,Lr)|0,_=_+Math.imul(k,Ur)|0,_=_+Math.imul(K,Lr)|0,L=L+Math.imul(K,Ur)|0,M=M+Math.imul(he,Fr)|0,_=_+Math.imul(he,nr)|0,_=_+Math.imul(pe,Fr)|0,L=L+Math.imul(pe,nr)|0;var Dy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Dy>>>26)|0,Dy&=67108863,M=Math.imul(Yt,Ir),_=Math.imul(Yt,Tr),_=_+Math.imul(ir,Ir)|0,L=Math.imul(ir,Tr),M=M+Math.imul(He,Rr)|0,_=_+Math.imul(He,Pr)|0,_=_+Math.imul(ze,Rr)|0,L=L+Math.imul(ze,Pr)|0,M=M+Math.imul(Re,Cr)|0,_=_+Math.imul(Re,Or)|0,_=_+Math.imul(Ve,Cr)|0,L=L+Math.imul(Ve,Or)|0,M=M+Math.imul(ge,kr)|0,_=_+Math.imul(ge,qr)|0,_=_+Math.imul(be,kr)|0,L=L+Math.imul(be,qr)|0,M=M+Math.imul(ee,Dr)|0,_=_+Math.imul(ee,Nr)|0,_=_+Math.imul(J,Dr)|0,L=L+Math.imul(J,Nr)|0,M=M+Math.imul(V,Br)|0,_=_+Math.imul(V,Mr)|0,_=_+Math.imul(N,Br)|0,L=L+Math.imul(N,Mr)|0,M=M+Math.imul(Z,Lr)|0,_=_+Math.imul(Z,Ur)|0,_=_+Math.imul(I,Lr)|0,L=L+Math.imul(I,Ur)|0,M=M+Math.imul(k,Fr)|0,_=_+Math.imul(k,nr)|0,_=_+Math.imul(K,Fr)|0,L=L+Math.imul(K,nr)|0;var Ny=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ny>>>26)|0,Ny&=67108863,M=Math.imul(Yt,Rr),_=Math.imul(Yt,Pr),_=_+Math.imul(ir,Rr)|0,L=Math.imul(ir,Pr),M=M+Math.imul(He,Cr)|0,_=_+Math.imul(He,Or)|0,_=_+Math.imul(ze,Cr)|0,L=L+Math.imul(ze,Or)|0,M=M+Math.imul(Re,kr)|0,_=_+Math.imul(Re,qr)|0,_=_+Math.imul(Ve,kr)|0,L=L+Math.imul(Ve,qr)|0,M=M+Math.imul(ge,Dr)|0,_=_+Math.imul(ge,Nr)|0,_=_+Math.imul(be,Dr)|0,L=L+Math.imul(be,Nr)|0,M=M+Math.imul(ee,Br)|0,_=_+Math.imul(ee,Mr)|0,_=_+Math.imul(J,Br)|0,L=L+Math.imul(J,Mr)|0,M=M+Math.imul(V,Lr)|0,_=_+Math.imul(V,Ur)|0,_=_+Math.imul(N,Lr)|0,L=L+Math.imul(N,Ur)|0,M=M+Math.imul(Z,Fr)|0,_=_+Math.imul(Z,nr)|0,_=_+Math.imul(I,Fr)|0,L=L+Math.imul(I,nr)|0;var By=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(By>>>26)|0,By&=67108863,M=Math.imul(Yt,Cr),_=Math.imul(Yt,Or),_=_+Math.imul(ir,Cr)|0,L=Math.imul(ir,Or),M=M+Math.imul(He,kr)|0,_=_+Math.imul(He,qr)|0,_=_+Math.imul(ze,kr)|0,L=L+Math.imul(ze,qr)|0,M=M+Math.imul(Re,Dr)|0,_=_+Math.imul(Re,Nr)|0,_=_+Math.imul(Ve,Dr)|0,L=L+Math.imul(Ve,Nr)|0,M=M+Math.imul(ge,Br)|0,_=_+Math.imul(ge,Mr)|0,_=_+Math.imul(be,Br)|0,L=L+Math.imul(be,Mr)|0,M=M+Math.imul(ee,Lr)|0,_=_+Math.imul(ee,Ur)|0,_=_+Math.imul(J,Lr)|0,L=L+Math.imul(J,Ur)|0,M=M+Math.imul(V,Fr)|0,_=_+Math.imul(V,nr)|0,_=_+Math.imul(N,Fr)|0,L=L+Math.imul(N,nr)|0;var My=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(My>>>26)|0,My&=67108863,M=Math.imul(Yt,kr),_=Math.imul(Yt,qr),_=_+Math.imul(ir,kr)|0,L=Math.imul(ir,qr),M=M+Math.imul(He,Dr)|0,_=_+Math.imul(He,Nr)|0,_=_+Math.imul(ze,Dr)|0,L=L+Math.imul(ze,Nr)|0,M=M+Math.imul(Re,Br)|0,_=_+Math.imul(Re,Mr)|0,_=_+Math.imul(Ve,Br)|0,L=L+Math.imul(Ve,Mr)|0,M=M+Math.imul(ge,Lr)|0,_=_+Math.imul(ge,Ur)|0,_=_+Math.imul(be,Lr)|0,L=L+Math.imul(be,Ur)|0,M=M+Math.imul(ee,Fr)|0,_=_+Math.imul(ee,nr)|0,_=_+Math.imul(J,Fr)|0,L=L+Math.imul(J,nr)|0;var Ly=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ly>>>26)|0,Ly&=67108863,M=Math.imul(Yt,Dr),_=Math.imul(Yt,Nr),_=_+Math.imul(ir,Dr)|0,L=Math.imul(ir,Nr),M=M+Math.imul(He,Br)|0,_=_+Math.imul(He,Mr)|0,_=_+Math.imul(ze,Br)|0,L=L+Math.imul(ze,Mr)|0,M=M+Math.imul(Re,Lr)|0,_=_+Math.imul(Re,Ur)|0,_=_+Math.imul(Ve,Lr)|0,L=L+Math.imul(Ve,Ur)|0,M=M+Math.imul(ge,Fr)|0,_=_+Math.imul(ge,nr)|0,_=_+Math.imul(be,Fr)|0,L=L+Math.imul(be,nr)|0;var Uy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Uy>>>26)|0,Uy&=67108863,M=Math.imul(Yt,Br),_=Math.imul(Yt,Mr),_=_+Math.imul(ir,Br)|0,L=Math.imul(ir,Mr),M=M+Math.imul(He,Lr)|0,_=_+Math.imul(He,Ur)|0,_=_+Math.imul(ze,Lr)|0,L=L+Math.imul(ze,Ur)|0,M=M+Math.imul(Re,Fr)|0,_=_+Math.imul(Re,nr)|0,_=_+Math.imul(Ve,Fr)|0,L=L+Math.imul(Ve,nr)|0;var mi=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(mi>>>26)|0,mi&=67108863,M=Math.imul(Yt,Lr),_=Math.imul(Yt,Ur),_=_+Math.imul(ir,Lr)|0,L=Math.imul(ir,Ur),M=M+Math.imul(He,Fr)|0,_=_+Math.imul(He,nr)|0,_=_+Math.imul(ze,Fr)|0,L=L+Math.imul(ze,nr)|0;var Fy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Fy>>>26)|0,Fy&=67108863,M=Math.imul(Yt,Fr),_=Math.imul(Yt,nr),_=_+Math.imul(ir,Fr)|0,L=Math.imul(ir,nr);var Ky=(j+M|0)+((_&8191)<<13)|0;return j=(L+(_>>>13)|0)+(Ky>>>26)|0,Ky&=67108863,W[0]=Xd,W[1]=Iy,W[2]=Ty,W[3]=Ry,W[4]=Py,W[5]=Cy,W[6]=lo,W[7]=Oy,W[8]=ky,W[9]=qy,W[10]=Dy,W[11]=Ny,W[12]=By,W[13]=My,W[14]=Ly,W[15]=Uy,W[16]=mi,W[17]=Fy,W[18]=Ky,j!==0&&(W[19]=j,S.length++),S};Math.imul||(g=p);function m(P,b,w){w.negative=b.negative^P.negative,w.length=P.length+b.length;for(var S=0,C=0,B=0;B<w.length-1;B++){var W=C;C=0;for(var j=S&67108863,M=Math.min(B,b.length-1),_=Math.max(0,B-P.length+1);_<=M;_++){var L=B-_,ae=P.words[L]|0,X=b.words[_]|0,ne=ae*X,oe=ne&67108863;W=W+(ne/67108864|0)|0,oe=oe+j|0,j=oe&67108863,W=W+(oe>>>26)|0,C+=W>>>26,W&=67108863}w.words[B]=j,S=W,W=C}return S!==0?w.words[B]=S:w.length--,w.strip()}function E(P,b,w){var S=new v;return S.mulp(P,b,w)}n.prototype.mulTo=function(b,w){var S,C=this.length+b.length;return this.length===10&&b.length===10?S=g(this,b,w):C<63?S=p(this,b,w):C<1024?S=m(this,b,w):S=E(this,b,w),S};function v(P,b){this.x=P,this.y=b}v.prototype.makeRBT=function(b){for(var w=new Array(b),S=n.prototype._countBits(b)-1,C=0;C<b;C++)w[C]=this.revBin(C,S,b);return w},v.prototype.revBin=function(b,w,S){if(b===0||b===S-1)return b;for(var C=0,B=0;B<w;B++)C|=(b&1)<<w-B-1,b>>=1;return C},v.prototype.permute=function(b,w,S,C,B,W){for(var j=0;j<W;j++)C[j]=w[b[j]],B[j]=S[b[j]]},v.prototype.transform=function(b,w,S,C,B,W){this.permute(W,b,w,S,C,B);for(var j=1;j<B;j<<=1)for(var M=j<<1,_=Math.cos(2*Math.PI/M),L=Math.sin(2*Math.PI/M),ae=0;ae<B;ae+=M)for(var X=_,ne=L,oe=0;oe<j;oe++){var he=S[ae+oe],pe=C[ae+oe],_e=S[ae+oe+j],k=C[ae+oe+j],K=X*_e-ne*k;k=X*k+ne*_e,_e=K,S[ae+oe]=he+_e,C[ae+oe]=pe+k,S[ae+oe+j]=he-_e,C[ae+oe+j]=pe-k,oe!==M&&(K=_*X-L*ne,ne=_*ne+L*X,X=K)}},v.prototype.guessLen13b=function(b,w){var S=Math.max(w,b)|1,C=S&1,B=0;for(S=S/2|0;S;S=S>>>1)B++;return 1<<B+1+C},v.prototype.conjugate=function(b,w,S){if(!(S<=1))for(var C=0;C<S/2;C++){var B=b[C];b[C]=b[S-C-1],b[S-C-1]=B,B=w[C],w[C]=-w[S-C-1],w[S-C-1]=-B}},v.prototype.normalize13b=function(b,w){for(var S=0,C=0;C<w/2;C++){var B=Math.round(b[2*C+1]/w)*8192+Math.round(b[2*C]/w)+S;b[C]=B&67108863,B<67108864?S=0:S=B/67108864|0}return b},v.prototype.convert13b=function(b,w,S,C){for(var B=0,W=0;W<w;W++)B=B+(b[W]|0),S[2*W]=B&8191,B=B>>>13,S[2*W+1]=B&8191,B=B>>>13;for(W=2*w;W<C;++W)S[W]=0;r(B===0),r((B&~8191)==0)},v.prototype.stub=function(b){for(var w=new Array(b),S=0;S<b;S++)w[S]=0;return w},v.prototype.mulp=function(b,w,S){var C=2*this.guessLen13b(b.length,w.length),B=this.makeRBT(C),W=this.stub(C),j=new Array(C),M=new Array(C),_=new Array(C),L=new Array(C),ae=new Array(C),X=new Array(C),ne=S.words;ne.length=C,this.convert13b(b.words,b.length,j,C),this.convert13b(w.words,w.length,L,C),this.transform(j,W,M,_,C,B),this.transform(L,W,ae,X,C,B);for(var oe=0;oe<C;oe++){var he=M[oe]*ae[oe]-_[oe]*X[oe];_[oe]=M[oe]*X[oe]+_[oe]*ae[oe],M[oe]=he}return this.conjugate(M,_,C),this.transform(M,_,ne,W,C,B),this.conjugate(ne,W,C),this.normalize13b(ne,C),S.negative=b.negative^w.negative,S.length=b.length+w.length,S.strip()},n.prototype.mul=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),this.mulTo(b,w)},n.prototype.mulf=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),E(this,b,w)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){r(typeof b=="number"),r(b<67108864);for(var w=0,S=0;S<this.length;S++){var C=(this.words[S]|0)*b,B=(C&67108863)+(w&67108863);w>>=26,w+=C/67108864|0,w+=B>>>26,this.words[S]=B&67108863}return w!==0&&(this.words[S]=w,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var w=h(b);if(w.length===0)return new n(1);for(var S=this,C=0;C<w.length&&w[C]===0;C++,S=S.sqr());if(++C<w.length)for(var B=S.sqr();C<w.length;C++,B=B.sqr())w[C]!==0&&(S=S.mul(B));return S},n.prototype.iushln=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=67108863>>>26-w<<26-w,B;if(w!==0){var W=0;for(B=0;B<this.length;B++){var j=this.words[B]&C,M=(this.words[B]|0)-j<<w;this.words[B]=M|W,W=j>>>26-w}W&&(this.words[B]=W,this.length++)}if(S!==0){for(B=this.length-1;B>=0;B--)this.words[B+S]=this.words[B];for(B=0;B<S;B++)this.words[B]=0;this.length+=S}return this.strip()},n.prototype.ishln=function(b){return r(this.negative===0),this.iushln(b)},n.prototype.iushrn=function(b,w,S){r(typeof b=="number"&&b>=0);var C;w?C=(w-w%26)/26:C=0;var B=b%26,W=Math.min((b-B)/26,this.length),j=67108863^67108863>>>B<<B,M=S;if(C-=W,C=Math.max(0,C),M){for(var _=0;_<W;_++)M.words[_]=this.words[_];M.length=W}if(W!==0)if(this.length>W)for(this.length-=W,_=0;_<this.length;_++)this.words[_]=this.words[_+W];else this.words[0]=0,this.length=1;var L=0;for(_=this.length-1;_>=0&&(L!==0||_>=C);_--){var ae=this.words[_]|0;this.words[_]=L<<26-B|ae>>>B,L=ae&j}return M&&L!==0&&(M.words[M.length++]=L),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(b,w,S){return r(this.negative===0),this.iushrn(b,w,S)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return!1;var B=this.words[S];return!!(B&C)},n.prototype.imaskn=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(w!==0&&S++,this.length=Math.min(S,this.length),w!==0){var C=67108863^67108863>>>w<<w;this.words[this.length-1]&=C}return this.strip()},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return r(typeof b=="number"),r(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},n.prototype.isubn=function(b){if(r(typeof b=="number"),r(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,w,S){var C=b.length+S,B;this._expand(C);var W,j=0;for(B=0;B<b.length;B++){W=(this.words[B+S]|0)+j;var M=(b.words[B]|0)*w;W-=M&67108863,j=(W>>26)-(M/67108864|0),this.words[B+S]=W&67108863}for(;B<this.length-S;B++)W=(this.words[B+S]|0)+j,j=W>>26,this.words[B+S]=W&67108863;if(j===0)return this.strip();for(r(j===-1),j=0,B=0;B<this.length;B++)W=-(this.words[B]|0)+j,j=W>>26,this.words[B]=W&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,w){var S=this.length-b.length,C=this.clone(),B=b,W=B.words[B.length-1]|0,j=this._countBits(W);S=26-j,S!==0&&(B=B.ushln(S),C.iushln(S),W=B.words[B.length-1]|0);var M=C.length-B.length,_;if(w!=="mod"){_=new n(null),_.length=M+1,_.words=new Array(_.length);for(var L=0;L<_.length;L++)_.words[L]=0}var ae=C.clone()._ishlnsubmul(B,1,M);ae.negative===0&&(C=ae,_&&(_.words[M]=1));for(var X=M-1;X>=0;X--){var ne=(C.words[B.length+X]|0)*67108864+(C.words[B.length+X-1]|0);for(ne=Math.min(ne/W|0,67108863),C._ishlnsubmul(B,ne,X);C.negative!==0;)ne--,C.negative=0,C._ishlnsubmul(B,1,X),C.isZero()||(C.negative^=1);_&&(_.words[X]=ne)}return _&&_.strip(),C.strip(),w!=="div"&&S!==0&&C.iushrn(S),{div:_||null,mod:C}},n.prototype.divmod=function(b,w,S){if(r(!b.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var C,B,W;return this.negative!==0&&b.negative===0?(W=this.neg().divmod(b,w),w!=="mod"&&(C=W.div.neg()),w!=="div"&&(B=W.mod.neg(),S&&B.negative!==0&&B.iadd(b)),{div:C,mod:B}):this.negative===0&&b.negative!==0?(W=this.divmod(b.neg(),w),w!=="mod"&&(C=W.div.neg()),{div:C,mod:W.mod}):(this.negative&b.negative)!=0?(W=this.neg().divmod(b.neg(),w),w!=="div"&&(B=W.mod.neg(),S&&B.negative!==0&&B.isub(b)),{div:W.div,mod:B}):b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:b.length===1?w==="div"?{div:this.divn(b.words[0]),mod:null}:w==="mod"?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,w)},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var w=this.divmod(b);if(w.mod.isZero())return w.div;var S=w.div.negative!==0?w.mod.isub(b):w.mod,C=b.ushrn(1),B=b.andln(1),W=S.cmp(C);return W<0||B===1&&W===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},n.prototype.modn=function(b){r(b<=67108863);for(var w=(1<<26)%b,S=0,C=this.length-1;C>=0;C--)S=(w*S+(this.words[C]|0))%b;return S},n.prototype.idivn=function(b){r(b<=67108863);for(var w=0,S=this.length-1;S>=0;S--){var C=(this.words[S]|0)+w*67108864;this.words[S]=C/b|0,w=C%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){r(b.negative===0),r(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),B=new n(0),W=new n(0),j=new n(1),M=0;w.isEven()&&S.isEven();)w.iushrn(1),S.iushrn(1),++M;for(var _=S.clone(),L=w.clone();!w.isZero();){for(var ae=0,X=1;(w.words[0]&X)==0&&ae<26;++ae,X<<=1);if(ae>0)for(w.iushrn(ae);ae-- >0;)(C.isOdd()||B.isOdd())&&(C.iadd(_),B.isub(L)),C.iushrn(1),B.iushrn(1);for(var ne=0,oe=1;(S.words[0]&oe)==0&&ne<26;++ne,oe<<=1);if(ne>0)for(S.iushrn(ne);ne-- >0;)(W.isOdd()||j.isOdd())&&(W.iadd(_),j.isub(L)),W.iushrn(1),j.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(W),B.isub(j)):(S.isub(w),W.isub(C),j.isub(B))}return{a:W,b:j,gcd:S.iushln(M)}},n.prototype._invmp=function(b){r(b.negative===0),r(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),B=new n(0),W=S.clone();w.cmpn(1)>0&&S.cmpn(1)>0;){for(var j=0,M=1;(w.words[0]&M)==0&&j<26;++j,M<<=1);if(j>0)for(w.iushrn(j);j-- >0;)C.isOdd()&&C.iadd(W),C.iushrn(1);for(var _=0,L=1;(S.words[0]&L)==0&&_<26;++_,L<<=1);if(_>0)for(S.iushrn(_);_-- >0;)B.isOdd()&&B.iadd(W),B.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(B)):(S.isub(w),B.isub(C))}var ae;return w.cmpn(1)===0?ae=C:ae=B,ae.cmpn(0)<0&&ae.iadd(b),ae},n.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var w=this.clone(),S=b.clone();w.negative=0,S.negative=0;for(var C=0;w.isEven()&&S.isEven();C++)w.iushrn(1),S.iushrn(1);do{for(;w.isEven();)w.iushrn(1);for(;S.isEven();)S.iushrn(1);var B=w.cmp(S);if(B<0){var W=w;w=S,S=W}else if(B===0||S.cmpn(1)===0)break;w.isub(S)}while(!0);return S.iushln(C)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){r(typeof b=="number");var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return this._expand(S+1),this.words[S]|=C,this;for(var B=C,W=S;B!==0&&W<this.length;W++){var j=this.words[W]|0;j+=B,B=j>>>26,j&=67108863,this.words[W]=j}return B!==0&&(this.words[W]=B,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(b){var w=b<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;this.strip();var S;if(this.length>1)S=1;else{w&&(b=-b),r(b<=67108863,"Number is too big");var C=this.words[0]|0;S=C===b?0:C<b?-1:1}return this.negative!==0?-S|0:S},n.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var w=this.ucmp(b);return this.negative!==0?-w|0:w},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var w=0,S=this.length-1;S>=0;S--){var C=this.words[S]|0,B=b.words[S]|0;if(C!==B){C<B?w=-1:C>B&&(w=1);break}}return w},n.prototype.gtn=function(b){return this.cmpn(b)===1},n.prototype.gt=function(b){return this.cmp(b)===1},n.prototype.gten=function(b){return this.cmpn(b)>=0},n.prototype.gte=function(b){return this.cmp(b)>=0},n.prototype.ltn=function(b){return this.cmpn(b)===-1},n.prototype.lt=function(b){return this.cmp(b)===-1},n.prototype.lten=function(b){return this.cmpn(b)<=0},n.prototype.lte=function(b){return this.cmp(b)<=0},n.prototype.eqn=function(b){return this.cmpn(b)===0},n.prototype.eq=function(b){return this.cmp(b)===0},n.red=function(b){return new G(b)},n.prototype.toRed=function(b){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return r(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},n.prototype.redMul=function(b){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return r(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var A={k256:null,p224:null,p192:null,p25519:null};function R(P,b){this.name=P,this.p=new n(b,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},R.prototype.ireduce=function(b){var w=b,S;do this.split(w,this.tmp),w=this.imulK(w),w=w.iadd(this.tmp),S=w.bitLength();while(S>this.n);var C=S<this.n?-1:w.ucmp(this.p);return C===0?(w.words[0]=0,w.length=1):C>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},R.prototype.split=function(b,w){b.iushrn(this.n,0,w)},R.prototype.imulK=function(b){return b.imul(this.k)};function F(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(F,R),F.prototype.split=function(b,w){for(var S=4194303,C=Math.min(b.length,9),B=0;B<C;B++)w.words[B]=b.words[B];if(w.length=C,b.length<=9){b.words[0]=0,b.length=1;return}var W=b.words[9];for(w.words[w.length++]=W&S,B=10;B<b.length;B++){var j=b.words[B]|0;b.words[B-10]=(j&S)<<4|W>>>22,W=j}W>>>=22,b.words[B-10]=W,W===0&&b.length>10?b.length-=10:b.length-=9},F.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var w=0,S=0;S<b.length;S++){var C=b.words[S]|0;w+=C*977,b.words[S]=w&67108863,w=C*64+(w/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function q(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(q,R);function D(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(D,R);function z(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(z,R),z.prototype.imulK=function(b){for(var w=0,S=0;S<b.length;S++){var C=(b.words[S]|0)*19+w,B=C&67108863;C>>>=26,b.words[S]=B,w=C}return w!==0&&(b.words[b.length++]=w),b},n._prime=function(b){if(A[b])return A[b];var w;if(b==="k256")w=new F;else if(b==="p224")w=new q;else if(b==="p192")w=new D;else if(b==="p25519")w=new z;else throw new Error("Unknown prime "+b);return A[b]=w,w};function G(P){if(typeof P=="string"){var b=n._prime(P);this.m=b.p,this.prime=b}else r(P.gtn(1),"modulus must be greater than 1"),this.m=P,this.prime=null}G.prototype._verify1=function(b){r(b.negative===0,"red works only with positives"),r(b.red,"red works only with red numbers")},G.prototype._verify2=function(b,w){r((b.negative|w.negative)==0,"red works only with positives"),r(b.red&&b.red===w.red,"red works only with red numbers")},G.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},G.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},G.prototype.add=function(b,w){this._verify2(b,w);var S=b.add(w);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},G.prototype.iadd=function(b,w){this._verify2(b,w);var S=b.iadd(w);return S.cmp(this.m)>=0&&S.isub(this.m),S},G.prototype.sub=function(b,w){this._verify2(b,w);var S=b.sub(w);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},G.prototype.isub=function(b,w){this._verify2(b,w);var S=b.isub(w);return S.cmpn(0)<0&&S.iadd(this.m),S},G.prototype.shl=function(b,w){return this._verify1(b),this.imod(b.ushln(w))},G.prototype.imul=function(b,w){return this._verify2(b,w),this.imod(b.imul(w))},G.prototype.mul=function(b,w){return this._verify2(b,w),this.imod(b.mul(w))},G.prototype.isqr=function(b){return this.imul(b,b.clone())},G.prototype.sqr=function(b){return this.mul(b,b)},G.prototype.sqrt=function(b){if(b.isZero())return b.clone();var w=this.m.andln(3);if(r(w%2==1),w===3){var S=this.m.add(new n(1)).iushrn(2);return this.pow(b,S)}for(var C=this.m.subn(1),B=0;!C.isZero()&&C.andln(1)===0;)B++,C.iushrn(1);r(!C.isZero());var W=new n(1).toRed(this),j=W.redNeg(),M=this.m.subn(1).iushrn(1),_=this.m.bitLength();for(_=new n(2*_*_).toRed(this);this.pow(_,M).cmp(j)!==0;)_.redIAdd(j);for(var L=this.pow(_,C),ae=this.pow(b,C.addn(1).iushrn(1)),X=this.pow(b,C),ne=B;X.cmp(W)!==0;){for(var oe=X,he=0;oe.cmp(W)!==0;he++)oe=oe.redSqr();r(he<ne);var pe=this.pow(L,new n(1).iushln(ne-he-1));ae=ae.redMul(pe),L=pe.redSqr(),X=X.redMul(L),ne=he}return ae},G.prototype.invm=function(b){var w=b._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},G.prototype.pow=function(b,w){if(w.isZero())return new n(1).toRed(this);if(w.cmpn(1)===0)return b.clone();var S=4,C=new Array(1<<S);C[0]=new n(1).toRed(this),C[1]=b;for(var B=2;B<C.length;B++)C[B]=this.mul(C[B-1],b);var W=C[0],j=0,M=0,_=w.bitLength()%26;for(_===0&&(_=26),B=w.length-1;B>=0;B--){for(var L=w.words[B],ae=_-1;ae>=0;ae--){var X=L>>ae&1;if(W!==C[0]&&(W=this.sqr(W)),X===0&&j===0){M=0;continue}j<<=1,j|=X,M++,!(M!==S&&(B!==0||ae!==0))&&(W=this.mul(W,C[j]),M=0,j=0)}_=26}return W},G.prototype.convertTo=function(b){var w=b.umod(this.m);return w===b?w.clone():w},G.prototype.convertFrom=function(b){var w=b.clone();return w.red=null,w},n.mont=function(b){return new Y(b)};function Y(P){G.call(this,P),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(Y,G),Y.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},Y.prototype.convertFrom=function(b){var w=this.imod(b.mul(this.rinv));return w.red=null,w},Y.prototype.imul=function(b,w){if(b.isZero()||w.isZero())return b.words[0]=0,b.length=1,b;var S=b.imul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(C).iushrn(this.shift),W=B;return B.cmp(this.m)>=0?W=B.isub(this.m):B.cmpn(0)<0&&(W=B.iadd(this.m)),W._forceRed(this)},Y.prototype.mul=function(b,w){if(b.isZero()||w.isZero())return new n(0)._forceRed(this);var S=b.mul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(C).iushrn(this.shift),W=B;return B.cmp(this.m)>=0?W=B.isub(this.m):B.cmpn(0)<0&&(W=B.iadd(this.m)),W._forceRed(this)},Y.prototype.invm=function(b){var w=this.imod(b._invmp(this.m).mul(this.r2));return w._forceRed(this)}})(typeof iA=="undefined"||iA,OM)});var ju=y((g6t,qM)=>{f();qM.exports=kM;function kM(t,e){if(!t)throw new Error(e||"Assertion failed")}kM.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)}});var nA=y(BM=>{f();"use strict";var rw=BM;function Z8e(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t!="string"){for(var i=0;i<t.length;i++)r[i]=t[i]|0;return r}if(e==="hex"){t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!=0&&(t="0"+t);for(var i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var i=0;i<t.length;i++){var n=t.charCodeAt(i),s=n>>8,o=n&255;s?r.push(s,o):r.push(o)}return r}rw.toArray=Z8e;function DM(t){return t.length===1?"0"+t:t}rw.zero2=DM;function NM(t){for(var e="",r=0;r<t.length;r++)e+=DM(t[r].toString(16));return e}rw.toHex=NM;rw.encode=function(e,r){return r==="hex"?NM(e):e}});var ns=y(MM=>{f();"use strict";var Eo=MM,J8e=Sa(),ePe=ju(),iw=nA();Eo.assert=ePe;Eo.toArray=iw.toArray;Eo.zero2=iw.zero2;Eo.toHex=iw.toHex;Eo.encode=iw.encode;function tPe(t,e,r){var i=new Array(Math.max(t.bitLength(),r)+1);i.fill(0);for(var n=1<<e+1,s=t.clone(),o=0;o<i.length;o++){var a,c=s.andln(n-1);s.isOdd()?(c>(n>>1)-1?a=(n>>1)-c:a=c,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i}Eo.getNAF=tPe;function rPe(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var i=0,n=0,s;t.cmpn(-i)>0||e.cmpn(-n)>0;){var o=t.andln(3)+i&3,a=e.andln(3)+n&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)==0?c=0:(s=t.andln(7)+i&7,(s===3||s===5)&&a===2?c=-o:c=o),r[0].push(c);var u;(a&1)==0?u=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?u=-a:u=a),r[1].push(u),2*i===c+1&&(i=1-i),2*n===u+1&&(n=1-n),t.iushrn(1),e.iushrn(1)}return r}Eo.getJSF=rPe;function iPe(t,e,r){var i="_"+e;t.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=r.call(this)}}Eo.cachedProperty=iPe;function nPe(t){return typeof t=="string"?Eo.toArray(t,"hex"):t}Eo.parseBytes=nPe;function sPe(t){return new J8e(t,"hex","le")}Eo.intFromLE=sPe});var cA=y((v6t,aA)=>{f();var sA;aA.exports=function(e){return sA||(sA=new Vu(null)),sA.generate(e)};function Vu(t){this.rand=t}aA.exports.Rand=Vu;Vu.prototype.generate=function(e){return this._rand(e)};Vu.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),i=0;i<r.length;i++)r[i]=this.rand.getByte();return r};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Vu.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Vu.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Vu.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(oA=ph(),typeof oA.randomBytes!="function")throw new Error("Not supported");Vu.prototype._rand=function(e){return oA.randomBytes(e)}}catch(t){}var oA});var mg=y((w6t,LM)=>{f();"use strict";var mf=Sa(),bg=ns(),nw=bg.getNAF,oPe=bg.getJSF,sw=bg.assert;function zu(t,e){this.type=t,this.p=new mf(e.p,16),this.red=e.prime?mf.red(e.prime):mf.mont(this.p),this.zero=new mf(0).toRed(this.red),this.one=new mf(1).toRed(this.red),this.two=new mf(2).toRed(this.red),this.n=e.n&&new mf(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}LM.exports=zu;zu.prototype.point=function(){throw new Error("Not implemented")};zu.prototype.validate=function(){throw new Error("Not implemented")};zu.prototype._fixedNafMul=function(e,r){sw(e.precomputed);var i=e._getDoubles(),n=nw(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var u=a+i.step-1;u>=a;u--)c=(c<<1)+n[u];o.push(c)}for(var l=this.jpoint(null,null,null),d=this.jpoint(null,null,null),h=s;h>0;h--){for(a=0;a<o.length;a++)c=o[a],c===h?d=d.mixedAdd(i.points[a]):c===-h&&(d=d.mixedAdd(i.points[a].neg()));l=l.add(d)}return l.toP()};zu.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=nw(r,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var l=o[c];sw(l!==0),e.type==="affine"?l>0?a=a.mixedAdd(s[l-1>>1]):a=a.mixedAdd(s[-l-1>>1].neg()):l>0?a=a.add(s[l-1>>1]):a=a.add(s[-l-1>>1].neg())}return e.type==="affine"?a.toP():a};zu.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,l,d,h;for(l=0;l<n;l++){h=r[l];var p=h._getNAFPoints(e);o[l]=p.wnd,a[l]=p.points}for(l=n-1;l>=1;l-=2){var g=l-1,m=l;if(o[g]!==1||o[m]!==1){c[g]=nw(i[g],o[g],this._bitLength),c[m]=nw(i[m],o[m],this._bitLength),u=Math.max(c[g].length,u),u=Math.max(c[m].length,u);continue}var E=[r[g],null,null,r[m]];r[g].y.cmp(r[m].y)===0?(E[1]=r[g].add(r[m]),E[2]=r[g].toJ().mixedAdd(r[m].neg())):r[g].y.cmp(r[m].y.redNeg())===0?(E[1]=r[g].toJ().mixedAdd(r[m]),E[2]=r[g].add(r[m].neg())):(E[1]=r[g].toJ().mixedAdd(r[m]),E[2]=r[g].toJ().mixedAdd(r[m].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],A=oPe(i[g],i[m]);for(u=Math.max(A[0].length,u),c[g]=new Array(u),c[m]=new Array(u),d=0;d<u;d++){var R=A[0][d]|0,F=A[1][d]|0;c[g][d]=v[(R+1)*3+(F+1)],c[m][d]=0,a[g]=E}}var q=this.jpoint(null,null,null),D=this._wnafT4;for(l=u;l>=0;l--){for(var z=0;l>=0;){var G=!0;for(d=0;d<n;d++)D[d]=c[d][l]|0,D[d]!==0&&(G=!1);if(!G)break;z++,l--}if(l>=0&&z++,q=q.dblp(z),l<0)break;for(d=0;d<n;d++){var Y=D[d];Y!==0&&(Y>0?h=a[d][Y-1>>1]:Y<0&&(h=a[d][-Y-1>>1].neg()),h.type==="affine"?q=q.mixedAdd(h):q=q.add(h))}}for(l=0;l<n;l++)a[l]=null;return s?q:q.toP()};function Os(t,e){this.curve=t,this.type=e,this.precomputed=null}zu.BasePoint=Os;Os.prototype.eq=function(){throw new Error("Not implemented")};Os.prototype.validate=function(){return this.curve.validate(this)};zu.prototype.decodePoint=function(e,r){e=bg.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?sw(e[e.length-1]%2==0):e[0]===7&&sw(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Os.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Os.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};Os.prototype.encode=function(e,r){return bg.encode(this._encode(r),e)};Os.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};Os.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};Os.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};Os.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}};Os.prototype._getBeta=function(){return null};Os.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r}});var Yi=y((_6t,uA)=>{f();typeof Object.create=="function"?uA.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:uA.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}}});var FM=y((E6t,UM)=>{f();"use strict";var aPe=ns(),jr=Sa(),lA=Yi(),Ah=mg(),cPe=aPe.assert;function ks(t){Ah.call(this,"short",t),this.a=new jr(t.a,16).toRed(this.red),this.b=new jr(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}lA(ks,Ah);UM.exports=ks;ks.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new jr(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new jr(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],cPe(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new jr(a.a,16),b:new jr(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}};ks.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:jr.mont(e),i=new jr(2).toRed(r).redInvm(),n=i.redNeg(),s=new jr(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};ks.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new jr(1),o=new jr(0),a=new jr(0),c=new jr(1),u,l,d,h,p,g,m,E=0,v,A;i.cmpn(0)!==0;){var R=n.div(i);v=n.sub(R.mul(i)),A=a.sub(R.mul(s));var F=c.sub(R.mul(o));if(!d&&v.cmp(r)<0)u=m.neg(),l=s,d=v.neg(),h=A;else if(d&&++E==2)break;m=v,n=i,i=v,a=s,s=A,c=o,o=F}p=v.neg(),g=A;var q=d.sqr().add(h.sqr()),D=p.sqr().add(g.sqr());return D.cmp(q)>=0&&(p=u,g=l),d.negative&&(d=d.neg(),h=h.neg()),p.negative&&(p=p.neg(),g=g.neg()),[{a:d,b:h},{a:p,b:g}]};ks.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),u=s.mul(i.b),l=o.mul(n.b),d=e.sub(a).sub(c),h=u.add(l).neg();return{k1:d,k2:h}};ks.prototype.pointFromX=function(e,r){e=new jr(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)};ks.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};ks.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=c,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var l=this._wnafMulAdd(1,n,s,o*2,i),d=0;d<o*2;d++)n[d]=null,s[d]=null;return l};function Mi(t,e,r,i){Ah.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new jr(e,16),this.y=new jr(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}lA(Mi,Ah.BasePoint);ks.prototype.point=function(e,r,i){return new Mi(this,e,r,i)};ks.prototype.pointFromJSON=function(e,r){return Mi.fromJSON(this,e,r)};Mi.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}};Mi.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Mi.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};Mi.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Mi.prototype.isInfinity=function(){return this.inf};Mi.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Mi.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Mi.prototype.getX=function(){return this.x.fromRed()};Mi.prototype.getY=function(){return this.y.fromRed()};Mi.prototype.mul=function(e){return e=new jr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Mi.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};Mi.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};Mi.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Mi.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};Mi.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Xi(t,e,r,i){Ah.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new jr(0)):(this.x=new jr(e,16),this.y=new jr(r,16),this.z=new jr(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}lA(Xi,Ah.BasePoint);ks.prototype.jpoint=function(e,r,i){return new Xi(this,e,r,i)};Xi.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)};Xi.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Xi.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=c.redSqr(),d=l.redMul(c),h=n.redMul(l),p=u.redSqr().redIAdd(d).redISub(h).redISub(h),g=u.redMul(h.redISub(p)).redISub(o.redMul(d)),m=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(p,g,m)};Xi.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),l=u.redMul(a),d=i.redMul(u),h=c.redSqr().redIAdd(l).redISub(d).redISub(d),p=c.redMul(d.redISub(h)).redISub(s.redMul(l)),g=this.z.redMul(a);return this.curve.jpoint(h,p,g)};Xi.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),l=a.redAdd(a);for(r=0;r<e;r++){var d=o.redSqr(),h=l.redSqr(),p=h.redSqr(),g=d.redAdd(d).redIAdd(d).redIAdd(n.redMul(u)),m=o.redMul(h),E=g.redSqr().redISub(m.redAdd(m)),v=m.redISub(E),A=g.redMul(v);A=A.redIAdd(A).redISub(p);var R=l.redMul(c);r+1<e&&(u=u.redMul(p)),o=E,c=R,l=A}return this.curve.jpoint(o,l.redMul(s),c)};Xi.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Xi.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),u=c.redSqr().redISub(a).redISub(a),l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),e=u,r=c.redMul(a.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),h=this.y.redSqr(),p=h.redSqr(),g=this.x.redAdd(h).redSqr().redISub(d).redISub(p);g=g.redIAdd(g);var m=d.redAdd(d).redIAdd(d),E=m.redSqr(),v=p.redIAdd(p);v=v.redIAdd(v),v=v.redIAdd(v),e=E.redISub(g).redISub(g),r=m.redMul(g.redISub(e)).redISub(v),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};Xi.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);e=u;var l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),r=c.redMul(a.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),h=this.y.redSqr(),p=this.x.redMul(h),g=this.x.redSub(d).redMul(this.x.redAdd(d));g=g.redAdd(g).redIAdd(g);var m=p.redIAdd(p);m=m.redIAdd(m);var E=m.redAdd(m);e=g.redSqr().redISub(E),i=this.y.redAdd(this.z).redSqr().redISub(h).redISub(d);var v=h.redSqr();v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v),r=g.redMul(m.redISub(e)).redISub(v)}return this.curve.jpoint(e,r,i)};Xi.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var l=u.redMul(a),d=c.redSqr().redISub(l.redAdd(l)),h=l.redISub(d),p=a.redSqr();p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var g=c.redMul(h).redISub(p),m=i.redAdd(i).redMul(n);return this.curve.jpoint(d,g,m)};Xi.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var l=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),d=r.redMul(l);d=d.redIAdd(d),d=d.redIAdd(d);var h=this.x.redMul(c).redISub(d);h=h.redIAdd(h),h=h.redIAdd(h);var p=this.y.redMul(l.redMul(u.redISub(l)).redISub(a.redMul(c)));p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(h,p,g)};Xi.prototype.mul=function(e,r){return e=new jr(e,r),this.curve._wnafMul(this,e)};Xi.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};Xi.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Xi.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Xi.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var VM=y((S6t,jM)=>{f();"use strict";var Ih=Sa(),KM=Yi(),ow=mg(),uPe=ns();function Th(t){ow.call(this,"mont",t),this.a=new Ih(t.a,16).toRed(this.red),this.b=new Ih(t.b,16).toRed(this.red),this.i4=new Ih(4).toRed(this.red).redInvm(),this.two=new Ih(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}KM(Th,ow);jM.exports=Th;Th.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function Li(t,e,r){ow.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Ih(e,16),this.z=new Ih(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}KM(Li,ow.BasePoint);Th.prototype.decodePoint=function(e,r){return this.point(uPe.toArray(e,r),1)};Th.prototype.point=function(e,r){return new Li(this,e,r)};Th.prototype.pointFromJSON=function(e){return Li.fromJSON(this,e)};Li.prototype.precompute=function(){};Li.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Li.fromJSON=function(e,r){return new Li(e,r[0],r[1]||e.one)};Li.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Li.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Li.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),o=r.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};Li.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Li.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),u=r.z.redMul(a.redAdd(c).redSqr()),l=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,l)};Li.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};Li.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Li.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Li.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Li.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Li.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var $M=y((x6t,HM)=>{f();"use strict";var lPe=ns(),Bc=Sa(),zM=Yi(),aw=mg(),fPe=lPe.assert;function xa(t){this.twisted=(t.a|0)!=1,this.mOneA=this.twisted&&(t.a|0)==-1,this.extended=this.mOneA,aw.call(this,"edwards",t),this.a=new Bc(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Bc(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Bc(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),fPe(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)==1}zM(xa,aw);HM.exports=xa;xa.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};xa.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};xa.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)};xa.prototype.pointFromX=function(e,r){e=new Bc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(e,a)};xa.prototype.pointFromY=function(e,r){e=new Bc(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)};xa.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function or(t,e,r,i,n){aw.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Bc(e,16),this.y=new Bc(r,16),this.z=i?new Bc(i,16):this.curve.one,this.t=n&&new Bc(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}zM(or,aw.BasePoint);xa.prototype.pointFromJSON=function(e){return or.fromJSON(this,e)};xa.prototype.point=function(e,r,i,n){return new or(this,e,r,i,n)};or.fromJSON=function(e,r){return new or(e,r[0],r[1],r[2])};or.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};or.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};or.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=n.redAdd(r),a=o.redSub(i),c=n.redSub(r),u=s.redMul(a),l=o.redMul(c),d=s.redMul(c),h=a.redMul(o);return this.curve.point(u,l,h,d)};or.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var l=a.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(l.redSub(this.curve.two)),s=l.redMul(a.redSub(i)),o=l.redSqr().redSub(l).redSub(l)):(c=this.z.redSqr(),u=l.redSub(c).redISub(c),n=e.redSub(r).redISub(i).redMul(u),s=l.redMul(a.redSub(i)),o=l.redMul(u))}else a=r.redAdd(i),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(i)),o=a.redMul(u);return this.curve.point(n,s,o)};or.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};or.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(r),a=s.redSub(n),c=s.redAdd(n),u=i.redAdd(r),l=o.redMul(a),d=c.redMul(u),h=o.redMul(u),p=a.redMul(c);return this.curve.point(l,d,p,h)};or.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),l=r.redMul(a).redMul(u),d,h;return this.curve.twisted?(d=r.redMul(c).redMul(s.redSub(this.curve._mulA(n))),h=a.redMul(c)):(d=r.redMul(c).redMul(s.redSub(n)),h=this.curve._mulC(a).redMul(c)),this.curve.point(l,d,h)};or.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};or.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};or.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)};or.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)};or.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};or.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};or.prototype.getX=function(){return this.normalize(),this.x.fromRed()};or.prototype.getY=function(){return this.normalize(),this.y.fromRed()};or.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};or.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}};or.prototype.toP=or.prototype.normalize;or.prototype.mixedAdd=or.prototype.add});var fA=y(GM=>{f();"use strict";var cw=GM;cw.base=mg();cw.short=FM();cw.mont=VM();cw.edwards=$M()});var So=y(Jt=>{f();"use strict";var dPe=ju(),hPe=Yi();Jt.inherits=hPe;function pPe(t,e){return(t.charCodeAt(e)&64512)!=55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)==56320}function yPe(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):pPe(t,n)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<t.length;n++)r[n]=t[n]|0;return r}Jt.toArray=yPe;function gPe(t){for(var e="",r=0;r<t.length;r++)e+=YM(t[r].toString(16));return e}Jt.toHex=gPe;function WM(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}Jt.htonl=WM;function bPe(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];e==="little"&&(n=WM(n)),r+=XM(n.toString(16))}return r}Jt.toHex32=bPe;function YM(t){return t.length===1?"0"+t:t}Jt.zero2=YM;function XM(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}Jt.zero8=XM;function mPe(t,e,r,i){var n=r-e;dPe(n%4==0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}Jt.join32=mPe;function vPe(t,e){for(var r=new Array(t.length*4),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];e==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}Jt.split32=vPe;function wPe(t,e){return t>>>e|t<<32-e}Jt.rotr32=wPe;function _Pe(t,e){return t<<e|t>>>32-e}Jt.rotl32=_Pe;function EPe(t,e){return t+e>>>0}Jt.sum32=EPe;function SPe(t,e,r){return t+e+r>>>0}Jt.sum32_3=SPe;function xPe(t,e,r,i){return t+e+r+i>>>0}Jt.sum32_4=xPe;function APe(t,e,r,i,n){return t+e+r+i+n>>>0}Jt.sum32_5=APe;function IPe(t,e,r,i){var n=t[e],s=t[e+1],o=i+s>>>0,a=(o<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=o}Jt.sum64=IPe;function TPe(t,e,r,i){var n=e+i>>>0,s=(n<e?1:0)+t+r;return s>>>0}Jt.sum64_hi=TPe;function RPe(t,e,r,i){var n=e+i;return n>>>0}Jt.sum64_lo=RPe;function PPe(t,e,r,i,n,s,o,a){var c=0,u=e;u=u+i>>>0,c+=u<e?1:0,u=u+s>>>0,c+=u<s?1:0,u=u+a>>>0,c+=u<a?1:0;var l=t+r+n+o+c;return l>>>0}Jt.sum64_4_hi=PPe;function CPe(t,e,r,i,n,s,o,a){var c=e+i+s+a;return c>>>0}Jt.sum64_4_lo=CPe;function OPe(t,e,r,i,n,s,o,a,c,u){var l=0,d=e;d=d+i>>>0,l+=d<e?1:0,d=d+s>>>0,l+=d<s?1:0,d=d+a>>>0,l+=d<a?1:0,d=d+u>>>0,l+=d<u?1:0;var h=t+r+n+o+c+l;return h>>>0}Jt.sum64_5_hi=OPe;function kPe(t,e,r,i,n,s,o,a,c,u){var l=e+i+s+a+u;return l>>>0}Jt.sum64_5_lo=kPe;function qPe(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}Jt.rotr64_hi=qPe;function DPe(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Jt.rotr64_lo=DPe;function NPe(t,e,r){return t>>>r}Jt.shr64_hi=NPe;function BPe(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Jt.shr64_lo=BPe});var Rh=y(ZM=>{f();"use strict";var QM=So(),MPe=ju();function uw(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}ZM.BlockHash=uw;uw.prototype.update=function(e,r){if(e=QM.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=QM.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};uw.prototype.digest=function(e){return this.update(this._pad()),MPe(this.pending===null),this._digest(e)};uw.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n}});var dA=y(Mc=>{f();"use strict";var LPe=So(),Aa=LPe.rotr32;function UPe(t,e,r,i){if(t===0)return JM(e,r,i);if(t===1||t===3)return t7(e,r,i);if(t===2)return e7(e,r,i)}Mc.ft_1=UPe;function JM(t,e,r){return t&e^~t&r}Mc.ch32=JM;function e7(t,e,r){return t&e^t&r^e&r}Mc.maj32=e7;function t7(t,e,r){return t^e^r}Mc.p32=t7;function FPe(t){return Aa(t,2)^Aa(t,13)^Aa(t,22)}Mc.s0_256=FPe;function KPe(t){return Aa(t,6)^Aa(t,11)^Aa(t,25)}Mc.s1_256=KPe;function jPe(t){return Aa(t,7)^Aa(t,18)^t>>>3}Mc.g0_256=jPe;function VPe(t){return Aa(t,17)^Aa(t,19)^t>>>10}Mc.g1_256=VPe});var n7=y((P6t,i7)=>{f();"use strict";var Ph=So(),zPe=Rh(),HPe=dA(),hA=Ph.rotl32,vg=Ph.sum32,$Pe=Ph.sum32_5,GPe=HPe.ft_1,r7=zPe.BlockHash,WPe=[1518500249,1859775393,2400959708,3395469782];function Ia(){if(!(this instanceof Ia))return new Ia;r7.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Ph.inherits(Ia,r7);i7.exports=Ia;Ia.blockSize=512;Ia.outSize=160;Ia.hmacStrength=80;Ia.padLength=64;Ia.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=hA(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4];for(n=0;n<i.length;n++){var l=~~(n/20),d=$Pe(hA(s,5),GPe(l,o,a,c),u,i[n],WPe[l]);u=c,c=a,a=hA(o,30),o=s,s=d}this.h[0]=vg(this.h[0],s),this.h[1]=vg(this.h[1],o),this.h[2]=vg(this.h[2],a),this.h[3]=vg(this.h[3],c),this.h[4]=vg(this.h[4],u)};Ia.prototype._digest=function(e){return e==="hex"?Ph.toHex32(this.h,"big"):Ph.split32(this.h,"big")}});var pA=y((C6t,o7)=>{f();"use strict";var Ch=So(),YPe=Rh(),Oh=dA(),XPe=ju(),xo=Ch.sum32,QPe=Ch.sum32_4,ZPe=Ch.sum32_5,JPe=Oh.ch32,eCe=Oh.maj32,tCe=Oh.s0_256,rCe=Oh.s1_256,iCe=Oh.g0_256,nCe=Oh.g1_256,s7=YPe.BlockHash,sCe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ta(){if(!(this instanceof Ta))return new Ta;s7.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sCe,this.W=new Array(64)}Ch.inherits(Ta,s7);o7.exports=Ta;Ta.blockSize=512;Ta.outSize=256;Ta.hmacStrength=192;Ta.padLength=64;Ta.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=QPe(nCe(i[n-2]),i[n-7],iCe(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],l=this.h[5],d=this.h[6],h=this.h[7];for(XPe(this.k.length===i.length),n=0;n<i.length;n++){var p=ZPe(h,rCe(u),JPe(u,l,d),this.k[n],i[n]),g=xo(tCe(s),eCe(s,o,a));h=d,d=l,l=u,u=xo(c,p),c=a,a=o,o=s,s=xo(p,g)}this.h[0]=xo(this.h[0],s),this.h[1]=xo(this.h[1],o),this.h[2]=xo(this.h[2],a),this.h[3]=xo(this.h[3],c),this.h[4]=xo(this.h[4],u),this.h[5]=xo(this.h[5],l),this.h[6]=xo(this.h[6],d),this.h[7]=xo(this.h[7],h)};Ta.prototype._digest=function(e){return e==="hex"?Ch.toHex32(this.h,"big"):Ch.split32(this.h,"big")}});var u7=y((O6t,c7)=>{f();"use strict";var yA=So(),a7=pA();function Lc(){if(!(this instanceof Lc))return new Lc;a7.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}yA.inherits(Lc,a7);c7.exports=Lc;Lc.blockSize=512;Lc.outSize=224;Lc.hmacStrength=192;Lc.padLength=64;Lc.prototype._digest=function(e){return e==="hex"?yA.toHex32(this.h.slice(0,7),"big"):yA.split32(this.h.slice(0,7),"big")}});var mA=y((k6t,h7)=>{f();"use strict";var jn=So(),oCe=Rh(),aCe=ju(),Ra=jn.rotr64_hi,Pa=jn.rotr64_lo,l7=jn.shr64_hi,f7=jn.shr64_lo,Hu=jn.sum64,gA=jn.sum64_hi,bA=jn.sum64_lo,cCe=jn.sum64_4_hi,uCe=jn.sum64_4_lo,lCe=jn.sum64_5_hi,fCe=jn.sum64_5_lo,d7=oCe.BlockHash,dCe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Ao(){if(!(this instanceof Ao))return new Ao;d7.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=dCe,this.W=new Array(160)}jn.inherits(Ao,d7);h7.exports=Ao;Ao.blockSize=1024;Ao.outSize=512;Ao.hmacStrength=192;Ao.padLength=128;Ao.prototype._prepareBlock=function(e,r){for(var i=this.W,n=0;n<32;n++)i[n]=e[r+n];for(;n<i.length;n+=2){var s=SCe(i[n-4],i[n-3]),o=xCe(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],u=_Ce(i[n-30],i[n-29]),l=ECe(i[n-30],i[n-29]),d=i[n-32],h=i[n-31];i[n]=cCe(s,o,a,c,u,l,d,h),i[n+1]=uCe(s,o,a,c,u,l,d,h)}};Ao.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],l=this.h[6],d=this.h[7],h=this.h[8],p=this.h[9],g=this.h[10],m=this.h[11],E=this.h[12],v=this.h[13],A=this.h[14],R=this.h[15];aCe(this.k.length===i.length);for(var F=0;F<i.length;F+=2){var q=A,D=R,z=vCe(h,p),G=wCe(h,p),Y=hCe(h,p,g,m,E,v),P=pCe(h,p,g,m,E,v),b=this.k[F],w=this.k[F+1],S=i[F],C=i[F+1],B=lCe(q,D,z,G,Y,P,b,w,S,C),W=fCe(q,D,z,G,Y,P,b,w,S,C);q=bCe(n,s),D=mCe(n,s),z=yCe(n,s,o,a,c,u),G=gCe(n,s,o,a,c,u);var j=gA(q,D,z,G),M=bA(q,D,z,G);A=E,R=v,E=g,v=m,g=h,m=p,h=gA(l,d,B,W),p=bA(d,d,B,W),l=c,d=u,c=o,u=a,o=n,a=s,n=gA(B,W,j,M),s=bA(B,W,j,M)}Hu(this.h,0,n,s),Hu(this.h,2,o,a),Hu(this.h,4,c,u),Hu(this.h,6,l,d),Hu(this.h,8,h,p),Hu(this.h,10,g,m),Hu(this.h,12,E,v),Hu(this.h,14,A,R)};Ao.prototype._digest=function(e){return e==="hex"?jn.toHex32(this.h,"big"):jn.split32(this.h,"big")};function hCe(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function pCe(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function yCe(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function gCe(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function bCe(t,e){var r=Ra(t,e,28),i=Ra(e,t,2),n=Ra(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function mCe(t,e){var r=Pa(t,e,28),i=Pa(e,t,2),n=Pa(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function vCe(t,e){var r=Ra(t,e,14),i=Ra(t,e,18),n=Ra(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function wCe(t,e){var r=Pa(t,e,14),i=Pa(t,e,18),n=Pa(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function _Ce(t,e){var r=Ra(t,e,1),i=Ra(t,e,8),n=l7(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function ECe(t,e){var r=Pa(t,e,1),i=Pa(t,e,8),n=f7(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function SCe(t,e){var r=Ra(t,e,19),i=Ra(e,t,29),n=l7(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}function xCe(t,e){var r=Pa(t,e,19),i=Pa(e,t,29),n=f7(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}});var g7=y((q6t,y7)=>{f();"use strict";var vA=So(),p7=mA();function Uc(){if(!(this instanceof Uc))return new Uc;p7.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}vA.inherits(Uc,p7);y7.exports=Uc;Uc.blockSize=1024;Uc.outSize=384;Uc.hmacStrength=192;Uc.padLength=128;Uc.prototype._digest=function(e){return e==="hex"?vA.toHex32(this.h.slice(0,12),"big"):vA.split32(this.h.slice(0,12),"big")}});var b7=y(kh=>{f();"use strict";kh.sha1=n7();kh.sha224=u7();kh.sha256=pA();kh.sha384=g7();kh.sha512=mA()});var S7=y(E7=>{f();"use strict";var vf=So(),ACe=Rh(),lw=vf.rotl32,m7=vf.sum32,wg=vf.sum32_3,v7=vf.sum32_4,w7=ACe.BlockHash;function Ca(){if(!(this instanceof Ca))return new Ca;w7.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}vf.inherits(Ca,w7);E7.ripemd160=Ca;Ca.blockSize=512;Ca.outSize=160;Ca.hmacStrength=192;Ca.padLength=64;Ca.prototype._update=function(e,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,u=n,l=s,d=o,h=a,p=0;p<80;p++){var g=m7(lw(v7(i,_7(p,n,s,o),e[RCe[p]+r],ICe(p)),CCe[p]),a);i=a,a=o,o=lw(s,10),s=n,n=g,g=m7(lw(v7(c,_7(79-p,u,l,d),e[PCe[p]+r],TCe(p)),OCe[p]),h),c=h,h=d,d=lw(l,10),l=u,u=g}g=wg(this.h[1],s,d),this.h[1]=wg(this.h[2],o,h),this.h[2]=wg(this.h[3],a,c),this.h[3]=wg(this.h[4],i,u),this.h[4]=wg(this.h[0],n,l),this.h[0]=g};Ca.prototype._digest=function(e){return e==="hex"?vf.toHex32(this.h,"little"):vf.split32(this.h,"little")};function _7(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function ICe(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function TCe(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var RCe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],PCe=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],CCe=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],OCe=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var A7=y((B6t,x7)=>{f();"use strict";var kCe=So(),qCe=ju();function qh(t,e,r){if(!(this instanceof qh))return new qh(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(kCe.toArray(e,r))}x7.exports=qh;qh.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),qCe(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)};qh.prototype.update=function(e,r){return this.inner.update(e,r),this};qh.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var fw=y(I7=>{f();var Qi=I7;Qi.utils=So();Qi.common=Rh();Qi.sha=b7();Qi.ripemd=S7();Qi.hmac=A7();Qi.sha1=Qi.sha.sha1;Qi.sha256=Qi.sha.sha256;Qi.sha224=Qi.sha.sha224;Qi.sha384=Qi.sha.sha384;Qi.sha512=Qi.sha.sha512;Qi.ripemd160=Qi.ripemd.ripemd160});var R7=y((L6t,T7)=>{f();T7.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var dw=y(O7=>{f();"use strict";var wA=O7,$u=fw(),_A=fA(),DCe=ns(),P7=DCe.assert;function C7(t){t.type==="short"?this.curve=new _A.short(t):t.type==="edwards"?this.curve=new _A.edwards(t):this.curve=new _A.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,P7(this.g.validate(),"Invalid curve"),P7(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}wA.PresetCurve=C7;function Gu(t,e){Object.defineProperty(wA,t,{configurable:!0,enumerable:!0,get:function(){var r=new C7(e);return Object.defineProperty(wA,t,{configurable:!0,enumerable:!0,value:r}),r}})}Gu("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:$u.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Gu("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:$u.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Gu("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:$u.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Gu("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:$u.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Gu("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:$u.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Gu("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:$u.sha256,gRed:!1,g:["9"]});Gu("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:$u.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var EA;try{EA=R7()}catch(t){EA=void 0}Gu("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:$u.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",EA]})});var D7=y((F6t,q7)=>{f();"use strict";var NCe=fw(),wf=nA(),k7=ju();function Wu(t){if(!(this instanceof Wu))return new Wu(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=wf.toArray(t.entropy,t.entropyEnc||"hex"),r=wf.toArray(t.nonce,t.nonceEnc||"hex"),i=wf.toArray(t.pers,t.persEnc||"hex");k7(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}q7.exports=Wu;Wu.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};Wu.prototype._hmac=function(){return new NCe.hmac(this.hash,this.K)};Wu.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Wu.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=wf.toArray(e,r),i=wf.toArray(i,n),k7(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};Wu.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=wf.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,wf.encode(o,r)}});var B7=y((K6t,N7)=>{f();"use strict";var BCe=Sa(),MCe=ns(),SA=MCe.assert;function fn(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}N7.exports=fn;fn.fromPublic=function(e,r,i){return r instanceof fn?r:new fn(e,{pub:r,pubEnc:i})};fn.fromPrivate=function(e,r,i){return r instanceof fn?r:new fn(e,{priv:r,privEnc:i})};fn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};fn.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};fn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};fn.prototype._importPrivate=function(e,r){this.priv=new BCe(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};fn.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?SA(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&SA(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};fn.prototype.derive=function(e){return e.validate()||SA(e.validate(),"public point not validated"),e.mul(this.priv).getX()};fn.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};fn.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};fn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var U7=y((j6t,L7)=>{f();"use strict";var hw=Sa(),xA=ns(),LCe=xA.assert;function pw(t,e){if(t instanceof pw)return t;this._importDER(t,e)||(LCe(t.r&&t.s,"Signature without r or s"),this.r=new hw(t.r,16),this.s=new hw(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}L7.exports=pw;function UCe(){this.place=0}function AA(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function M7(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}pw.prototype._importDER=function(e,r){e=xA.toArray(e,r);var i=new UCe;if(e[i.place++]!==48)return!1;var n=AA(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=AA(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=AA(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new hw(o),this.s=new hw(c),this.recoveryParam=null,!0};function IA(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}pw.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=M7(r),i=M7(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];IA(n,r.length),n=n.concat(r),n.push(2),IA(n,i.length);var s=n.concat(i),o=[48];return IA(o,s.length),o=o.concat(s),xA.encode(o,e)}});var V7=y((V6t,j7)=>{f();"use strict";var _f=Sa(),F7=D7(),FCe=ns(),TA=dw(),KCe=cA(),K7=FCe.assert,RA=B7(),yw=U7();function qs(t){if(!(this instanceof qs))return new qs(t);typeof t=="string"&&(K7(Object.prototype.hasOwnProperty.call(TA,t),"Unknown curve "+t),t=TA[t]),t instanceof TA.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}j7.exports=qs;qs.prototype.keyPair=function(e){return new RA(this,e)};qs.prototype.keyFromPrivate=function(e,r){return RA.fromPrivate(this,e,r)};qs.prototype.keyFromPublic=function(e,r){return RA.fromPublic(this,e,r)};qs.prototype.genKeyPair=function(e){e||(e={});for(var r=new F7({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||KCe(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new _f(2));;){var s=new _f(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};qs.prototype._truncateToN=function(e,r){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};qs.prototype.sign=function(e,r,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),r=this.keyFromPrivate(r,i),e=this._truncateToN(new _f(e,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new F7({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),u=this.n.sub(new _f(1)),l=0;;l++){var d=n.k?n.k(l):new _f(c.generate(this.n.byteLength()));if(d=this._truncateToN(d,!0),!(d.cmpn(1)<=0||d.cmp(u)>=0)){var h=this.g.mul(d);if(!h.isInfinity()){var p=h.getX(),g=p.umod(this.n);if(g.cmpn(0)!==0){var m=d.invm(this.n).mul(g.mul(r.getPrivate()).iadd(e));if(m=m.umod(this.n),m.cmpn(0)!==0){var E=(h.getY().isOdd()?1:0)|(p.cmp(g)!==0?2:0);return n.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),E^=1),new yw({r:g,s:m,recoveryParam:E})}}}}}};qs.prototype.verify=function(e,r,i,n){e=this._truncateToN(new _f(e,16)),i=this.keyFromPublic(i,n),r=new yw(r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),u=a.mul(s).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(c,i.getPublic(),u),l.isInfinity()?!1:l.eqXToP(s)):(l=this.g.mulAdd(c,i.getPublic(),u),l.isInfinity()?!1:l.getX().umod(this.n).cmp(s)===0)};qs.prototype.recoverPubKey=function(t,e,r,i){K7((3&r)===r,"The recovery param is more than two bits"),e=new yw(e,i);var n=this.n,s=new _f(t),o=e.r,a=e.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var l=e.r.invm(n),d=n.sub(s).mul(l).umod(n),h=a.mul(l).umod(n);return this.g.mulAdd(d,o,h)};qs.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new yw(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch(o){continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")}});var G7=y((z6t,$7)=>{f();"use strict";var _g=ns(),z7=_g.assert,H7=_g.parseBytes,Dh=_g.cachedProperty;function Ui(t,e){this.eddsa=t,this._secret=H7(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=H7(e.pub)}Ui.fromPublic=function(e,r){return r instanceof Ui?r:new Ui(e,{pub:r})};Ui.fromSecret=function(e,r){return r instanceof Ui?r:new Ui(e,{secret:r})};Ui.prototype.secret=function(){return this._secret};Dh(Ui,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Dh(Ui,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Dh(Ui,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});Dh(Ui,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Dh(Ui,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Dh(Ui,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Ui.prototype.sign=function(e){return z7(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Ui.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};Ui.prototype.getSecret=function(e){return z7(this._secret,"KeyPair is public only"),_g.encode(this.secret(),e)};Ui.prototype.getPublic=function(e){return _g.encode(this.pubBytes(),e)};$7.exports=Ui});var Y7=y((H6t,W7)=>{f();"use strict";var jCe=Sa(),gw=ns(),VCe=gw.assert,bw=gw.cachedProperty,zCe=gw.parseBytes;function Ef(t,e){this.eddsa=t,typeof e!="object"&&(e=zCe(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),VCe(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof jCe&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}bw(Ef,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});bw(Ef,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});bw(Ef,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});bw(Ef,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Ef.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Ef.prototype.toHex=function(){return gw.encode(this.toBytes(),"hex").toUpperCase()};W7.exports=Ef});var eL=y(($6t,J7)=>{f();"use strict";var HCe=fw(),$Ce=dw(),Nh=ns(),GCe=Nh.assert,X7=Nh.parseBytes,Q7=G7(),Z7=Y7();function Vn(t){if(GCe(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Vn))return new Vn(t);t=$Ce[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=HCe.sha512}J7.exports=Vn;Vn.prototype.sign=function(e,r){e=X7(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Vn.prototype.verify=function(e,r,i){e=X7(e),r=this.makeSignature(r);var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(n.pub().mul(s));return a.eq(o)};Vn.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Nh.intFromLE(e.digest()).umod(this.curve.n)};Vn.prototype.keyFromPublic=function(e){return Q7.fromPublic(this,e)};Vn.prototype.keyFromSecret=function(e){return Q7.fromSecret(this,e)};Vn.prototype.makeSignature=function(e){return e instanceof Z7?e:new Z7(this,e)};Vn.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};Vn.prototype.decodePoint=function(e){e=Nh.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&~128),n=(e[r]&128)!=0,s=Nh.intFromLE(i);return this.curve.pointFromY(s,n)};Vn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Vn.prototype.decodeInt=function(e){return Nh.intFromLE(e)};Vn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var rL=y(tL=>{f();"use strict";var Sf=tL;Sf.version=PM().version;Sf.utils=ns();Sf.rand=cA();Sf.curve=fA();Sf.curves=dw();Sf.ec=V7();Sf.eddsa=eL()});var nL=y((W6t,iL)=>{f();var WCe=rL().ec,Oa=new WCe("secp256k1"),It=Oa.curve,er=It.n.constructor;function YCe(t,e){let r=new er(e);if(r.cmp(It.p)>=0)return null;r=r.toRed(It.red);let i=r.redSqr().redIMul(r).redIAdd(It.b).redSqrt();return t===3!==i.isOdd()&&(i=i.redNeg()),Oa.keyPair({pub:{x:r,y:i}})}function XCe(t,e,r){let i=new er(e),n=new er(r);if(i.cmp(It.p)>=0||n.cmp(It.p)>=0||(i=i.toRed(It.red),n=n.toRed(It.red),(t===6||t===7)&&n.isOdd()!==(t===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(It.b)).isZero()?Oa.keyPair({pub:{x:i,y:n}}):null}function Yu(t){let e=t[0];switch(e){case 2:case 3:return t.length!==33?null:YCe(e,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:XCe(e,t.subarray(1,33),t.subarray(33,65));default:return null}}function xf(t,e){let r=e.encode(null,t.length===33);for(let i=0;i<t.length;++i)t[i]=r[i]}iL.exports={contextRandomize(){return 0},privateKeyVerify(t){let e=new er(t);return e.cmp(It.n)<0&&!e.isZero()?0:1},privateKeyNegate(t){let e=new er(t),r=It.n.sub(e).umod(It.n).toArrayLike(Uint8Array,"be",32);return t.set(r),0},privateKeyTweakAdd(t,e){let r=new er(e);if(r.cmp(It.n)>=0||(r.iadd(new er(t)),r.cmp(It.n)>=0&&r.isub(It.n),r.isZero()))return 1;let i=r.toArrayLike(Uint8Array,"be",32);return t.set(i),0},privateKeyTweakMul(t,e){let r=new er(e);if(r.cmp(It.n)>=0||r.isZero())return 1;r.imul(new er(t)),r.cmp(It.n)>=0&&(r=r.umod(It.n));let i=r.toArrayLike(Uint8Array,"be",32);return t.set(i),0},publicKeyVerify(t){return Yu(t)===null?1:0},publicKeyCreate(t,e){let r=new er(e);if(r.cmp(It.n)>=0||r.isZero())return 1;let i=Oa.keyFromPrivate(e).getPublic();return xf(t,i),0},publicKeyConvert(t,e){let r=Yu(e);if(r===null)return 1;let i=r.getPublic();return xf(t,i),0},publicKeyNegate(t,e){let r=Yu(e);if(r===null)return 1;let i=r.getPublic();return i.y=i.y.redNeg(),xf(t,i),0},publicKeyCombine(t,e){let r=new Array(e.length);for(let n=0;n<e.length;++n)if(r[n]=Yu(e[n]),r[n]===null)return 1;let i=r[0].getPublic();for(let n=1;n<r.length;++n)i=i.add(r[n].pub);return i.isInfinity()?2:(xf(t,i),0)},publicKeyTweakAdd(t,e,r){let i=Yu(e);if(i===null)return 1;if(r=new er(r),r.cmp(It.n)>=0)return 2;let n=i.getPublic().add(It.g.mul(r));return n.isInfinity()?2:(xf(t,n),0)},publicKeyTweakMul(t,e,r){let i=Yu(e);if(i===null)return 1;if(r=new er(r),r.cmp(It.n)>=0||r.isZero())return 2;let n=i.getPublic().mul(r);return xf(t,n),0},signatureNormalize(t){let e=new er(t.subarray(0,32)),r=new er(t.subarray(32,64));return e.cmp(It.n)>=0||r.cmp(It.n)>=0?1:(r.cmp(Oa.nh)===1&&t.set(It.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){let r=e.subarray(0,32),i=e.subarray(32,64);if(new er(r).cmp(It.n)>=0||new er(i).cmp(It.n)>=0)return 1;let{output:n}=t,s=n.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=n.subarray(6+33,6+33+33);c[0]=0,c.set(i,1);let u=33,l=0;for(;u>1&&c[l]===0&&!(c[l+1]&128);--u,++l);return c=c.subarray(l),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(t.outputlen=6+o+u,n[0]=48,n[1]=t.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+o]=2,n[5+o]=c.length,n.set(c,6+o),0)},signatureImport(t,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let r=e[3];if(r===0||5+r>=e.length||e[4+r]!==2)return 1;let i=e[5+r];if(i===0||6+r+i!==e.length||e[4]&128||r>1&&e[4]===0&&!(e[5]&128)||e[r+6]&128||i>1&&e[r+6]===0&&!(e[r+7]&128))return 1;let n=e.subarray(4,4+r);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new er(n);o.cmp(It.n)>=0&&(o=new er(0));let a=new er(e.subarray(6+r));return a.cmp(It.n)>=0&&(a=new er(0)),t.set(o.toArrayLike(Uint8Array,"be",32),0),t.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e,r,i,n){if(n){let a=n;n=c=>{let u=a(e,r,null,i,c);if(!(u instanceof Uint8Array&&u.length===32))throw new Error("This is the way");return new er(u)}}let s=new er(r);if(s.cmp(It.n)>=0||s.isZero())return 1;let o;try{o=Oa.sign(e,r,{canonical:!0,k:n,pers:i})}catch(a){return 1}return t.signature.set(o.r.toArrayLike(Uint8Array,"be",32),0),t.signature.set(o.s.toArrayLike(Uint8Array,"be",32),32),t.recid=o.recoveryParam,0},ecdsaVerify(t,e,r){let i={r:t.subarray(0,32),s:t.subarray(32,64)},n=new er(i.r),s=new er(i.s);if(n.cmp(It.n)>=0||s.cmp(It.n)>=0)return 1;if(s.cmp(Oa.nh)===1||n.isZero()||s.isZero())return 3;let o=Yu(r);if(o===null)return 2;let a=o.getPublic();return Oa.verify(e,i,a)?0:3},ecdsaRecover(t,e,r,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new er(n.r),o=new er(n.s);if(s.cmp(It.n)>=0||o.cmp(It.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=Oa.recoverPubKey(i,n,r)}catch(c){return 2}return xf(t,a),0},ecdh(t,e,r,i,n,s,o){let a=Yu(e);if(a===null)return 1;let c=new er(r);if(c.cmp(It.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(n===void 0){let l=u.encode(null,!0),d=Oa.hash().update(l).digest();for(let h=0;h<32;++h)t[h]=d[h]}else{s||(s=new Uint8Array(32));let l=u.getX().toArray("be",32);for(let g=0;g<32;++g)s[g]=l[g];o||(o=new Uint8Array(32));let d=u.getY().toArray("be",32);for(let g=0;g<32;++g)o[g]=d[g];let h=n(s,o,i);if(!(h instanceof Uint8Array&&h.length===t.length))return 2;t.set(h)}return 0}}});var oL=y((Y6t,sL)=>{f();sL.exports=RM()(nL())});var uL=y((X6t,cL)=>{f();"use strict";var Io=oL(),{sha256:aL}=(ri(),li);cL.exports=t=>{let e=32;function r(){let l;do l=t(32);while(!Io.privateKeyVerify(l));return l}async function i(l,d){let{digest:h}=await aL.digest(d),p=Io.ecdsaSign(h,l);return Io.signatureExport(p.signature)}async function n(l,d,h){let{digest:p}=await aL.digest(h);return d=Io.signatureImport(d),Io.ecdsaVerify(d,p,l)}function s(l){if(!Io.publicKeyVerify(l))throw new Error("Invalid public key");return Io.publicKeyConvert(l,!0)}function o(l){return Io.publicKeyConvert(l,!1)}function a(l){if(!Io.privateKeyVerify(l))throw new Error("Invalid private key")}function c(l){if(!Io.publicKeyVerify(l))throw new Error("Invalid public key")}function u(l){return a(l),Io.publicKeyCreate(l)}return{generateKey:r,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:o,validatePrivateKey:a,validatePublicKey:c,computePublicKey:u}}});var hL=y((Q6t,dL)=>{f();"use strict";var{sha256:lL}=(ri(),li),QCe=ue(),{equals:fL}=(di(),fi),{toString:ZCe}=(tt(),et),JCe=Xv();dL.exports=(t,e,r)=>{r=r||uL()(e);class i{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return fL(this.bytes,u.bytes)}async hash(){let{bytes:u}=await lL.digest(this.bytes);return u}}class n{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return fL(this.bytes,u.bytes)}async hash(){let{bytes:u}=await lL.digest(this.bytes);return u}async id(){let u=await this.public.hash();return ZCe(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return JCe.export(this.bytes,u);throw QCe(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await r.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var yL=y((Z6t,pL)=>{f();"use strict";pL.exports={SHA1:20,SHA256:32,SHA512:64}});var PA=y(bL=>{f();"use strict";var gL=lg(),eOe=yL(),tOe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},rOe=async(t,e)=>{let r=await gL.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};bL.create=async function(t,e){let r=tOe[t],i=await gL.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(n){return rOe(i,n)},length:eOe[t]}}});var EL=y((eAt,_L)=>{f();"use strict";var mL=ue(),{concat:vL}=(un(),cn),{fromString:iOe}=(ft(),ht),nOe=PA(),wL={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};_L.exports=async(t,e,r)=>{let i=wL[t];if(!i){let A=Object.keys(wL).join(" / ");throw mL(new Error(`unknown cipher type '${t}'. Must be ${A}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw mL(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=iOe("key expansion"),c=2*(s+n+o),u=await nOe.create(e,r),l=await u.digest(a),d=[],h=0;for(;h<c;){let A=await u.digest(vL([l,a])),R=A.length;h+R>c&&(R=c-h),d.push(A),h+=R,l=await u.digest(l)}let p=c/2,g=vL(d),m=g.slice(0,p),E=g.slice(p,c),v=A=>({iv:A.slice(0,s),cipherKey:A.slice(s,s+n),macKey:A.slice(s+n)});return{k1:v(m),k2:v(E)}}});var xL=y((tAt,SL)=>{f();"use strict";var sOe=ue();SL.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw sOe(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var CL=y(PL=>{f();"use strict";var oOe=ue(),Eg=lg(),{base64urlToBuffer:AL}=Yv(),aOe=xL(),{toString:CA}=(tt(),et),{concat:cOe}=(un(),cn),{equals:uOe}=(di(),fi),IL={"P-256":256,"P-384":384,"P-521":521};PL.generateEphmeralKeyPair=async function(t){aOe(Object.keys(IL),t);let e=await Eg.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(n,s)=>{let o;s?o=await Eg.get().subtle.importKey("jwk",fOe(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await Eg.get().subtle.importKey("jwk",RL(t,n),{name:"ECDH",namedCurve:t},!1,[]),o],c=await Eg.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],IL[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await Eg.get().subtle.exportKey("jwk",e.publicKey);return{key:lOe(i),genSharedKey:r}};var TL={"P-256":32,"P-384":48,"P-521":66};function lOe(t){let e=TL[t.crv];return cOe([Uint8Array.from([4]),AL(t.x,e),AL(t.y,e)],1+e*2)}function RL(t,e){let r=TL[t];if(uOe(!e.slice(0,1),Uint8Array.from([4])))throw oOe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:CA(e.slice(1,r+1),"base64url"),y:CA(e.slice(1+r),"base64url"),ext:!0}}var fOe=(t,e)=>({...RL(t,e.public),d:CA(e.private,"base64url")})});var kL=y((iAt,OL)=>{f();"use strict";var dOe=CL();OL.exports=async t=>dOe.generateEphmeralKeyPair(t)});var vw=y((nAt,DL)=>{f();"use strict";var ka=Sv();xc();k6();var OA=dt(),Sg=ue(),{fromString:hOe}=(ft(),ht),pOe=BB(),Ds={rsa:wM(),ed25519:IM(),secp256k1:hL()(ka,hg())},mw={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function Bh(t){let e=Ds[t.toLowerCase()];if(!e){let r=Object.keys(Ds).join(" / ");throw Sg(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var yOe=async(t,e)=>Bh(t).generateKeyPair(e),gOe=async(t,e,r)=>{let i=Bh(t);if(t.toLowerCase()!=="ed25519")throw Sg(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,r)},bOe=t=>{let e=ka.PublicKey.decode(t),r=e.Data;switch(e.Type){case ka.KeyType.RSA:return Ds.rsa.unmarshalRsaPublicKey(r);case ka.KeyType.Ed25519:return Ds.ed25519.unmarshalEd25519PublicKey(r);case ka.KeyType.Secp256k1:if(Ds.secp256k1)return Ds.secp256k1.unmarshalSecp256k1PublicKey(r);throw Sg(new Error(mw.message),mw.code);default:Bh(e.Type)}},mOe=(t,e)=>(e=(e||"rsa").toLowerCase(),Bh(e),t.bytes),qL=async t=>{let e=ka.PrivateKey.decode(t),r=e.Data;switch(e.Type){case ka.KeyType.RSA:return Ds.rsa.unmarshalRsaPrivateKey(r);case ka.KeyType.Ed25519:return Ds.ed25519.unmarshalEd25519PrivateKey(r);case ka.KeyType.Secp256k1:if(Ds.secp256k1)return Ds.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Sg(new Error(mw.message),mw.code);default:Bh(e.Type)}},vOe=(t,e)=>(e=(e||"rsa").toLowerCase(),Bh(e),t.bytes),wOe=async(t,e)=>{try{let n=await pOe.import(t,e);return qL(n)}catch(n){}let r=OA.pki.decryptRsaPrivateKey(t,e);if(r===null)throw Sg(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=OA.asn1.toDer(OA.pki.privateKeyToAsn1(r));return i=hOe(i.getBytes(),"ascii"),Ds.rsa.unmarshalRsaPrivateKey(i)};DL.exports={supportedKeys:Ds,keysPBM:ka,keyStretcher:EL(),generateEphemeralKeyPair:kL(),generateKeyPair:yOe,generateKeyPairFromSeed:gOe,unmarshalPublicKey:bOe,marshalPublicKey:mOe,unmarshalPrivateKey:qL,marshalPrivateKey:vOe,import:wOe}});var ww=y((sAt,kA)=>{f();"use strict";function _Oe(t,{className:e,symbolName:r}){let i=Symbol.for(r),n={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function EOe(t,{className:e,symbolName:r,withoutNew:i}){let n=Symbol.for(r),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}kA.exports=_Oe;kA.exports.proto=EOe});var ML=y((oAt,BL)=>{f();"use strict";var Mh=ki(),NL=Mh.Reader,SOe=Mh.Writer,vi=Mh.util,xg=Mh.roots["libp2p-peer-id"]||(Mh.roots["libp2p-peer-id"]={});xg.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.id=vi.newBuffer([]),t.prototype.pubKey=vi.newBuffer([]),t.prototype.privKey=vi.newBuffer([]),t.encode=function(r,i){return i||(i=SOe.create()),i.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&i.uint32(26).bytes(r.privKey),i},t.decode=function(r,i){r instanceof NL||(r=NL.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new xg.PeerIdProto;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw vi.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof xg.PeerIdProto)return r;var i=new xg.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?vi.base64.decode(r.id,i.id=vi.newBuffer(vi.base64.length(r.id)),0):r.id.length&&(i.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?vi.base64.decode(r.pubKey,i.pubKey=vi.newBuffer(vi.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?vi.base64.decode(r.privKey,i.privKey=vi.newBuffer(vi.base64.length(r.privKey)),0):r.privKey.length&&(i.privKey=r.privKey)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=vi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=vi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=vi.newBuffer(n.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(n.id=i.bytes===String?vi.base64.encode(r.id,0,r.id.length):i.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?vi.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?vi.base64.encode(r.privKey,0,r.privKey.length):i.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Mh.util.toJSONOptions)},t}();BL.exports=xg});var rt=y((dn,HL)=>{f();"use strict";var{CID:qA}=(Ie(),Ne),xOe=(on(),sn),AOe=(Yx(),gv),IOe=(ei(),Jr),TOe=(Zy(),ch),{base58btc:DA}=(ei(),Jr),{base32:ROe}=(on(),sn),{base16:LL}=(Xx(),bv),Ag=(xn(),Ln),qa=vw(),POe=ww(),{PeerIdProto:UL}=ML(),{equals:Af}=(di(),fi),{fromString:Ig}=(ft(),ht),{toString:COe}=(tt(),et),{identity:_w}=(Cc(),Pc),FL={...xOe,...AOe,...IOe,...TOe},OOe=Object.keys(FL).reduce((t,e)=>t.or(FL[e]),ROe.decoder),kOe=112,KL=114,jL=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&i&&!Af(r.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=DA.encode(this.id).substring(1),this._privKey=r,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Ag.decode(this.id);e.code===_w.code&&(this._pubKey=qa.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return qa.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return qa.marshalPrivateKey(this.privKey)}marshal(e){return UL.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:zL(this.marshalPrivKey()),pubKey:zL(this.marshalPubKey())}}toHexString(){return LL.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=qA.createV1(KL,Ag.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return Af(this.id,e);if(e.id)return Af(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&Af(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Ag.decode(this.id).code===_w.code)return!0}catch(e){}return!1}},Da=POe(jL,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});dn=HL.exports=Da;var Tg=t=>t.bytes.length<=42?Ag.create(_w.code,t.bytes).bytes:t.hash(),NA=async(t,e)=>{let r=await Tg(e);return new Da(r,t,e)};dn.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await qa.generateKeyPair(t.keyType,t.bits);return NA(e,e.public)};dn.createFromHexString=t=>new Da(LL.decode("f"+t));dn.createFromBytes=t=>{try{let e=qA.decode(t);if(!VL(e))throw new Error("Supplied PeerID CID is invalid");return dn.createFromCID(e)}catch{if(Ag.decode(t).code!==_w.code)throw new Error("Supplied PeerID CID is invalid");return new Da(t)}};dn.createFromB58String=t=>dn.createFromBytes(DA.decode("z"+t));var VL=t=>t.code===KL||t.code===kOe;dn.createFromCID=t=>{if(t=qA.asCID(t),!t||!VL(t))throw new Error("Supplied PeerID CID is invalid");return new Da(t.multihash.bytes)};dn.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=Ig(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await qa.unmarshalPublicKey(e);return NA(void 0,r)};dn.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=Ig(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await qa.unmarshalPrivateKey(t);return NA(e,e.public)};dn.createFromJSON=async t=>{let e=DA.decode("z"+t.id),r=t.privKey&&Ig(t.privKey,"base64pad"),i=t.pubKey&&Ig(t.pubKey,"base64pad"),n=i&&await qa.unmarshalPublicKey(i);if(!r)return new Da(e,void 0,n);let s=await qa.unmarshalPrivateKey(r),o=await Tg(s.public),a;if(n&&(a=await Tg(n)),n&&!Af(o,a))throw new Error("Public and private key do not match");if(e&&!Af(o,e))throw new Error("Id and private key do not match");return new Da(e,s,n)};dn.createFromProtobuf=async t=>{typeof t=="string"&&(t=Ig(t,"base16"));let{id:e,privKey:r,pubKey:i}=UL.decode(t);r=r?await qa.unmarshalPrivateKey(r):!1,i=i?await qa.unmarshalPublicKey(i):!1;let n,s;if(r&&(s=await Tg(r.public)),i&&(n=await Tg(i)),r){if(i&&!Af(s,n))throw new Error("Public and private key do not match");return new Da(s,r,r.public)}if(i)return new Da(n,void 0,i);if(e)return new Da(e);throw new Error("Protobuf did not contain any usable key material")};dn.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),dn.createFromBytes(OOe.decode(t)));dn.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function zL(t){if(t)return COe(t,"base64pad")}});var WL=y((aAt,GL)=>{f();"use strict";hh();var Ew=dt(),{toString:Lh}=(tt(),et),{fromString:$L}=(ft(),ht);GL.exports={createCipheriv:(t,e,r)=>{let i=Ew.cipher.createCipher("AES-CTR",Lh(e,"ascii"));return i.start({iv:Lh(r,"ascii")}),{update:n=>(i.update(Ew.util.createBuffer(Lh(n,"ascii"))),$L(i.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let i=Ew.cipher.createDecipher("AES-CTR",Lh(e,"ascii"));return i.start({iv:Lh(r,"ascii")}),{update:n=>(i.update(Ew.util.createBuffer(Lh(n,"ascii"))),$L(i.output.getBytes(),"ascii"))}}}});var QL=y((cAt,XL)=>{f();"use strict";var qOe=ue(),YL={16:"aes-128-ctr",32:"aes-256-ctr"};XL.exports=function(t){let e=YL[t.length];if(!e){let r=Object.entries(YL).map(([i,n])=>`${i} (${n})`).join(" / ");throw qOe(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var e9=y(JL=>{f();"use strict";var ZL=WL(),DOe=QL();JL.create=async function(t,e){let r=DOe(t),i=ZL.createCipheriv(r,t,e),n=ZL.createDecipheriv(r,t,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var i9=y((lAt,r9)=>{f();"use strict";var NOe=E6(),BOe=Qt(),MOe=ue(),t9={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function LOe(t,e,r,i,n){let s=t9[n];if(!s){let a=Object.keys(t9).join(" / ");throw MOe(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=NOe(t,e,r,i,s);return BOe.encode64(o)}r9.exports=LOe});var Na=y(Uh=>{f();"use strict";var UOe=PA(),FOe=e9(),KOe=vw();Uh.aes=FOe;Uh.hmac=UOe;Uh.keys=KOe;Uh.randomBytes=hg();Uh.pbkdf2=i9()});var MA=y((dAt,s9)=>{f();"use strict";var n9="[a-fA-F\\d:]",Xu=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${n9})|(?<=${n9})(?=\\s|$))`:"",To="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",hi="[a-fA-F\\d]{1,4}",Sw=`
(?:
(?:${hi}:){7}(?:${hi}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${hi}:){6}(?:${To}|:${hi}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${hi}:){5}(?::${To}|(?::${hi}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${hi}:){4}(?:(?::${hi}){0,1}:${To}|(?::${hi}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${hi}:){3}(?:(?::${hi}){0,2}:${To}|(?::${hi}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${hi}:){2}(?:(?::${hi}){0,3}:${To}|(?::${hi}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${hi}:){1}(?:(?::${hi}){0,4}:${To}|(?::${hi}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${hi}){0,5}:${To}|(?::${hi}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),jOe=new RegExp(`(?:^${To}$)|(?:^${Sw}$)`),VOe=new RegExp(`^${To}$`),zOe=new RegExp(`^${Sw}$`),BA=t=>t&&t.exact?jOe:new RegExp(`(?:${Xu(t)}${To}${Xu(t)})|(?:${Xu(t)}${Sw}${Xu(t)})`,"g");BA.v4=t=>t&&t.exact?VOe:new RegExp(`${Xu(t)}${To}${Xu(t)}`,"g");BA.v6=t=>t&&t.exact?zOe:new RegExp(`${Xu(t)}${Sw}${Xu(t)}`,"g");s9.exports=BA});var a9=y((hAt,o9)=>{f();"use strict";var LA=MA(),Fh=t=>LA({exact:!0}).test(t);Fh.v4=t=>LA.v4({exact:!0}).test(t);Fh.v6=t=>LA.v6({exact:!0}).test(t);Fh.version=t=>Fh(t)?Fh.v4(t)?4:6:void 0;o9.exports=Fh});var d9=y((pAt,f9)=>{f();"use strict";var UA=a9(),{toString:c9}=(tt(),et),HOe=UA,FA=UA.v4,u9=UA.v6,l9=function(t,e,r){r=~~r;let i;if(FA(t))i=e||new Uint8Array(r+4),t.split(/\./g).map(function(n){i[r++]=parseInt(n,10)&255});else if(u9(t)){let n=t.split(":",8),s;for(s=0;s<n.length;s++){let o=FA(n[s]),a;o&&(a=l9(n[s]),n[s]=c9(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,c9(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(r+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[r++]=o>>8&255,i[r++]=o&255}}if(!i)throw Error("Invalid ip address: "+t);return i},$Oe=function(t,e,r){e=~~e,r=r||t.length-e;let i=[],n,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)i.push(t[e+o]);n=i.join(".")}else if(r===16){for(let o=0;o<r;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};f9.exports={isIP:HOe,isV4:FA,isV6:u9,toBytes:l9,toString:$Oe}});var Rg=y((yAt,p9)=>{f();"use strict";function zn(t){if(typeof t=="number"){if(zn.codes[t])return zn.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(zn.names[t])return zn.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var Ns=-1;zn.lengthPrefixedVarSize=Ns;zn.V=Ns;zn.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Ns,"ip6zone"],[53,Ns,"dns","resolvable"],[54,Ns,"dns4","resolvable"],[55,Ns,"dns6","resolvable"],[56,Ns,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Ns,"unix",!1,"path"],[421,Ns,"ipfs"],[421,Ns,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Ns,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Ns,"memory"]];zn.names={};zn.codes={};zn.table.map(t=>{let e=h9.apply(null,t);return zn.codes[e.code]=e,zn.names[e.name]=e,null});zn.object=h9;function h9(t,e,r,i,n){return{code:t,size:e,name:r,resolvable:Boolean(i),path:Boolean(n)}}p9.exports=zn});var b9=y((gAt,g9)=>{f();g9.exports=KA;var y9=128,GOe=127,WOe=~GOe,YOe=Math.pow(2,31);function KA(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw KA.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var i=r;t>=YOe;)e[r++]=t&255|y9,t/=128;for(;t&WOe;)e[r++]=t&255|y9,t>>>=7;return e[r]=t|0,KA.bytes=r-i+1,e}});var w9=y((bAt,v9)=>{f();v9.exports=jA;var XOe=128,m9=127;function jA(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o||i>49)throw jA.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&m9)<<i:(s&m9)*Math.pow(2,i),i+=7}while(s>=XOe);return jA.bytes=n-e,r}});var E9=y((mAt,_9)=>{f();var QOe=Math.pow(2,7),ZOe=Math.pow(2,14),JOe=Math.pow(2,21),eke=Math.pow(2,28),tke=Math.pow(2,35),rke=Math.pow(2,42),ike=Math.pow(2,49),nke=Math.pow(2,56),ske=Math.pow(2,63);_9.exports=function(t){return t<QOe?1:t<ZOe?2:t<JOe?3:t<eke?4:t<tke?5:t<rke?6:t<ike?7:t<nke?8:t<ske?9:10}});var ss=y((vAt,S9)=>{f();S9.exports={encode:b9(),decode:w9(),encodingLength:E9()}});var O9=y((wAt,C9)=>{f();"use strict";var xw=d9(),x9=Rg(),{CID:oke}=(Ie(),Ne),{base32:A9}=(on(),sn),{base58btc:ake}=(ei(),Jr),cke=(xn(),Ln),Kh=ss(),{toString:Aw}=(tt(),et),{fromString:I9}=(ft(),ht),{concat:Iw}=(un(),cn);C9.exports=Pg;function Pg(t,e){return e instanceof Uint8Array?Pg.toString(t,e):Pg.toBytes(t,e)}Pg.toString=function(e,r){switch(x9(e).code){case 4:case 41:return uke(r);case 6:case 273:case 33:case 132:return R9(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return fke(r);case 421:return hke(r);case 444:return P9(r);case 445:return P9(r);default:return Aw(r,"base16")}};Pg.toBytes=function(e,r){switch(x9(e).code){case 4:return T9(r);case 41:return T9(r);case 6:case 273:case 33:case 132:return VA(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return lke(r);case 421:return dke(r);case 444:return pke(r);case 445:return yke(r);default:return I9(r,"base16")}};function T9(t){if(!xw.isIP(t))throw new Error("invalid ip address");return xw.toBytes(t)}function uke(t){let e=xw.toString(t);if(!e||!xw.isIP(e))throw new Error("invalid ip address");return e}function VA(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function R9(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function lke(t){let e=I9(t),r=Uint8Array.from(Kh.encode(e.length));return Iw([r,e],r.length+e.length)}function fke(t){let e=Kh.decode(t);if(t=t.slice(Kh.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return Aw(t)}function dke(t){let e;t[0]==="Q"||t[0]==="1"?e=cke.decode(ake.decode(`z${t}`)).bytes:e=oke.parse(t).multihash.bytes;let r=Uint8Array.from(Kh.encode(e.length));return Iw([r,e],r.length+e.length)}function hke(t){let e=Kh.decode(t),r=t.slice(Kh.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return Aw(r,"base58btc")}function pke(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=A9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=VA(i);return Iw([r,n],r.length+n.length)}function yke(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=A9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=VA(i);return Iw([r,n],r.length+n.length)}function P9(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),i=Aw(e,"base32"),n=R9(r);return i+":"+n}});var V9=y((_At,j9)=>{f();"use strict";var k9=O9(),zA=Rg(),Cg=ss(),{concat:q9}=(un(),cn),{toString:gke}=(tt(),et);j9.exports={stringToStringTuples:D9,stringTuplesToString:N9,tuplesToStringTuples:M9,stringTuplesToTuples:B9,bytesToTuples:HA,tuplesToBytes:L9,bytesToString:bke,stringToBytes:F9,fromString:mke,fromBytes:K9,validateBytes:$A,isValidBytes:vke,cleanPath:Tw,ParseError:GA,protoFromTuple:Og,sizeForAddr:U9};function D9(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let i=0;i<r.length;i++){let n=r[i],s=zA(n);if(s.size===0){e.push([n]);continue}if(i++,i>=r.length)throw GA("invalid address: "+t);if(s.path){e.push([n,Tw(r.slice(i).join("/"))]);break}e.push([n,r[i]])}return e}function N9(t){let e=[];return t.map(r=>{let i=Og(r);return e.push(i.name),r.length>1&&e.push(r[1]),null}),Tw(e.join("/"))}function B9(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=Og(e);return e.length>1?[r.code,k9.toBytes(r.code,e[1])]:[r.code]})}function M9(t){return t.map(e=>{let r=Og(e);return e[1]?[r.code,k9.toString(r.code,e[1])]:[r.code]})}function L9(t){return K9(q9(t.map(e=>{let r=Og(e),i=Uint8Array.from(Cg.encode(r.code));return e.length>1&&(i=q9([i,e[1]])),i})))}function U9(t,e){return t.size>0?t.size/8:t.size===0?0:Cg.decode(e)+Cg.decode.bytes}function HA(t){let e=[],r=0;for(;r<t.length;){let i=Cg.decode(t,r),n=Cg.decode.bytes,s=zA(i),o=U9(s,t.slice(r+n));if(o===0){e.push([i]),r+=n;continue}let a=t.slice(r+n,r+n+o);if(r+=o+n,r>t.length)throw GA("Invalid address Uint8Array: "+gke(t,"base16"));e.push([i,a])}return e}function bke(t){let e=HA(t),r=M9(e);return N9(r)}function F9(t){t=Tw(t);let e=D9(t),r=B9(e);return L9(r)}function mke(t){return F9(t)}function K9(t){let e=$A(t);if(e)throw e;return Uint8Array.from(t)}function $A(t){try{HA(t)}catch(e){return e}}function vke(t){return $A(t)===void 0}function Tw(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function GA(t){return new Error("Error parsing address: "+t)}function Og(t){return zA(t[0])}});var it=y((EAt,$9)=>{f();"use strict";var Ro=V9(),jh=Rg(),z9=ss(),{CID:wke}=(Ie(),Ne),{base58btc:_ke}=(ei(),Jr),Eke=ue(),Ske=Symbol.for("nodejs.util.inspect.custom"),{toString:Rw}=(tt(),et),{equals:xke}=(di(),fi),WA=new Map,H9=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Tn=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,H9,{value:!0}),e instanceof Uint8Array)this.bytes=Ro.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Ro.fromString(e)}else if(Tn.isMultiaddr(e))this.bytes=Ro.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Ro.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},jh(e)))}protoCodes(){let e=[],r=this.bytes,i=0;for(;i<r.length;){let n=z9.decode(r,i),s=z9.decode.bytes,o=jh(n);i+=Ro.sizeForAddr(o,r.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Ro.bytesToTuples(this.bytes)}stringTuples(){let e=Ro.bytesToTuples(this.bytes);return Ro.tuplesToStringTuples(e)}encapsulate(e){return e=new Tn(e),new Tn(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),i=this.toString(),n=i.lastIndexOf(r);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new Tn(i.slice(0,n))}decapsulateCode(e){let r=this.tuples();for(let i=r.length-1;i>=0;i--)if(r[i][0]===e)return new Tn(Ro.tuplesToBytes(r.slice(0,i)));return this}getPeerId(){try{let r=this.stringTuples().filter(i=>i[0]===jh.names.ipfs.code).pop();if(r&&r[1]){let i=r[1];return i[0]==="Q"||i[0]==="1"?Rw(_ke.decode(`z${i}`),"base58btc"):Rw(wke.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!jh(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return xke(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let r=WA.get(e.name);if(!r)throw Eke(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(n=>new Tn(n))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new Tn("/"+[i,e.address,r,e.port].join("/"))}static isName(e){return Tn.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof Tn||Boolean(e&&e[H9])}[Ske](){return"<Multiaddr "+Rw(this.bytes,"base16")+" - "+Ro.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+Rw(this.bytes,"base16")+" - "+Ro.bytesToString(this.bytes)+">"}};Tn.protocols=jh;Tn.resolvers=WA;function Ake(t){return new Tn(t)}$9.exports={Multiaddr:Tn,multiaddr:Ake,protocols:jh,resolvers:WA}});var Tf=y((SAt,rU)=>{f();"use strict";var{Multiaddr:YA}=it(),G9=Qe("dns4"),W9=Qe("dns6"),Y9=Qe("dnsaddr"),If=hn(Qe("dns"),Y9,G9,W9),kg=hn(Qe("ip4"),Qe("ip6")),Vh=hn(pt(kg,Qe("tcp")),pt(If,Qe("tcp"))),XA=pt(kg,Qe("udp")),X9=pt(XA,Qe("utp")),Q9=pt(XA,Qe("quic")),zh=hn(pt(Vh,Qe("ws")),pt(If,Qe("ws"))),Hh=hn(pt(Vh,Qe("wss")),pt(If,Qe("wss"))),Pw=hn(pt(Vh,Qe("http")),pt(kg,Qe("http")),pt(If,Qe("http"))),Cw=hn(pt(Vh,Qe("https")),pt(kg,Qe("https")),pt(If,Qe("https"))),QA=hn(pt(zh,Qe("p2p-webrtc-star"),Qe("p2p")),pt(Hh,Qe("p2p-webrtc-star"),Qe("p2p")),pt(zh,Qe("p2p-webrtc-star")),pt(Hh,Qe("p2p-webrtc-star"))),Ike=hn(pt(zh,Qe("p2p-websocket-star"),Qe("p2p")),pt(Hh,Qe("p2p-websocket-star"),Qe("p2p")),pt(zh,Qe("p2p-websocket-star")),pt(Hh,Qe("p2p-websocket-star"))),ZA=hn(pt(Pw,Qe("p2p-webrtc-direct"),Qe("p2p")),pt(Cw,Qe("p2p-webrtc-direct"),Qe("p2p")),pt(Pw,Qe("p2p-webrtc-direct")),pt(Cw,Qe("p2p-webrtc-direct"))),$h=hn(zh,Hh,Pw,Cw,QA,ZA,Vh,X9,Q9,If),Tke=hn(pt($h,Qe("p2p-stardust"),Qe("p2p")),pt($h,Qe("p2p-stardust"))),Qu=hn(pt($h,Qe("p2p")),QA,ZA,Qe("p2p")),Z9=hn(pt(Qu,Qe("p2p-circuit"),Qu),pt(Qu,Qe("p2p-circuit")),pt(Qe("p2p-circuit"),Qu),pt($h,Qe("p2p-circuit")),pt(Qe("p2p-circuit"),$h),Qe("p2p-circuit")),J9=()=>hn(pt(Z9,J9),Z9),Gh=J9(),eU=hn(pt(Gh,Qu,Gh),pt(Qu,Gh),pt(Gh,Qu),Gh,Qu);rU.exports={DNS:If,DNS4:G9,DNS6:W9,DNSADDR:Y9,IP:kg,TCP:Vh,UDP:XA,QUIC:Q9,UTP:X9,HTTP:Pw,HTTPS:Cw,WebSockets:zh,WebSocketsSecure:Hh,WebSocketStar:Ike,WebRTCStar:QA,WebRTCDirect:ZA,Reliable:$h,Stardust:Tke,Circuit:Gh,P2P:eU,IPFS:eU};function tU(t){function e(r){if(!YA.isMultiaddr(r))try{r=new YA(r)}catch(n){return!1}let i=t(r.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function pt(...t){function e(r){if(r.length<t.length)return null;let i=r;return t.some(n=>(i=typeof n=="function"?n().partialMatch(r):n.partialMatch(r),Array.isArray(i)&&(r=i),i===null)),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:tU(e),partialMatch:e}}function hn(...t){function e(i){let n=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:tU(e),partialMatch:e}}function Qe(t){let e=t;function r(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new YA(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:i}}});var Yh=y((xAt,yU)=>{f();"use strict";var{base58btc:Rke}=(ei(),Jr),{base32:Pke}=(on(),sn),Cke=(xn(),Ln),{Multiaddr:iU}=it(),Oke=Tf(),{CID:JA}=(Ie(),Ne),{URL:kke}=cv(),{toString:qke}=(tt(),et),eI=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,Wh=/^\/(ip[fn]s)\/([^/?#]+)/,nU=1,sU=2,qg=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,oU=1,aU=2,Dke=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function Nke(t){let e=tI(t);try{Cke.decode(Rke.decode("z"+e))}catch{return!1}return!0}function Bke(t){try{Pke.decode(t)}catch{return!1}return!0}function Dg(t){try{return typeof t=="string"?Boolean(JA.parse(t)):t instanceof Uint8Array?Boolean(JA.decode(t)):Boolean(JA.asCID(t))}catch(e){return!1}}function cU(t){if(!t)return!1;if(iU.isMultiaddr(t))return!0;try{return new iU(t),!0}catch(e){return!1}}function Mke(t){return cU(t)&&Oke.P2P.matches(t)}function Ng(t,e,r=nU,i=sU){let n=tI(t);if(!n)return!1;let s=n.match(e);if(!s||s[r]!=="ipfs")return!1;let o=s[i];return o&&e===qg&&(o=o.toLowerCase()),Dg(o)}function Ow(t,e,r=nU,i=sU){let n=tI(t);if(!n)return!1;let s=n.match(e);if(!s||s[r]!=="ipns")return!1;let o=s[i];if(o&&e===qg){if(o=o.toLowerCase(),Dg(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new kke(`http://${o}`);return Dke.test(a)}catch(a){return!1}}return!0}function uU(t){return typeof t=="string"}function tI(t){return t instanceof Uint8Array?qke(t,"base58btc"):uU(t)?t:!1}var rI=t=>Ng(t,qg,aU,oU),iI=t=>Ow(t,qg,aU,oU),lU=t=>rI(t)||iI(t),fU=t=>Ng(t,eI)||rI(t),dU=t=>Ow(t,eI)||iI(t),hU=t=>fU(t)||dU(t)||lU(t),pU=t=>Ng(t,Wh)||Ow(t,Wh);yU.exports={multihash:Nke,multiaddr:cU,peerMultiaddr:Mke,cid:Dg,base32cid:t=>Bke(t)&&Dg(t),ipfsSubdomain:rI,ipnsSubdomain:iI,subdomain:lU,subdomainGatewayPattern:qg,ipfsUrl:fU,ipnsUrl:dU,url:hU,pathGatewayPattern:eI,ipfsPath:t=>Ng(t,Wh),ipnsPath:t=>Ow(t,Wh),path:pU,pathPattern:Wh,urlOrPath:t=>hU(t)||pU(t),cidPath:t=>uU(t)&&!Dg(t)&&Ng(`/ipfs/${t}`,Wh)}});var nI=y((AAt,gU)=>{f();var Xh=1e3,Qh=Xh*60,Zh=Qh*60,Rf=Zh*24,Lke=Rf*7,Uke=Rf*365.25;gU.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Fke(t);if(r==="number"&&isFinite(t))return e.long?jke(t):Kke(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Fke(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*Uke;case"weeks":case"week":case"w":return r*Lke;case"days":case"day":case"d":return r*Rf;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Zh;case"minutes":case"minute":case"mins":case"min":case"m":return r*Qh;case"seconds":case"second":case"secs":case"sec":case"s":return r*Xh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Kke(t){var e=Math.abs(t);return e>=Rf?Math.round(t/Rf)+"d":e>=Zh?Math.round(t/Zh)+"h":e>=Qh?Math.round(t/Qh)+"m":e>=Xh?Math.round(t/Xh)+"s":t+"ms"}function jke(t){var e=Math.abs(t);return e>=Rf?kw(t,e,Rf,"day"):e>=Zh?kw(t,e,Zh,"hour"):e>=Qh?kw(t,e,Qh,"minute"):e>=Xh?kw(t,e,Xh,"second"):t+" ms"}function kw(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var mU=y((IAt,bU)=>{f();function Vke(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=n,r.enabled=o,r.humanize=nI(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let d=0;for(let h=0;h<l.length;h++)d=(d<<5)-d+l.charCodeAt(h),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=e;function r(l){let d,h=null,p,g;function m(...E){if(!m.enabled)return;let v=m,A=Number(new Date),R=A-(d||A);v.diff=R,v.prev=d,v.curr=A,d=A,E[0]=r.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let F=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(D,z)=>{if(D==="%%")return"%";F++;let G=r.formatters[z];if(typeof G=="function"){let Y=E[F];D=G.call(v,Y),E.splice(F,1),F--}return D}),r.formatArgs.call(v,E),(v.log||r.log).apply(v,E)}return m.namespace=l,m.useColors=r.useColors(),m.color=r.selectColor(l),m.extend=i,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==r.namespaces&&(p=r.namespaces,g=r.enabled(l)),g),set:E=>{h=E}}),typeof r.init=="function"&&r.init(m),m}function i(l,d){let h=r(this.namespace+(typeof d=="undefined"?":":d)+l);return h.log=this.log,h}function n(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let d,h=(typeof l=="string"?l:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)!h[d]||(l=h[d].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.substr(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(d=>"-"+d)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let d,h;for(d=0,h=r.skips.length;d<h;d++)if(r.skips[d].test(l))return!1;for(d=0,h=r.names.length;d<h;d++)if(r.names[d].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}bU.exports=Vke});var me=y((os,qw)=>{f();os.formatArgs=Hke;os.save=$ke;os.load=Gke;os.useColors=zke;os.storage=Wke();os.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();os.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function zke(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Hke(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+qw.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}os.log=console.debug||console.log||(()=>{});function $ke(t){try{t?os.storage.setItem("debug",t):os.storage.removeItem("debug")}catch(e){}}function Gke(){let t;try{t=os.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function Wke(){try{return localStorage}catch(t){}}qw.exports=mU()(os);var{formatters:Yke}=qw.exports;Yke.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Fc,Jh,sI,Ze,Zi,vU,TAt,RAt,wU=xe(()=>{f();Fc=Wt(ki()),Jh=Fc.default.Reader,sI=Fc.default.Writer,Ze=Fc.default.util,Zi=Fc.default.roots["ipfs-unixfs"]||(Fc.default.roots["ipfs-unixfs"]={}),vU=Zi.Data=(()=>{function t(e){if(this.blocksizes=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Ze.newBuffer([]),t.prototype.filesize=Ze.Long?Ze.Long.fromBits(0,0,!0):0,t.prototype.blocksizes=Ze.emptyArray,t.prototype.hashType=Ze.Long?Ze.Long.fromBits(0,0,!0):0,t.prototype.fanout=Ze.Long?Ze.Long.fromBits(0,0,!0):0,t.prototype.mode=0,t.prototype.mtime=null,t.encode=function(r,i){if(i||(i=sI.create()),i.uint32(8).int32(r.Type),r.Data!=null&&Object.hasOwnProperty.call(r,"Data")&&i.uint32(18).bytes(r.Data),r.filesize!=null&&Object.hasOwnProperty.call(r,"filesize")&&i.uint32(24).uint64(r.filesize),r.blocksizes!=null&&r.blocksizes.length)for(var n=0;n<r.blocksizes.length;++n)i.uint32(32).uint64(r.blocksizes[n]);return r.hashType!=null&&Object.hasOwnProperty.call(r,"hashType")&&i.uint32(40).uint64(r.hashType),r.fanout!=null&&Object.hasOwnProperty.call(r,"fanout")&&i.uint32(48).uint64(r.fanout),r.mode!=null&&Object.hasOwnProperty.call(r,"mode")&&i.uint32(56).uint32(r.mode),r.mtime!=null&&Object.hasOwnProperty.call(r,"mtime")&&Zi.UnixTime.encode(r.mtime,i.uint32(66).fork()).ldelim(),i},t.decode=function(r,i){r instanceof Jh||(r=Jh.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Zi.Data;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;case 3:s.filesize=r.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=r.uint32()+r.pos;r.pos<a;)s.blocksizes.push(r.uint64());else s.blocksizes.push(r.uint64());break;case 5:s.hashType=r.uint64();break;case 6:s.fanout=r.uint64();break;case 7:s.mode=r.uint32();break;case 8:s.mtime=Zi.UnixTime.decode(r,r.uint32());break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Ze.ProtocolError("missing required 'Type'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Zi.Data)return r;var i=new Zi.Data;switch(r.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(r.Data!=null&&(typeof r.Data=="string"?Ze.base64.decode(r.Data,i.Data=Ze.newBuffer(Ze.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),r.filesize!=null&&(Ze.Long?(i.filesize=Ze.Long.fromValue(r.filesize)).unsigned=!0:typeof r.filesize=="string"?i.filesize=parseInt(r.filesize,10):typeof r.filesize=="number"?i.filesize=r.filesize:typeof r.filesize=="object"&&(i.filesize=new Ze.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0))),r.blocksizes){if(!Array.isArray(r.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<r.blocksizes.length;++n)Ze.Long?(i.blocksizes[n]=Ze.Long.fromValue(r.blocksizes[n])).unsigned=!0:typeof r.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(r.blocksizes[n],10):typeof r.blocksizes[n]=="number"?i.blocksizes[n]=r.blocksizes[n]:typeof r.blocksizes[n]=="object"&&(i.blocksizes[n]=new Ze.LongBits(r.blocksizes[n].low>>>0,r.blocksizes[n].high>>>0).toNumber(!0))}if(r.hashType!=null&&(Ze.Long?(i.hashType=Ze.Long.fromValue(r.hashType)).unsigned=!0:typeof r.hashType=="string"?i.hashType=parseInt(r.hashType,10):typeof r.hashType=="number"?i.hashType=r.hashType:typeof r.hashType=="object"&&(i.hashType=new Ze.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0))),r.fanout!=null&&(Ze.Long?(i.fanout=Ze.Long.fromValue(r.fanout)).unsigned=!0:typeof r.fanout=="string"?i.fanout=parseInt(r.fanout,10):typeof r.fanout=="number"?i.fanout=r.fanout:typeof r.fanout=="object"&&(i.fanout=new Ze.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0))),r.mode!=null&&(i.mode=r.mode>>>0),r.mtime!=null){if(typeof r.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=Zi.UnixTime.fromObject(r.mtime)}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Ze.newBuffer(n.Data))),Ze.Long){var s=new Ze.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(Ze.Long){var s=new Ze.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(Ze.Long){var s=new Ze.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?Zi.Data.DataType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Ze.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),r.filesize!=null&&r.hasOwnProperty("filesize")&&(typeof r.filesize=="number"?n.filesize=i.longs===String?String(r.filesize):r.filesize:n.filesize=i.longs===String?Ze.Long.prototype.toString.call(r.filesize):i.longs===Number?new Ze.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0):r.filesize),r.blocksizes&&r.blocksizes.length){n.blocksizes=[];for(var o=0;o<r.blocksizes.length;++o)typeof r.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(r.blocksizes[o]):r.blocksizes[o]:n.blocksizes[o]=i.longs===String?Ze.Long.prototype.toString.call(r.blocksizes[o]):i.longs===Number?new Ze.LongBits(r.blocksizes[o].low>>>0,r.blocksizes[o].high>>>0).toNumber(!0):r.blocksizes[o]}return r.hashType!=null&&r.hasOwnProperty("hashType")&&(typeof r.hashType=="number"?n.hashType=i.longs===String?String(r.hashType):r.hashType:n.hashType=i.longs===String?Ze.Long.prototype.toString.call(r.hashType):i.longs===Number?new Ze.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0):r.hashType),r.fanout!=null&&r.hasOwnProperty("fanout")&&(typeof r.fanout=="number"?n.fanout=i.longs===String?String(r.fanout):r.fanout:n.fanout=i.longs===String?Ze.Long.prototype.toString.call(r.fanout):i.longs===Number?new Ze.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0):r.fanout),r.mode!=null&&r.hasOwnProperty("mode")&&(n.mode=r.mode),r.mtime!=null&&r.hasOwnProperty("mtime")&&(n.mtime=Zi.UnixTime.toObject(r.mtime,i)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Fc.default.util.toJSONOptions)},t.DataType=function(){let e={},r=Object.create(e);return r[e[0]="Raw"]=0,r[e[1]="Directory"]=1,r[e[2]="File"]=2,r[e[3]="Metadata"]=3,r[e[4]="Symlink"]=4,r[e[5]="HAMTShard"]=5,r}(),t})(),TAt=Zi.UnixTime=(()=>{function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Seconds=Ze.Long?Ze.Long.fromBits(0,0,!1):0,t.prototype.FractionalNanoseconds=0,t.encode=function(r,i){return i||(i=sI.create()),i.uint32(8).int64(r.Seconds),r.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(r,"FractionalNanoseconds")&&i.uint32(21).fixed32(r.FractionalNanoseconds),i},t.decode=function(r,i){r instanceof Jh||(r=Jh.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Zi.UnixTime;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Seconds=r.int64();break;case 2:s.FractionalNanoseconds=r.fixed32();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw Ze.ProtocolError("missing required 'Seconds'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Zi.UnixTime)return r;var i=new Zi.UnixTime;return r.Seconds!=null&&(Ze.Long?(i.Seconds=Ze.Long.fromValue(r.Seconds)).unsigned=!1:typeof r.Seconds=="string"?i.Seconds=parseInt(r.Seconds,10):typeof r.Seconds=="number"?i.Seconds=r.Seconds:typeof r.Seconds=="object"&&(i.Seconds=new Ze.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber())),r.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=r.FractionalNanoseconds>>>0),i},t.toObject=function(r,i){i||(i={});var n={};if(i.defaults){if(Ze.Long){var s=new Ze.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return r.Seconds!=null&&r.hasOwnProperty("Seconds")&&(typeof r.Seconds=="number"?n.Seconds=i.longs===String?String(r.Seconds):r.Seconds:n.Seconds=i.longs===String?Ze.Long.prototype.toString.call(r.Seconds):i.longs===Number?new Ze.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber():r.Seconds),r.FractionalNanoseconds!=null&&r.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=r.FractionalNanoseconds),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Fc.default.util.toJSONOptions)},t})(),RAt=Zi.Metadata=(()=>{function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.MimeType="",t.encode=function(r,i){return i||(i=sI.create()),r.MimeType!=null&&Object.hasOwnProperty.call(r,"MimeType")&&i.uint32(10).string(r.MimeType),i},t.decode=function(r,i){r instanceof Jh||(r=Jh.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Zi.Metadata;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.MimeType=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Zi.Metadata)return r;var i=new Zi.Metadata;return r.MimeType!=null&&(i.MimeType=String(r.MimeType)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),r.MimeType!=null&&r.hasOwnProperty("MimeType")&&(n.MimeType=r.MimeType),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Fc.default.util.toJSONOptions)},t})()});var as={};ut(as,{UnixFS:()=>wi,parseMode:()=>Nw,parseMtime:()=>oI});function Nw(t){if(t!=null)return typeof t=="number"?t&4095:(t=t.toString(),t.substring(0,1)==="0"?parseInt(t,8)&4095:parseInt(t,10)&4095)}function oI(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),i=Math.floor(r/1e3);e={secs:i,nsecs:(r-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,Dw.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var Dw,Kc,_U,Xke,EU,SU,wi,pi=xe(()=>{f();Dw=Wt(ue());wU();Kc=vU,_U=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],Xke=["directory","hamt-sharded-directory"],EU=parseInt("0644",8),SU=parseInt("0755",8);wi=class{static unmarshal(e){let r=Kc.decode(e),i=Kc.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new wi({type:_U[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:r,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(r&&!_U.includes(r))throw(0,Dw.default)(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=r||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=Nw(c),a&&(this.mtime=oI(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?SU:EU;let r=Nw(e);r!==void 0&&(this._mode=r)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&Xke.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(r=>{e+=r}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=Kc.DataType.Raw;break;case"directory":e=Kc.DataType.Directory;break;case"file":e=Kc.DataType.File;break;case"metadata":e=Kc.DataType.Metadata;break;case"symlink":e=Kc.DataType.Symlink;break;case"hamt-sharded-directory":e=Kc.DataType.HAMTShard;break;default:throw(0,Dw.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let r=this.data;(!this.data||!this.data.length)&&(r=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(Nw(this.mode)||0),i===EU&&!this.isDirectory()&&(i=void 0),i===SU&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=oI(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return Kc.encode(s).finish()}}});function aI(t,e){let r=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let n=t[e++];if(r+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[r,e]}function Bw(t,e){let r;[r,e]=aI(t,e);let i=e+r;if(r<0||i<0)throw new Error("protobuf: invalid length");if(i>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,i),i]}function xU(t,e){let r;return[r,e]=aI(t,e),[r&7,r>>3,e]}function Zke(t){let e={},r=t.length,i=0;for(;i<r;){let n,s;if([n,s,i]=xU(t,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=Bw(t,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=Bw(t,i),e.Name=Qke.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=aI(t,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function AU(t){let e=t.length,r=0,i,n=!1,s;for(;r<e;){let a,c;if([a,c,r]=xU(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,r]=Bw(t,r),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let u;[u,r]=Bw(t,r),i.push(Zke(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}var Qke,IU=xe(()=>{f();Qke=new TextDecoder});function eqe(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=Bg(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){let i=TU.encode(t.Name);r-=i.length,e.set(i,r),r=Bg(e,r,i.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=Bg(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function PU(t){let e=rqe(t),r=new Uint8Array(e),i=e;if(t.Data&&(i-=t.Data.length,r.set(t.Data,i),i=Bg(r,i,t.Data.length)-1,r[i]=10),t.Links)for(let n=t.Links.length-1;n>=0;n--){let s=eqe(t.Links[n],r.subarray(0,i));i-=s,i=Bg(r,i,s)-1,r[i]=18}return r}function tqe(t){let e=0;if(t.Hash){let r=t.Hash.length;e+=1+r+ep(r)}if(typeof t.Name=="string"){let r=TU.encode(t.Name).length;e+=1+r+ep(r)}return typeof t.Tsize=="number"&&(e+=1+ep(t.Tsize)),e}function rqe(t){let e=0;if(t.Data){let r=t.Data.length;e+=1+r+ep(r)}if(t.Links)for(let r of t.Links){let i=tqe(r);e+=1+i+ep(i)}return e}function Bg(t,e,r){e-=ep(r);let i=e;for(;r>=Jke;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,i}function ep(t){return t%2==0&&t++,Math.floor((iqe(t)+6)/7)}function iqe(t){let e=0;return t>=RU&&(t=Math.floor(t/RU),e=32),t>=1<<16&&(t>>>=16,e+=16),t>=1<<8&&(t>>>=8,e+=8),e+nqe[t]}var TU,RU,Jke,nqe,CU=xe(()=>{f();TU=new TextEncoder,RU=2**32,Jke=2**31;nqe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]});function OU(t,e){if(t===e)return 0;let r=t.Name?cI.encode(t.Name):[],i=e.Name?cI.encode(e.Name):[],n=r.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(r[o]!==i[o]){n=r[o],s=i[o];break}return n<s?-1:s<n?1:0}function kU(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function qU(t){if(typeof t.asCID=="object"){let r=We.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Hash){let r=We.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=We.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=We.decode(t.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function Bs(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=cI.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map(qU),e.Links.sort(OU);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function uI(t){if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");if(!kU(t,sqe))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<t.Links.length;e++){let r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!kU(r,oqe))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&OU(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function DU(t,e=[]){return Bs({Data:t,Links:e})}function NU(t,e,r){return qU({Hash:r,Name:t,Tsize:e})}var sqe,oqe,cI,BU=xe(()=>{f();Ie();sqe=["Data","Links"],oqe=["Hash","Name","Tsize"],cI=new TextEncoder});var Mt={};ut(Mt,{code:()=>Mg,createLink:()=>NU,createNode:()=>DU,decode:()=>jc,encode:()=>Po,name:()=>aqe,prepare:()=>Bs,validate:()=>uI});function Po(t){uI(t);let e={};return t.Links&&(e.Links=t.Links.map(r=>{let i={};return r.Hash&&(i.Hash=r.Hash.bytes),r.Name!==void 0&&(i.Name=r.Name),r.Tsize!==void 0&&(i.Tsize=r.Tsize),i})),t.Data&&(e.Data=t.Data),PU(e)}function jc(t){let e=AU(t),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map(i=>{let n={};try{n.Hash=We.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),r}var aqe,Mg,_t=xe(()=>{f();Ie();IU();CU();BU();aqe="dag-pb",Mg=112});function MU(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(cqe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(lqe(t))return"Buffer";let r=fqe(t);return r||"Object"}function lqe(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function fqe(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(uqe.includes(e))return e}var cqe,uqe,LU=xe(()=>{f();cqe=["string","number","bigint","symbol"],uqe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var de,Fe,cs=xe(()=>{f();de=class{constructor(e,r,i){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};de.uint=new de(0,"uint",!0);de.negint=new de(1,"negint",!0);de.bytes=new de(2,"bytes",!0);de.string=new de(3,"string",!0);de.array=new de(4,"array",!1);de.map=new de(5,"map",!1);de.tag=new de(6,"tag",!1);de.float=new de(7,"float",!0);de.false=new de(7,"false",!0);de.true=new de(7,"true",!0);de.null=new de(7,"null",!0);de.undefined=new de(7,"undefined",!0);de.break=new de(7,"break",!0);Fe=class{constructor(e,r,i){this.type=e,this.value=r,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function Mw(t){return tp&&globalThis.Buffer.isBuffer(t)}function lI(t){return t instanceof Uint8Array?Mw(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}function VU(t,e){if(Mw(t)&&Mw(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function zU(t,e=1/0){let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function HU(t,e,r){let i=[];for(;e<r;){let n=t[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=r){let a,c,u,l;switch(o){case 1:n<128&&(s=n);break;case 2:a=t[e+1],(a&192)==128&&(l=(n&31)<<6|a&63,l>127&&(s=l));break;case 3:a=t[e+1],c=t[e+2],(a&192)==128&&(c&192)==128&&(l=(n&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=t[e+1],c=t[e+2],u=t[e+3],(a&192)==128&&(c&192)==128&&(u&192)==128&&(l=(n&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return pqe(i)}function pqe(t){let e=t.length;if(e<=$U)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=$U));return r}var tp,dqe,hqe,UU,FU,Ba,Lw,KU,jU,$U,rp=xe(()=>{f();tp=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",dqe=new TextDecoder,hqe=new TextEncoder;UU=tp?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):HU(t,e,r):(t,e,r)=>r-e>64?dqe.decode(t.subarray(e,r)):HU(t,e,r),FU=tp?t=>t.length>64?globalThis.Buffer.from(t):zU(t):t=>t.length>64?hqe.encode(t):zU(t),Ba=t=>Uint8Array.from(t),Lw=tp?(t,e,r)=>Mw(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),KU=tp?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),lI(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),i=0;for(let n of t)i+n.length>r.length&&(n=n.subarray(0,r.length-i)),r.set(n,i),i+=n.length;return r},jU=tp?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);$U=4096});var yqe,Uw,GU=xe(()=>{f();rp();yqe=256,Uw=class{constructor(e=yqe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=r.length-(this.maxCursor-this.cursor)-1;r.set(e,n)}else{if(r){let n=r.length-(this.maxCursor-this.cursor)-1;n<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=jU(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(r=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=Lw(i,0,this.cursor)}else r=KU(this.chunks,this.cursor);return e&&this.reset(),r}}});function Vc(t,e,r){if(t.length-e<r)throw new Error(`${ot} not enough data for type`)}var ot,fI,Lg,Co=xe(()=>{f();ot="CBOR decode error:",fI="CBOR encode error:",Lg=[];Lg[23]=1;Lg[24]=2;Lg[25]=3;Lg[26]=5;Lg[27]=9});function us(t,e,r){Vc(t,e,1);let i=t[e];if(r.strict===!0&&i<Fi[0])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);return i}function ls(t,e,r){Vc(t,e,2);let i=t[e]<<8|t[e+1];if(r.strict===!0&&i<Fi[1])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);return i}function fs(t,e,r){Vc(t,e,4);let i=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&i<Fi[2])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);return i}function ds(t,e,r){Vc(t,e,8);let i=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],n=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(r.strict===!0&&s<Fi[3])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${ot} integers outside of the safe integer range are not supported`)}function WU(t,e,r,i){return new Fe(de.uint,us(t,e+1,i),2)}function YU(t,e,r,i){return new Fe(de.uint,ls(t,e+1,i),3)}function XU(t,e,r,i){return new Fe(de.uint,fs(t,e+1,i),5)}function QU(t,e,r,i){return new Fe(de.uint,ds(t,e+1,i),9)}function Ms(t,e){return Hn(t,0,e.value)}function Hn(t,e,r){if(r<Fi[0]){let i=Number(r);t.push([e|i])}else if(r<Fi[1]){let i=Number(r);t.push([e|24,i])}else if(r<Fi[2]){let i=Number(r);t.push([e|25,i>>>8,i&255])}else if(r<Fi[3]){let i=Number(r);t.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(r);if(i<Fi[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,t.push(n)}else throw new Error(`${ot} encountered BigInt larger than allowable range`)}}var Fi,Ma=xe(()=>{f();cs();Co();Fi=[24,256,65536,4294967296,BigInt("18446744073709551616")];Ms.encodedSize=function(e){return Hn.encodedSize(e.value)};Hn.encodedSize=function(e){return e<Fi[0]?1:e<Fi[1]?2:e<Fi[2]?3:e<Fi[3]?5:9};Ms.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0}});function ZU(t,e,r,i){return new Fe(de.negint,-1-us(t,e+1,i),2)}function JU(t,e,r,i){return new Fe(de.negint,-1-ls(t,e+1,i),3)}function eF(t,e,r,i){return new Fe(de.negint,-1-fs(t,e+1,i),5)}function rF(t,e,r,i){let n=ds(t,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new Fe(de.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${ot} integers outside of the safe integer range are not supported`);return new Fe(de.negint,dI-BigInt(n),9)}function Fw(t,e){let r=e.value,i=typeof r=="bigint"?r*dI-tF:r*-1-1;Hn(t,e.type.majorEncoded,i)}var dI,tF,hI=xe(()=>{f();cs();Ma();Co();dI=BigInt(-1),tF=BigInt(1);Fw.encodedSize=function(e){let r=e.value,i=typeof r=="bigint"?r*dI-tF:r*-1-1;return i<Fi[0]?1:i<Fi[1]?2:i<Fi[2]?3:i<Fi[3]?5:9};Fw.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0}});function Ug(t,e,r,i){Vc(t,e,r+i);let n=Lw(t,e+r,e+r+i);return new Fe(de.bytes,n,r+i)}function iF(t,e,r,i){return Ug(t,e,1,r)}function nF(t,e,r,i){return Ug(t,e,2,us(t,e+1,i))}function sF(t,e,r,i){return Ug(t,e,3,ls(t,e+1,i))}function oF(t,e,r,i){return Ug(t,e,5,fs(t,e+1,i))}function aF(t,e,r,i){let n=ds(t,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer bytes lengths not supported`);return Ug(t,e,9,n)}function Kw(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===de.string?FU(t.value):t.value),t.encodedBytes}function ip(t,e){let r=Kw(e);Hn(t,e.type.majorEncoded,r.length),t.push(r)}function gqe(t,e){return t.length<e.length?-1:t.length>e.length?1:VU(t,e)}var jw=xe(()=>{f();cs();Co();Ma();rp();ip.encodedSize=function(e){let r=Kw(e);return Hn.encodedSize(r.length)+r.length};ip.compareTokens=function(e,r){return gqe(Kw(e),Kw(r))}});function Fg(t,e,r,i){let n=r+i;return Vc(t,e,n),new Fe(de.string,UU(t,e+r,e+n),n)}function cF(t,e,r,i){return Fg(t,e,1,r)}function uF(t,e,r,i){return Fg(t,e,2,us(t,e+1,i))}function lF(t,e,r,i){return Fg(t,e,3,ls(t,e+1,i))}function fF(t,e,r,i){return Fg(t,e,5,fs(t,e+1,i))}function dF(t,e,r,i){let n=ds(t,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer string lengths not supported`);return Fg(t,e,9,n)}var hF,pI=xe(()=>{f();cs();Co();Ma();jw();rp();hF=ip});function np(t,e,r,i){return new Fe(de.array,i,r)}function pF(t,e,r,i){return np(t,e,1,r)}function yF(t,e,r,i){return np(t,e,2,us(t,e+1,i))}function gF(t,e,r,i){return np(t,e,3,ls(t,e+1,i))}function bF(t,e,r,i){return np(t,e,5,fs(t,e+1,i))}function mF(t,e,r,i){let n=ds(t,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer array lengths not supported`);return np(t,e,9,n)}function vF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${ot} indefinite length items not allowed`);return np(t,e,1,1/0)}function yI(t,e){Hn(t,de.array.majorEncoded,e.value)}var gI=xe(()=>{f();cs();Ma();Co();yI.compareTokens=Ms.compareTokens});function sp(t,e,r,i){return new Fe(de.map,i,r)}function wF(t,e,r,i){return sp(t,e,1,r)}function _F(t,e,r,i){return sp(t,e,2,us(t,e+1,i))}function EF(t,e,r,i){return sp(t,e,3,ls(t,e+1,i))}function SF(t,e,r,i){return sp(t,e,5,fs(t,e+1,i))}function xF(t,e,r,i){let n=ds(t,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer map lengths not supported`);return sp(t,e,9,n)}function AF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${ot} indefinite length items not allowed`);return sp(t,e,1,1/0)}function bI(t,e){Hn(t,de.map.majorEncoded,e.value)}var mI=xe(()=>{f();cs();Ma();Co();bI.compareTokens=Ms.compareTokens});function IF(t,e,r,i){return new Fe(de.tag,r,1)}function TF(t,e,r,i){return new Fe(de.tag,us(t,e+1,i),2)}function RF(t,e,r,i){return new Fe(de.tag,ls(t,e+1,i),3)}function PF(t,e,r,i){return new Fe(de.tag,fs(t,e+1,i),5)}function CF(t,e,r,i){return new Fe(de.tag,ds(t,e+1,i),9)}function vI(t,e){Hn(t,de.tag.majorEncoded,e.value)}var wI=xe(()=>{f();cs();Ma();vI.compareTokens=Ms.compareTokens});function OF(t,e,r,i){if(i.allowUndefined===!1)throw new Error(`${ot} undefined values are not supported`);return new Fe(de.undefined,void 0,1)}function kF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${ot} indefinite length items not allowed`);return new Fe(de.break,void 0,1)}function _I(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${ot} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${ot} Infinity values are not supported`)}return new Fe(de.float,t,e)}function qF(t,e,r,i){return _I(EI(t,e+1),3,i)}function DF(t,e,r,i){return _I(SI(t,e+1),5,i)}function NF(t,e,r,i){return _I(UF(t,e+1),9,i)}function Vw(t,e,r){let i=e.value;if(i===!1)t.push([de.float.majorEncoded|bqe]);else if(i===!0)t.push([de.float.majorEncoded|mqe]);else if(i===null)t.push([de.float.majorEncoded|vqe]);else if(i===void 0)t.push([de.float.majorEncoded|wqe]);else{let n,s=!1;(!r||r.float64!==!0)&&(MF(i),n=EI(Oo,1),i===n||Number.isNaN(i)?(Oo[0]=249,t.push(Oo.slice(0,3)),s=!0):(LF(i),n=SI(Oo,1),i===n&&(Oo[0]=250,t.push(Oo.slice(0,5)),s=!0))),s||(_qe(i),n=UF(Oo,1),Oo[0]=251,t.push(Oo.slice(0,9)))}}function MF(t){if(t===1/0)Ls.setUint16(0,31744,!1);else if(t===-1/0)Ls.setUint16(0,64512,!1);else if(Number.isNaN(t))Ls.setUint16(0,32256,!1);else{Ls.setFloat32(0,t);let e=Ls.getUint32(0),r=(e&2139095040)>>23,i=e&8388607;if(r===255)Ls.setUint16(0,31744,!1);else if(r===0)Ls.setUint16(0,(t&2147483648)>>16|i>>13,!1);else{let n=r-127;n<-24?Ls.setUint16(0,0):n<-14?Ls.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Ls.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function EI(t,e){if(t.length-e<2)throw new Error(`${ot} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let i=r>>10&31,n=r&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,r&32768?-s:s}function LF(t){Ls.setFloat32(0,t,!1)}function SI(t,e){if(t.length-e<4)throw new Error(`${ot} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function _qe(t){Ls.setFloat64(0,t,!1)}function UF(t,e){if(t.length-e<8)throw new Error(`${ot} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}var bqe,mqe,vqe,wqe,BF,Ls,Oo,xI=xe(()=>{f();cs();Co();Ma();bqe=20,mqe=21,vqe=22,wqe=23;Vw.encodedSize=function(e,r){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!r||r.float64!==!0){if(MF(i),n=EI(Oo,1),i===n||Number.isNaN(i))return 3;if(LF(i),n=SI(Oo,1),i===n)return 5}return 9};BF=new ArrayBuffer(9),Ls=new DataView(BF,1),Oo=new Uint8Array(BF,0);Vw.compareTokens=Ms.compareTokens});function Lt(t,e,r){throw new Error(`${ot} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function zw(t){return()=>{throw new Error(`${ot} ${t}`)}}function FF(t){switch(t.type){case de.false:return Ba([244]);case de.true:return Ba([245]);case de.null:return Ba([246]);case de.bytes:return t.value.length?void 0:Ba([64]);case de.string:return t.value===""?Ba([96]):void 0;case de.array:return t.value===0?Ba([128]):void 0;case de.map:return t.value===0?Ba([160]):void 0;case de.uint:return t.value<24?Ba([Number(t.value)]):void 0;case de.negint:if(t.value>=-24)return Ba([31-Number(t.value)])}}var ke,ko,AI=xe(()=>{f();cs();Ma();hI();jw();pI();gI();mI();wI();xI();Co();rp();ke=[];for(let t=0;t<=23;t++)ke[t]=Lt;ke[24]=WU;ke[25]=YU;ke[26]=XU;ke[27]=QU;ke[28]=Lt;ke[29]=Lt;ke[30]=Lt;ke[31]=Lt;for(let t=32;t<=55;t++)ke[t]=Lt;ke[56]=ZU;ke[57]=JU;ke[58]=eF;ke[59]=rF;ke[60]=Lt;ke[61]=Lt;ke[62]=Lt;ke[63]=Lt;for(let t=64;t<=87;t++)ke[t]=iF;ke[88]=nF;ke[89]=sF;ke[90]=oF;ke[91]=aF;ke[92]=Lt;ke[93]=Lt;ke[94]=Lt;ke[95]=zw("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)ke[t]=cF;ke[120]=uF;ke[121]=lF;ke[122]=fF;ke[123]=dF;ke[124]=Lt;ke[125]=Lt;ke[126]=Lt;ke[127]=zw("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)ke[t]=pF;ke[152]=yF;ke[153]=gF;ke[154]=bF;ke[155]=mF;ke[156]=Lt;ke[157]=Lt;ke[158]=Lt;ke[159]=vF;for(let t=160;t<=183;t++)ke[t]=wF;ke[184]=_F;ke[185]=EF;ke[186]=SF;ke[187]=xF;ke[188]=Lt;ke[189]=Lt;ke[190]=Lt;ke[191]=AF;for(let t=192;t<=215;t++)ke[t]=IF;ke[216]=TF;ke[217]=RF;ke[218]=PF;ke[219]=CF;ke[220]=Lt;ke[221]=Lt;ke[222]=Lt;ke[223]=Lt;for(let t=224;t<=243;t++)ke[t]=zw("simple values are not supported");ke[244]=Lt;ke[245]=Lt;ke[246]=Lt;ke[247]=OF;ke[248]=zw("simple values are not supported");ke[249]=qF;ke[250]=DF;ke[251]=NF;ke[252]=Lt;ke[253]=Lt;ke[254]=Lt;ke[255]=kF;ko=[];for(let t=0;t<24;t++)ko[t]=new Fe(de.uint,t,1);for(let t=-1;t>=-24;t--)ko[31-t]=new Fe(de.negint,t,1);ko[64]=new Fe(de.bytes,new Uint8Array(0),1);ko[96]=new Fe(de.string,"",1);ko[128]=new Fe(de.array,0,1);ko[160]=new Fe(de.map,0,1);ko[244]=new Fe(de.false,!1,1);ko[245]=new Fe(de.true,!0,1);ko[246]=new Fe(de.null,null,1)});function Hw(t,e={},r){let i=MU(t),n=e&&e.typeEncoders&&e.typeEncoders[i]||Ju[i];if(typeof n=="function"){let o=n(t,i,e,r);if(o!=null)return o}let s=Ju[i];if(!s)throw new Error(`${fI} unsupported type: ${i}`);return s(t,i,e,r)}function Sqe(t,e){e.mapSorter&&t.sort(e.mapSorter)}function xqe(t,e){let r=Array.isArray(t[0])?t[0][0]:t[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==i.type)return r.type.compare(i.type);let n=r.type.major,s=La[n].compareTokens(r,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function jF(t,e,r,i){if(Array.isArray(e))for(let n of e)jF(t,n,r,i);else r[e.type.major](t,e,i)}function Aqe(t,e,r){let i=Hw(t,r);if(!Array.isArray(i)&&r.quickEncodeToken){let n=r.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,r),a=new Uw(o);if(s(a,i,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return lI(a.chunks[0])}}return jF(KF,i,e,r),KF.toBytes(!0)}function $w(t,e){return e=Object.assign({},Eqe,e),Aqe(t,La,e)}var Eqe,La,KF,Kg,Zu,Ju,VF=xe(()=>{f();LU();cs();GU();Co();AI();rp();Ma();hI();jw();pI();gI();mI();wI();xI();Eqe={float64:!1,mapSorter:xqe,quickEncodeToken:FF},La=[];La[de.uint.major]=Ms;La[de.negint.major]=Fw;La[de.bytes.major]=ip;La[de.string.major]=hF;La[de.array.major]=yI;La[de.map.major]=bI;La[de.tag.major]=vI;La[de.float.major]=Vw;KF=new Uw,Kg=class{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${fI} object contains circular references`);return new Kg(r,e)}},Zu={null:new Fe(de.null,null),undefined:new Fe(de.undefined,void 0),true:new Fe(de.true,!0),false:new Fe(de.false,!1),emptyArray:new Fe(de.array,0),emptyMap:new Fe(de.map,0)},Ju={number(t,e,r,i){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Fe(de.float,t):t>=0?new Fe(de.uint,t):new Fe(de.negint,t)},bigint(t,e,r,i){return t>=BigInt(0)?new Fe(de.uint,t):new Fe(de.negint,t)},Uint8Array(t,e,r,i){return new Fe(de.bytes,t)},string(t,e,r,i){return new Fe(de.string,t)},boolean(t,e,r,i){return t?Zu.true:Zu.false},null(t,e,r,i){return Zu.null},undefined(t,e,r,i){return Zu.undefined},ArrayBuffer(t,e,r,i){return new Fe(de.bytes,new Uint8Array(t))},DataView(t,e,r,i){return new Fe(de.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,i){if(!t.length)return r.addBreakTokens===!0?[Zu.emptyArray,new Fe(de.break)]:Zu.emptyArray;i=Kg.createCheck(i,t);let n=[],s=0;for(let o of t)n[s++]=Hw(o,r,i);return r.addBreakTokens?[new Fe(de.array,t.length),n,new Fe(de.break)]:[new Fe(de.array,t.length),n]},Object(t,e,r,i){let n=e!=="Object",s=n?t.keys():Object.keys(t),o=n?t.size:s.length;if(!o)return r.addBreakTokens===!0?[Zu.emptyMap,new Fe(de.break)]:Zu.emptyMap;i=Kg.createCheck(i,t);let a=[],c=0;for(let u of s)a[c++]=[Hw(u,r,i),Hw(n?t.get(u):t[u],r,i)];return Sqe(a,r),r.addBreakTokens?[new Fe(de.map,o),a,new Fe(de.break)]:[new Fe(de.map,o),a]}};Ju.Map=Ju.Object;Ju.Buffer=Ju.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ju[`${t}Array`]=Ju.DataView});function Tqe(t,e,r){let i=[];for(let n=0;n<t.value;n++){let s=Vg(e,r);if(s===Gw){if(t.value===1/0)break;throw new Error(`${ot} got unexpected break to lengthed array`)}if(s===jg)throw new Error(`${ot} found array but not enough entries (got ${n}, expected ${t.value})`);i[n]=s}return i}function Rqe(t,e,r){let i=r.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<t.value;o++){let a=Vg(e,r);if(a===Gw){if(t.value===1/0)break;throw new Error(`${ot} got unexpected break to lengthed map`)}if(a===jg)throw new Error(`${ot} found map but not enough entries (got ${o} [no key], expected ${t.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${ot} non-string keys not supported (got ${typeof a})`);let c=Vg(e,r);if(c===jg)throw new Error(`${ot} found map but not enough entries (got ${o} [no value], expected ${t.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function Vg(t,e){if(t.done())return jg;let r=t.next();if(r.type===de.break)return Gw;if(r.type.terminal)return r.value;if(r.type===de.array)return Tqe(r,t,e);if(r.type===de.map)return Rqe(r,t,e);if(r.type===de.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let i=Vg(t,e);return e.tags[r.value](i)}throw new Error(`${ot} tag not supported (${r.value})`)}throw new Error("unsupported")}function Ww(t,e){if(!(t instanceof Uint8Array))throw new Error(`${ot} data to decode must be a Uint8Array`);e=Object.assign({},Iqe,e);let r=e.tokenizer||new zF(t,e),i=Vg(r,e);if(i===jg)throw new Error(`${ot} did not find any content to decode`);if(i===Gw)throw new Error(`${ot} got unexpected break`);if(!r.done())throw new Error(`${ot} too many terminals, data makes no sense`);return i}var Iqe,zF,jg,Gw,HF=xe(()=>{f();Co();cs();AI();Iqe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},zF=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],r=ko[e];if(r===void 0){let i=ke[e];if(!i)throw new Error(`${ot} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;r=i(this.data,this.pos,n,this.options)}return this.pos+=r.encodedLength,r}},jg=Symbol.for("DONE"),Gw=Symbol.for("BREAK")});var Yw={};ut(Yw,{Token:()=>Fe,Type:()=>de,decode:()=>Ww,encode:()=>$w});var zg=xe(()=>{f();VF();HF();cs()});var Xw={};ut(Xw,{code:()=>Hg,decode:()=>Pf,encode:()=>II,name:()=>Dqe});function Pqe(t){if(t.asCID!==t)return null;let e=We.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Fe(de.tag,$F),new Fe(de.bytes,r)]}function Cqe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Oqe(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function qqe(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return We.decode(t.subarray(1))}var $F,kqe,GF,Dqe,Hg,II,Pf,zc=xe(()=>{f();zg();Ie();$F=42;kqe={float64:!0,typeEncoders:{Object:Pqe,undefined:Cqe,number:Oqe}};GF={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};GF.tags[$F]=qqe;Dqe="dag-cbor",Hg=113,II=t=>$w(t,kqe),Pf=t=>Ww(t,GF)});var YF=y((o4t,WF)=>{f();"use strict";WF.exports=()=>{}});var tl=y(el=>{f();"use strict";var $g=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=$g.code}};$g.code="ERR_NOT_INITIALIZED";el.NotInitializedError=$g;var TI=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=op.code}};TI.code="ERR_ALREADY_INITIALIZING";el.AlreadyInitializingError=TI;var op=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=op.code}};op.code="ERR_ALREADY_INITIALIZED";el.AlreadyInitializedError=op;var Gg=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=Gg.code}};Gg.code="ERR_NOT_STARTED";el.NotStartedError=Gg;var Wg=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=Wg.code}};Wg.code="ERR_ALREADY_STARTING";el.AlreadyStartingError=Wg;var Yg=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=Yg.code}};Yg.code="ERR_ALREADY_STARTED";el.AlreadyStartedError=Yg;var Xg=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=Xg.code}};Xg.code="ERR_NOT_ENABLED";el.NotEnabledError=Xg});var XF,QF=xe(()=>{f();XF="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var Qg={};ut(Qg,{customAlphabet:()=>Nqe,customRandom:()=>JF,nanoid:()=>Bqe,random:()=>ZF,urlAlphabet:()=>XF});var ZF,JF,Nqe,Bqe,Zg=xe(()=>{f();QF();ZF=t=>crypto.getRandomValues(new Uint8Array(t)),JF=(t,e,r)=>{let i=(2<<Math.log(t.length-1)/Math.LN2)-1,n=-~(1.6*i*e/t.length);return()=>{let s="";for(;;){let o=r(n),a=n;for(;a--;)if(s+=t[o[a]&i]||"",s.length===e)return s}}},Nqe=(t,e)=>JF(t,e,ZF),Bqe=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let i=r[t]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var RI=y((l4t,tK)=>{f();"use strict";var{nanoid:Mqe}=(Zg(),Qg),{toString:Lqe}=(tt(),et),{fromString:Uqe}=(ft(),ht),Hc="/",eK=new TextEncoder().encode(Hc),Qw=eK[0],Us=class{constructor(e,r){if(typeof e=="string")this._buf=Uqe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Qw)throw new Error("Invalid key")}toString(e="utf8"){return Lqe(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Us(e.join(Hc))}static random(){return new Us(Mqe().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=eK),this._buf[0]!==Qw){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Qw,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Qw;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),i=e.list();for(let n=0;n<r.length;n++){if(i.length<n+1)return!1;let s=r[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return r.length<i.length}reverse(){return Us.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Hc).slice(1)}type(){return Fqe(this.baseNamespace())}name(){return Kqe(this.baseNamespace())}instance(e){return new Us(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Hc)||(e+=Hc),e+=this.type(),new Us(e)}parent(){let e=this.list();return e.length===1?new Us(Hc):new Us(e.slice(0,-1).join(Hc))}child(e){return this.toString()===Hc?e:e.toString()===Hc?this:new Us(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Us.withNamespaces([...this.namespaces(),...jqe(e.map(r=>r.namespaces()))])}};function Fqe(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Kqe(t){let e=t.split(":");return e[e.length-1]}function jqe(t){return[].concat(...t)}tK.exports=Us});var iK=y((f4t,rK)=>{f();"use strict";var{nanoid:Vqe}=(Zg(),Qg),zqe=(t=e=>e)=>t(Vqe());rK.exports=zqe});var ap=y((d4t,nK)=>{f();"use strict";var Hqe=async t=>{let e=[];for await(let r of t)e.push(r);return e};nK.exports=Hqe});var PI=y((h4t,sK)=>{f();"use strict";var $qe=iK(),Gqe=ap(),Wqe=(t,e)=>async function*(){yield*(await Gqe(t)).sort(e)}(),Yqe=(t,e)=>{let r=new RegExp("^"+e);return t.replace(r,"")};sK.exports={sortAll:Wqe,tmpdir:$qe,replaceStartWith:Yqe}});var Ua=y((p4t,oK)=>{f();"use strict";var Xqe=async t=>{for await(let e of t);};oK.exports=Xqe});var Fa=y((y4t,aK)=>{f();"use strict";var Qqe=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};aK.exports=Qqe});var cp=y((g4t,cK)=>{f();"use strict";var Zqe=async function*(t,e){let r=0;if(!(e<1)){for await(let i of t)if(yield i,r++,r===e)return}};cK.exports=Zqe});var CI=y((b4t,hK)=>{f();"use strict";var{sortAll:uK}=PI(),lK=Ua(),up=Fa(),fK=cp(),dK=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await lK(this.putMany(e,i)),e=[],await lK(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=up(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>up(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>uK(n,s),i)),e.offset!=null){let n=0;i=up(i,()=>n++>=e.offset)}return e.limit!=null&&(i=fK(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=up(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>up(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>uK(n,s),i)),e.offset!=null){let n=0;i=up(i,()=>n++>=e.offset)}return e.limit!=null&&(i=fK(i,e.limit)),i}};hK.exports=dK});var OI=y((m4t,pK)=>{f();"use strict";var Jg=ue();function Jqe(t){return t=t||new Error("Cannot open database"),Jg(t,"ERR_DB_OPEN_FAILED")}function eDe(t){return t=t||new Error("Delete failed"),Jg(t,"ERR_DB_DELETE_FAILED")}function tDe(t){return t=t||new Error("Write failed"),Jg(t,"ERR_DB_WRITE_FAILED")}function rDe(t){return t=t||new Error("Not Found"),Jg(t,"ERR_NOT_FOUND")}function iDe(t){return t=t||new Error("Aborted"),Jg(t,"ERR_ABORTED")}pK.exports={dbOpenFailedError:Jqe,dbDeleteFailedError:eDe,dbWriteFailedError:tDe,notFoundError:rDe,abortedError:iDe}});var mK=y((v4t,bK)=>{f();"use strict";var yK=RI(),nDe=CI(),sDe=OI(),gK=class extends nDe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw sDe.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new yK(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new yK(e))}};bK.exports=gK});var Ut=y((w4t,vK)=>{f();"use strict";var oDe=RI(),aDe=mK(),cDe=PI(),uDe=OI(),lDe=CI();vK.exports={Key:oDe,MemoryDatastore:aDe,utils:cDe,Errors:uDe,Adapter:lDe}});var _K=y((_4t,wK)=>{f();"use strict";wK.exports=function(){return Date.now()}});var SK=y((E4t,EK)=>{f();"use strict";var kI=_K();function qI(t,e,r){var i=this;this._started=kI(),this._rescheduled=0,this._scheduled=e,this._args=r,this._timer=setTimeout(n,e);function n(){i._rescheduled>0?(i._scheduled=i._rescheduled-(kI()-i._started),i._timer=setTimeout(n,i._scheduled),i._rescheduled=0):t.apply(null,i._args)}}qI.prototype.reschedule=function(t){var e=kI();return e+t-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=t,!0)};qI.prototype.clear=function(){clearTimeout(this._timer)};function fDe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new qI(arguments[0],arguments[1],t)}EK.exports=fDe});var Zw=y((S4t,DI)=>{f();"use strict";var{AbortController:dDe}=typeof self!="undefined"?self:typeof window!="undefined"?window:nf(),xK=SK(),eb=class extends dDe{constructor(e){super();this._ms=e,this._timer=xK(()=>this.abort(),e),Object.setPrototypeOf(this,eb.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=xK(()=>this.abort(),this._ms)}};DI.exports=eb;DI.exports.TimeoutController=eb});var tb=y((x4t,NI)=>{f();"use strict";var hDe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;NI.exports=yt;NI.exports.default=yt;yt.nanosecond=yt.ns=1/1e6;yt.\u00B5s=yt.\u03BCs=yt.us=yt.microsecond=1/1e3;yt.millisecond=yt.ms=yt[""]=1;yt.second=yt.sec=yt.s=yt.ms*1e3;yt.minute=yt.min=yt.m=yt.s*60;yt.hour=yt.hr=yt.h=yt.m*60;yt.day=yt.d=yt.h*24;yt.week=yt.wk=yt.w=yt.d*7;yt.month=yt.b=yt.d*(365.25/12);yt.year=yt.yr=yt.y=yt.d*365.25;function yt(t="",e="ms"){var r=null;return t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2"),t.replace(hDe,function(i,n,s){s=AK(s),s&&(r=(r||0)+parseFloat(n,10)*s)}),r&&r/(AK(e)||1)}function AK(t){return yt[t]||yt[t.toLowerCase().replace(/s$/,"")]}});var TK=y(IK=>{f();"use strict";var rb=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=rb.code}};rb.code="ERR_TIMEOUT";IK.TimeoutError=rb});var qe=y((I4t,RK)=>{f();"use strict";var pDe=Zw(),{anySignal:yDe}=Tu(),{default:gDe}=tb(),{TimeoutError:BI}=TK();function bDe(t,e){return(...r)=>{let i=r[e??r.length-1];if(!i||!i.timeout)return t(...r);let n=typeof i.timeout=="string"?gDe(i.timeout):i.timeout,s=new pDe(n);i.signal=yDe([i.signal,s.signal]);let o=t(...r),a=new Promise((l,d)=>{s.signal.addEventListener("abort",()=>{d(new BI)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new BI;if(Date.now()-c>n)throw s.abort(),new BI};return o[Symbol.asyncIterator]?async function*(){let l=o[Symbol.asyncIterator]();try{for(;;){let{value:d,done:h}=await Promise.race([l.next(),a]);if(h)break;u(),yield d}}catch(d){throw u(),d}finally{s.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([o,a]);return u(),l}catch(l){throw u(),l}finally{s.clear()}})()}}RK.exports=bDe});var ib=y((T4t,OK)=>{f();"use strict";var{CID:MI}=(Ie(),Ne),PK=ue(),CK="/ipfs/",mDe=t=>{if(t instanceof Uint8Array)try{t=MI.decode(t)}catch(n){throw PK(n,"ERR_INVALID_CID")}let e=MI.asCID(t);if(e)return{cid:e,path:void 0};t=t.toString(),t.startsWith(CK)&&(t=t.substring(CK.length));let r=t.split("/"),i;try{e=MI.parse(r.shift()||"")}catch(n){throw PK(n,"ERR_INVALID_CID")}return r.length&&(i=`/${r.join("/")}`),{cid:e,path:i}};OK.exports=mDe});var Ki=y((R4t,qK)=>{f();"use strict";var vDe=Yh(),{CID:nb}=(Ie(),Ne),wDe=Ut().Key,LI=ue(),_De=qe(),EDe=ib(),SDe=(_t(),Mt),xDe="ERR_BAD_PATH",ADe=t=>{if(nb.asCID(t))return`/ipfs/${t}`;let r=t.toString();try{return`/ipfs/${nb.parse(r)}`}catch{}if(vDe.path(r))return r;throw LI(new Error(`invalid path: ${t}`),xDe)},IDe=t=>t instanceof Uint8Array?nb.decode(t).toString():(t=t.toString(),t.indexOf("/ipfs/")===0&&(t=t.substring("/ipfs/".length)),t.charAt(t.length-1)==="/"&&(t=t.substring(0,t.length-1)),t),TDe=async function(t,e,r,i={}){let{cid:n,path:s}=EDe(r);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:u}of kK(n,i.path,e,t,{signal:i.signal})){if(!nb.asCID(c))break;a=u,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},RDe=t=>{if(t.type!=="file"&&t.type!=="directory"&&t.type!=="raw")throw new Error(`Unknown node type '${t.type}'`);let e={cid:t.cid,path:t.path,name:t.name,size:t.size,type:"file"};return t.type==="directory"&&(e.type="dir"),t.type==="file"&&(e.size=t.unixfs.fileSize()),(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,t.unixfs.mtime!==void 0&&(e.mtime=t.unixfs.mtime)),e},PDe=_De(async(t,e)=>await t),kK=async function*(t,e,r,i,n){let s=async u=>{let l=await r.getCodec(u.code),d=await i.blocks.get(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(o.length||(yield{value:a,remainderPath:""});o.length;){let u=o.shift();if(!u)throw LI(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(t.code===SDe.code&&Array.isArray(a.Links)){let l=a.Links.find(d=>d.Name===u);if(l){yield{value:l.Hash,remainderPath:o.join("/")},a=await s(l.Hash),c=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw LI(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");nb.asCID(a)&&(c=a,a=await s(a))}};qK.exports={normalizePath:ADe,normalizeCidPath:IDe,resolvePath:TDe,mapFile:RDe,withTimeout:PDe,resolve:kK,OFFLINE_ERROR:"This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY:new wDe("/local/filesroot"),MFS_MAX_CHUNK_SIZE:262144,MFS_MAX_LINKS:174}});var Jw=y((P4t,DK)=>{f();"use strict";var{NotStartedError:CDe,AlreadyStartingError:ODe,AlreadyStartedError:kDe}=tl(),{withTimeout:qDe}=Ki(),Ka=class{static create({start:e,stop:r}){return new Ka(e,r)}static async start(e,r){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(r);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new ODe;case"started":throw new kDe;case"stopping":return await i.ready,await Ka.start(e,r);default:return Ka.panic(e)}}static async stop(e){let{state:r,deactivate:i}=e;switch(r.status){case"stopped":break;case"starting":{try{await r.ready}catch(n){}return await Ka.stop(e)}case"stopping":return await r.ready;case"started":{i&&await i(r.value),e.state={status:"stopped"};break}default:Ka.panic(r)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},r){switch(e.status){case"started":return e.value;case"starting":return await qDe(e.ready,r);default:throw new CDe}}static panic({state:e}){let r=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${r}, should never happen if you see this please report a bug`)}constructor(e,r){this.activate=e,this.deactivate=r,this.state={status:"stopped"}}async use(e){return await Ka.use(this,e)}try(){return Ka.try(this)}};DK.exports=Ka});var BK=y((C4t,NK)=>{f();"use strict";var DDe=Jw();NK.exports=({network:t,preload:e,peerId:r,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,options:c})=>async()=>{let{libp2p:l}=await DDe.start(t,{peerId:r,repo:n,print:a,options:c});await Promise.all([s.startOnline({keychain:i,libp2p:l,peerId:r,repo:n}),e.start(),o.start()])}});var LK=y((O4t,MK)=>{f();"use strict";var NDe=Jw();MK.exports=({network:t,preload:e,ipns:r,repo:i,mfsPreload:n})=>async()=>{await Promise.all([e.stop(),r.stop(),n.stop(),NDe.stop(t),i.close()])}});var sb=y((k4t,UK)=>{f();UK.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),i=Object.create(null);function n(s,o){r[s]=o,e++,e>=t&&(e=0,i=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||i[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:n(s,o)},clear:function(){r=Object.create(null),i=Object.create(null)}}}});var UI=y((q4t,KK)=>{f();"use strict";var BDe=sb(),FK=class{constructor(e){this.lru=BDe(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,i){this.lru.set(e,{value:r,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};KK.exports=FK});var VK=y((D4t,FI)=>{f();"use strict";var MDe=Object.prototype.hasOwnProperty,Rn="~";function ob(){}Object.create&&(ob.prototype=Object.create(null),new ob().__proto__||(Rn=!1));function LDe(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function jK(t,e,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new LDe(r,i||t,n),o=Rn?Rn+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function e_(t,e){--t._eventsCount==0?t._events=new ob:delete t._events[e]}function pn(){this._events=new ob,this._eventsCount=0}pn.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)MDe.call(r,i)&&e.push(Rn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};pn.prototype.listeners=function(e){var r=Rn?Rn+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};pn.prototype.listenerCount=function(e){var r=Rn?Rn+e:e,i=this._events[r];return i?i.fn?1:i.length:0};pn.prototype.emit=function(e,r,i,n,s,o){var a=Rn?Rn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,i),!0;case 4:return c.fn.call(c.context,r,i,n),!0;case 5:return c.fn.call(c.context,r,i,n,s),!0;case 6:return c.fn.call(c.context,r,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,r);break;case 3:c[d].fn.call(c[d].context,r,i);break;case 4:c[d].fn.call(c[d].context,r,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};pn.prototype.on=function(e,r,i){return jK(this,e,r,i,!1)};pn.prototype.once=function(e,r,i){return jK(this,e,r,i,!0)};pn.prototype.removeListener=function(e,r,i,n){var s=Rn?Rn+e:e;if(!this._events[s])return this;if(!r)return e_(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!n||o.once)&&(!i||o.context===i)&&e_(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==r||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:e_(this,s)}return this};pn.prototype.removeAllListeners=function(e){var r;return e?(r=Rn?Rn+e:e,this._events[r]&&e_(this,r)):(this._events=new ob,this._eventsCount=0),this};pn.prototype.off=pn.prototype.removeListener;pn.prototype.addListener=pn.prototype.on;pn.prefixed=Rn;pn.EventEmitter=pn;typeof FI!="undefined"&&(FI.exports=pn)});var HK=y((N4t,zK)=>{f();"use strict";zK.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(i=>{i(e())}).then(()=>r),r=>new Promise(i=>{i(e())}).then(()=>{throw r})))});var GK=y((B4t,t_)=>{f();"use strict";var UDe=HK(),KI=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},$K=(t,e,r)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{i(r())}catch(c){n(c)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,a=r instanceof Error?r:new KI(o);typeof t.cancel=="function"&&t.cancel(),n(a)},e);UDe(t.then(i,n),()=>{clearTimeout(s)})});t_.exports=$K;t_.exports.default=$K;t_.exports.TimeoutError=KI});var WK=y(jI=>{f();"use strict";Object.defineProperty(jI,"__esModule",{value:!0});function FDe(t,e,r){let i=0,n=t.length;for(;n>0;){let s=n/2|0,o=i+s;r(t[o],e)<=0?(i=++o,n-=s+1):n=s}return i}jI.default=FDe});var XK=y(VI=>{f();"use strict";Object.defineProperty(VI,"__esModule",{value:!0});var KDe=WK(),YK=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let i={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(i);return}let n=KDe.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};VI.default=YK});var $c=y(zI=>{f();"use strict";Object.defineProperty(zI,"__esModule",{value:!0});var jDe=VK(),QK=GK(),VDe=XK(),r_=()=>{},zDe=new QK.TimeoutError,ZK=class extends jDe{constructor(e){var r,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r_,this._resolveIdle=r_,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:VDe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r_,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r_,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():QK.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&n(zDe)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async i=>this.add(i,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};zI.default=ZK});var tj=y((F4t,ej)=>{f();"use strict";var HDe=UI(),{default:$De}=$c(),GDe=Gy(),HI=new HDe(1e3),WDe=60*1e3,YDe=new $De({concurrency:4}),JK=t=>{if(t.Path)return t.Path;throw new Error(t.Message)};ej.exports=async(t,e)=>(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&HI.has(o)){let c=HI.get(o);return JK(c)}let a=await YDe.add(async()=>{let c=await GDe.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),l=await c.json();return HI.set(u,l,WDe),l});return JK(a)})(t,e)});var ij=y((K4t,rj)=>{f();"use strict";var XDe=tj(),QDe=qe();function ZDe(t){return t.endsWith(".eth")&&(t=t.replace(/.eth$/,".eth.link")),t}rj.exports=()=>QDe(async(e,r={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=ZDe(e),XDe(e,r)})});var sj=y((j4t,nj)=>{f();"use strict";nj.exports=({network:t})=>()=>{let e=t.try();return e!=null&&Boolean(e.libp2p.isStarted())}});var cj=y((V4t,aj)=>{f();"use strict";var oj=Yh(),{CID:$I}=(Ie(),Ne),JDe=rt(),eNe=qe(),{resolve:tNe}=Ki();aj.exports=({repo:t,codecs:e,bases:r,name:i})=>{async function n(s,o={}){if(!oj.path(s))throw new Error("invalid argument "+s);if(oj.ipnsPath(s))for await(let E of i.resolve(s,o))s=E;let[,a,c,...u]=s.split("/"),l=o.cidBase?await r.getBase(o.cidBase):void 0,d=rNe(c);if(u.length===0){let E=l?l.encoder.encode(d):c;return`/${a}/${E}`}let h=$I.decode(d);s=u.join("/");let p=tNe(h,s,e,t,o),g=h,m=s;for await(let E of p)$I.asCID(E.value)&&(g=E.value,m=E.remainderPath);return`/ipfs/${g.toString(l&&l.encoder)}${m?"/"+m:""}`}return eNe(n)};function rNe(t){try{return JDe.parse(t).toBytes()}catch{return $I.parse(t).bytes}}});var $n=y((z4t,uj)=>{f();"use strict";var iNe=async t=>{let e;for await(let r of t)e=r;return e};uj.exports=iNe});var fj=y((H4t,lj)=>{f();"use strict";var nNe=$n(),{CID:sNe}=(Ie(),Ne);lj.exports=({addAll:t})=>(e,r={})=>{let i,n=sNe.asCID(e);return n?i=t([{cid:n,...r}],r):i=t([{path:e.toString(),...r}],r),nNe(i)}});var lp=y(($4t,dj)=>{f();"use strict";var ab=ue(),{CID:GI}=(Ie(),Ne);async function*oNe(t){if(t==null)throw ab(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");let e=GI.asCID(t);if(e){yield qo({cid:e});return}if(t instanceof String||typeof t=="string"){yield qo({path:t});return}if(t.cid!=null||t.path!=null)return yield qo(t);if(Symbol.iterator in t){let r=t[Symbol.iterator](),i=r.next();if(i.done)return r;if(GI.asCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield qo({cid:i.value});for(let n of r)yield qo({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield qo(i.value);for(let n of r)yield qo(n);return}throw ab(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in t){let r=t[Symbol.asyncIterator](),i=await r.next();if(i.done)return r;if(GI.asCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield qo({cid:i.value});for await(let n of r)yield qo({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield qo(i.value);for await(let n of r)yield qo(n);return}throw ab(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}throw ab(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}function qo(t){let e=t.cid||`${t.path}`;if(!e)throw ab(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let r={path:e,recursive:t.recursive!==!1};return t.metadata!=null&&(r.metadata=t.metadata),r}dj.exports={normaliseInput:oNe}});var WI=y((G4t,hj)=>{f();hj.exports=aNe;function aNe(t,e,r){if(!t)return r;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!t||(t=t[n],t===void 0))return r;return t}});var YI=y((W4t,pj)=>{f();"use strict";var cNe=async t=>{let e=0;for await(let r of t)e++;return e};pj.exports=cNe});var wj=y((Y4t,vj)=>{f();"use strict";var{CID:yj}=(Ie(),Ne),gj=Ut().Key,uNe=me()("ipfs:repo:migrator:migration-8"),lNe=YI(),{base32:i_}=(on(),sn),fNe=(Rs(),wo),dNe=(xn(),Ln);function bj(t){return t.child?bj(t.child):t}function hNe(t){try{let e=i_.decode(`b${t.toString().toLowerCase().slice(1)}`),r=yj.decode(e).multihash.bytes,i=i_.encode(r).slice(1).toUpperCase();return new gj(`/${i}`,!1)}catch(e){return t}}function pNe(t){try{let e=i_.decode(`b${t.toString().toLowerCase().slice(1)}`),r=dNe.decode(e),i=i_.encode(yj.createV1(fNe.code,r).bytes).slice(1);return new gj(`/${i.toUpperCase()}`,!1)}catch{return t}}async function mj(t,e,r){let i=t.blocks;await i.open();let n=bj(i),s=await lNe(n.queryKeys({filters:[o=>r(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=r(a.key);c.toString()!==a.key.toString()&&(o+=1,uNe(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}vj.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(t,e=()=>{})=>mj(t,e,hNe),revert:(t,e=()=>{})=>mj(t,e,pNe)}});var Sj=y((Q4t,Ej)=>{f();"use strict";var fp=ki(),_j=fp.Reader,yNe=fp.Writer,X4t=fp.util,cb=fp.roots.default||(fp.roots.default={});cb.ipfs=function(){var t={};return t.pin=function(){var e={};return e.Set=function(){function r(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(n,s){return s||(s=yNe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},r.decode=function(n,s){n instanceof _j||(n=_j.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new cb.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},r.fromObject=function(n){if(n instanceof cb.ipfs.pin.Set)return n;var s=new cb.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},r.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,fp.util.toJSONOptions)},r}(),e}(),t}();Ej.exports=cb});var Aj=y((Z4t,xj)=>{f();XI.BASE=2166136261;function XI(t){for(var e=XI.BASE,r=0,i=t.length;r<i;r++)e^=t.charCodeAt(r),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}xj.exports=XI});var QI=y((J4t,Tj)=>{f();"use strict";var{Key:Ij}=Ut(),{base32:gNe}=(on(),sn),{CID:bNe}=(kc(),mh),mNe=new Ij("/local/pins"),vNe=256,wNe=8192,_Ne=bNe.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),ENe={direct:"direct",recursive:"recursive"};function SNe(t){return new Ij(`/${gNe.encode(t.multihash.bytes).toUpperCase().substring(1)}`)}Tj.exports={PIN_DS_KEY:mNe,DEFAULT_FANOUT:vNe,MAX_ITEMS:wNe,EMPTY_KEY:_Ne,PinTypes:ENe,cidToKey:SNe}});var Rj={};ut(Rj,{compare:()=>xNe});function xNe(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}var Pj=xe(()=>{f()});var Nj=y((eTt,Dj)=>{f();"use strict";var{CID:Cj}=(Ie(),Ne),{ipfs:{pin:{Set:ZI}}}=Sj(),ANe=Aj(),JI=ss(),n_=(_t(),Mt),{DEFAULT_FANOUT:e4,MAX_ITEMS:INe,EMPTY_KEY:Oj}=QI(),{concat:t4}=(un(),cn),{compare:TNe}=(Pj(),Rj),{toString:RNe}=(tt(),et),{fromString:PNe}=(ft(),ht),{sha256:kj}=(ri(),li);function CNe(t){let e=t.Data;if(!e)throw new Error("No data present");let r=JI.decode(e),i=JI.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+r>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,r+i),s=ZI.toObject(ZI.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>t.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(r+i)}}function ONe(t,e){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,t,!0);let n=PNe(e.toString()),s=t4([r,n],r.byteLength+n.byteLength);return ANe(RNe(s))}async function*qj(t,e){let r=CNe(e),i=0;for(let n of e.Links){if(i<r.header.fanout){let s=n.Hash;if(!Oj.equals(s)){let o=await t.get(s),a=n_.decode(o);yield*qj(t,a)}}else yield n.Hash;i++}}async function*kNe(t,e,r){let i=e.Links.find(o=>o.Name===r);if(!i)throw new Error("No link found with name "+r);let n=await t.get(i.Hash),s=n_.decode(n);yield*qj(t,s)}function qNe(t,e){return r(e,0);async function r(i,n){let s=ZI.encode({version:1,fanout:e4,seed:n}).finish(),o=JI.encode(s.length),a=t4([o,s]),c=[];for(let l=0;l<e4;l++)c.push({Name:"",Tsize:1,Hash:Oj});if(i.length<=INe){let l=i.map(p=>({link:{Name:"",Tsize:1,Hash:p.key},data:p.data||new Uint8Array})).sort((p,g)=>TNe(p.link.Hash.bytes,g.link.Hash.bytes)),d=c.concat(l.map(p=>p.link));return{Data:t4([a,...l.map(p=>p.data)]),Links:d}}else{let l=i.reduce((h,p)=>{let g=ONe(n,p.key)%e4;return h[g]=g in h?h[g].concat([p]):[p],h},[]),d=0;for(let h of l){let p=await r(h,n+1);await u(p,d),d++}return{Data:a,Links:c}}async function u(l,d){let h=n_.encode(l),p=await kj.digest(h),g=Cj.createV0(p);await t.put(g,h);let m=l.Links.reduce((E,v)=>E+(v.Tsize||0),0)+h.length;c[d]={Name:"",Tsize:m,Hash:g}}}}async function DNe(t,e,r){let i=await qNe(t,r.map(c=>({key:c}))),n=n_.encode(i),s=await kj.digest(n),o=Cj.createV0(s);await t.put(o,n);let a=i.Links.reduce((c,u)=>c+u.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}Dj.exports={loadSet:kNe,storeSet:DNe}});var Uj=y((tTt,Lj)=>{f();"use strict";var{CID:r4}=(Ie(),Ne),ub=(_t(),Mt),i4=(zg(),Yw),dp=Nj(),{cidToKey:Bj,PIN_DS_KEY:s_,PinTypes:hp}=QI(),n4=YI(),{sha256:NNe}=(ri(),li),BNe=(xn(),Ln),{base32:MNe}=(on(),sn);async function LNe(t,e,r,i){if(!await e.has(s_))return;let n=await e.get(s_),s=r4.decode(n),o=await t.get(s),a=ub.decode(o),c=0,u=await n4(dp.loadSet(t,a,hp.recursive))+await n4(dp.loadSet(t,a,hp.direct));for await(let l of dp.loadSet(t,a,hp.recursive)){c++;let d={depth:1/0};l.version!==0&&(d.version=l.version),l.code!==ub.code&&(d.codec=l.code),await r.put(Bj(l),i4.encode(d)),i(c/u*100,`Migrated recursive pin ${l}`)}for await(let l of dp.loadSet(t,a,hp.direct)){c++;let d={depth:0};l.version!==0&&(d.version=l.version),l.code!==ub.code&&(d.codec=l.code),await r.put(Bj(l),i4.encode(d)),i(c/u*100,`Migrated direct pin ${l}`)}await t.delete(s),await e.delete(s_)}async function UNe(t,e,r,i){let n=[],s=[],o=0,a=await n4(r.queryKeys({}));for await(let{key:h,value:p}of r.query({})){o++;let g=i4.decode(p),m=r4.create(g.version||0,g.codec||ub.code,BNe.decode(MNe.decode("b"+h.toString().toLowerCase().split("/").pop())));g.depth===0?(i(o/a*100,`Reverted direct pin ${m}`),s.push(m)):(i(o/a*100,`Reverted recursive pin ${m}`),n.push(m))}i(100,"Updating pin root");let c={Links:[await dp.storeSet(t,hp.direct,s),await dp.storeSet(t,hp.recursive,n)]},u=ub.encode(c),l=await NNe.digest(u),d=r4.createV0(l);await t.put(d,u),await e.put(s_,d.bytes)}async function Mj(t,e,r){let i=t.blocks,n=t.datastore,s=t.pins;await i.open(),await n.open(),await s.open();try{await r(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}Lj.exports={version:9,description:"Migrates pins to datastore",migrate:(t,e=()=>{})=>Mj(t,e,LNe),revert:(t,e=()=>{})=>Mj(t,e,UNe)}});var Cf=y((rTt,zj)=>{f();"use strict";var{Key:Fj,Errors:Kj}=Ut(),FNe=new Fj("/config"),KNe=new Fj("/version");function s4(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function jj(t,e,r){let i=await e(t);if(i)return i;let n=s4(r);return n?new Promise((s,o)=>{let a=n.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function Vj(t,e,r,i){if(await r(t))return e(t);let n=s4(i);if(!n)throw Kj.notFoundError();return new Promise((s,o)=>{let a=n.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(Kj.notFoundError())}})}function o_(t){let e=t.get.bind(t),r=t.has.bind(t);return t.get=i=>Vj(i,e,r,t),t.has=i=>jj(i,r,t),t}function jNe(t){return{...t,root:o_(t.root),datastore:o_(t.datastore),pins:o_(t.pins),keys:o_(t.keys)}}zj.exports={wrapBackends:jNe,hasWithFallback:jj,getWithFallback:Vj,findLevelJs:s4,CONFIG_KEY:FNe,VERSION_KEY:KNe}});var Xj=y((iTt,Yj)=>{f();"use strict";var{findLevelJs:Hj}=Cf(),{fromString:VNe}=(ft(),ht),{toString:zNe}=(tt(),et);async function HNe(t,e,r=()=>{}){let i=Hj(e);if(!i){r(`${t} did not need an upgrade`);return}r(`Upgrading ${t}`),await Wj(i,(s,o)=>[{type:"del",key:s},{type:"put",key:VNe(s),value:o}])}async function $Ne(t,e,r=()=>{}){let i=Hj(e);if(!i){r(`${t} did not need a downgrade`);return}r(`Downgrading ${t}`),await Wj(i,(s,o)=>[{type:"del",key:s},{type:"put",key:zNe(s),value:o}])}function $j(t){return t.child?$j(t.child):t}async function Gj(t,e,r){let i=Object.entries(t).map(([o,a])=>({key:o,backend:$j(a)})).filter(({key:o,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:o,backend:a})=>({name:o,store:a}));e(0,`Migrating ${i.length} dbs`);let n=0,s=o=>{e(Math.round(n/i.length*100),o)};for(let{name:o,store:a}of i){await a.open();try{await r(o,a,s)}finally{n++,await a.close()}}e(100,`Migrated ${i.length} dbs`)}Yj.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(t,e=()=>{})=>Gj(t,e,HNe),revert:(t,e=()=>{})=>Gj(t,e,$Ne)};function Wj(t,e){function r(i,n){let s=t.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function u(){let l=i[a++],d=l.key,h;try{h=l.type==="del"?s.delete(d):s.put(l.value,d)}catch(p){c=p,o.abort();return}a<i.length&&(h.onsuccess=u)}u()}return new Promise((i,n)=>{let s=t.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,l,d)=>{if(u||l===void 0){let h=p=>{if(p){n(p);return}i()};s.end(h);return}r(e(l,d),a)};s.next(c)}})}});var Zj=y((nTt,Qj)=>{f();"use strict";var{Key:GNe}=Ut(),pp=new GNe("/local/filesroot");async function WNe(t,e=()=>{}){e(100,"Migrating MFS root to repo datastore"),await t.root.open(),await t.datastore.open();let r=await t.root.get(pp);await t.datastore.put(pp,r),await t.root.delete(pp),await t.datastore.close(),await t.root.close(),e(100,"Stored MFS root in repo datastore")}async function YNe(t,e=()=>{}){e(100,"Migrating MFS root to repo root datastore"),await t.root.open(),await t.datastore.open();let r=await t.datastore.get(pp);await t.root.put(pp,r),await t.datastore.delete(pp),await t.datastore.close(),await t.root.close(),e(100,"Stored MFS root in repo root datastore")}Qj.exports={version:11,description:"Store mfs root in the datastore",migrate:WNe,revert:YNe}});var eV=y((sTt,Jj)=>{f();"use strict";var Of={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};Jj.exports=[Object.assign({version:1},Of),Object.assign({version:2},Of),Object.assign({version:3},Of),Object.assign({version:4},Of),Object.assign({version:5},Of),Object.assign({version:6},Of),Object.assign({version:7},Of),wj(),Uj(),Xj(),Zj()]});var a_=y((oTt,tV)=>{f();"use strict";var o4=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}};o4.code="ERR_NON_REVERSIBLE_MIGRATION";var a4=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}};a4.code="ERR_NOT_INITIALIZED_REPO";var c4=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}};c4.code="ERR_REQUIRED_PARAMETER";var u4=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}};u4.code="ERR_INVALID_VALUE";var l4=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}};l4.code="ERR_MISSING_REPO_OPTIONS";tV.exports={NonReversibleMigrationError:o4,NotInitializedRepoError:a4,RequiredParameterError:c4,InvalidValueError:u4,MissingRepoOptionsError:l4}});var iV=y((aTt,rV)=>{f();"use strict";var f4=me()("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:XNe,VERSION_KEY:QNe}=Cf(),{MissingRepoOptionsError:ZNe}=a_();async function JNe(t){if(!t)throw new ZNe("Please pass repo options when trying to open a repo");let e=t.root;try{await e.open();let r=await e.has(QNe),i=await e.has(XNe);return!r||!i?(f4(`Version entry present: ${r}`),f4(`Config entry present: ${i}`),!1):!0}catch(r){return f4("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}rV.exports={isRepoInitialized:JNe}});var oV=y((cTt,sV)=>{f();"use strict";var eBe=iV(),{MissingRepoOptionsError:tBe,NotInitializedRepoError:rBe}=a_(),{VERSION_KEY:nV}=Cf(),{fromString:iBe}=(ft(),ht),{toString:nBe}=(tt(),et);async function sBe(t){if(!await eBe.isRepoInitialized(t))throw new rBe("Repo is not initialized!");let e=t.root;await e.open();try{return parseInt(nBe(await e.get(nV)))}finally{await e.close()}}async function oBe(t,e){if(!e)throw new tBe("Please pass repo options when trying to open a repo");let r=e.root;await r.open(),await r.put(nV,iBe(String(t))),await r.close()}sV.exports={getVersion:sBe,setVersion:oBe}});var fV=y((uTt,lV)=>{f();"use strict";var d4=eV(),kf=oV(),hs=a_(),{wrapBackends:aV}=Cf(),Do=me()("ipfs:repo:migrator");function cV(t){return t=t||d4,!Array.isArray(t)||t.length===0?0:t[t.length-1].version}async function aBe(t,e,r,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||d4,!t)throw new hs.RequiredParameterError("Path argument is required!");if(!r)throw new hs.RequiredParameterError("repoOptions argument is required!");if(!i)throw new hs.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new hs.InvalidValueError("Version has to be positive integer!");e=aV(e);let c=await kf.getVersion(e);if(c===i){Do("Nothing to migrate.");return}if(c>i)throw new hs.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);uV(a,c,i);let u;!o&&!n&&(u=await r.repoLock.lock(t));try{for(let l of a){if(i!==void 0&&l.version>i)break;if(!(l.version<=c)){Do(`Migrating version ${l.version}`);try{if(!o){let d=()=>{};s&&(d=(h,p)=>s(l.version,h.toFixed(2),p)),await l.migrate(e,d)}}catch(d){let h=l.version-1;throw Do(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await kf.setVersion(h,e),new Error(`During migration to version ${l.version} exception was raised: ${d.stack||d.message||d}`)}Do(`Migrating to version ${l.version} finished`)}}o||await kf.setVersion(i||cV(a),e),Do("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&u&&await u.close()}}async function cBe(t,e,r,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||d4,!t)throw new hs.RequiredParameterError("Path argument is required!");if(!r)throw new hs.RequiredParameterError("repoOptions argument is required!");if(!i)throw new hs.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new hs.InvalidValueError("Version has to be positive integer!");e=aV(e);let c=await kf.getVersion(e);if(c===i){Do("Nothing to revert.");return}if(c<i)throw new hs.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);uV(a,i,c,!0);let u;!o&&!n&&(u=await r.repoLock.lock(t)),Do(`Reverting from version ${c} to ${i}`);try{let l=a.slice().reverse();for(let d of l){if(d.version<=i)break;if(!(d.version>c)){Do(`Reverting migration version ${d.version}`);try{if(!o){let h=()=>{};s&&(h=(p,g)=>s(d.version,p.toFixed(2),g)),await d.revert(e,h)}}catch(h){let p=d.version;throw Do(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${p}`),await kf.setVersion(p,e),h.message=`During reversion to version ${d.version} exception was raised: ${h.message}`,h}Do(`Reverting to version ${d.version} finished`)}}o||await kf.setVersion(i,e),Do(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&u&&await u.close()}}function uV(t,e,r,i=!1){let n=0;for(let s of t){if(s.version>r)break;if(s.version>e){if(i&&!s.revert)throw new hs.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==r-e)throw new hs.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${r}`)}lV.exports={getCurrentRepoVersion:kf.getVersion,getLatestMigrationVersion:cV,errors:hs,migrate:aBe,revert:cBe}});var pV=y((lTt,c_)=>{f();"use strict";c_.exports=dBe;c_.exports.format=dV;c_.exports.parse=hV;var uBe=/\B(?=(\d{3})+(?!\d))/g,lBe=/(?:\.0*|(\.[^0]+)0+)$/,rl={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},fBe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function dBe(t,e){return typeof t=="string"?hV(t):typeof t=="number"?dV(t,e):null}function dV(t,e){if(!Number.isFinite(t))return null;var r=Math.abs(t),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!rl[a.toLowerCase()])&&(r>=rl.pb?a="PB":r>=rl.tb?a="TB":r>=rl.gb?a="GB":r>=rl.mb?a="MB":r>=rl.kb?a="KB":a="B");var c=t/rl[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(lBe,"$1")),i&&(u=u.replace(uBe,i)),u+n+a}function hV(t){if(typeof t=="number"&&!isNaN(t))return t;if(typeof t!="string")return null;var e=fBe.exec(t),r,i="b";return e?(r=parseFloat(e[1]),i=e[4].toLowerCase()):(r=parseInt(t,10),i="b"),Math.floor(rl[i]*r)}});var gV=y((fTt,yV)=>{f();"use strict";yV.exports={repoVersion:10}});var mV=y((dTt,bV)=>{f();"use strict";var hBe=Ut().Key,pBe=me(),yBe=pBe("ipfs:repo:version"),{toString:gBe}=(tt(),et),{fromString:bBe}=(ft(),ht),{hasWithFallback:mBe,getWithFallback:vBe}=Cf(),h4=new hBe("version");bV.exports=t=>({async exists(){return mBe(h4,t.has.bind(t),t)},async get(){let e=await vBe(h4,t.get.bind(t),t.has.bind(t),t);return parseInt(gBe(e),10)},set(e){return t.put(h4,bBe(String(e)))},async check(e){let r=await this.get();return yBe("comparing version: %s and %s",r,e),r===e||(r===6&&e===7||e===6&&r===7)}})});var p4=y((hTt,wV)=>{f();wV.exports=wBe;function wBe(t,e,r){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var i=e.pop();if(!i)return!1;vV(i);for(var n;n=e.shift();)if(vV(n),typeof t[n]=="undefined"&&(t[n]={}),t=t[n],!t||typeof t!="object")return!1;return t[i]=r,!0}function vV(t){if(t==="__proto__"||t==="constructor"||t==="prototype")throw new Error("setting of prototype values not supported")}});var u_=y(qf=>{f();"use strict";var lb=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=lb.code}};lb.code="ERR_LOCK_EXISTS";qf.LockExistsError=lb;var fb=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=fb.code}};fb.code="ERR_NOT_FOUND";qf.NotFoundError=fb;var db=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=db.code}};db.code="ERR_INVALID_REPO_VERSION";qf.InvalidRepoVersionError=db;qf.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED";qf.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN";qf.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"});var SV=y((yTt,EV)=>{f();"use strict";var{Key:_Be}=Ut(),{default:EBe}=$c(),SBe=WI(),xBe=p4(),y4=ue(),_V=u_(),{toString:ABe}=(tt(),et),{fromString:IBe}=(ft(),ht),{hasWithFallback:TBe,getWithFallback:RBe}=Cf(),g4=new _Be("config");EV.exports=t=>{let e=new EBe({concurrency:1}),r={async getAll(s={}){let o=await RBe(g4,t.get.bind(t),t.has.bind(t),t,{signal:s.signal});return JSON.parse(ABe(o))},async get(s,o={}){if(s==null)throw new _V.NotFoundError(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=SBe(a,s);if(c===void 0)throw new _V.NotFoundError(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw y4(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw y4(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw y4(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return TBe(g4,t.has.bind(t),t)}};return r;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await r.getAll();return typeof u=="object"&&u!==null&&xBe(u,a,c),n(u)}return n(c)}function n(s){let o=IBe(JSON.stringify(s,null,2));return t.put(g4,o)}}});var AV=y((gTt,xV)=>{f();"use strict";xV.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var TV=y((bTt,IV)=>{f();"use strict";var b4=AV();IV.exports=(t,e={})=>{if(!b4(t)&&!Array.isArray(t))throw new TypeError("Expected a plain object or array");let{deep:r}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u=[];return i.push(a),n.push(u),u.push(...a.map(l=>Array.isArray(l)?s(l):b4(l)?o(l):l)),u},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u={},l=Object.keys(a).sort(e.compare);i.push(a),n.push(u);for(let d of l){let h=a[d],p;r&&Array.isArray(h)?p=s(h):p=r&&b4(h)?o(h):h,Object.defineProperty(u,d,{...Object.getOwnPropertyDescriptor(a,d),value:p})}return u};return Array.isArray(t)?r?s(t):t.slice():o(t)}});var PV=y((mTt,RV)=>{f();"use strict";var PBe=Ut().Key,CBe=TV(),{toString:OBe}=(tt(),et),{fromString:kBe}=(ft(),ht),m4=new PBe("datastore_spec");RV.exports=t=>({exists(){return t.has(m4)},async get(){let e=await t.get(m4);return JSON.parse(OBe(e))},async set(e){return t.put(m4,kBe(JSON.stringify(CBe(e,{deep:!0}))))}})});var OV=y((vTt,CV)=>{f();"use strict";var qBe=Ut().Key,{fromString:DBe}=(ft(),ht),v4=new qBe("api");CV.exports=t=>({async get(){let e=await t.get(v4);return e&&e.toString()},set(e){return t.put(v4,DBe(e.toString()))},delete(){return t.delete(v4)}})});var qV=y((_Tt,kV)=>{f();kV.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var w4=y((STt,NV)=>{f();var DV=qV();NV.exports=class{constructor(e){this.hwm=e||16,this.head=new DV(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new DV(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var ja=y((xTt,BV)=>{f();var _4=w4();BV.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new _4,i,n,s,o=()=>{if(!r.isEmpty()){if(t.writev){let m,E=[];for(;!r.isEmpty();){if(m=r.shift(),m.error)throw m.error;E.push(m.value)}return{done:m.done,value:E}}let g=r.shift();if(g.error)throw g.error;return g}return s?{done:!0}:new Promise((g,m)=>{n=E=>(n=null,E.error?m(E.error):t.writev&&!E.done?g({done:E.done,value:[E.value]}):g(E),i)})},a=g=>n?n(g):(r.push(g),i),c=g=>(r=new _4,n?n({error:g}):(r.push({error:g}),i)),u=g=>s?i:a({done:!1,value:g}),l=g=>s?i:(s=!0,g?c(g):a({done:!0})),d=()=>(r=new _4,l(),{done:!0}),h=g=>(l(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:d,throw:h,push:u,end:l},!e)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(g){return p.throw(g),e&&(e(g),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(g){return p.end(g),e&&(e(g),e=null),i}},i}});var LV=y((ATt,MV)=>{f();"use strict";var NBe=Fa(),BBe=ja(),MBe=Ua(),{CID:LBe}=(Ie(),Ne),UBe=ue(),{identity:FBe}=(Cc(),Pc);MV.exports=KBe;function KBe(t){return{open(){return t.open()},close(){return t.close()},query(e,r){return t.query(e,r)},queryKeys(e,r){return t.queryKeys(e,r)},async get(e,r){let i=il(e);return i.isIdentity?Promise.resolve(i.digest):t.get(e,r)},async*getMany(e,r){for await(let i of e)yield this.get(i,r)},async put(e,r,i){let{isIdentity:n}=il(e);n||await t.put(e,r,i)},async*putMany(e,r){let i=BBe();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await MBe(t.putMany(async function*(){for await(let{key:s,value:o}of e)il(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,r){let{isIdentity:i}=il(e);return i?Promise.resolve(!0):t.has(e,r)},delete(e,r){let{isIdentity:i}=il(e);return i?Promise.resolve():t.delete(e,r)},deleteMany(e,r){return t.deleteMany(NBe(e,i=>!il(i).isIdentity),r)},batch(){let e=t.batch();return{put(r,i){let{isIdentity:n}=il(r);n||e.put(r,i)},delete(r){let{isIdentity:i}=il(r);i||e.delete(r)},commit:r=>e.commit(r)}}}}function il(t){let e=LBe.asCID(t);if(e==null)throw UBe(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==FBe.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}});var l_=y(E4=>{f();"use strict";var jBe=u_(),VBe=me(),UV=VBe("ipfs:repo:lock:memory"),FV="repo.lock",hb={};E4.lock=async t=>{let e=t+"/"+FV;if(UV("locking %s",e),hb[e]===!0)throw new jBe.LockExistsError(`Lock already being held for file: ${e}`);return hb[e]=!0,{async close(){hb[e]&&delete hb[e]}}};E4.locked=async t=>{let e=t+"/"+FV;return UV(`checking lock: ${e}`),Boolean(hb[e])}});var jV=y((TTt,KV)=>{f();"use strict";KV.exports={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:l_()}});var zV=y((RTt,VV)=>{f();"use strict";VV.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});var Df=y((PTt,HV)=>{f();"use strict";var zBe=async t=>{for await(let e of t)return e};HV.exports=zBe});var d_={};ut(d_,{Block:()=>pb,create:()=>WBe,createUnsafe:()=>$V,decode:()=>GBe,encode:()=>$Be});var f_,S4,x4,HBe,pb,$Be,GBe,$V,WBe,h_=xe(()=>{f();kc();f_=({enumerable:t=!0,configurable:e=!1}={})=>({enumerable:t,configurable:e,writable:!1}),S4=function*(t,e){if(t!=null&&!(t instanceof Uint8Array))for(let[r,i]of Object.entries(t)){let n=[...e,r];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=We.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*S4(o,a))}else{let s=We.asCID(i);s?yield[n.join("/"),s]:yield*S4(i,n)}}},x4=function*(t,e){if(t!=null)for(let[r,i]of Object.entries(t)){let n=[...e,r];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!We.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!We.asCID(o)&&(yield*x4(o,a))}else yield*x4(i,n)}},HBe=(t,e)=>{let r=t;for(let[i,n]of e.entries()){if(r=r[n],r==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=We.asCID(r);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:r}},pb=class{constructor({cid:e,bytes:r,value:i}){if(!e||!r||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=r,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:f_(),bytes:f_(),value:f_(),asBlock:f_()})}links(){return S4(this.value,[])}tree(){return x4(this.value,[])}get(e="/"){return HBe(this.value,e.split("/").filter(Boolean))}},$Be=async({value:t,codec:e,hasher:r})=>{if(typeof t=="undefined")throw new Error('Missing required argument "value"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let i=e.encode(t),n=await r.digest(i),s=We.create(1,e.code,n);return new pb({value:t,bytes:i,cid:s})},GBe=async({bytes:t,codec:e,hasher:r})=>{if(!t)throw new Error('Missing required argument "bytes"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let i=e.decode(t),n=await r.digest(t),s=We.create(1,e.code,n);return new pb({value:i,bytes:t,cid:s})},$V=({bytes:t,cid:e,value:r,codec:i})=>{let n=r!==void 0?r:i&&i.decode(t);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new pb({cid:e,bytes:t,value:n})},WBe=async({bytes:t,cid:e,hasher:r,codec:i})=>{if(!t)throw new Error('Missing required argument "bytes"');if(!r)throw new Error('Missing required argument "hasher"');let n=i.decode(t),s=await r.digest(t);if(!Sc.equals(e.multihash.bytes,s.bytes))throw new Error("CID hash does not match bytes");return $V({bytes:t,cid:e,value:n,codec:i})}});var A4=y((OTt,XV)=>{f();"use strict";var{Key:YBe}=Ut(),{CID:GV}=(kc(),mh),XBe=(Rs(),wo),QBe=ue(),{base32:WV}=(on(),sn),ZBe=(xn(),Ln);function JBe(t){let e=GV.asCID(t);if(e==null)throw QBe(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=WV.encode(e.multihash.bytes);return new YBe("/"+r.slice(1).toUpperCase(),!1)}function eMe(t){return GV.createV1(XBe.code,YV(t))}function YV(t){return ZBe.decode(WV.decode(`b${t.toString().toLowerCase().substring(1)}`))}XV.exports={cidToKey:JBe,keyToCid:eMe,keyToMultihash:YV}});var I4=y((kTt,ZV)=>{f();"use strict";var tMe=me()("ipfs:repo:utils:walk-dag"),rMe=(h_(),d_);async function*QV(t,e,r,i){try{let n=await e.get(t,i),s=await r(t.code),o=rMe.createUnsafe({bytes:n,cid:t,codec:s});for(let[,a]of o.links())yield a,yield*QV(a,e,r,i)}catch(n){throw tMe("Could not walk DAG for CID",t.toString(),n),n}}ZV.exports=QV});var T4=y((qTt,nz)=>{f();"use strict";var{CID:JV}=(Ie(),Ne),iMe=ue(),nMe=me(),ez=Df(),sMe=(h_(),d_),nl=(zg(),Yw),p_=(_t(),Mt),{cidToKey:y_,keyToMultihash:tz}=A4(),rz=I4();function oMe(t){let e=`Invalid type '${t}', must be one of {direct, indirect, recursive, all}`;return iMe(new Error(e),"ERR_INVALID_PIN_TYPE")}var Fs={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},iz=class{constructor({pinstore:e,blockstore:r,loadCodec:i}){this.pinstore=e,this.blockstore=r,this.loadCodec=i,this.log=nMe("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,r={}){await this.blockstore.get(e,r);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==p_.code&&(i.codec=e.code),r.metadata&&(i.metadata=r.metadata),this.pinstore.put(y_(e),nl.encode(i))}unpin(e,r){return this.pinstore.delete(y_(e),r)}async pinRecursively(e,r={}){await this.fetchCompleteDag(e,r);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==p_.code&&(i.codec=e.code),r.metadata&&(i.metadata=r.metadata),await this.pinstore.put(y_(e),nl.encode(i))}async*directKeys(e){for await(let r of this.pinstore.query({filters:[i=>nl.decode(i.value).depth===0]})){let i=nl.decode(r.value),n=i.version||0,s=i.codec!=null?i.codec:p_.code,o=tz(r.key);yield{cid:JV.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let r of this.pinstore.query({filters:[i=>nl.decode(i.value).depth===1/0]})){let i=nl.decode(r.value),n=i.version||0,s=i.codec!=null?i.codec:p_.code,o=tz(r.key);yield{cid:JV.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:r}of this.recursiveKeys())for await(let i of rz(r,this.blockstore,this.loadCodec,e)){let n=[Fs.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,r,i){Array.isArray(r)||(r=[r]);let n=r.includes(Fs.all),s=r.includes(Fs.direct),o=r.includes(Fs.recursive),a=r.includes(Fs.indirect);if(o||s||n){let l=await ez(this.pinstore.query({prefix:y_(e).toString(),filters:[d=>{if(n)return!0;let h=nl.decode(d.value);return r.includes(h.depth===0?Fs.direct:Fs.recursive)}],limit:1}));if(l){let d=nl.decode(l.value);return{cid:e,pinned:!0,reason:d.depth===0?Fs.direct:Fs.recursive,metadata:d.metadata}}}let c=this;async function*u(l,d){for await(let{cid:h}of d)for await(let p of rz(h,c.blockstore,c.loadCodec))if(p.equals(l)){yield h;return}}if(n||a){let l=await ez(u(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:Fs.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,r){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),u=sMe.createUnsafe({bytes:a,cid:s,codec:c});await Promise.all([...u.links()].map(([,l])=>n(l,o)))};await n(e,r)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Fs).includes(e))throw oMe(e);return!0}};nz.exports={PinManager:iz,PinTypes:Fs}});var No=y((DTt,sz)=>{f();"use strict";var aMe=async function*(t,e){for await(let r of t)yield e(r)};sz.exports=aMe});var cz=y((NTt,az)=>{f();"use strict";var cMe=No(),uMe=ue(),{PinTypes:lMe}=T4();az.exports=fMe;function fMe(t,e){return{open(){return e.open()},close(){return e.close()},query(r,i){return e.query(r,i)},queryKeys(r,i){return e.queryKeys(r,i)},async get(r,i){return e.get(r,i)},async*getMany(r,i){yield*e.getMany(r,i)},async put(r,i,n){await e.put(r,i,n)},async*putMany(r,i){yield*e.putMany(r,i)},has(r,i){return e.has(r,i)},async delete(r,i){return await oz(r,t),e.delete(r,i)},deleteMany(r,i){return e.deleteMany(cMe(r,async n=>(await oz(n,t),n)),i)},batch(){return e.batch()}}}async function oz(t,e){let{pinned:r,reason:i}=await e.isPinnedWithType(t,lMe.all);if(r)throw uMe(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}});var yr=y((BTt,R4)=>{f();"use strict";var yp=typeof Reflect=="object"?Reflect:null,uz=yp&&typeof yp.apply=="function"?yp.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},g_;yp&&typeof yp.ownKeys=="function"?g_=yp.ownKeys:Object.getOwnPropertySymbols?g_=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:g_=function(e){return Object.getOwnPropertyNames(e)};function dMe(t){console&&console.warn&&console.warn(t)}var lz=Number.isNaN||function(e){return e!==e};function Xt(){Xt.init.call(this)}R4.exports=Xt;R4.exports.once=gMe;Xt.EventEmitter=Xt;Xt.prototype._events=void 0;Xt.prototype._eventsCount=0;Xt.prototype._maxListeners=void 0;var fz=10;function b_(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Xt,"defaultMaxListeners",{enumerable:!0,get:function(){return fz},set:function(t){if(typeof t!="number"||t<0||lz(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");fz=t}});Xt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Xt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||lz(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function dz(t){return t._maxListeners===void 0?Xt.defaultMaxListeners:t._maxListeners}Xt.prototype.getMaxListeners=function(){return dz(this)};Xt.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")uz(c,this,r);else for(var u=c.length,l=bz(c,u),i=0;i<u;++i)uz(l[i],this,r);return!0};function hz(t,e,r,i){var n,s,o;if(b_(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=dz(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,dMe(a)}return t}Xt.prototype.addListener=function(e,r){return hz(this,e,r,!1)};Xt.prototype.on=Xt.prototype.addListener;Xt.prototype.prependListener=function(e,r){return hz(this,e,r,!0)};function hMe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pz(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=hMe.bind(i);return n.listener=r,i.wrapFn=n,n}Xt.prototype.once=function(e,r){return b_(r),this.on(e,pz(this,e,r)),this};Xt.prototype.prependOnceListener=function(e,r){return b_(r),this.prependListener(e,pz(this,e,r)),this};Xt.prototype.removeListener=function(e,r){var i,n,s,o,a;if(b_(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():pMe(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Xt.prototype.off=Xt.prototype.removeListener;Xt.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function yz(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?yMe(n):bz(n,n.length)}Xt.prototype.listeners=function(e){return yz(this,e,!0)};Xt.prototype.rawListeners=function(e){return yz(this,e,!1)};Xt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):gz.call(t,e)};Xt.prototype.listenerCount=gz;function gz(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Xt.prototype.eventNames=function(){return this._eventsCount>0?g_(this._events):[]};function bz(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function pMe(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function yMe(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function gMe(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}mz(t,e,s,{once:!0}),e!=="error"&&bMe(t,n,{once:!0})})}function bMe(t,e,r){typeof t.on=="function"&&mz(t,"error",e,r)}function mz(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var P4=y((MTt,vz)=>{f();vz.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var wz=y(()=>{f()});var Cz=y((FTt,Pz)=>{f();var mMe=yr().EventEmitter,{nanoid:vMe}=(Zg(),Qg),{WORKER_REQUEST_READ_LOCK:_z,WORKER_RELEASE_READ_LOCK:Ez,MASTER_GRANT_READ_LOCK:Sz,WORKER_REQUEST_WRITE_LOCK:xz,WORKER_RELEASE_WRITE_LOCK:Az,MASTER_GRANT_WRITE_LOCK:Iz}=P4(),yb,Tz=(t,e,r,i,n)=>(s,o)=>{o&&o.type===r&&t.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===i&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},Rz=(t,e,r,i)=>()=>{let n=vMe();return process.send({type:e,identifier:n,name:t}),new Promise(s=>{let o=a=>{a&&a.type===r&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:t})}))};process.on("message",o)})};Pz.exports=t=>{try{if(yb=wz(),!Object.keys(yb).length)return}catch(e){return}if(yb.isMaster||t.singleProcess){let e=new mMe;return yb.on("message",Tz(e,"requestReadLock",_z,Ez,Sz)),yb.on("message",Tz(e,"requestWriteLock",xz,Az,Iz)),e}return{isWorker:!0,readLock:e=>Rz(e,_z,Sz,Ez),writeLock:e=>Rz(e,xz,Iz,Az)}}});var C4=y((KTt,Oz)=>{f();var sl={},gp=t=>{t.addEventListener("message",e=>{gp.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{gp.dispatchEvent("message",t,e)})};gp.addEventListener=(t,e)=>{sl[t]||(sl[t]=[]),sl[t].push(e)};gp.removeEventListener=(t,e)=>{!sl[t]||(sl[t]=sl[t].filter(r=>r===e))};gp.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!sl[e]||sl[e].forEach(r=>r.apply(null,t))};Oz.exports=gp});var jz=y((jTt,Kz)=>{f();var wMe=yr().EventEmitter,{nanoid:_Me}=(Zg(),Qg),{WORKER_REQUEST_READ_LOCK:kz,WORKER_RELEASE_READ_LOCK:qz,MASTER_GRANT_READ_LOCK:Dz,WORKER_REQUEST_WRITE_LOCK:Nz,WORKER_RELEASE_WRITE_LOCK:Bz,MASTER_GRANT_WRITE_LOCK:Mz}=P4(),Lz=C4(),Uz=(t,e,r,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==r)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};t.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let d={type:l.data.type,name:l.data.name,identifier:l.data.identifier};d&&d.type===i&&d.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},Fz=(t,e,r,i)=>()=>{let n=_Me();return globalThis.postMessage({type:e,identifier:n,name:t}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===r&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:t})}))};globalThis.addEventListener("message",o)})},EMe={singleProcess:!1};Kz.exports=t=>{if(t=Object.assign({},EMe,t),!!globalThis.document||t.singleProcess){let r=new wMe;return Lz.addEventListener("message",Uz(r,"requestReadLock",kz,qz,Dz)),Lz.addEventListener("message",Uz(r,"requestWriteLock",Nz,Bz,Mz)),r}return{isWorker:!0,readLock:r=>Fz(r,kz,Dz,qz),writeLock:r=>Fz(r,Nz,Mz,Bz)}}});var Vz=y((zTt,O4)=>{f();"use strict";var m_,VTt=O4.exports.timeout=function(t,e){var r=new m_,i;return Promise.race([t,new Promise(function(n,s){i=setTimeout(function(){s(r)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};m_=O4.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};m_.prototype=Object.create(Error.prototype);m_.prototype.name="TimeoutError"});var D4=y((HTt,q4)=>{f();var SMe=Cz(),xMe=jz(),{default:zz}=$c(),{timeout:AMe}=Vz(),IMe=C4(),Nf={},ol;function k4(t,e){let r,i=new Promise(n=>{r=n});return t.add(()=>AMe((()=>new Promise(n=>{r(()=>{n()})}))(),e.timeout)),i}var TMe=(t,e)=>{if(ol.isWorker)return{readLock:ol.readLock(t,e),writeLock:ol.writeLock(t,e)};let r=new zz({concurrency:1}),i=null;return{readLock:()=>{if(i)return k4(i,e);i=new zz({concurrency:e.concurrency,autoStart:!1});let n=i,s=k4(i,e);return r.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,k4(r,e))}},RMe={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};q4.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},RMe,e),ol||(ol=SMe(e)||xMe(e),ol.isWorker||(ol.on("requestReadLock",(r,i)=>{!Nf[r]||Nf[r].readLock().then(n=>i().finally(()=>n()))}),ol.on("requestWriteLock",async(r,i)=>{!Nf[r]||Nf[r].writeLock().then(n=>i().finally(()=>n()))}))),Nf[t]||(Nf[t]=TMe(t,e)),Nf[t]);q4.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(i){i.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return IMe(r),r}});var v_=y(($Tt,Hz)=>{f();"use strict";async function*PMe(t,e=1){let r=[];e<1&&(e=1);for await(let i of t)for(r.push(i);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length;)yield r.slice(0,e),r=r.slice(e)}Hz.exports=PMe});var w_=y((GTt,$z)=>{f();"use strict";var CMe=v_();async function*OMe(t,e=1){for await(let r of CMe(t,e)){let i=r.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}$z.exports=OMe});var Ar=y((WTt,bp)=>{f();var Gz=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},N4=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),__=t=>t&&typeof t.sink=="function"&&N4(t.source),kMe=t=>e=>(t.sink(e),t.source),Wz=(...t)=>{if(__(t[0])){let e=t[0];t[0]=()=>e.source}else if(N4(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&__(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)__(t[e])&&(t[e]=kMe(t[e]));return Gz(...t)};bp.exports=Wz;bp.exports.pipe=Wz;bp.exports.rawPipe=Gz;bp.exports.isIterable=N4;bp.exports.isDuplex=__});var mp=y((YTt,Yz)=>{f();"use strict";var qMe=ja(),DMe=async function*(...t){let e=qMe();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let i of r)e.push(i)})),e.end()}catch(r){e.end(r)}},0),yield*e};Yz.exports=DMe});var Jz=y((XTt,Zz)=>{f();"use strict";var{CID:NMe}=(Ie(),Ne),gb=me()("ipfs:repo:gc"),{Errors:BMe}=Ut(),MMe=BMe.notFoundError().code,LMe=w_(),{pipe:UMe}=Ar(),Xz=mp(),B4=No(),FMe=Fa(),{Key:KMe}=Ut(),{base32:Qz}=(on(),sn),jMe=I4(),VMe=256,zMe=new KMe("/local/filesroot");Zz.exports=({gcLock:t,pins:e,blockstore:r,root:i,loadCodec:n})=>{async function*s(){let o=Date.now();gb("Creating set of marked blocks");let a=await t.writeLock();try{let c=await HMe({pins:e,blockstore:r,root:i,loadCodec:n}),u=r.queryKeys({});yield*$Me({blockstore:r},c,u),gb(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s};async function HMe({pins:t,blockstore:e,loadCodec:r,root:i}){let n=async function*(){let a;try{a=await i.get(zMe)}catch(u){if(u.code===MMe){gb("No blocks in MFS");return}throw u}let c=NMe.decode(a);yield c,yield*jMe(c,e,r)}(),s=Xz(B4(t.recursiveKeys(),({cid:a})=>a),t.indirectKeys(),B4(t.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of Xz(s,n))o.add(Qz.encode(a.multihash.bytes));return o}async function*$Me({blockstore:t},e,r){let i=0,n=0;yield*UMe(LMe(B4(r,async o=>async function(){i++;try{let c=Qz.encode(o.multihash.bytes);if(e.has(c))return null;try{await t.delete(o),n++}catch(u){return{err:new Error(`Could not delete block with CID ${o}: ${u.message}`)}}return{cid:o}}catch(c){let u=`Could delete block with CID ${o}`;return gb(u,c),{err:new Error(u+`: ${c.message}`)}}}),VMe),o=>FMe(o,Boolean)),gb(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}});var Bf=y((QTt,sH)=>{f();"use strict";var eH=WI(),GMe=me(),vp=ue(),tH=fV(),WMe=pV(),YMe=gr(),E_=gV(),XMe=mV(),QMe=SV(),ZMe=PV(),JMe=OV(),e7e=LV(),t7e=jV(),rH=zV(),Gc=u_(),{PinManager:r7e,PinTypes:i7e}=T4(),n7e=cz(),s7e=D4(),o7e=Jz(),a7e=l_(),c7e=l_(),Gn=GMe("ipfs:repo"),u7e=Number.MAX_SAFE_INTEGER,l7e="repoAutoMigrate",iH=class{constructor(e,r,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof r!="function")throw new Error("missing codec loader");this.options=YMe(t7e,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new r7e({pinstore:o,blockstore:s,loadCodec:r});let a=n7e(this.pins,s);this.blocks=e7e(a),this.version=XMe(this.root),this.config=QMe(this.root),this.spec=ZMe(this.root),this.apiAddr=JMe(this.root),this.gcLock=s7e(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=o7e({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:r})}async init(e){Gn("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(d7e(e)),await this.spec.set(h7e(e)),await this.version.set(E_.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw vp(new Error("repo is already open"),Gc.ERR_REPO_ALREADY_OPEN);Gn("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Gn("acquired repo.lock"),!await this.version.check(E_.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(E_.repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new Gc.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Gn("creating datastore"),await this.datastore.open(),Gn("creating blocks"),this.blocks.open(),Gn("creating keystore"),await this.keys.open(),Gn("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Gn("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(r){Gn("error removing lock",r)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw vp(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Gn("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(r){throw r.code==="ERR_NOT_FOUND"?vp(new Error("repo is not initialized yet"),Gc.ERR_REPO_NOT_INITIALIZED,{path:this.path}):r}if(!e)throw vp(new Error("repo is not initialized yet"),Gc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw vp(new Error("repo is already closed"),Gc.ERR_REPO_ALREADY_CLOSED);Gn("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Gc.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Gn("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,r,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),nH(this.datastore),nH(this.keys)]),o=r.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:r.count,repoSize:o}}throw vp(new Error("repo is not initialized yet"),Gc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(l7e)}catch(r){if(r.code===Gc.NotFoundError.code)e=!0;else throw r}return e}async _migrate(e,r){return await this.version.get()>e?(Gn(`reverting to version ${e}`),tH.revert(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Gn(`migrating to version ${e}`),tH.migrate(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt(WMe(e))}catch(e){return BigInt(u7e)}}async _blockStat(){let e=BigInt(0),r=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),r+=BigInt(n.byteLength),r+=BigInt(i.bytes.byteLength);return{count:e,size:r}}};async function nH(t){let e=BigInt(0);for await(let r of t.query({}))e+=BigInt(r.value.byteLength),e+=BigInt(r.key.uint8Array().byteLength);return e}function f7e(t,e,r,i){return new iH(t,e,r,i)}sH.exports={createRepo:f7e,repoVersion:E_.repoVersion,errors:Gc,utils:{blockstore:A4()},locks:{memory:a7e,fs:c7e},PinTypes:i7e};function d7e(t){return t.Datastore=Object.assign({},rH,eH(t,"datastore")),t}function h7e(t){let e={...rH.Spec,...eH(t,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}});var cH=y((ZTt,aH)=>{f();"use strict";var{resolvePath:p7e}=Ki(),y7e=qe(),{normaliseInput:g7e}=lp(),{PinTypes:oH}=Bf();aH.exports=({repo:t,codecs:e})=>{async function*r(i,n={}){let s=async function*(){for await(let{path:c,recursive:u,metadata:l}of g7e(i)){let{cid:d}=await p7e(t,e,c),{reason:h}=await t.pins.isPinnedWithType(d,[oH.recursive,oH.direct]);if(h==="recursive"&&!u)throw new Error(`${d} already pinned recursively`);u?await t.pins.pinRecursively(d,{metadata:l}):await t.pins.pinDirectly(d,{metadata:l}),yield d}};if(!Boolean(n.lock)){yield*s();return}let a=await t.gcLock.readLock();try{yield*s()}finally{a()}}return y7e(r)}});var fH=y((JTt,lH)=>{f();"use strict";var{PinTypes:Wn}=Bf(),{normaliseInput:b7e}=lp(),{resolvePath:m7e}=Ki(),v7e=qe(),uH=ue();function bb(t,e,r){let i={type:t,cid:e};return r&&(i.metadata=r),i}lH.exports=({repo:t,codecs:e})=>{async function*r(i={}){let n=Wn.all;if(i.type&&(n=i.type,!Object.keys(Wn).includes(n)))throw uH(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of b7e(i.paths)){let{cid:a}=await m7e(t,e,o),{reason:c,pinned:u,parent:l,metadata:d}=await t.pins.isPinnedWithType(a,n);if(!u)throw uH(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case Wn.direct:case Wn.recursive:s=!0,yield bb(c,a,d);break;default:s=!0,yield bb(`${Wn.indirect} through ${l}`,a,d)}}if(!s)throw new Error("No match found");return}if(n===Wn.recursive||n===Wn.all)for await(let{cid:s,metadata:o}of t.pins.recursiveKeys())yield bb(Wn.recursive,s,o);if(n===Wn.indirect||n===Wn.all)for await(let s of t.pins.indirectKeys(i))yield bb(Wn.indirect,s);if(n===Wn.direct||n===Wn.all)for await(let{cid:s,metadata:o}of t.pins.directKeys())yield bb(Wn.direct,s,o)}return v7e(r)}});var hH=y((e5t,dH)=>{f();"use strict";var w7e=$n();dH.exports=({rmAll:t})=>(e,r={})=>w7e(t([{path:e,...r}],r))});var yH=y((t5t,pH)=>{f();"use strict";var{normaliseInput:_7e}=lp(),{resolvePath:E7e}=Ki(),S7e=qe(),{PinTypes:M4}=Bf();pH.exports=({repo:t,codecs:e})=>{async function*r(i,n={}){let s=await t.gcLock.readLock();try{for await(let{path:o,recursive:a}of _7e(i)){let{cid:c}=await E7e(t,e,o),{pinned:u,reason:l}=await t.pins.isPinnedWithType(c,M4.all);if(!u)throw new Error(`${c} is not pinned`);switch(l){case M4.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await t.pins.unpin(c),yield c;break;case M4.direct:await t.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${l}`)}}}finally{s()}}return S7e(r)}});var mH=y((r5t,bH)=>{f();"use strict";var x7e=fj(),A7e=cH(),I7e=fH(),T7e=hH(),R7e=yH(),gH=class{constructor({codecs:e,repo:r}){let i=A7e({codecs:e,repo:r});this.addAll=i,this.add=x7e({addAll:i});let n=R7e({codecs:e,repo:r});this.rmAll=n,this.rm=T7e({rmAll:n}),this.ls=I7e({codecs:e,repo:r}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};bH.exports=gH});var vH=y((n5t,L4)=>{f();var i5t=function(){typeof L4!="undefined"&&(L4.exports=v);var t=24*3600,e=3200,r=(365*400+97)*e/400,i=t*r,n=i*1e3,s=1e3*1e4*1e4*t,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,l="000000000",d=Math.trunc||M,h=v.prototype;v.fromDate=Y,v.fromInt64BE=W(0,1,2,3,0,4),v.fromInt64LE=W(3,2,1,0,4,0),v.fromString=G,v.fromTimeT=P,h.year=0,h.time=0,h.nano=0,h.addNano=D,h.getNano=z,h.getTimeT=w,h.getYear=A,h.toDate=F,h.toJSON=S,h.toString=C,h.writeInt64BE=B(0,1,2,3,0,4),h.writeInt64LE=B(3,2,1,0,4,0);var p="%Y-%m-%dT%H:%M:%S.%NZ",g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return v;function v(X,ne,oe){var he=this;if(!(he instanceof v))return new v(X,ne,oe);he.time=+X||0,he.nano=+ne||0,he.year=+oe||0,R(he)}function A(){var X=this.toDate().getUTCFullYear();return X+this.year}function R(X){var ne=X.year,oe=X.time,he=X.nano,pe,_e;if(he<0||c<=he){var k=Math.floor(he/c);he-=k*c,oe+=k,pe=1}var K=ne%e;if(oe<-s||s<oe||K){_e=d(oe/n),_e&&(ne+=_e*e,oe-=_e*n);var $=q(oe);$.setUTCFullYear(K+$.getUTCFullYear()),ne-=K,oe=+$,_e=d(ne/e);var Z=oe+_e*n;_e&&-s<=Z&&Z<=s&&(ne-=_e*e,oe=Z),pe=1}return pe&&(X.year=ne,X.time=oe,X.nano=he),X}function F(){var X=R(this);return q(X.time)}function q(X){var ne=new Date(0);return ne.setTime(X),ne}function D(X){return this.nano+=+X||0,this}function z(){var X=R(this);return(X.time%1e3*c+ +X.nano+u)%u}function G(X){var ne,oe=new v;X+="";var he=X.replace(/^\s*[+\-]?\d+/,function(pe){var _e=+pe,k=1970+(_e-1970)%400;return oe.year=_e-k,k}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(pe,_e,k){return _e<0&&(k*=-1),ne=(+_e*60+ +k)*6e4,""}).replace(/\.\d+$/,function(pe){return oe.nano=+(pe+l).substr(1,9),""}).split(/\D+/);if(he.length>1?he[1]--:he[1]=0,oe.time=ne=Date.UTC.apply(Date,he)-(ne||0),isNaN(ne))throw new TypeError("Invalid Date");return R(oe)}function Y(X){return new v(+X)}function P(X){return b(X,0)}function b(X,ne){ne|=0,ne*=a,X=+X||0;var oe=d(ne/i)+d(X/i),he=ne%i+X%i,pe=d(he/i);return pe&&(oe+=pe,he-=pe*i),new v(he*1e3,0,oe*e)}function w(){var X=R(this),ne=Math.floor(X.time/1e3),oe=X.year;return oe&&(ne+=oe*r*t/e),ne}function S(){return this.toString().replace(/0{1,6}Z$/,"Z")}function C(X){var ne=this,oe=ne.toDate(),he={H:Z,L:V,M:I,N,S:U,Y:_e,a:Q,b:ee,d:K,e:$,m:k};return pe(X||p);function pe(J){return J.replace(/%./g,function(ce){var ge=ce[1],be=E[ge],je=he[ge];return be?pe(be):je?je():ce})}function _e(){var J=ne.getYear();return J>999999?"+"+J:J>9999?"+"+ae(J,6):J>=0?ae(J,4):J>=-999999?"-"+ae(-J,6):J}function k(){return L(oe.getUTCMonth()+1)}function K(){return L(oe.getUTCDate())}function $(){return _(oe.getUTCDate())}function Z(){return L(oe.getUTCHours())}function I(){return L(oe.getUTCMinutes())}function U(){return L(oe.getUTCSeconds())}function V(){return ae(oe.getUTCMilliseconds(),3)}function N(){return ae(ne.getNano(),9)}function Q(){return m[oe.getUTCDay()]}function ee(){return g[oe.getUTCMonth()]}}function B(X,ne,oe,he,pe,_e){return k;function k($,Z){var I=R(this);$||($=new Array(8)),j($,Z|=0);var U=Math.floor(I.time/1e3),V=I.year*(r*t/e),N=d(V/a)+d(U/a),Q=V%a+U%a,ee=Math.floor(Q/a);return ee&&(N+=ee,Q-=ee*a),K($,Z+pe,N),K($,Z+_e,Q),$}function K($,Z,I){$[Z+X]=I>>24&255,$[Z+ne]=I>>16&255,$[Z+oe]=I>>8&255,$[Z+he]=I&255}}function W(X,ne,oe,he,pe,_e){return k;function k($,Z){j($,Z|=0);var I=K($,Z+pe),U=K($,Z+_e);return b(U,I)}function K($,Z){return $[Z+X]*o+($[Z+ne]<<16|$[Z+oe]<<8|$[Z+he])}}function j(X,ne){var oe=X&&X.length;if(oe==null)throw new TypeError("Invalid Buffer");if(oe<ne+8)throw new RangeError("Out of range")}function M(X){var ne=X-X%1;return ne===0&&(X<0||X===0&&1/X!=1/0)?-0:ne}function _(X){return(X>9?"":" ")+(X|0)}function L(X){return(X>9?"":"0")+(X|0)}function ae(X,ne){return(l+(X|0)).substr(-ne)}}()});var CH=y((s5t,PH)=>{f();PH.exports=ar;var Ks=null;try{Ks=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function ar(t,e,r){this.low=t|0,this.high=e|0,this.unsigned=!!r}ar.prototype.__isLong__;Object.defineProperty(ar.prototype,"__isLong__",{value:!0});function Yn(t){return(t&&t.__isLong__)===!0}ar.isLong=Yn;var wH={},_H={};function Mf(t,e){var r,i,n;return e?(t>>>=0,(n=0<=t&&t<256)&&(i=_H[t],i)?i:(r=cr(t,(t|0)<0?-1:0,!0),n&&(_H[t]=r),r)):(t|=0,(n=-128<=t&&t<128)&&(i=wH[t],i)?i:(r=cr(t,t<0?-1:0,!1),n&&(wH[t]=r),r))}ar.fromInt=Mf;function js(t,e){if(isNaN(t))return e?Lf:Vs;if(e){if(t<0)return Lf;if(t>=SH)return RH}else{if(t<=-xH)return Xn;if(t+1>=xH)return TH}return t<0?js(-t,e).neg():cr(t%wp|0,t/wp|0,e)}ar.fromNumber=js;function cr(t,e,r){return new ar(t,e,r)}ar.fromBits=cr;var S_=Math.pow;function U4(t,e,r){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Vs;if(typeof e=="number"?(r=e,e=!1):e=!!e,r=r||10,r<2||36<r)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return U4(t.substring(1),e,r).neg();for(var n=js(S_(r,8)),s=Vs,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),r);if(a<8){var u=js(S_(r,a));s=s.mul(u).add(js(c))}else s=s.mul(n),s=s.add(js(c))}return s.unsigned=e,s}ar.fromString=U4;function Bo(t,e){return typeof t=="number"?js(t,e):typeof t=="string"?U4(t,e):cr(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}ar.fromValue=Bo;var EH=1<<16,P7e=1<<24,wp=EH*EH,SH=wp*wp,xH=SH/2,AH=Mf(P7e),Vs=Mf(0);ar.ZERO=Vs;var Lf=Mf(0,!0);ar.UZERO=Lf;var _p=Mf(1);ar.ONE=_p;var IH=Mf(1,!0);ar.UONE=IH;var F4=Mf(-1);ar.NEG_ONE=F4;var TH=cr(4294967295|0,2147483647|0,!1);ar.MAX_VALUE=TH;var RH=cr(4294967295|0,4294967295|0,!0);ar.MAX_UNSIGNED_VALUE=RH;var Xn=cr(0,2147483648|0,!1);ar.MIN_VALUE=Xn;var Pe=ar.prototype;Pe.toInt=function(){return this.unsigned?this.low>>>0:this.low};Pe.toNumber=function(){return this.unsigned?(this.high>>>0)*wp+(this.low>>>0):this.high*wp+(this.low>>>0)};Pe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Xn)){var r=js(e),i=this.div(r),n=i.mul(r).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=js(S_(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,l=u.toString(e);if(o=c,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Pe.getHighBits=function(){return this.high};Pe.getHighBitsUnsigned=function(){return this.high>>>0};Pe.getLowBits=function(){return this.low};Pe.getLowBitsUnsigned=function(){return this.low>>>0};Pe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Xn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,r=31;r>0&&(e&1<<r)==0;r--);return this.high!=0?r+33:r+1};Pe.isZero=function(){return this.high===0&&this.low===0};Pe.eqz=Pe.isZero;Pe.isNegative=function(){return!this.unsigned&&this.high<0};Pe.isPositive=function(){return this.unsigned||this.high>=0};Pe.isOdd=function(){return(this.low&1)==1};Pe.isEven=function(){return(this.low&1)==0};Pe.equals=function(e){return Yn(e)||(e=Bo(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Pe.eq=Pe.equals;Pe.notEquals=function(e){return!this.eq(e)};Pe.neq=Pe.notEquals;Pe.ne=Pe.notEquals;Pe.lessThan=function(e){return this.comp(e)<0};Pe.lt=Pe.lessThan;Pe.lessThanOrEqual=function(e){return this.comp(e)<=0};Pe.lte=Pe.lessThanOrEqual;Pe.le=Pe.lessThanOrEqual;Pe.greaterThan=function(e){return this.comp(e)>0};Pe.gt=Pe.greaterThan;Pe.greaterThanOrEqual=function(e){return this.comp(e)>=0};Pe.gte=Pe.greaterThanOrEqual;Pe.ge=Pe.greaterThanOrEqual;Pe.compare=function(e){if(Yn(e)||(e=Bo(e)),this.eq(e))return 0;var r=this.isNegative(),i=e.isNegative();return r&&!i?-1:!r&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Pe.comp=Pe.compare;Pe.negate=function(){return!this.unsigned&&this.eq(Xn)?Xn:this.not().add(_p)};Pe.neg=Pe.negate;Pe.add=function(e){Yn(e)||(e=Bo(e));var r=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,l=0,d=0,h=0,p=0;return p+=s+u,h+=p>>>16,p&=65535,h+=n+c,d+=h>>>16,h&=65535,d+=i+a,l+=d>>>16,d&=65535,l+=r+o,l&=65535,cr(h<<16|p,l<<16|d,this.unsigned)};Pe.subtract=function(e){return Yn(e)||(e=Bo(e)),this.add(e.neg())};Pe.sub=Pe.subtract;Pe.multiply=function(e){if(this.isZero())return Vs;if(Yn(e)||(e=Bo(e)),Ks){var r=Ks.mul(this.low,this.high,e.low,e.high);return cr(r,Ks.get_high(),this.unsigned)}if(e.isZero())return Vs;if(this.eq(Xn))return e.isOdd()?Xn:Vs;if(e.eq(Xn))return this.isOdd()?Xn:Vs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(AH)&&e.lt(AH))return js(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,l=e.low&65535,d=0,h=0,p=0,g=0;return g+=o*l,p+=g>>>16,g&=65535,p+=s*l,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=n*l,d+=h>>>16,h&=65535,h+=s*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=i*l+n*u+s*c+o*a,d&=65535,cr(p<<16|g,d<<16|h,this.unsigned)};Pe.mul=Pe.multiply;Pe.divide=function(e){if(Yn(e)||(e=Bo(e)),e.isZero())throw Error("division by zero");if(Ks){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var r=(this.unsigned?Ks.div_u:Ks.div_s)(this.low,this.high,e.low,e.high);return cr(r,Ks.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Lf:Vs;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Lf;if(e.gt(this.shru(1)))return IH;s=Lf}else{if(this.eq(Xn)){if(e.eq(_p)||e.eq(F4))return Xn;if(e.eq(Xn))return _p;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(Vs)?e.isNegative()?_p:F4:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(Xn))return this.unsigned?Lf:Vs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Vs}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:S_(2,a-48),u=js(i),l=u.mul(e);l.isNegative()||l.gt(n);)i-=c,u=js(i,this.unsigned),l=u.mul(e);u.isZero()&&(u=_p),s=s.add(u),n=n.sub(l)}return s};Pe.div=Pe.divide;Pe.modulo=function(e){if(Yn(e)||(e=Bo(e)),Ks){var r=(this.unsigned?Ks.rem_u:Ks.rem_s)(this.low,this.high,e.low,e.high);return cr(r,Ks.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Pe.mod=Pe.modulo;Pe.rem=Pe.modulo;Pe.not=function(){return cr(~this.low,~this.high,this.unsigned)};Pe.and=function(e){return Yn(e)||(e=Bo(e)),cr(this.low&e.low,this.high&e.high,this.unsigned)};Pe.or=function(e){return Yn(e)||(e=Bo(e)),cr(this.low|e.low,this.high|e.high,this.unsigned)};Pe.xor=function(e){return Yn(e)||(e=Bo(e)),cr(this.low^e.low,this.high^e.high,this.unsigned)};Pe.shiftLeft=function(e){return Yn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?cr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):cr(0,this.low<<e-32,this.unsigned)};Pe.shl=Pe.shiftLeft;Pe.shiftRight=function(e){return Yn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?cr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):cr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Pe.shr=Pe.shiftRight;Pe.shiftRightUnsigned=function(e){if(Yn(e)&&(e=e.toInt()),e&=63,e===0)return this;var r=this.high;if(e<32){var i=this.low;return cr(i>>>e|r<<32-e,r>>>e,this.unsigned)}else return e===32?cr(r,0,this.unsigned):cr(r>>>e-32,0,this.unsigned)};Pe.shru=Pe.shiftRightUnsigned;Pe.shr_u=Pe.shiftRightUnsigned;Pe.toSigned=function(){return this.unsigned?cr(this.low,this.high,!1):this};Pe.toUnsigned=function(){return this.unsigned?this:cr(this.low,this.high,!0)};Pe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Pe.toBytesLE=function(){var e=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Pe.toBytesBE=function(){var e=this.high,r=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,r>>>24,r>>>16&255,r>>>8&255,r&255]};ar.fromBytes=function(e,r,i){return i?ar.fromBytesLE(e,r):ar.fromBytesBE(e,r)};ar.fromBytesLE=function(e,r){return new ar(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)};ar.fromBytesBE=function(e,r){return new ar(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)}});var qH=y((o5t,kH)=>{f();"use strict";var Ep=ki(),OH=Ep.Reader,C7e=Ep.Writer,Ye=Ep.util,Sp=Ep.roots["ipfs-ipns"]||(Ep.roots["ipfs-ipns"]={});Sp.IpnsEntry=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.value=Ye.newBuffer([]),t.prototype.signature=Ye.newBuffer([]),t.prototype.validityType=0,t.prototype.validity=Ye.newBuffer([]),t.prototype.sequence=Ye.Long?Ye.Long.fromBits(0,0,!0):0,t.prototype.ttl=Ye.Long?Ye.Long.fromBits(0,0,!0):0,t.prototype.pubKey=Ye.newBuffer([]),t.prototype.signatureV2=Ye.newBuffer([]),t.prototype.data=Ye.newBuffer([]),t.encode=function(r,i){return i||(i=C7e.create()),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(10).bytes(r.value),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(18).bytes(r.signature),r.validityType!=null&&Object.hasOwnProperty.call(r,"validityType")&&i.uint32(24).int32(r.validityType),r.validity!=null&&Object.hasOwnProperty.call(r,"validity")&&i.uint32(34).bytes(r.validity),r.sequence!=null&&Object.hasOwnProperty.call(r,"sequence")&&i.uint32(40).uint64(r.sequence),r.ttl!=null&&Object.hasOwnProperty.call(r,"ttl")&&i.uint32(48).uint64(r.ttl),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(58).bytes(r.pubKey),r.signatureV2!=null&&Object.hasOwnProperty.call(r,"signatureV2")&&i.uint32(66).bytes(r.signatureV2),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&i.uint32(74).bytes(r.data),i},t.decode=function(r,i){r instanceof OH||(r=OH.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Sp.IpnsEntry;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.value=r.bytes();break;case 2:s.signature=r.bytes();break;case 3:s.validityType=r.int32();break;case 4:s.validity=r.bytes();break;case 5:s.sequence=r.uint64();break;case 6:s.ttl=r.uint64();break;case 7:s.pubKey=r.bytes();break;case 8:s.signatureV2=r.bytes();break;case 9:s.data=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Sp.IpnsEntry)return r;var i=new Sp.IpnsEntry;switch(r.value!=null&&(typeof r.value=="string"?Ye.base64.decode(r.value,i.value=Ye.newBuffer(Ye.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),r.signature!=null&&(typeof r.signature=="string"?Ye.base64.decode(r.signature,i.signature=Ye.newBuffer(Ye.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),r.validityType){case"EOL":case 0:i.validityType=0;break}return r.validity!=null&&(typeof r.validity=="string"?Ye.base64.decode(r.validity,i.validity=Ye.newBuffer(Ye.base64.length(r.validity)),0):r.validity.length&&(i.validity=r.validity)),r.sequence!=null&&(Ye.Long?(i.sequence=Ye.Long.fromValue(r.sequence)).unsigned=!0:typeof r.sequence=="string"?i.sequence=parseInt(r.sequence,10):typeof r.sequence=="number"?i.sequence=r.sequence:typeof r.sequence=="object"&&(i.sequence=new Ye.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0))),r.ttl!=null&&(Ye.Long?(i.ttl=Ye.Long.fromValue(r.ttl)).unsigned=!0:typeof r.ttl=="string"?i.ttl=parseInt(r.ttl,10):typeof r.ttl=="number"?i.ttl=r.ttl:typeof r.ttl=="object"&&(i.ttl=new Ye.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0))),r.pubKey!=null&&(typeof r.pubKey=="string"?Ye.base64.decode(r.pubKey,i.pubKey=Ye.newBuffer(Ye.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.signatureV2!=null&&(typeof r.signatureV2=="string"?Ye.base64.decode(r.signatureV2,i.signatureV2=Ye.newBuffer(Ye.base64.length(r.signatureV2)),0):r.signatureV2.length&&(i.signatureV2=r.signatureV2)),r.data!=null&&(typeof r.data=="string"?Ye.base64.decode(r.data,i.data=Ye.newBuffer(Ye.base64.length(r.data)),0):r.data.length&&(i.data=r.data)),i},t.toObject=function(r,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Ye.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Ye.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=Ye.newBuffer(n.validity))),Ye.Long){var s=new Ye.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(Ye.Long){var s=new Ye.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Ye.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=Ye.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=Ye.newBuffer(n.data)))}return r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?Ye.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Ye.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),r.validityType!=null&&r.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?Sp.IpnsEntry.ValidityType[r.validityType]:r.validityType),r.validity!=null&&r.hasOwnProperty("validity")&&(n.validity=i.bytes===String?Ye.base64.encode(r.validity,0,r.validity.length):i.bytes===Array?Array.prototype.slice.call(r.validity):r.validity),r.sequence!=null&&r.hasOwnProperty("sequence")&&(typeof r.sequence=="number"?n.sequence=i.longs===String?String(r.sequence):r.sequence:n.sequence=i.longs===String?Ye.Long.prototype.toString.call(r.sequence):i.longs===Number?new Ye.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0):r.sequence),r.ttl!=null&&r.hasOwnProperty("ttl")&&(typeof r.ttl=="number"?n.ttl=i.longs===String?String(r.ttl):r.ttl:n.ttl=i.longs===String?Ye.Long.prototype.toString.call(r.ttl):i.longs===Number?new Ye.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0):r.ttl),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Ye.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.signatureV2!=null&&r.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?Ye.base64.encode(r.signatureV2,0,r.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(r.signatureV2):r.signatureV2),r.data!=null&&r.hasOwnProperty("data")&&(n.data=i.bytes===String?Ye.base64.encode(r.data,0,r.data.length):i.bytes===Array?Array.prototype.slice.call(r.data):r.data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ep.util.toJSONOptions)},t.ValidityType=function(){var e={},r=Object.create(e);return r[e[0]="EOL"]=0,r}(),t}();kH.exports=Sp});var DH=y((a5t,K4)=>{f();"use strict";K4.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${i}T${n}:${s}:${o}.${c}Z`};K4.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let i=parseInt(r[1],10),n=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var NH=y(Mo=>{f();"use strict";Mo.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD";Mo.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY";Mo.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION";Mo.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION";Mo.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT";Mo.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY";Mo.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID";Mo.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER";Mo.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA";Mo.ERR_INVALID_EMBEDDED_KEY="ERR_INVALID_EMBEDDED_KEY"});var Tp=y((u5t,GH)=>{f();"use strict";var BH=vH(),{Key:mb}=Ut(),j4=Na(),V4=rt(),O7e=(xn(),Ln),{identity:k7e}=(Cc(),Pc),ji=ue(),{base32upper:q7e}=(on(),sn),{fromString:xp}=(ft(),ht),{toString:z4}=(tt(),et),{concat:Ap}=(un(),cn),{equals:MH}=(di(),fi),LH=(zg(),Yw),UH=CH(),FH=me(),ps=Object.assign(FH("jsipns"),{error:FH("jsipns:error")}),{IpnsEntry:Ip}=qH(),{parseRFC3339:H4}=DH(),Vi=NH(),D7e=k7e.code,KH="/ipns/",N7e=xp("/ipns/"),B7e=(t,e,r,i)=>{let n=new BH(Date.now()+Number(i)),s=Ip.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*100000n+BigInt(a||0);return jH(t,e,r,s,n,c)},M7e=(t,e,r,i)=>{let n=BH.fromString(i),s=Ip.ValidityType.EOL,o=n.toDate().getTime()-Date.now(),a=BigInt(o)*100000n+BigInt(n.getNano());return jH(t,e,r,s,n,a)},jH=async(t,e,r,i,n,s)=>{r=BigInt(r);let o=xp(n.toString()),a=await V7e(t,e,i,o),c=L7e(e,o,i,r,s),u=$H(c),l=await t.sign(u),d={value:e,signature:a,validityType:i,validity:o,sequence:r,ttl:s,signatureV2:l,data:c};return ps(`ipns entry for ${e} created`),d},L7e=(t,e,r,i,n)=>{let s={Value:t,Validity:e,ValidityType:r,Sequence:i,TTL:n};return LH.encode(s)},VH=async(t,e)=>{let{value:r,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=$H(e.data),U7e(e)):(o=e.signature,s=HH(r,i,n));let a;try{a=await t.verify(s,o)}catch(c){a=!1}if(!a)throw ps.error("record signature verification failed"),ji(new Error("record signature verification failed"),Vi.ERR_SIGNATURE_VERIFICATION);if(i===Ip.ValidityType.EOL){let c;try{c=H4(z4(n))}catch(u){throw ps.error("unrecognized validity format (not an rfc3339 format)"),ji(new Error("unrecognized validity format (not an rfc3339 format)"),Vi.ERR_UNRECOGNIZED_FORMAT)}if(c.getTime()<Date.now())throw ps.error("record has expired"),ji(new Error("record has expired"),Vi.ERR_IPNS_EXPIRED_RECORD)}else if(i)throw ps.error("unrecognized validity type"),ji(new Error("unrecognized validity type"),Vi.ERR_UNRECOGNIZED_VALIDITY);ps(`ipns entry for ${r} is valid`)},U7e=t=>{if(!t.data)throw ji(new Error("Record data is missing"),Vi.ERR_INVALID_RECORD_DATA);let e=LH.decode(t.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!MH(e.Value,t.value))throw ji(new Error('Field "value" did not match between protobuf and CBOR'),Vi.ERR_SIGNATURE_VERIFICATION);if(!MH(e.Validity,t.validity))throw ji(new Error('Field "validity" did not match between protobuf and CBOR'),Vi.ERR_SIGNATURE_VERIFICATION);if(e.ValidityType!==t.validityType)throw ji(new Error('Field "validityType" did not match between protobuf and CBOR'),Vi.ERR_SIGNATURE_VERIFICATION);if(e.Sequence!==t.sequence)throw ji(new Error('Field "sequence" did not match between protobuf and CBOR'),Vi.ERR_SIGNATURE_VERIFICATION);if(e.TTL!==t.ttl)throw ji(new Error('Field "ttl" did not match between protobuf and CBOR'),Vi.ERR_SIGNATURE_VERIFICATION)},F7e=async(t,e)=>{if(!t||!t.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw ps.error(n),ji(n,Vi.ERR_UNDEFINED_PARAMETER)}let r;try{r=await V4.createFromPubKey(t.bytes)}catch(n){throw ji(n,Vi.ERR_PEER_ID_FROM_PUBLIC_KEY)}let i;try{i=H7e(r)}catch(n){throw ps.error(n),ji(n,Vi.ERR_PUBLIC_KEY_FROM_ID)}if(i)return null;try{e.pubKey=j4.keys.marshalPublicKey(t)}catch(n){throw ps.error(n),n}return e},zH=async(t,e)=>{if(!e||!t){let i=new Error("one or more of the provided parameters are not defined");throw ps.error(i),ji(i,Vi.ERR_UNDEFINED_PARAMETER)}let r;if(e.pubKey){try{r=j4.keys.unmarshalPublicKey(e.pubKey)}catch(n){throw ps.error(n),n}if(!(await V4.createFromPubKey(e.pubKey)).equals(t))throw ji(new Error("Embedded public key did not match PeerID"),Vi.ERR_INVALID_EMBEDDED_KEY)}else t.pubKey&&(r=t.pubKey);if(r)return r;throw ji(new Error("no public key is available"),Vi.ERR_UNDEFINED_PARAMETER)},$4=t=>q7e.encode(t).slice(1),K7e=t=>new mb(`/ipns/${$4(t)}`),j7e=t=>{let e=xp("/pk/"),r=xp("/ipns/");return{routingPubKey:new mb(Ap([e,t]),!1),pkKey:new mb($4(Ap([e,t]))),routingKey:new mb(Ap([r,t]),!1),ipnsKey:new mb($4(Ap([r,t])))}},V7e=(t,e,r,i)=>{try{let n=HH(e,r,i);return t.sign(n)}catch(n){throw ps.error("record signature creation failed"),ji(new Error("record signature creation failed: "+n.message),Vi.ERR_SIGNATURE_CREATION)}},z7e=t=>{if(t.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${t.toString()}`);throw ps.error(e),ji(e,Vi.ERR_UNRECOGNIZED_VALIDITY)},HH=(t,e,r)=>{let i=xp(z7e(e));return Ap([t,r,i])},$H=t=>{let e=xp("ipns-signature:");return Ap([e,t])},H7e=t=>{let e=O7e.decode(t.id);return e.code!==D7e?null:j4.keys.unmarshalPublicKey(e.digest)},$7e=t=>Ip.encode({...t,sequence:UH.fromString(t.sequence.toString()),ttl:t.ttl==null?void 0:UH.fromString(t.ttl.toString())}).finish(),x_=t=>{let e=Ip.decode(t),r=Ip.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:r.value,signature:r.signature,validityType:r.validityType,validity:r.validity,sequence:Object.hasOwnProperty.call(r,"sequence")?BigInt(`${r.sequence}`):0n,pubKey:r.pubKey,ttl:Object.hasOwnProperty.call(r,"ttl")?BigInt(`${r.ttl}`):void 0,signatureV2:r.signatureV2,data:r.data}},G7e={validate:async(t,e)=>{let r=x_(t),i=e.slice(N7e.length),n=V4.createFromBytes(i),s=await zH(n,r);await VH(s,r)},select:(t,e)=>{let r=x_(t),i=x_(e);if(r.signatureV2&&!i.signatureV2)return 0;if(i.signatureV2&&!r.signatureV2)return 1;if(r.sequence>i.sequence)return 0;if(r.sequence<i.sequence)return 1;let n=H4(z4(r.validity));return H4(z4(i.validity)).getTime()>n.getTime()?1:0}};GH.exports={create:B7e,createWithExpiration:M7e,validate:VH,embedPublicKey:F7e,extractPublicKey:zH,getLocalKey:K7e,getIdKeys:j7e,marshal:$7e,unmarshal:x_,validator:G7e,namespace:KH,namespaceLength:KH.length}});var e$=y((ZH,JH)=>{f();"use strict";var A_=rt(),{Key:WH,Errors:W7e}=Ut(),Pn=ue(),YH=me(),_i=Object.assign(YH("ipfs:ipns:publisher"),{error:YH("ipfs:ipns:publisher:error")}),{toString:vb}=(tt(),et),{equals:Y7e}=(di(),fi),Wc=Tp(),XH=W7e.notFoundError().code,QH=60*60*1e3,G4=class{constructor(e,r){this._routing=e,this._datastore=r}async publishWithEOL(e,r,i){if(!e||!e.bytes)throw Pn(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await A_.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,r,i,n);return this._putRecordToRouting(s,n)}publish(e,r){return this.publishWithEOL(e,r,QH)}async _putRecordToRouting(e,r){if(!A_.isPeerId(r)){let o="peerId received is not valid";throw _i.error(o),Pn(new Error(o),"ERR_INVALID_PEER_ID")}let i=r._pubKey,n=await Wc.embedPublicKey(i,e),s=Wc.getIdKeys(r.toBytes());return await this._publishEntry(s.routingKey,n||e),await this._publishPublicKey(s.routingPubKey,i),n||e}async _publishEntry(e,r){if(!(e instanceof WH)){let n="datastore key does not have a valid format";throw _i.error(n),Pn(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=Wc.marshal(r)}catch(n){throw _i.error(n),n}try{let n=await this._routing.put(e.uint8Array(),i);return _i(`ipns record for ${vb(e.uint8Array(),"base64")} was stored in the routing`),n}catch(n){let s=`ipns record for ${vb(e.uint8Array(),"base64")} could not be stored in the routing`;throw _i.error(s),_i.error(n),Pn(new Error(s),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,r){if(!(e instanceof WH)){let i="datastore key does not have a valid format";throw _i.error(i),Pn(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!r||!r.bytes){let i="one or more of the provided parameters are not defined";throw _i.error(i),Pn(new Error(i),"ERR_UNDEFINED_PARAMETER")}try{let i=await this._routing.put(e.uint8Array(),r.bytes);return _i(`public key for ${vb(e.uint8Array(),"base64")} was stored in the routing`),i}catch(i){let n=`public key for ${vb(e.uint8Array(),"base64")} could not be stored in the routing`;throw _i.error(n),_i.error(i),Pn(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,r={}){if(!A_.isPeerId(e)){let n="peerId received is not valid";throw _i.error(n),Pn(new Error(n),"ERR_INVALID_PEER_ID")}let i=r.checkRouting!==!1;try{let n=await this._datastore.get(Wc.getLocalKey(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==XH){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw _i.error(s),Pn(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw Pn(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=Wc.getIdKeys(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw _i.error(s),s}}}_unmarshalData(e){try{return Wc.unmarshal(e)}catch(r){throw Pn(r,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,r,i,n){if(!A_.isPeerId(n)){let u="peerId received is not valid";throw _i.error(u),Pn(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(u){if(u.code!==XH){let l=`unexpected error when determining the last published IPNS record for ${n.id} ${u.stack}`;throw _i.error(l),Pn(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=Y7e(o.value,r)?BigInt(o.sequence):BigInt(o.sequence)+1n);let c;try{c=await Wc.create(e,r,a,i)}catch(u){let l=`ipns record for ${r} could not be created`;throw _i.error(u),Pn(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let u=Wc.marshal(c);return await this._datastore.put(Wc.getLocalKey(n.id),u),_i(`ipns record for ${vb(r,"base32")} was stored in the datastore`),c}catch(u){let l=`ipns record for ${r} could not be stored in the datastore`;throw _i.error(l),Pn(new Error(l),"ERR_STORING_IN_DATASTORE")}}};G4.defaultRecordLifetime=QH;ZH=JH.exports=G4});var u$=y((a$,c$)=>{f();"use strict";var t$=Tp(),X7e=Na(),r$=rt(),Uf=ue(),i$=me(),I_=Object.assign(i$("ipfs:ipns:republisher"),{error:i$("ipfs:ipns:republisher:error")}),n$=60*1e3,s$=60*n$,Q7e=4*s$,Z7e=24*s$,o$=class{constructor(e,r,i,n,s={pass:""}){this._publisher=e,this._datastore=r,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw Uf(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){I_.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:r}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(r,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||n$):this._options.broadcastInterval||Q7e),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw Uf(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,r){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";I_.error(n);return}if(r)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,r),o=await X7e.keys.import(s,r);await this._republishEntry(o)}}catch(i){I_.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw Uf(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let r=await r$.createFromPrivKey(e.bytes),i=await this._getPreviousValue(r);await this._publisher.publishWithEOL(e,i,Z7e)}catch(r){if(r.code==="ERR_NO_ENTRY_FOUND")return;throw r}}async _getPreviousValue(e){if(!r$.isPeerId(e))throw Uf(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let r=await this._datastore.get(t$.getLocalKey(e.id));if(!(r instanceof Uint8Array))throw Uf(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return t$.unmarshal(r).value}catch(i){throw I_.error(i),Uf(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(r){throw r&&r.notFound?Uf(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):r}}};a$=c$.exports=o$});var y$=y((h$,p$)=>{f();"use strict";var T_=Tp(),J7e=rt(),Rp=ue(),l$=me(),R_=Object.assign(l$("ipfs:ipns:resolver"),{error:l$("ipfs:ipns:resolver:error")}),{toString:eLe}=(tt(),et),{Errors:tLe}=Ut(),rLe=tLe.notFoundError().code,f$=32,d$=class{constructor(e){this._routing=e}async resolve(e,r={}){if(typeof e!="string")throw Rp(new Error("invalid name"),"ERR_INVALID_NAME");let i=r.recursive&&r.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw Rp(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=f$);let a=await this.resolver(s,o);return R_(`${e} was locally resolved correctly`),a}async resolver(e,r){if(r===0){let s=`could not resolve name (recursion limit of ${f$} exceeded)`;throw R_.error(s),Rp(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!r?i:this.resolver(n[2],r-1)}async _resolveName(e){let r=J7e.parse(e),{routingKey:i}=T_.getIdKeys(r.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw R_.error("could not get record from routing",o),o.code===rLe?Rp(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):Rp(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=T_.unmarshal(n)}catch(o){throw R_.error("could not unmarshal record",o),Rp(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(r,s)}async _validateRecord(e,r){let i=await T_.extractPublicKey(e,r);return await T_.validate(i,r),eLe(r.value)}};h$=p$.exports=d$});var _$=y((l5t,w$)=>{f();"use strict";var{createFromPrivKey:iLe}=rt(),nLe=ue(),g$=me(),wb=Object.assign(g$("ipfs:ipns"),{error:g$("ipfs:ipns:error")}),W4=e$(),sLe=u$(),oLe=y$(),aLe=UI(),b$=60*1e3,{toString:m$}=(tt(),et),v$=class{constructor(e,r,i,n,s){this.publisher=new W4(e,r),this.republisher=new sLe(this.publisher,r,i,n,s),this.resolver=new oLe(e),this.cache=new aLe(1e3),this.routing=e}async publish(e,r,i=W4.defaultRecordLifetime){try{let n=await iLe(e.bytes);await this.publisher.publishWithEOL(e,r,i),wb(`IPNS value ${m$(r,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<b$?o:b$;return this.cache.set(s,r,a),wb(`IPNS value ${m$(r,"base32")} was cached correctly`),{name:s,value:r}}catch(n){throw wb.error(n),n}}async resolve(e,r={}){if(typeof e!="string")throw nLe(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!r.nocache&&!r.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,r);return wb(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw wb.error(i),i}}async initializeKeyspace(e,r){return this.publish(e,r,W4.defaultRecordLifetime)}};w$.exports=v$});var _b=y((f5t,S$)=>{f();"use strict";var{Adapter:cLe}=Ut(),Ff=No(),{pipe:Y4}=Ar(),E$=class extends cLe{constructor(e,r){super();this.child=e,this.transform=r}open(){return this.child.open()}put(e,r,i){return this.child.put(this.transform.convert(e),r,i)}get(e,r){return this.child.get(this.transform.convert(e),r)}has(e,r){return this.child.has(this.transform.convert(e),r)}delete(e,r){return this.child.delete(this.transform.convert(e),r)}async*putMany(e,r={}){let i=this.transform,n=this.child;yield*Y4(e,async function*(s){yield*Ff(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,r)},async function*(s){yield*Ff(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,r={}){let i=this.transform,n=this.child;yield*Y4(e,async function*(s){yield*Ff(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,r)})}async*deleteMany(e,r={}){let i=this.transform,n=this.child;yield*Y4(e,async function*(s){yield*Ff(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,r)},async function*(s){yield*Ff(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(r,i)=>{e.put(this.transform.convert(r),i)},delete:r=>{e.delete(this.transform.convert(r))},commit:r=>e.commit(r)}}query(e,r){return Ff(this.child.query(e,r),({key:i,value:n})=>({key:this.transform.invert(i),value:n}))}queryKeys(e,r){return Ff(this.child.queryKeys(e,r),i=>this.transform.invert(i))}close(){return this.child.close()}};S$.exports=E$});var A$=y((d5t,x$)=>{f();"use strict";x$.exports=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var J4=y((h5t,P$)=>{f();"use strict";var{Key:I$}=Ut(),uLe=A$(),P_="/repo/flatfs/shard/",T$="SHARDING",lLe="_README",C_=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${P_}v1/${this.name}/${this.param}`}},X4=class extends C_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},Q4=class extends C_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let r=this._padding+e;return r.slice(r.length-this.param)}},Z4=class extends C_{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let r=this._padding+e,i=r.length-this.param-1;return r.slice(i,i+this.param)}};function R$(t){if(t=t.trim(),t.length===0)throw new Error("empty shard string");if(!t.startsWith(P_))throw new Error(`invalid or no path prefix: ${t}`);let e=t.slice(P_.length).split("/"),r=e[0];if(r!=="v1")throw new Error(`expect 'v1' version, got '${r}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new X4(n);case"suffix":return new Q4(n);case"next-to-last":return new Z4(n);default:throw new Error(`unkown sharding function: ${i}`)}}var fLe=async(t,e)=>{let r=new I$(t).child(new I$(T$)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(r);return R$(new TextDecoder().decode(n||"").trim())};P$.exports={readme:uLe,parseShardFun:R$,readShardFun:fLe,Prefix:X4,Suffix:Q4,NextToLast:Z4,README_FN:lLe,SHARDING_FN:T$,PREFIX:P_}});var O$=y((p5t,C$)=>{f();"use strict";var{Adapter:dLe,Key:O_,Errors:hLe}=Ut(),Eb=J4(),pLe=_b(),Pp=new O_(Eb.SHARDING_FN),Sb=new O_(Eb.README_FN),Kf=class extends dLe{constructor(e,r){super();this.child=new pLe(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=r}async open(){await this.child.open(),this.shard=await Kf.create(this.child,this.shard)}_convertKey(e){let r=e.toString();return r===Pp.toString()||r===Sb.toString()?e:new O_(this.shard.fun(r)).child(e)}_invertKey(e){let r=e.toString();return r===Pp.toString()||r===Sb.toString()?e:O_.withNamespaces(e.list().slice(1))}static async createOrOpen(e,r){try{await Kf.create(e,r)}catch(i){if(i&&i.message!=="datastore exists")throw i}return Kf.open(e)}static async open(e){let r=await Eb.readShardFun("/",e);return new Kf(e,r)}static async create(e,r){let i=await e.has(Pp);if(!i&&!r)throw hLe.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Pp,new TextEncoder().encode(r.toString()+`
`)),a(Sb,new TextEncoder().encode(Eb.readme))]),r}let n=await Eb.readShardFun("/",e),s=(n||"").toString(),o=r.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,r,i){return this.child.put(e,r,i)}get(e,r){return this.child.get(e,r)}has(e,r){return this.child.has(e,r)}delete(e,r){return this.child.delete(e,r)}async*putMany(e,r={}){yield*this.child.putMany(e,r)}async*getMany(e,r={}){yield*this.child.getMany(e,r)}async*deleteMany(e,r={}){yield*this.child.deleteMany(e,r)}batch(){return this.child.batch()}query(e,r){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.key.toString()!==Pp.toString(),s=>s.key.toString()!==Sb.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s.key).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>({key:c,value:u})=>o({key:this._invertKey(c),value:u}));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s({key:this._invertKey(a.key),value:a.value},{key:this._invertKey(c.key),value:c.value}))),this.child.query(i,r)}queryKeys(e,r){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.toString()!==Pp.toString(),s=>s.toString()!==Sb.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>c=>o(this._invertKey(c)));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s(this._invertKey(a),this._invertKey(c)))),this.child.queryKeys(i,r)}close(){return this.child.close()}};C$.exports=Kf});var L$=y((y5t,M$)=>{f();"use strict";var{Adapter:yLe,Key:gLe,Errors:eT,utils:{sortAll:k$,replaceStartWith:tT}}=Ut(),k_=Fa(),q$=cp(),D$=mp(),N$=_b(),B$=class extends yLe{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let r of this.mounts)if(r.prefix.toString()===e.toString()||r.prefix.isAncestorOf(e)){let i=tT(e.toString(),r.prefix.toString());return{datastore:r.datastore,mountpoint:r.prefix,rest:new gLe(i)}}}put(e,r,i){let n=this._lookup(e);if(n==null)throw eT.dbWriteFailedError(new Error("No datastore mounted for this key"));return n.datastore.put(n.rest,r,i)}get(e,r){let i=this._lookup(e);if(i==null)throw eT.notFoundError(new Error("No datastore mounted for this key"));return i.datastore.get(i.rest,r)}has(e,r){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(i.rest,r)}delete(e,r){let i=this._lookup(e);if(i==null)throw eT.dbDeleteFailedError(new Error("No datastore mounted for this key"));return i.datastore.delete(i.rest,r)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},r=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s],rest:n.rest}};return{put:(i,n)=>{let s=r(i);s.batch.put(s.rest,n)},delete:i=>{let n=r(i);n.batch.delete(n.rest)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,r){let i=this.mounts.map(s=>{let o=new N$(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=tT(e.prefix,s.prefix.toString())),o.query({prefix:a,filters:e.filters},r)}),n=D$(...i);if(e.filters&&e.filters.forEach(s=>{n=k_(n,s)}),e.orders&&e.orders.forEach(s=>{n=k$(n,s)}),e.offset!=null){let s=0;n=k_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=q$(n,e.limit)),n}queryKeys(e,r){let i=this.mounts.map(s=>{let o=new N$(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=tT(e.prefix,s.prefix.toString())),o.queryKeys({prefix:a,filters:e.filters},r)}),n=D$(...i);if(e.filters&&e.filters.forEach(s=>{n=k_(n,s)}),e.orders&&e.orders.forEach(s=>{n=k$(n,s)}),e.offset!=null){let s=0;n=k_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=q$(n,e.limit)),n}};M$.exports=B$});var V$=y((g5t,j$)=>{f();"use strict";var{Adapter:bLe,Errors:q_}=Ut(),mLe=me()("datastore:core:tiered"),U$=ja(),F$=Ua(),K$=class extends bLe{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw q_.dbOpenFailedError()}}async put(e,r){try{await Promise.all(this.stores.map(i=>i.put(e,r)))}catch(i){throw q_.dbWriteFailedError()}}async get(e,r){for(let i of this.stores)try{let n=await i.get(e,r);if(n)return n}catch(n){mLe(n)}throw q_.notFoundError()}async has(e,r){for(let i of this.stores)if(await i.has(e,r))return!0;return!1}async delete(e,r){try{await Promise.all(this.stores.map(i=>i.delete(e,r)))}catch(i){throw q_.dbDeleteFailedError()}}async*putMany(e,r={}){let i,n=this.stores.map(s=>{let o=U$();return F$(s.putMany(o,r)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,r={}){let i,n=this.stores.map(s=>{let o=U$();return F$(s.deleteMany(o,r)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(r=>r.batch());return{put:(r,i)=>{e.forEach(n=>n.put(r,i))},delete:r=>{e.forEach(i=>i.delete(r))},commit:async r=>{for(let i of e)await i.commit(r)}}}query(e,r){return this.stores[this.stores.length-1].query(e,r)}queryKeys(e,r){return this.stores[this.stores.length-1].queryKeys(e,r)}};j$.exports=K$});var $$=y((b5t,H$)=>{f();"use strict";var rT=Ut().Key,vLe=_b(),z$=class extends vLe{constructor(e,r){super(e,{convert(i){return r.child(i)},invert(i){if(r.toString()==="/")return i;if(!r.isAncestorOf(i))throw new Error(`Expected prefix: (${r.toString()}) in key: ${i.toString()}`);return new rT(i.toString().slice(r.toString().length),!1)}});this.prefix=r}query(e,r){return e.prefix&&this.prefix.toString()!=="/"?super.query(Object.assign({},e,{prefix:this.prefix.child(new rT(e.prefix)).toString()})):super.query(e,r)}queryKeys(e,r){return e.prefix&&this.prefix.toString()!=="/"?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new rT(e.prefix)).toString()})):super.queryKeys(e,r)}};H$.exports=z$});var W$=y((m5t,G$)=>{f();"use strict";var wLe=_b(),_Le=O$(),ELe=L$(),SLe=V$(),xLe=$$(),ALe=J4();G$.exports={KeytransformDatastore:wLe,ShardingDatastore:_Le,MountDatastore:ELe,TieredDatastore:SLe,NamespaceDatastore:xLe,shard:ALe}});var xb=y((iT,nT)=>{f();(function(t,e){typeof iT=="object"&&typeof nT!="undefined"?nT.exports=function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}:typeof define=="function"&&define.amd?define(function(){return function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}}):t.dlv=function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}})(iT)});var Z$=y((v5t,Q$)=>{f();"use strict";var ILe=ue(),{toString:Y$}=(tt(),et),{fromString:X$}=(ft(),ht),D_="/record/";function TLe(t){return Y$(t,"base32")}function RLe(t){(typeof t=="string"||t instanceof String)&&(t=X$(t.toString()));let e=Y$(t,"base64url");return`${D_}${e}`}function PLe(t){if(t.substring(0,D_.length)!==D_)throw ILe(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=t.substring(D_.length);return X$(e,"base64url")}Q$.exports={encodeBase32:TLe,keyToTopic:RLe,topicToKey:PLe}});var nG=y((rG,iG)=>{f();"use strict";var{Key:sT,Adapter:CLe}=Ut(),{encodeBase32:J$,keyToTopic:N_,topicToKey:OLe}=Z$(),{equals:kLe}=(di(),fi),zs=ue(),eG=me(),yn=Object.assign(eG("datastore-pubsub:publisher"),{error:eG("datastore-pubsub:publisher:error")}),tG=class extends CLe{constructor(e,r,i,n,s){super();if(!n)throw zs(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw zs(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw zs(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw zs(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=r,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,r){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw yn.error(n),zs(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(r instanceof Uint8Array)){let n="received value is not a Uint8Array";throw yn.error(n),zs(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=N_(e);yn(`publish value for topic ${i}`),await this._pubsub.publish(i,r)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw yn.error(n),zs(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let r=N_(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(r)>-1)return this._getLocal(e);try{this._pubsub.on(r,this._onMessage),await this._pubsub.subscribe(r)}catch(n){let s=`cannot subscribe topic ${r}`;throw yn.error(s),zs(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return yn(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){let r=N_(e);return this._pubsub.removeListener(r,this._onMessage),this._pubsub.unsubscribe(r)}async _getLocal(e){let r=new sT("/"+J$(e),!1),i;try{i=await this._datastore.get(r)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${r.toString()}`;throw yn.error(o),zs(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${r.toString()}`;throw yn.error(s),zs(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw yn.error(n),zs(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:r,from:i,topicIDs:n}=e,s;try{s=OLe(n[0])}catch(o){yn.error(o);return}if(yn(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){yn("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){yn.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(o){yn.error(o)}}async _storeIfSubscriptionIsBetter(e,r){let i=!1;try{i=await this._isBetter(e,r)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,r)}async _validateRecord(e,r){return this._validator.validate(e,r)}async _selectRecord(e,r){return await this._validator.select(e,r)===0}async _isBetter(e,r){try{await this._validateRecord(r,e)}catch(s){let o="record received through pubsub is not valid";throw yn.error(o),zs(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new sT(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return kLe(n,r)?!1:this._selectRecord(e,[n,r])}async _storeRecord(e,r){let i=new sT("/"+J$(e),!1);await this._datastore.put(i,r),yn(`record for ${N_(e)} was stored in the datastore`)}};rG=iG.exports=tG});var aT=y((w5t,fG)=>{f();"use strict";var al=Tp(),{base58btc:sG}=(ei(),Jr),qLe=nG(),{fromString:oG}=(ft(),ht),{toString:aG}=(tt(),et),cG=ue(),uG=me(),oT=Object.assign(uG("ipfs:ipns:pubsub"),{error:uG("ipfs:ipns:pubsub:error")}),lG=class{constructor(e,r,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new qLe(e,r,i,al.validator,this._handleSubscriptionKey)}put(e,r){return this._pubsubDs.put(e,r)}async get(e){let r,i;try{r=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,al.namespaceLength);if(aG(n)===al.namespace){let s=sG.encode(e).substring(1),o=sG.encode(e.slice(al.namespaceLength)).substring(1);this._subscriptions[s]=o,oT(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=aG(e,"base58btc"));let r=this._subscriptions[e];if(!r)throw cG(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=al.getIdKeys(oG(r,"base58btc"))}catch(n){throw oT.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(r=>`${al.namespace}${r}`)}async cancel(e){if(typeof e!="string")throw cG(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(al.namespace)&&(e=e.substring(al.namespaceLength));let r=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!r)return{canceled:!1};let i=oG(r);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[r],oT(`unsubscribed pubsub ${r}: ${e}`),{canceled:!0}}};fG.exports=lG});var pG=y((_5t,hG)=>{f();"use strict";var Cp=ki(),dG=Cp.Reader,DLe=Cp.Writer,Hs=Cp.util,Ab=Cp.roots["libp2p-record"]||(Cp.roots["libp2p-record"]={});Ab.Record=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.key=Hs.newBuffer([]),t.prototype.value=Hs.newBuffer([]),t.prototype.timeReceived="",t.encode=function(r,i){return i||(i=DLe.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&i.uint32(10).bytes(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(18).bytes(r.value),r.timeReceived!=null&&Object.hasOwnProperty.call(r,"timeReceived")&&i.uint32(42).string(r.timeReceived),i},t.decode=function(r,i){r instanceof dG||(r=dG.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Ab.Record;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.bytes();break;case 2:s.value=r.bytes();break;case 5:s.timeReceived=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Ab.Record)return r;var i=new Ab.Record;return r.key!=null&&(typeof r.key=="string"?Hs.base64.decode(r.key,i.key=Hs.newBuffer(Hs.base64.length(r.key)),0):r.key.length&&(i.key=r.key)),r.value!=null&&(typeof r.value=="string"?Hs.base64.decode(r.value,i.value=Hs.newBuffer(Hs.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),r.timeReceived!=null&&(i.timeReceived=String(r.timeReceived)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=Hs.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Hs.newBuffer(n.value))),n.timeReceived=""),r.key!=null&&r.hasOwnProperty("key")&&(n.key=i.bytes===String?Hs.base64.encode(r.key,0,r.key.length):i.bytes===Array?Array.prototype.slice.call(r.key):r.key),r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?Hs.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.timeReceived!=null&&r.hasOwnProperty("timeReceived")&&(n.timeReceived=r.timeReceived),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Cp.util.toJSONOptions)},t}();hG.exports=Ab});var yG=y((E5t,cT)=>{f();"use strict";cT.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${i}T${n}:${s}:${o}.${c}Z`};cT.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let i=parseInt(r[1],10),n=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var mG=y((S5t,bG)=>{f();"use strict";var{Record:uT}=pG(),gG=yG(),Ib=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(r instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=r,this.timeReceived=i}serialize(){return uT.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&gG.toRFC3339(this.timeReceived)}}static deserialize(e){let r=uT.decode(e);return Ib.fromDeserialized(uT.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let r;return e.timeReceived&&(r=gG.parseRFC3339(e.timeReceived)),new Ib(e.key,e.value,r)}};bG.exports=Ib});var wG=y((x5t,vG)=>{f();"use strict";var{sha256:NLe}=(ri(),li),B_=ue(),{toString:BLe}=(tt(),et),{equals:MLe}=(di(),fi),LLe=async(t,e)=>{if(!(t instanceof Uint8Array))throw B_(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(t.byteLength<5)throw B_(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(BLe(t.subarray(0,4))!=="/pk/")throw B_(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=t.slice(4),n=await NLe.digest(e);if(!MLe(i,n.bytes))throw B_(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};vG.exports={func:LLe,sign:!1}});var EG=y((A5t,_G)=>{f();"use strict";_G.exports={pk:wG()}});var xG=y((I5t,SG)=>{f();"use strict";var ULe=ue(),{toString:FLe}=(tt(),et),KLe=(t,e)=>{let r=e.key,n=FLe(r).split("/");if(n.length<3)return;let s=t[n[1].toString()];if(!s){let o="Invalid record keytype";throw ULe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(r,e.value)};SG.exports={verifyRecord:KLe,validators:EG()}});var IG=y((T5t,AG)=>{f();"use strict";var jLe=(t,e)=>0;AG.exports=jLe});var RG=y((R5t,TG)=>{f();"use strict";TG.exports={pk:IG()}});var CG=y((P5t,PG)=>{f();"use strict";var lT=ue(),{toString:VLe}=(tt(),et),zLe=(t,e,r)=>{if(r.length===0){let o="No records given";throw lT(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=VLe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw lT(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=t[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw lT(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return s(e,r)};PG.exports={bestRecord:zLe,selectors:RG()}});var jf=y((C5t,OG)=>{f();"use strict";OG.exports={Record:mG(),validator:xG(),selection:CG()}});var fT=y((O5t,qG)=>{f();"use strict";var kG=Tp(),{toString:HLe}=(tt(),et);qG.exports={encodeBase32:t=>HLe(t,"base32upper"),validator:{func:(t,e)=>kG.validator.validate(e,t)},selector:(t,e)=>kG.validator.select(e[0],e[1])}});var hT=y((MG,LG)=>{f();"use strict";var{Key:$Le}=Ut(),{Record:DG}=jf(),{encodeBase32:GLe}=fT(),Tb=ue(),NG=me(),dT=Object.assign(NG("ipfs:ipns:offline-datastore"),{error:NG("ipfs:ipns:offline-datastore:error")}),BG=class{constructor(e){this._repo=e,this.stores=[]}async put(e,r){if(!(e instanceof Uint8Array))throw Tb(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(r instanceof Uint8Array))throw Tb(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw dT.error(s),Tb(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new DG(e,r);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw Tb(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(s){throw dT.error(s),Tb(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(r),n;try{n=DG.deserialize(i)}catch(s){throw dT.error(s),s}return n.value}_routingKey(e){return new $Le("/"+GLe(e),!1)}};MG=LG.exports=BG});var FG=y((k5t,UG)=>{f();"use strict";var{TieredDatastore:WLe}=W$(),pT=xb(),YLe=aT(),XLe=hT();UG.exports=({libp2p:t,repo:e,peerId:r,options:i})=>{let n=[],s;if(pT(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=t.pubsub,a=e.datastore;s=new YLe(o,a,r),n.push(s)}if(pT(i,"offline")||!pT(i,"libp2p.config.dht.enabled",!1)){let o=new XLe(e);n.push(o)}else n.push(t._dht);return new WLe(n)}});var HG=y((q5t,zG)=>{f();"use strict";var KG=_$(),QLe=FG(),ZLe=hT(),{NotInitializedError:JLe,AlreadyInitializedError:jG}=tl(),e9e=me()("ipfs:components:ipns"),VG=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new JLe}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:r,keychain:i}){if(this.offline!=null)throw new jG;e9e("initializing IPNS keyspace");let n=new ZLe(e),s=new KG(n,e.datastore,r,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:r,peerId:i,keychain:n}){if(this.online!=null)throw new jG;let s=QLe({libp2p:e,repo:r,peerId:i,options:this.options}),o=new KG(s,r.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,r,i){return this.getIPNS().publish(e,r,i)}resolve(e,r){return this.getIPNS().resolve(e,r)}initializeKeyspace(e,r){return this.getIPNS().initializeKeyspace(e,r)}};zG.exports=VG});var GG=y($G=>{f();"use strict";var t9e=Yh(),r9e=ib(),i9e=Ua(),{resolve:n9e}=Ki();$G.resolvePath=async({ipns:t,repo:e,codecs:r},i,n)=>{if(t9e.ipnsPath(i))return t.resolve(i);let{cid:s,path:o}=r9e(i);await i9e(n9e(s,o||"",r,e,n))}});var QG=y((N5t,XG)=>{f();"use strict";var WG=me(),{default:s9e}=tb(),o9e=Na(),YG=ue(),{fromString:a9e}=(ft(),ht),{toString:c9e}=(tt(),et),yT=Object.assign(WG("ipfs:name:publish"),{error:WG("ipfs:name:publish:error")}),{OFFLINE_ERROR:u9e,normalizePath:l9e}=Ki(),f9e=qe(),{resolvePath:d9e}=GG();XG.exports=({ipns:t,repo:e,codecs:r,peerId:i,isOnline:n,keychain:s})=>{let o=async c=>{if(c==="self")return i.privKey;try{let u=await s.exportKey(c,"temp");return await o9e.keys.import(u,"temp")}catch(u){throw yT.error(u),YG(u,"ERR_CANNOT_GET_KEY")}};async function a(c,u={}){let l=u.resolve!==!1,d=u.lifetime||"24h",h=u.key||"self";if(!n())throw YG(new Error(u9e),"OFFLINE_ERROR");try{c=l9e(c)}catch(v){throw yT.error(v),v}let p=0;try{p=s9e(d)||0,p=parseFloat(p.toFixed(6))}catch(v){throw yT.error(v),v}let g=await Promise.all([o(h),l?d9e({ipns:t,repo:e,codecs:r},c):Promise.resolve()]),m=a9e(c),E=await t.publish(g[0],m,p);return{name:E.name,value:c9e(E.value)}}return f9e(a)}});var JG=y((B5t,ZG)=>{f();"use strict";var h9e=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;ZG.exports=function(e,r){if(r==null&&(r=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(r){if(i!==".")return!1}else if(i===".")return!1;return h9e.test(e)}});var iW=y((M5t,rW)=>{f();"use strict";var eW=me(),gT=ue(),p9e=gr().bind({ignoreUndefined:!0}),{CID:y9e}=(Ie(),Ne),g9e=rt(),b9e=JG(),{toString:m9e}=(tt(),et),v9e=Object.assign(eW("ipfs:name:resolve"),{error:eW("ipfs:name:resolve:error")}),{OFFLINE_ERROR:w9e}=Ki(),_9e=qe(),tW=(t,e)=>e.length>0?t+"/"+e.join("/"):t;rW.exports=({dns:t,ipns:e,peerId:r,isOnline:i,options:{offline:n}})=>{async function*s(o,a={}){if(a=p9e({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw gT(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");o||(o=r.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...l]=o.slice(1).split("/");try{u.substring(0,1)==="1"?g9e.parse(u):y9e.parse(u)}catch(h){if(b9e(u)){yield tW(await t(u,a),l);return}throw v9e.error(h),gT(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!i()&&!n)throw gT(new Error(w9e),"OFFLINE_ERROR");let d=await e.resolve(`/${c}/${u}`,a);yield tW(d instanceof Uint8Array?m9e(d):d,l)}return _9e(s)}});var M_=y(oW=>{f();"use strict";var nW=aT(),sW=ue();oW.getPubsubRouting=(t,e)=>{if(!t||!(e&&e.ipnsPubsub))throw sW(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(t.routing instanceof nW)return t.routing;let r=(t.routing.stores||[]).find(i=>i instanceof nW);if(!r)throw sW(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}});var cW=y((U5t,aW)=>{f();"use strict";var{getPubsubRouting:E9e}=M_(),S9e=qe();aW.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n,s={}){return E9e(t,r).cancel(n,s)}return S9e(i)}});var lW=y((F5t,uW)=>{f();"use strict";var{getPubsubRouting:x9e}=M_(),A9e=qe();uW.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(x9e(t,r))}}catch(s){return{enabled:!1}}}return A9e(i)}});var dW=y((K5t,fW)=>{f();"use strict";var{getPubsubRouting:I9e}=M_(),T9e=qe();fW.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n={}){return I9e(t,r).getSubscriptions(n)}return T9e(i)}});var yW=y((j5t,pW)=>{f();"use strict";var R9e=cW(),P9e=lW(),C9e=dW(),hW=class{constructor({ipns:e,options:r}){this.cancel=R9e({ipns:e,options:r}),this.state=P9e({ipns:e,options:r}),this.subs=C9e({ipns:e,options:r})}};pW.exports=hW});var mW=y((V5t,bW)=>{f();"use strict";var O9e=QG(),k9e=iW(),q9e=yW(),gW=class{constructor({dns:e,ipns:r,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=O9e({ipns:r,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=k9e({dns:e,ipns:r,peerId:s,isOnline:o,options:c}),this.pubsub=new q9e({ipns:r,options:c})}};bW.exports=gW});var _W=y((z5t,mT)=>{f();"use strict";var D9e=(_t(),Mt),{Errors:N9e}=Ut(),B9e=N9e.notFoundError().code,vW=ib(),{CID:wW}=(Ie(),Ne),M9e=Zw(),{anySignal:L9e}=Tu(),L_={default:"<dst>",edges:"<src> -> <dst>"};mT.exports=function({repo:t,codecs:e,resolve:r,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==L_.default)throw new Error("Cannot set edges to true and also specify format");if(o.format=o.edges?L_.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1),o.timeout){let u=new M9e(o.timeout);o.signal=L9e([o.signal,u.signal])}let c=(Array.isArray(s)?s:[s]).map(u=>U9e(i,u,o));for(let u of c)try{yield*F9e(r,t,e,u,o)}catch(l){yield{ref:"",err:l.message}}}return n};mT.exports.Format=L_;function U9e(t,e,r){let{cid:i,path:n}=vW(e);return r.preload!==!1&&t(i),`/ipfs/${i}${n||""}`}async function*F9e(t,e,r,i,n){let s=await t(i,n),{cid:o}=vW(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let u of j9e(e,r,o,a,c,n))!u.parent||u.isDuplicate||(yield{ref:K9e(u.parent.cid,u.node.cid,u.node.name,n.format)})}function K9e(t,e,r="",i=L_.default){let n=i.replace(/<src>/g,t.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,r),n}async function*j9e(t,e,r,i,n,s){let o=new Set;async function*a(c,u){let l=u+1;if(!(l>i))try{for await(let d of V9e(t,e,c.cid,s))yield{parent:c,node:d,isDuplicate:n&&o.has(d.cid.toString())},n&&o.add(d.cid.toString()),yield*a(d,l)}catch(d){throw d.code===B9e&&(d.message=`Could not find object with CID: ${c.cid}`),d}}yield*a({cid:r},0)}async function*V9e(t,e,r,i){let n=await t.blocks.get(r,i),o=(await e.getCodec(r.code)).decode(n),a=r.code===D9e.code,c=[];for(let[u,l]of bT(o,c)){if(a){let d=u.match(/^Links\/(\d+)\/Hash$/);if(d){let h=Number(d[1]);if(h<o.Links.length){yield{name:o.Links[h].Name,cid:l};continue}}}yield{name:u,cid:l}}}var bT=function*(t,e){if(t!=null&&!(t instanceof Uint8Array)){for(let[r,i]of Object.entries(t)){let n=[...e,r];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=wW.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*bT(o,a))}else{let s=wW.asCID(i);s?yield[n.join("/"),s]:yield*bT(i,n)}}return[]}}});var SW=y((H5t,EW)=>{f();"use strict";var z9e=qe();EW.exports=function({repo:t}){async function*e(r={}){for await(let i of t.blocks.queryKeys({},{signal:r.signal}))yield{ref:i.toString()}}return z9e(e)}});var AW=y(($5t,xW)=>{f();"use strict";var H9e=qe();xW.exports=({network:t})=>{async function e(r={}){let{bitswap:i}=await t.use(r),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return H9e(e)}});var TW=y((G5t,IW)=>{f();"use strict";var $9e=rt(),G9e=qe();IW.exports=({network:t})=>{async function e(r,i={}){let{bitswap:n}=await t.use(i),s=n.wantlistForPeer($9e.createFromB58String(r));return Array.from(s).map(o=>o[1].cid)}return G9e(e)}});var PW=y((W5t,RW)=>{f();"use strict";var W9e=qe();RW.exports=({network:t})=>{async function e(r,i={}){let{bitswap:n}=await t.use(i);return Array.isArray(r)||(r=[r]),n.unwant(r)}return W9e(e)}});var vT=y((Y5t,CW)=>{f();"use strict";var Y9e=qe();CW.exports=({network:t})=>{async function e(r={}){let i=(await t.use(r)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return Y9e(e)}});var qW=y((X5t,kW)=>{f();"use strict";var X9e=AW(),Q9e=TW(),Z9e=PW(),J9e=vT(),OW=class{constructor({network:e}){this.wantlist=X9e({network:e}),this.wantlistForPeer=Q9e({network:e}),this.unwant=Z9e({network:e}),this.stat=J9e({network:e})}};kW.exports=OW});var wT=y(DW=>{f();"use strict";var eUe=Tf().IPFS.matches;DW.isValidMultiaddr=t=>{try{return eUe(t)}catch(e){return!1}}});var BW=y((Z5t,NW)=>{f();"use strict";var{isValidMultiaddr:tUe}=wT(),rUe=qe();NW.exports=({repo:t})=>{async function e(r,i={}){if(!tUe(r))throw new Error(`${r} is not a valid Multiaddr`);let n=await t.config.getAll(i),s=n.Bootstrap||[];return s.push(r.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await t.config.replace(n),{Peers:[r]}}return rUe(e)}});var LW=y((J5t,MW)=>{f();"use strict";var iUe=qe(),{Multiaddr:nUe}=it();MW.exports=({repo:t})=>{async function e(r={}){let i=await t.config.getAll(r),n=i.Bootstrap||[];return i.Bootstrap=[],await t.config.replace(i),{Peers:n.map(s=>new nUe(s))}}return iUe(e)}});var FW=y((eRt,UW)=>{f();"use strict";var sUe=qe(),{Multiaddr:oUe}=it();UW.exports=({repo:t})=>{async function e(r={}){return{Peers:(await t.config.get("Bootstrap",r)||[]).map(n=>new oUe(n))}}return sUe(e)}});var U_=y((tRt,KW)=>{f();"use strict";KW.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})});var zW=y((rRt,VW)=>{f();"use strict";var jW=U_(),aUe=qe(),{Multiaddr:cUe}=it();VW.exports=({repo:t})=>{async function e(r={}){let i=await t.config.getAll(r);return i.Bootstrap=jW().Bootstrap,await t.config.replace(i),{Peers:jW().Bootstrap.map(n=>new cUe(n))}}return aUe(e)}});var $W=y((iRt,HW)=>{f();"use strict";var{isValidMultiaddr:uUe}=wT(),lUe=qe();HW.exports=({repo:t})=>{async function e(r,i={}){if(!uUe(r))throw new Error(`${r} is not a valid Multiaddr`);let n=await t.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==r.toString()),await t.config.replace(n),{Peers:[r]}}return lUe(e)}});var YW=y((nRt,WW)=>{f();"use strict";var fUe=BW(),dUe=LW(),hUe=FW(),pUe=zW(),yUe=$W(),GW=class{constructor({repo:e}){this.add=fUe({repo:e}),this.list=hUe({repo:e}),this.rm=yUe({repo:e}),this.clear=dUe({repo:e}),this.reset=pUe({repo:e})}};WW.exports=GW});var QW=y((sRt,XW)=>{f();"use strict";var gUe=qe();XW.exports=({preload:t,repo:e})=>{async function r(i,n={}){return n.preload!==!1&&t(i),e.blocks.get(i,n)}return gUe(r)}});var JW=y((oRt,ZW)=>{f();"use strict";var{CID:bUe}=(Ie(),Ne),mUe=qe();ZW.exports=({codecs:t,hashers:e,repo:r,preload:i})=>{async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,u=o.format||(c===0?"dag-pb":"raw"),d=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),h=await t.getCodec(u),p=bUe.create(c,h.code,d);return await r.blocks.put(p,s,{signal:o.signal}),o.preload!==!1&&i(p),o.pin===!0&&await r.pins.pinRecursively(p,{signal:o.signal}),p}finally{a&&a()}}return mUe(n)}});var Op=y((F_,eY)=>{f();(function(t,e){typeof F_=="object"&&typeof eY!="undefined"?e(F_):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(F_,function(t){"use strict";async function*e(I,U){let V=[];for await(let N of U)V.push(N),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function*r(I,U){let V=[];for(let N of U)V.push(N),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function i(I,U){return U===void 0?V=>i(I,V):U[Symbol.asyncIterator]?e(I,U):r(I,U)}function n(I){if(typeof I.next=="function")return I;if(typeof I[Symbol.iterator]=="function")return I[Symbol.iterator]();if(typeof I[Symbol.asyncIterator]=="function")return I[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let I,U;return{promise:new Promise((N,Q)=>{U=N,I=Q}),reject:I,resolve:U}}function o(I,U){let V=n(U),N=[],Q=[],ee=!1,J=!1;function ce(){for(;Q.length>0&&N.length>0;){let Re=Q.shift(),{error:Ve,value:Je}=N.shift();Ve?Re.reject(Ve):Re.resolve({done:!1,value:Je})}for(;Q.length>0&&J;){let{resolve:Re}=Q.shift();Re({done:!0,value:void 0})}}async function ge(){if(!J&&!ee&&!(N.length>=I)){ee=!0;try{let{done:Re,value:Ve}=await V.next();Re?J=!0:N.push({value:Ve})}catch(Re){J=!0,N.push({error:Re})}ce(),ee=!1,ge()}}async function be(){if(N.length>0){let{error:Ve,value:Je}=N.shift();if(Ve)throw Ve;return ge(),{done:!1,value:Je}}if(J)return{done:!0,value:void 0};let Re=s();return Q.push(Re),ge(),Re.promise}let je={next:be,[Symbol.asyncIterator]:()=>je};return je}function*a(I,U){let V=[],N;try{for(let Q of U)V.push(Q),!(V.length<=I)&&(yield V.shift())}catch(Q){N=Q}for(let Q of V)yield Q;if(N)throw N}function c(I,U){return U===void 0?V=>c(I,V):I===0?U:U[Symbol.asyncIterator]?o(I,U):a(I,U)}async function u(I){let U=[];for await(let V of I)U.push(V);return U}function l(I){return I[Symbol.asyncIterator]?u(I):Array.from(I)}async function*d(I){for await(let U of I)yield*U}function*h(I){for(let U of I)yield*U}function p(...I){return I.find(V=>V[Symbol.asyncIterator]!==void 0)?d(I):h(I)}async function g(I){for await(let U of I);}function m(I){if(I[Symbol.asyncIterator])return g(I);for(let U of I);}async function*E(I,U){for await(let V of U)await I(V)&&(yield V)}function v(I,U){return U===void 0?V=>E(I,V):E(I,U)}async function*A(I){for await(let U of I)U&&typeof U!="string"&&(U[Symbol.iterator]||U[Symbol.asyncIterator])?yield*A(U):yield U}async function*R(I,U){for await(let V of U)yield await I(V)}function F(I,U){return U===void 0?V=>R(I,V):R(I,U)}function q(I,U){return U===void 0?V=>q(I,V):v(V=>V!=null,A(F(I,U)))}function D(I,U,V){let N=n(V),Q=[],ee=[],J=!1,ce=!1,ge=0,be=null;function je(){for(;ee.length>0&&Q.length>0;){let{resolve:ze}=ee.shift(),gt=Q.shift();ze({done:!1,value:gt})}for(;ee.length>0&&ge===0&&J;){let{resolve:ze,reject:gt}=ee.shift();be?(gt(be),be=null):ze({done:!0,value:void 0})}}async function Re(){if(J){je();return}if(!ce&&!(ge+Q.length>=I)){ce=!0,ge++;try{let{done:ze,value:gt}=await N.next();ze?(J=!0,ge--,je()):Ve(gt)}catch(ze){J=!0,ge--,be=ze,je()}ce=!1,Re()}}async function Ve(ze){try{let gt=await U(ze);if(gt&&gt[Symbol.asyncIterator])for await(let Yt of gt)Q.push(Yt);else Q.push(gt)}catch(gt){J=!0,be=gt}ge--,je(),Re()}async function Je(){if(Q.length===0){let gt=s();return ee.push(gt),Re(),gt.promise}let ze=Q.shift();return Re(),{done:!1,value:ze}}let He={next:Je,[Symbol.asyncIterator]:()=>He};return He}function z(I,U,V){return U===void 0?(N,Q)=>Q?z(I,N,Q):z(I,N):V===void 0?N=>z(I,U,N):v(N=>N!=null,A(D(I,U,V)))}async function G(I){return new Promise(U=>{I.once("readable",()=>{U()})})}async function*Y(I){for(;;){let U=I.read();if(U!==null){yield U;continue}if(I._readableState.ended)break;await G(I)}}function P(I){return typeof I[Symbol.asyncIterator]=="function"?I:Y(I)}async function*b(...I){let U=new Set(I.map(n));for(;U.size>0;)for(let V of U){let N=await V.next();N.done?U.delete(V):yield N.value}}function w(I,...U){let V=I();for(let N of U)V=N(V);return V}async function*S(I,U,V){let N=null,Q=ge=>({value:U(ge)}),ee=async function*(ge){for await(let be of ge){if(N)return;yield be}},J=w(()=>V,c(1),ee,F(Q),c(I-1)),ce=n(J);for(;;){let{value:ge,done:be}=await ce.next();if(be)break;try{let je=await ge.value;N||(yield je)}catch(je){N=je}}if(N)throw N}function C(I,U,V){return U===void 0?(N,Q)=>C(I,N,Q):V===void 0?N=>C(I,U,N):I===1?F(U,V):S(I,U,V)}function B(I,U,V){return U===void 0?(N,Q)=>Q?B(I,N,Q):B(I,N):V===void 0?N=>B(I,U,N):v(N=>N!=null,A(C(I,U,V)))}async function*W(...I){let U=I.map(n),V=new Set,N=new Map,Q=null,ee=null,J=null,ce=Re=>{Q=Re,ee&&ee(Re)},ge=Re=>{J&&J(Re)},be=()=>new Promise((Re,Ve)=>{if(Q&&Ve(Q),N.size>0)return Re();J=Re,ee=Ve}),je=Re=>{let Ve=Promise.resolve(Re.next()).then(async({done:Je,value:He})=>{Je||N.set(Re,He),V.delete(Ve)});V.add(Ve),Ve.then(ge,ce)};for(let Re of U)je(Re);for(;;){if(V.size===0&&N.size===0)return;await be();for(let[Re,Ve]of N)N.delete(Re),yield Ve,je(Re)}}async function j(I,U,V){let N=U;for await(let Q of V)N=await I(N,Q);return N}function M(I,U,V){return U===void 0?(N,Q)=>Q?j(I,N,Q):M(I,N):V===void 0?N=>M(I,U,N):j(I,U,V)}async function*_(I,U){let V=0;for await(let N of U)if(yield await N,V++,V>=I)break}function*L(I,U){let V=0;for(let N of U)if(yield N,V++,V>=I)break}function ae(I,U){return U===void 0?V=>ae(I,V):U[Symbol.asyncIterator]?_(I,U):L(I,U)}async function*X(I,U){for await(let V of U)await I(V),yield V}function ne(I,U){return U===void 0?V=>X(I,V):X(I,U)}function oe(I,U){let V=I[0]+U[0],N=I[1]+U[1];if(N>=1e9){let Q=N%1e9;V+=(N-Q)/1e9,N=Q}return[V,N]}async function*he(I,U){let V=U[Symbol.asyncIterator](),N=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=await V.next(),ce=process.hrtime(Q);if(N=oe(N,ce),I.progress&&I.progress(ce,N),J)return I.total&&I.total(N),ee;yield ee}}function*pe(I,U){let V=U[Symbol.iterator](),N=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=V.next(),ce=process.hrtime(Q);if(N=oe(N,ce),I.progress&&I.progress(ce,N),J)return I.total&&I.total(N),ee;yield ee}}function _e(I={},U){return U===void 0?V=>_e(I,V):U[Symbol.asyncIterator]!==void 0?he(I,U):pe(I,U)}function k(I,U,V){let N=n(V),Q=[],ee=[],J=!1,ce=!1,ge=0,be=null;function je(){for(;ee.length>0&&Q.length>0;){let{resolve:ze}=ee.shift(),gt=Q.shift();ze({done:!1,value:gt})}for(;ee.length>0&&ge===0&&J;){let{resolve:ze,reject:gt}=ee.shift();be?(gt(be),be=null):ze({done:!0,value:void 0})}}async function Re(){if(J){je();return}if(!ce&&!(ge+Q.length>=I)){ce=!0,ge++;try{let{done:ze,value:gt}=await N.next();ze?(J=!0,ge--,je()):Ve(gt)}catch(ze){J=!0,ge--,be=ze,je()}ce=!1,Re()}}async function Ve(ze){try{let gt=await U(ze);Q.push(gt)}catch(gt){J=!0,be=gt}ge--,je(),Re()}async function Je(){if(Q.length===0){let gt=s();return ee.push(gt),Re(),gt.promise}let ze=Q.shift();return Re(),{done:!1,value:ze}}let He={next:Je,[Symbol.asyncIterator]:()=>He};return He}function K(I,U,V){return U===void 0?(N,Q)=>Q?K(I,N,Q):K(I,N):V===void 0?N=>K(I,U,N):k(I,U,V)}async function $(I,U){let V=null,N=null,Q=null,ee=be=>{V=be,N&&N(be)},J=()=>{Q&&Q()},ce=()=>{I.removeListener("error",ee),I.removeListener("drain",J)};I.once("error",ee);let ge=()=>new Promise((be,je)=>{if(V)return je(V);I.once("drain",J),Q=be,N=je});for await(let be of U)if(I.write(be)===!1&&await ge(),V)break;if(ce(),V)throw V}function Z(I,U){return U===void 0?V=>$(I,V):$(I,U)}t.batch=i,t.buffer=c,t.collect=l,t.concat=p,t.consume=m,t.filter=v,t.flatMap=q,t.flatTransform=z,t.flatten=A,t.fromStream=P,t.getIterator=n,t.map=F,t.merge=b,t.parallelFlatMap=B,t.parallelMap=C,t.parallelMerge=W,t.pipeline=w,t.reduce=M,t.take=ae,t.tap=ne,t.time=_e,t.transform=K,t.writeToStream=Z,Object.defineProperty(t,"__esModule",{value:!0})})});var _T=y(rY=>{f();"use strict";var{CID:tY}=(Ie(),Ne);rY.cleanCid=t=>t instanceof Uint8Array?tY.decode(t):tY.parse(t.toString())});var nY=y((cRt,iY)=>{f();"use strict";var vUe=ue(),{parallelMap:wUe,filter:_Ue}=Op(),{pipe:EUe}=Ar(),{cleanCid:SUe}=_T(),xUe=qe(),AUe=8;iY.exports=({repo:t})=>{async function*e(r,i={}){Array.isArray(r)||(r=[r]);let n=await t.gcLock.writeLock();try{yield*EUe(r,wUe(AUe,async s=>{s=SUe(s);let o={cid:s};try{if(!await t.blocks.has(s))throw vUe(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await t.blocks.delete(s)}catch(a){i.force||(a.message=`cannot remove ${s}: ${a.message}`,o.error=a)}return o}),_Ue(()=>!i.quiet))}finally{n()}}return xUe(e)}});var oY=y((uRt,sY)=>{f();"use strict";var{cleanCid:IUe}=_T(),TUe=qe();sY.exports=({repo:t,preload:e})=>{async function r(i,n={}){i=IUe(i),n.preload!==!1&&e(i);let s=await t.blocks.get(i);return{cid:i,size:s.length}}return TUe(r)}});var uY=y((lRt,cY)=>{f();"use strict";var RUe=QW(),PUe=JW(),CUe=nY(),OUe=oY(),aY=class{constructor({codecs:e,hashers:r,preload:i,repo:n}){this.get=RUe({preload:i,repo:n}),this.put=PUe({codecs:e,hashers:r,preload:i,repo:n}),this.rm=CUe({repo:n}),this.stat=OUe({preload:i,repo:n})}};cY.exports=aY});var fY=y((fRt,lY)=>{f();"use strict";var kUe=$n();lY.exports=({addAll:t})=>{async function e(r,i={}){let n=await kUe(t(r,i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}});var dY,ET,hY=xe(()=>{f();dY=Wt(gr()),ET=dY.default});var pY=y((Rb,K_)=>{f();(function(t,e){"use strict";var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(p){if(!Array.isArray(p)&&!ArrayBuffer.isView(p))return!1;for(var g=0;g<p.length;g++)if(!Number.isInteger(p[g])||p[g]<0||p[g]>255)return!1;return!0}function n(p,g){return(p&65535)*g+(((p>>>16)*g&65535)<<16)}function s(p,g){return p<<g|p>>>32-g}function o(p){return p^=p>>>16,p=n(p,2246822507),p^=p>>>13,p=n(p,3266489909),p^=p>>>16,p}function a(p,g){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=p[3]+g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=p[2]+g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=p[1]+g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=p[0]+g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function c(p,g){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=p[3]*g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=p[2]*g[3],m[1]+=m[2]>>>16,m[2]&=65535,m[2]+=p[3]*g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=p[1]*g[3],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=p[2]*g[2],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=p[3]*g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=p[0]*g[3]+p[1]*g[2]+p[2]*g[1]+p[3]*g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function u(p,g){return g%=64,g===32?[p[1],p[0]]:g<32?[p[0]<<g|p[1]>>>32-g,p[1]<<g|p[0]>>>32-g]:(g-=32,[p[1]<<g|p[0]>>>32-g,p[0]<<g|p[1]>>>32-g])}function l(p,g){return g%=64,g===0?p:g<32?[p[0]<<g|p[1]>>>32-g,p[1]<<g]:[p[1]<<g-32,0]}function d(p,g){return[p[0]^g[0],p[1]^g[1]]}function h(p){return p=d(p,[0,p[0]>>>1]),p=c(p,[4283543511,3981806797]),p=d(p,[0,p[0]>>>1]),p=c(p,[3301882366,444984403]),p=d(p,[0,p[0]>>>1]),p}r.x86.hash32=function(p,g){if(r.inputValidation&&!i(p))return e;g=g||0;for(var m=p.length%4,E=p.length-m,v=g,A=0,R=3432918353,F=461845907,q=0;q<E;q=q+4)A=p[q]|p[q+1]<<8|p[q+2]<<16|p[q+3]<<24,A=n(A,R),A=s(A,15),A=n(A,F),v^=A,v=s(v,13),v=n(v,5)+3864292196;switch(A=0,m){case 3:A^=p[q+2]<<16;case 2:A^=p[q+1]<<8;case 1:A^=p[q],A=n(A,R),A=s(A,15),A=n(A,F),v^=A}return v^=p.length,v=o(v),v>>>0},r.x86.hash128=function(p,g){if(r.inputValidation&&!i(p))return e;g=g||0;for(var m=p.length%16,E=p.length-m,v=g,A=g,R=g,F=g,q=0,D=0,z=0,G=0,Y=597399067,P=2869860233,b=951274213,w=2716044179,S=0;S<E;S=S+16)q=p[S]|p[S+1]<<8|p[S+2]<<16|p[S+3]<<24,D=p[S+4]|p[S+5]<<8|p[S+6]<<16|p[S+7]<<24,z=p[S+8]|p[S+9]<<8|p[S+10]<<16|p[S+11]<<24,G=p[S+12]|p[S+13]<<8|p[S+14]<<16|p[S+15]<<24,q=n(q,Y),q=s(q,15),q=n(q,P),v^=q,v=s(v,19),v+=A,v=n(v,5)+1444728091,D=n(D,P),D=s(D,16),D=n(D,b),A^=D,A=s(A,17),A+=R,A=n(A,5)+197830471,z=n(z,b),z=s(z,17),z=n(z,w),R^=z,R=s(R,15),R+=F,R=n(R,5)+2530024501,G=n(G,w),G=s(G,18),G=n(G,Y),F^=G,F=s(F,13),F+=v,F=n(F,5)+850148119;switch(q=0,D=0,z=0,G=0,m){case 15:G^=p[S+14]<<16;case 14:G^=p[S+13]<<8;case 13:G^=p[S+12],G=n(G,w),G=s(G,18),G=n(G,Y),F^=G;case 12:z^=p[S+11]<<24;case 11:z^=p[S+10]<<16;case 10:z^=p[S+9]<<8;case 9:z^=p[S+8],z=n(z,b),z=s(z,17),z=n(z,w),R^=z;case 8:D^=p[S+7]<<24;case 7:D^=p[S+6]<<16;case 6:D^=p[S+5]<<8;case 5:D^=p[S+4],D=n(D,P),D=s(D,16),D=n(D,b),A^=D;case 4:q^=p[S+3]<<24;case 3:q^=p[S+2]<<16;case 2:q^=p[S+1]<<8;case 1:q^=p[S],q=n(q,Y),q=s(q,15),q=n(q,P),v^=q}return v^=p.length,A^=p.length,R^=p.length,F^=p.length,v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,v=o(v),A=o(A),R=o(R),F=o(F),v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(A>>>0).toString(16)).slice(-8)+("00000000"+(R>>>0).toString(16)).slice(-8)+("00000000"+(F>>>0).toString(16)).slice(-8)},r.x64.hash128=function(p,g){if(r.inputValidation&&!i(p))return e;g=g||0;for(var m=p.length%16,E=p.length-m,v=[0,g],A=[0,g],R=[0,0],F=[0,0],q=[2277735313,289559509],D=[1291169091,658871167],z=0;z<E;z=z+16)R=[p[z+4]|p[z+5]<<8|p[z+6]<<16|p[z+7]<<24,p[z]|p[z+1]<<8|p[z+2]<<16|p[z+3]<<24],F=[p[z+12]|p[z+13]<<8|p[z+14]<<16|p[z+15]<<24,p[z+8]|p[z+9]<<8|p[z+10]<<16|p[z+11]<<24],R=c(R,q),R=u(R,31),R=c(R,D),v=d(v,R),v=u(v,27),v=a(v,A),v=a(c(v,[0,5]),[0,1390208809]),F=c(F,D),F=u(F,33),F=c(F,q),A=d(A,F),A=u(A,31),A=a(A,v),A=a(c(A,[0,5]),[0,944331445]);switch(R=[0,0],F=[0,0],m){case 15:F=d(F,l([0,p[z+14]],48));case 14:F=d(F,l([0,p[z+13]],40));case 13:F=d(F,l([0,p[z+12]],32));case 12:F=d(F,l([0,p[z+11]],24));case 11:F=d(F,l([0,p[z+10]],16));case 10:F=d(F,l([0,p[z+9]],8));case 9:F=d(F,[0,p[z+8]]),F=c(F,D),F=u(F,33),F=c(F,q),A=d(A,F);case 8:R=d(R,l([0,p[z+7]],56));case 7:R=d(R,l([0,p[z+6]],48));case 6:R=d(R,l([0,p[z+5]],40));case 5:R=d(R,l([0,p[z+4]],32));case 4:R=d(R,l([0,p[z+3]],24));case 3:R=d(R,l([0,p[z+2]],16));case 2:R=d(R,l([0,p[z+1]],8));case 1:R=d(R,[0,p[z]]),R=c(R,q),R=u(R,31),R=c(R,D),v=d(v,R)}return v=d(v,[0,p.length]),A=d(A,[0,p.length]),v=a(v,A),A=a(A,v),v=h(v),A=h(A),v=a(v,A),A=a(A,v),("00000000"+(v[0]>>>0).toString(16)).slice(-8)+("00000000"+(v[1]>>>0).toString(16)).slice(-8)+("00000000"+(A[0]>>>0).toString(16)).slice(-8)+("00000000"+(A[1]>>>0).toString(16)).slice(-8)},typeof Rb!="undefined"?(typeof K_!="undefined"&&K_.exports&&(Rb=K_.exports=r),Rb.murmurHash3=r):typeof define=="function"&&define.amd?define([],function(){return r}):(r._murmurHash3=t.murmurHash3,r.noConflict=function(){return t.murmurHash3=r._murmurHash3,r._murmurHash3=e,r.noConflict=e,r},t.murmurHash3=r)})(Rb)});var gY=y((hRt,yY)=>{f();yY.exports=pY()});var bY={};ut(bY,{murmur3128:()=>Pb,murmur332:()=>DUe});function qUe(t){let e=new Array(4);for(let r=0;r<4;r++)e[r]=t&255,t=t>>8;return new Uint8Array(e)}var ST,DUe,Pb,j_=xe(()=>{f();ug();kc();ST=Wt(gY());DUe=Rc({name:"murmur3-32",code:35,encode:t=>qUe(ST.default.x86.hash32(t))}),Pb=Rc({name:"murmur3-128",code:34,encode:t=>Sc.fromHex(ST.default.x64.hash128(t))})});async function NUe(t){return(await Pb.encode(t)).slice(0,8).reverse()}var BUe,mY,vY=xe(()=>{f();hY();ri();j_();ET.bind({ignoreUndefined:!0});BUe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:bh,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:NUe,hamtHashCode:34,hamtBucketBits:8},mY=(t={})=>ET(BUe,t)});var MUe,Lo,kp=xe(()=>{f();Ie();_t();ri();MUe=async(t,e,r)=>{r.codec||(r.codec=Mt),r.hasher||(r.hasher=bh),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===Mt&&r.hasher!==bh&&(r.cidVersion=1);let i=await r.hasher.digest(t),n=We.create(r.cidVersion,r.codec.code,i);return r.onlyHash||await e.put(n,t,{signal:r.signal}),n},Lo=MUe});var LUe,wY,_Y=xe(()=>{f();pi();kp();_t();LUe=async(t,e,r)=>{let i=new wi({type:"directory",mtime:t.mtime,mode:t.mode}),n=Po(Bs({Data:i.marshal()})),s=await Lo(n,e,r),o=t.path;return{cid:s,path:o,unixfs:i,size:n.length}},wY=LUe});async function UUe(t,e){return e(await(0,EY.default)(t))}var EY,SY,xY=xe(()=>{f();EY=Wt(ap());SY=UUe});function FUe(t,e,r){return IY(t,e,r)}async function IY(t,e,r){let i=[];for await(let n of(0,AY.default)(t,r.maxChildrenPerNode))i.push(await e(n));return i.length>1?IY(i,e,r):i[0]}var AY,TY,RY=xe(()=>{f();AY=Wt(v_());TY=FUe});async function KUe(t,e,r){let i=new OY(r.layerRepeat),n=0,s=1,o=i;for await(let a of(0,PY.default)(t,r.maxChildrenPerNode))o.isFull()&&(o!==i&&i.addChild(await o.reduce(e)),n&&n%r.layerRepeat==0&&s++,o=new xT(s,r.layerRepeat,n),n++),o.append(a);return o&&o!==i&&i.addChild(await o.reduce(e)),i.reduce(e)}var PY,CY,xT,OY,kY=xe(()=>{f();PY=Wt(v_());CY=KUe,xT=class{constructor(e,r,i=0){this.maxDepth=e,this.layerRepeat=r,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let r={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(r),this.currentDepth=r.depth,this.node=r}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,r){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,r)))),r((e.data||[]).concat(i))}_findParent(e,r){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,r):i}},OY=class extends xT{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});var qY={};ut(qY,{default:()=>VUe});async function*jUe(t,e,r){for await(let i of t.content)yield async()=>{r.progress(i.length,t.path);let n,s={codec:Mt,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(s.codec=wo,s.cidVersion=1):(n=new wi({type:r.leafType,data:i,mtime:t.mtime,mode:t.mode}),i=Po({Data:n.marshal(),Links:[]})),{cid:await Lo(i,e,s),unixfs:n,size:i.length}}}var VUe,DY=xe(()=>{f();pi();kp();_t();Rs();VUe=jUe});async function*HUe(t,e,r){let i=-1,n,s;typeof r.bufferImporter=="function"?s=r.bufferImporter:s=(await Promise.resolve().then(()=>(DY(),qY))).default;for await(let o of(0,BY.default)(s(t,e,r),r.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}function GUe(t,e,r){let i=zUe[r.strategy];if(!i)throw(0,NY.default)(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return i(HUe(t,e,r),$Ue(t,e,r),r)}var NY,BY,zUe,$Ue,MY,LY=xe(()=>{f();NY=Wt(ue());pi();kp();_t();BY=Wt(w_());Rs();_t();xY();RY();kY();zUe={flat:SY,balanced:TY,trickle:CY};$Ue=(t,e,r)=>{async function i(n){if(n.length===1&&n[0].single&&r.reduceSingleLeafToSelf){let l=n[0];if(l.cid.code===Oc&&(t.mtime!==void 0||t.mode!==void 0)){let d=await e.get(l.cid);l.unixfs=new wi({type:"file",mtime:t.mtime,mode:t.mode,data:d}),d=Po(Bs({Data:l.unixfs.marshal()})),l.cid=await Lo(d,e,{...r,codec:Mt,hasher:r.hasher,cidVersion:r.cidVersion}),l.size=d.length}return{cid:l.cid,path:t.path,unixfs:l.unixfs,size:l.size}}let s=new wi({type:"file",mtime:t.mtime,mode:t.mode}),o=n.filter(l=>l.cid.code===Oc&&l.size||l.unixfs&&!l.unixfs.data&&l.unixfs.fileSize()?!0:Boolean(l.unixfs&&l.unixfs.data&&l.unixfs.data.length)).map(l=>l.cid.code===Oc?(s.addBlockSize(l.size),{Name:"",Tsize:l.size,Hash:l.cid}):(!l.unixfs||!l.unixfs.data?s.addBlockSize(l.unixfs&&l.unixfs.fileSize()||0):s.addBlockSize(l.unixfs.data.length),{Name:"",Tsize:l.size,Hash:l.cid})),a={Data:s.marshal(),Links:o},c=Po(Bs(a));return{cid:await Lo(c,e,r),path:t.path,unixfs:s,size:c.length+a.Links.reduce((l,d)=>l+d.Tsize,0)}}return i};MY=GUe});var gn=y((FRt,FY)=>{f();"use strict";var{Buffer:Uo}=Vt(),UY=Symbol.for("BufferList");function ur(t){if(!(this instanceof ur))return new ur(t);ur._init.call(this,t)}ur._init=function(e){Object.defineProperty(this,UY,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ur.prototype._new=function(e){return new ur(e)};ur.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};ur.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};ur.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};ur.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};ur.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Uo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&r||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Uo.concat(this._bufs,this.length);for(let d=0;d<this._bufs.length;d++)this._bufs[d].copy(e,u),u+=this._bufs[d].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,r,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Uo.allocUnsafe(a));for(let d=o[0];d<this._bufs.length;d++){let h=this._bufs[d].length-l;if(c>h)this._bufs[d].copy(e,u,l),u+=h;else{this._bufs[d].copy(e,u,l,l+c),u+=h;break}c-=h,l&&(l=0)}return e.length>u?e.slice(0,u):e};ur.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ur.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};ur.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ur.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};ur.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Uo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Uo.from(e));return this};ur.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ur.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Uo.from([t]):typeof t=="string"?t=Uo.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Uo.from(t.buffer,t.byteOffset,t.byteLength):Uo.isBuffer(t)||(t=Uo.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};ur.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?ur.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:ur.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();ur.prototype._isBufferList=function(e){return e instanceof ur||ur.isBufferList(e)};ur.isBufferList=function(e){return e!=null&&e[UY]};FY.exports=ur});var VY=y((KRt,jY)=>{f();var KY=class{constructor(e,r=12,i=8*1024,n=32*1024,s=64,o){this.bits=r,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(r,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:r,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=r(n(o,c)),l=r(n(a,e)),d=this.rabin.fingerprint(l,u),h=s(d);i(l),i(u);let p=h.indexOf(0);return p>=0?h.subarray(0,p):h}};jY.exports=KY});var rX=y(kb=>{f();"use strict";var AT=-8,V_=-4,WUe=0,zY=1,HY=1<<0,z_=1<<1,jRt=1<<2,VRt=1<<3,$Y=5,zRt=1<<$Y,GY=1<<10,WY=1<<11,HRt=1<<12,YUe=1<<13,YY=14,$Rt=1<<YY,GRt=1<<19,WRt=1<<20,YRt=1<<21,XRt=1<<22,XUe=0,IT=4,QUe=8,ZUe=12,XY=12,JUe=16,eFe=typeof BigUint64Array!="undefined",Cb=Symbol(),Ob=1024;function QY(t,e){let r=new Uint32Array(t),i=new Uint16Array(t);var n=r[e+V_>>>2]>>>1,s=e>>>1;if(n<=Ob)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+Ob-1],c=a>=55296&&a<56320?Ob-1:Ob;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>Ob);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function TT(t){let e={};function r(n,s){return n?QY(n.buffer,s):"<yet unknown>"}let i=t.env=t.env||{};return i.abort=i.abort||function(s,o,a,c){let u=e.memory||i.memory;throw Error("abort: "+r(u,s)+" at "+r(u,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+r(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},t.Math=t.Math||Math,t.Date=t.Date||Date,e}function RT(t,e){let r=e.exports,i=r.memory,n=r.table,s=r.__alloc,o=r.__retain,a=r.__rtti_base||~0;function c(D){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((D>>>=0)>=G)throw Error("invalid id: "+D);return z[(a+4>>>2)+D*2]}function u(D){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((D>>>=0)>=G)throw Error("invalid id: "+D);return z[(a+4>>>2)+D*2+1]}function l(D){return 31-Math.clz32(D>>>$Y&31)}function d(D){return 31-Math.clz32(D>>>YY&31)}function h(D){let z=D.length,G=s(z<<1,zY),Y=new Uint16Array(i.buffer);for(var P=0,b=G>>>1;P<z;++P)Y[b+P]=D.charCodeAt(P);return G}t.__allocString=h;function p(D){let z=i.buffer;if(new Uint32Array(z)[D+AT>>>2]!==zY)throw Error("not a string: "+D);return QY(z,D)}t.__getString=p;function g(D,z,G){let Y=i.buffer;if(G)switch(D){case 2:return new Float32Array(Y);case 3:return new Float64Array(Y)}else switch(D){case 0:return new(z?Int8Array:Uint8Array)(Y);case 1:return new(z?Int16Array:Uint16Array)(Y);case 2:return new(z?Int32Array:Uint32Array)(Y);case 3:return new(z?BigInt64Array:BigUint64Array)(Y)}throw Error("unsupported align: "+D)}function m(D,z){let G=c(D);if(!(G&(HY|z_)))throw Error("not an array: "+D+" @ "+G);let Y=l(G),P=z.length,b=s(P<<Y,WUe),w=s(G&z_?JUe:ZUe,D),S=new Uint32Array(i.buffer);S[w+XUe>>>2]=o(b),S[w+IT>>>2]=b,S[w+QUe>>>2]=P<<Y,G&z_&&(S[w+XY>>>2]=P);let C=g(Y,G&GY,G&WY);if(G&YUe)for(let B=0;B<P;++B)C[(b>>>Y)+B]=o(z[B]);else C.set(z,b>>>Y);return w}t.__allocArray=m;function E(D){let z=new Uint32Array(i.buffer),G=z[D+AT>>>2],Y=c(G);if(!(Y&HY))throw Error("not an array: "+G);let P=l(Y);var b=z[D+IT>>>2];let w=Y&z_?z[D+XY>>>2]:z[b+V_>>>2]>>>P;return g(P,Y&GY,Y&WY).subarray(b>>>=P,b+w)}t.__getArrayView=E;function v(D){let z=E(D),G=z.length,Y=new Array(G);for(let P=0;P<G;P++)Y[P]=z[P];return Y}t.__getArray=v;function A(D){let z=i.buffer,G=new Uint32Array(z)[D+V_>>>2];return z.slice(D,D+G)}t.__getArrayBuffer=A;function R(D,z,G){return new D(F(D,z,G))}function F(D,z,G){let Y=i.buffer,P=new Uint32Array(Y),b=P[G+IT>>>2];return new D(Y,b,P[b+V_>>>2]>>>z)}t.__getInt8Array=R.bind(null,Int8Array,0),t.__getInt8ArrayView=F.bind(null,Int8Array,0),t.__getUint8Array=R.bind(null,Uint8Array,0),t.__getUint8ArrayView=F.bind(null,Uint8Array,0),t.__getUint8ClampedArray=R.bind(null,Uint8ClampedArray,0),t.__getUint8ClampedArrayView=F.bind(null,Uint8ClampedArray,0),t.__getInt16Array=R.bind(null,Int16Array,1),t.__getInt16ArrayView=F.bind(null,Int16Array,1),t.__getUint16Array=R.bind(null,Uint16Array,1),t.__getUint16ArrayView=F.bind(null,Uint16Array,1),t.__getInt32Array=R.bind(null,Int32Array,2),t.__getInt32ArrayView=F.bind(null,Int32Array,2),t.__getUint32Array=R.bind(null,Uint32Array,2),t.__getUint32ArrayView=F.bind(null,Uint32Array,2),eFe&&(t.__getInt64Array=R.bind(null,BigInt64Array,3),t.__getInt64ArrayView=F.bind(null,BigInt64Array,3),t.__getUint64Array=R.bind(null,BigUint64Array,3),t.__getUint64ArrayView=F.bind(null,BigUint64Array,3)),t.__getFloat32Array=R.bind(null,Float32Array,2),t.__getFloat32ArrayView=F.bind(null,Float32Array,2),t.__getFloat64Array=R.bind(null,Float64Array,3),t.__getFloat64ArrayView=F.bind(null,Float64Array,3);function q(D,z){let G=new Uint32Array(i.buffer);var Y=G[D+AT>>>2];if(Y<=G[a>>>2])do if(Y==z)return!0;while(Y=u(Y));return!1}return t.__instanceof=q,t.memory=t.memory||i,t.table=t.table||n,tX(r,t)}function ZY(t){return typeof Response!="undefined"&&t instanceof Response}async function JY(t,e){return ZY(t=await t)?eX(t,e):RT(TT(e||(e={})),await WebAssembly.instantiate(t instanceof WebAssembly.Module?t:await WebAssembly.compile(t),e))}kb.instantiate=JY;function tFe(t,e){return RT(TT(e||(e={})),new WebAssembly.Instance(t instanceof WebAssembly.Module?t:new WebAssembly.Module(t),e))}kb.instantiateSync=tFe;async function eX(t,e){return WebAssembly.instantiateStreaming?RT(TT(e||(e={})),(await WebAssembly.instantiateStreaming(t,e)).instance):JY(ZY(t=await t)?t.arrayBuffer():t,e)}kb.instantiateStreaming=eX;function tX(t,e){var r=e?Object.create(e):{},i=t.__argumentsLength?function(n){t.__argumentsLength.value=n}:t.__setArgumentsLength||t.__setargc||function(){};for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;let s=t[n],o=n.split("."),a=r;for(;o.length>1;){let l=o.shift();Object.prototype.hasOwnProperty.call(a,l)||(a[l]={}),a=a[l]}let c=o[0],u=c.indexOf("#");if(u>=0){let l=c.substring(0,u),d=a[l];if(typeof d=="undefined"||!d.prototype){let h=function(...p){return h.wrap(h.prototype.constructor(0,...p))};h.prototype={valueOf:function(){return this[Cb]}},h.wrap=function(p){return Object.create(h.prototype,{[Cb]:{value:p,writable:!1}})},d&&Object.getOwnPropertyNames(d).forEach(p=>Object.defineProperty(h,p,Object.getOwnPropertyDescriptor(d,p))),a[l]=h}if(c=c.substring(u+1),a=a[l].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let h=t[n.replace("set:","get:")],p=t[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return h(this[Cb])},set:function(g){p(this[Cb],g)},enumerable:!0})}}else c==="constructor"?(a[c]=(...h)=>(i(h.length),s(...h))).original=s:(a[c]=function(...h){return i(h.length),s(this[Cb],...h)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:t[n.replace("set:","get:")],set:t[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...l)=>(i(l.length),s(...l))).original=s:a[c]=s}return r}kb.demangle=tX});var nX=y((ZRt,iX)=>{f();var{instantiate:rFe}=rX();PT.supported=typeof WebAssembly!="undefined";function PT(t={}){if(!PT.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return rFe(new Response(new Blob([e],{type:"application/wasm"})),t)}iX.exports=PT});var aX=y((JRt,oX)=>{f();var sX=VY(),iFe=nX(),nFe=async(t,e,r,i,n)=>{let s=await iFe();return new sX(s,t,e,r,i,n)};oX.exports={Rabin:sX,create:nFe}});var lX={};ut(lX,{default:()=>oFe});async function*sFe(t,e){let r,i,n;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)n=e.avgChunkSize,r=e.minChunkSize,i=e.maxChunkSize;else if(e.avgChunkSize)n=e.avgChunkSize,r=n/3,i=n+n/2;else throw(0,CT.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(r<16)throw(0,CT.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");i<r&&(i=r),n<r&&(n=r);let s=Math.floor(Math.log2(n));for await(let o of aFe(t,{min:r,max:i,bits:s,window:e.window,polynomial:e.polynomial}))yield o}async function*aFe(t,e){let r=await(0,uX.create)(e.bits,e.min,e.max,e.window),i=new cX.default;for await(let n of t){i.append(n);let s=r.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}var cX,uX,CT,oFe,fX=xe(()=>{f();cX=Wt(gn()),uX=Wt(aX()),CT=Wt(ue());oFe=sFe});var dX={};ut(dX,{default:()=>uFe});async function*cFe(t,e){let r=new H_.default,i=0,n=!1,s=e.maxChunkSize;for await(let o of t)for(r.append(o),i+=o.length;i>=s;)if(yield r.slice(0,s),n=!0,s===r.length)r=new H_.default,i=0;else{let a=new H_.default;a.append(r.shallowSlice(s)),r=a,i-=s}(!n||i)&&(yield r.slice(0,i))}var H_,uFe,hX=xe(()=>{f();H_=Wt(gn());uFe=cFe});var pX={};ut(pX,{default:()=>fFe});async function*lFe(t){for await(let e of t){if(e.length===void 0)throw(0,OT.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield V6(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,OT.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var OT,fFe,yX=xe(()=>{f();OT=Wt(ue());ft();fFe=lFe});var gX={};ut(gX,{default:()=>gFe});function dFe(t){return Symbol.iterator in t}function hFe(t){return Symbol.asyncIterator in t}function pFe(t){try{if(t instanceof Uint8Array)return async function*(){yield t}();if(dFe(t))return async function*(){yield*t}();if(hFe(t))return t}catch{throw(0,kT.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,kT.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*yFe(t,e,r){for await(let i of t)if(i.path&&(i.path.substring(0,2)==="./"&&(r.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof r.chunker=="function"?n=r.chunker:r.chunker==="rabin"?n=(await Promise.resolve().then(()=>(fX(),lX))).default:n=(await Promise.resolve().then(()=>(hX(),dX))).default;let s;typeof r.chunkValidator=="function"?s=r.chunkValidator:s=(await Promise.resolve().then(()=>(yX(),pX))).default;let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(pFe(i.content),r),r)};yield()=>MY(o,e,r)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>wY(n,e,r)}else throw new Error("Import candidate must have content or path or both")}var kT,gFe,bX=xe(()=>{f();_Y();LY();kT=Wt(ue());gFe=yFe});var mX,cl,$_=xe(()=>{f();mX=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},cl=mX});var vX,qb,qT=xe(()=>{f();_t();pi();$_();kp();vX=class extends cl{constructor(e,r){super(e,r);this._children={}}async put(e,r){this.cid=void 0,this.size=void 0,this._children[e]=r}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let r=0;r<e.length;r++){let i=e[r];yield{key:i,child:this._children[i]}}}async*flush(e){let r=Object.keys(this._children),i=[];for(let u=0;u<r.length;u++){let l=this._children[r[u]];if(l instanceof cl)for await(let d of l.flush(e))l=d,yield l;l.size!=null&&l.cid&&i.push({Name:r[u],Tsize:l.size,Hash:l.cid})}let n=new wi({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=Po(Bs(s)),a=await Lo(o,e,this.options),c=o.length+s.Links.reduce((u,l)=>u+(l.Tsize==null?0:l.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}},qb=vX});var EX=y((l8t,_X)=>{f();"use strict";var G_=7;_X.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,r){let i=this._internalPositionFor(e,!1);if(r===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,r,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let r=this._internalPositionFor(e,!0);if(r!==-1)return this._data[r][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let r=0;for(;r<this.length;)e(this.get(r),r,this),r++}map(e){let r=0,i=new Array(this.length);for(;r<this.length;)i[r]=e(this.get(r),r,this),r++;return i}reduce(e,r){let i=0,n=r;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let r=0,i,n;for(;r<this.length&&!i;)n=this.get(r),i=e(n),r++;return i?n:void 0}_internalPositionFor(e,r){let i=this._bytePosFor(e,r);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*G_;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(bFe,0),c=~(4294967295<<s+1),u=wX(n&c);return a+u-1}_bytePosFor(e,r){let i=Math.floor(e/G_),n=i+1;for(;!r&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*G_}_unsetBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*G_)}_setInternalPos(e,r,i,n){let s=this._data,o=[r,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=r)s.push(o);else if(s[0][0]<=r)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(mFe),this._changedData=!1}bitField(){let e=[],r=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,r),u=~(255<<c);n|=(s&u)<<8-r,s=s>>>c,i-=c,r-=c,(!r||!i&&!o.length)&&(e.push(n),n=0,r=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(vFe)}};function bFe(t,e){return t+wX(e)}function wX(t){let e=t;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function mFe(t,e){return t[0]-e[0]}function vFe(t){return t[1]}});var AX=y((f8t,xX)=>{f();"use strict";var wFe=EX(),{fromString:_Fe}=(ft(),ht),Fo=class{constructor(e,r,i=0){this._options=e,this._popCount=0,this._parent=r,this._posAtParent=i,this._children=new wFe,this.key=null}async put(e,r){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,r)}async get(e){let r=await this._findChild(e);if(r)return r.value}async del(e){let r=await this._findPlace(e),i=r.bucket._at(r.pos);i&&i.key===e&&r.bucket._delAt(r.pos)}leafCount(){return this._children.compactArray().reduce((r,i)=>i instanceof Fo?r+i.leafCount():r+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let r of e)r instanceof Fo?yield*r.eachLeafSeries():yield r;return[]}serialize(e,r){let i=[];return r(this._children.reduce((n,s,o)=>(s&&(s instanceof Fo?n.push(s.serialize(e,r)):n.push(e(s,o))),n),i))}asyncTransform(e,r){return SX(this,e,r)}toJSON(){return this.serialize(SFe,xFe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let r=await this._findPlace(e),i=r.bucket._at(r.pos);if(!(i instanceof Fo)&&i&&i.key===e)return i}async _findPlace(e){let r=this._options.hash(typeof e=="string"?_Fe(e):e),i=await r.take(this._options.bits),n=this._children.get(i);return n instanceof Fo?n._findPlace(r):{bucket:this,pos:i,hash:r,existingChild:n}}async _findNewBucketAndPos(e){let r=await this._findPlace(e);if(r.existingChild&&r.existingChild.key!==e){let i=new Fo(this._options,r.bucket,r.pos);r.bucket._putObjectAt(r.pos,i);let n=await i._findPlace(r.existingChild.hash);return n.bucket._putAt(n,r.existingChild.key,r.existingChild.value),i._findNewBucketAndPos(r.hash)}return r}_putAt(e,r,i){this._putObjectAt(e.pos,{key:r,value:i,hash:e.hash})}_putObjectAt(e,r){this._children.get(e)||this._popCount++,this._children.set(e,r)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(EFe);if(e&&!(e instanceof Fo)){let r=e.hash;r.untake(this._options.bits);let i={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function EFe(t){return Boolean(t)}function SFe(t,e){return t.key}function xFe(t){return t}async function SX(t,e,r){let i=[];for(let n of t._children.compactArray())if(n instanceof Fo)await SX(n,e,r);else{let s=await e(n);i.push({bitField:t._children.bitField(),children:s})}return r(i)}xX.exports=Fo});var TX=y((h8t,IX)=>{f();"use strict";var AFe=[255,254,252,248,240,224,192,128],IFe=[1,3,7,15,31,63,127,255];IX.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let r=e,i=0;for(;r&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,r),a=TFe(n,s-o,o);i=(i<<o)+a,r-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function TFe(t,e,r){let i=RFe(e,r);return(t&i)>>>e}function RFe(t,e){return AFe[t]&IFe[Math.min(e+t-1,7)]}});var RX=y((p8t,DT)=>{f();"use strict";var PFe=TX(),{concat:CFe}=(un(),cn);function OFe(t){function e(r){return r instanceof W_?r:new W_(r,t)}return e}var W_=class{constructor(e,r){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let r=e;for(;this._availableBits<r;)await this._produceMoreBits();let i=0;for(;r>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),r),o=n.take(s);i=(i<<s)+o,r-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let r=e;for(;r>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),r);i.untake(n),r-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?CFe([this._value,Uint8Array.from([this._depth])]):this._value,r=await this._hashFn(e),i=new PFe(r);this._buffers.push(i),this._availableBits+=i.availableBits()}};DT.exports=OFe;DT.exports.InfiniteHash=W_});var Db=y((y8t,CX)=>{f();"use strict";var PX=AX(),kFe=RX();function qFe(t){if(!t||!t.hashFn)throw new Error("please define an options.hashFn");let e={bits:t.bits||8,hash:kFe(t.hashFn)};return new PX(e)}CX.exports={createHAMT:qFe,Bucket:PX}});async function*qX(t,e,r,i){let n=t._children,s=[],o=0;for(let p=0;p<n.length;p++){let g=n.get(p);if(!g)continue;let m=p.toString(16).toUpperCase().padStart(2,"0");if(g instanceof Y_.Bucket){let E;for await(let v of await qX(g,e,null,i))E=v;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:m,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,v;for await(let R of E.flush(e))v=R,yield v;let A=m+g.key;s.push({Name:A,Tsize:v.size,Hash:v.cid}),o+=v.size}else{let E=g.value;if(!E.cid)continue;let v=m+g.key,A=E.size;s.push({Name:v,Tsize:A,Hash:E.cid}),o+=A}}let a=Uint8Array.from(n.bitField().reverse()),c=new wi({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:i.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),u={Data:c.marshal(),Links:s},l=Po(Bs(u)),d=await Lo(l,e,i),h=l.length+o;yield{cid:d,unixfs:c,size:h}}var Y_,OX,kX,DX=xe(()=>{f();_t();pi();$_();kp();Y_=Wt(Db()),OX=class extends cl{constructor(e,r){super(e,r);this._bucket=(0,Y_.createHAMT)({hashFn:r.hamtHashFn,bits:r.hamtBucketBits})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){for await(let r of qX(this._bucket,e,this,this.options))yield{...r,path:this.path}}},kX=OX});async function NX(t,e,r,i){let n=e;e instanceof qb&&e.directChildrenCount()>=r&&(n=await DFe(e,i));let s=n.parent;if(s){if(n!==e){if(t&&(t.parent=n),!n.parentKey)throw new Error("No parent key found");await s.put(n.parentKey,n)}return NX(n,s,r,i)}return n}async function DFe(t,e){let r=new kX({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},e);for await(let{key:i,child:n}of t.eachChildSeries())await r.put(i,n);return r}var BX,MX=xe(()=>{f();DX();qT();BX=NX});var NFe,LX,UX=xe(()=>{f();NFe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),LX=NFe});var KX={};ut(KX,{default:()=>LFe});async function BFe(t,e,r){let i=LX(t.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let u=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,t),e=await BX(null,s,r.shardSplitThreshold,r);else{let l=await s.get(c);(!l||!(l instanceof cl))&&(l=new qb({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:l&&l.unixfs&&l.unixfs.mtime,mode:l&&l.unixfs&&l.unixfs.mode},r)),await s.put(c,l),s=l}}return e}async function*FX(t,e){if(!(t instanceof cl)){t&&t.unixfs&&t.unixfs.isDirectory()&&(yield t);return}yield*t.flush(e)}async function*MFe(t,e,r){let i=new qb({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(let n of t)!n||(i=await BFe(n,i,r),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(r.wrapWithDirectory)yield*FX(i,e);else for await(let n of i.eachChildSeries())!n||(yield*FX(n.child,e))}var LFe,jX=xe(()=>{f();qT();MX();$_();UX();LFe=MFe});var X_={};ut(X_,{importer:()=>UFe});async function*UFe(t,e,r={}){let i=mY(r),n;typeof r.dagBuilder=="function"?n=r.dagBuilder:n=(await Promise.resolve().then(()=>(bX(),gX))).default;let s;typeof r.treeBuilder=="function"?s=r.treeBuilder:s=(await Promise.resolve().then(()=>(jX(),KX))).default;let o;Symbol.asyncIterator in t||Symbol.iterator in t?o=t:o=[t];for await(let a of s((0,VX.default)(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}var VX,Q_=xe(()=>{f();VX=Wt(w_());vY()});var Nb=y((C8t,zX)=>{f();"use strict";async function*FFe(t,e={}){let r=t.getReader();try{for(;;){let i=await r.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&r.cancel(),r.releaseLock()}}zX.exports=FFe});var GX=y((O8t,$X)=>{f();"use strict";var HX=Nb();function KFe(t){return typeof t.stream=="function"?HX(t.stream()):HX(new Response(t).body)}$X.exports=KFe});var Bb=y((k8t,WX)=>{f();"use strict";function jFe(t){let[e,r]=t[Symbol.asyncIterator]?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[r](){return this}}}WX.exports=jFe});var Z_=y((q8t,YX)=>{f();"use strict";function VFe(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function zFe(t){return t.constructor&&(t.constructor.name==="Blob"||t.constructor.name==="File")&&typeof t.stream=="function"}function HFe(t){return typeof t=="object"&&(t.path||t.content)}var $Fe=t=>t&&typeof t.getReader=="function";YX.exports={isBytes:VFe,isBlob:zFe,isFileObject:HFe,isReadableStream:$Fe}});var ZX=y((D8t,QX)=>{f();"use strict";var GFe=ue(),{fromString:WFe}=(ft(),ht),YFe=Nb(),XFe=GX(),QFe=Bb(),ZFe=ap(),JFe=No(),{isBytes:XX,isReadableStream:eKe,isBlob:tKe}=Z_();async function*rKe(t){if(XX(t)){yield NT(t);return}if(typeof t=="string"||t instanceof String){yield NT(t.toString());return}if(tKe(t)){yield*XFe(t);return}if(eKe(t)&&(t=YFe(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=QFe(t),{value:r,done:i}=await e.peek();if(i){yield*[];return}if(e.push(r),Number.isInteger(r)){yield Uint8Array.from(await ZFe(e));return}if(XX(r)||typeof r=="string"||r instanceof String){yield*JFe(e,NT);return}}throw GFe(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}function NT(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?Uint8Array.from(t):WFe(t.toString())}QX.exports=rKe});var BT=y((N8t,sQ)=>{f();"use strict";var JX=ue(),iKe=Nb(),nKe=Bb(),eQ=No(),{isBytes:tQ,isBlob:rQ,isReadableStream:iQ,isFileObject:nQ}=Z_(),{parseMtime:sKe,parseMode:oKe}=(pi(),as);sQ.exports=async function*(e,r){if(e==null)throw JX(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield qp(e.toString(),r);return}if(tQ(e)||rQ(e)){yield qp(e,r);return}if(iQ(e)&&(e=iKe(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let i=nKe(e),{value:n,done:s}=await i.peek();if(s){yield*[];return}if(i.push(n),Number.isInteger(n)||tQ(n)){yield qp(i,r);return}if(nQ(n)||rQ(n)||typeof n=="string"||n instanceof String){yield*eQ(i,o=>qp(o,r));return}if(n[Symbol.iterator]||n[Symbol.asyncIterator]||iQ(n)){yield*eQ(i,o=>qp(o,r));return}}if(nQ(e)){yield qp(e,r);return}throw JX(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")};async function qp(t,e){let{path:r,mode:i,mtime:n,content:s}=t,o={path:r||"",mode:oKe(i),mtime:sKe(n)};return s?o.content=await e(s):r||(o.content=await e(t)),o}});var aQ=y((B8t,oQ)=>{f();"use strict";var aKe=ZX(),cKe=BT();function uKe(t){return cKe(t,aKe)}oQ.exports={normaliseInput:uKe}});var lQ=y((M8t,uQ)=>{f();"use strict";var lKe=t=>{if(t)if(t.startsWith("size-")){let e=t.split("-")[1],r=parseInt(e);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}else{if(t.startsWith("rabin"))return{chunker:"rabin",...cQ(t)};throw new Error(`Unrecognized chunker option: ${t}`)}else return{chunker:"fixed"}},cQ=t=>{let e={},r=t.split("-");switch(r.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Mb(r[1],"avg");break;case 4:e.minChunkSize=Mb(r[1],"min"),e.avgChunkSize=Mb(r[2],"avg"),e.maxChunkSize=Mb(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Mb=(t,e)=>{let r=parseInt(t);if(isNaN(r))throw new Error(`Chunker parameter ${e} must be an integer`);return r};uQ.exports={parseChunkSize:Mb,parseRabinString:cQ,parseChunkerString:lKe}});var dQ=y((L8t,fQ)=>{f();"use strict";var{importer:fKe}=(Q_(),X_),{normaliseInput:dKe}=aQ(),{parseChunkerString:hKe}=lQ(),{pipe:pKe}=Ar(),yKe=qe(),gKe=gr().bind({ignoreUndefined:!0});fQ.exports=({repo:t,preload:e,options:r})=>{let i=r&&r.sharding;async function*n(s,o={}){let a=gKe({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},o,{...hKe(o.chunker)});a.hashAlg&&a.hashAlg!=="sha2-256"&&a.cidVersion!==1&&(a.cidVersion=1),a.trickle&&(a.strategy="trickle"),a.strategy==="trickle"&&(a.leafType="raw",a.reduceSingleLeafToSelf=!1),a.cidVersion>0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),a.hashAlg!==void 0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),delete a.trickle;let c={};if(a.progress){let d=a.progress;a.progress=(h,p)=>{c[p]||(c[p]=0),c[p]+=h,d(c[p],p)}}let u=pKe(dKe(s),d=>fKe(d,t.blocks,{...a,pin:!1}),bKe(a),mKe(e,a),vKe(t,a)),l=await t.gcLock.readLock();try{for await(let d of u)delete c[d.path],yield d}finally{l()}}return yKe(n)};function bKe(t){async function*e(r){for await(let i of r){let n=i.cid;t.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();t.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function mKe(t,e){async function*r(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&t(n.cid),yield n}return r}function vKe(t,e){async function*r(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await t.pins.pinRecursively(n.cid),yield n}}return r}});var J_,wKe,_Ke,hQ,EKe,pQ,yQ,gQ=xe(()=>{f();J_=Wt(Db());_t();j_();wKe=async function(t){return(await Pb.encode(t)).slice(0,8).reverse()},_Ke=(t,e,r)=>Promise.all(t.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new J_.Bucket({hash:r._options.hash,bits:r._options.bits},e,n))}return r.put(i.Name.substring(2),!0)})),hQ=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),EKe=t=>{let e=t.bucket,r=[];for(;e._parent;)r.push(e),e=e._parent;return r.push(e),r.reverse()},pQ=async(t,e,r,i,n)=>{if(!i){let l=(0,J_.createHAMT)({hashFn:wKe});i={rootBucket:l,hamtDepth:1,lastBucket:l}}await _Ke(t.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=hQ(s.pos),a=EKe(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=hQ(i.lastBucket._posAtParent));let c=t.Links.find(l=>{if(l.Name==null)return!1;let d=l.Name.substring(0,2),h=l.Name.substring(2);return!(d!==o||h&&h!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let u=await r.get(c.Hash,n);return t=jc(u),pQ(t,e,r,i,n)},yQ=pQ});function SKe(t,e,r,i){let n=t.length,s=e+n;return r>=s||i<e?new Uint8Array(0):(i>=e&&i<s&&(t=t.slice(0,i-e)),r>=e&&r<s&&(t=t.slice(r-e)),t)}var Vf,e2=xe(()=>{f();Vf=SKe});var t2,xKe,Dp,r2=xe(()=>{f();t2=Wt(ue()),xKe=(t,e,r)=>{if(e||(e=0),e<0)throw(0,t2.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>t)throw(0,t2.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!r&&r!==0&&(r=t-e),r<0)throw(0,t2.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+r>t&&(r=t-e),{offset:e,length:r}},Dp=xKe});async function*bQ(t,e,r,i,n=0,s){if(e instanceof Uint8Array){let c=Vf(e,n,r,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw(0,MT.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=wi.unmarshal(e.Data)}catch(c){throw(0,MT.default)(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=Vf(o.data,n,r,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],l=n+o.blockSizes[c];if(r>=a&&r<l||i>a&&i<=l||r<a&&i>l){let d=await t.get(u.Hash,{signal:s.signal}),h;switch(u.Hash.code){case Mg:h=await jc(d);break;case Oc:h=d;break;case Hg:h=await Pf(d);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let p of bQ(t,h,r,i,n,s))n+=p.length,yield p}n=l,a=l+1}}var MT,AKe,LT,mQ=xe(()=>{f();e2();r2();pi();MT=Wt(ue());_t();zc();Rs();AKe=(t,e,r,i,n,s,o)=>{function a(c={}){let u=r.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:l,length:d}=Dp(u,c.offset,c.length),h=l,p=l+d;return bQ(o,e,h,p,0,c)}return a},LT=AKe});var IKe,vQ,wQ=xe(()=>{f();IKe=(t,e,r,i,n,s,o)=>{async function*a(c={}){let u=c.offset||0,l=c.length||e.Links.length,d=e.Links.slice(u,l);for(let h of d){let p=await n(h.Hash,h.Name||"",`${i}/${h.Name||""}`,[],s+1,o,c);p.entry&&(yield p.entry)}}return a},vQ=IKe});async function*_Q(t,e,r,i,n,s){let o=t.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await r(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let u=await n.get(a.Hash);t=jc(u);for await(let l of _Q(t,e,r,i,n,s))yield l}}}var TKe,EQ,SQ=xe(()=>{f();_t();TKe=(t,e,r,i,n,s,o)=>{function a(c={}){return _Q(e,i,n,s,o,c)}return a};EQ=TKe});var i2,RKe,PKe,CKe,xQ,AQ=xe(()=>{f();i2=Wt(ue());pi();gQ();_t();mQ();wQ();SQ();RKe=(t,e)=>{let r=t.Links.find(i=>i.Name===e);return r&&r.Hash},PKe={raw:LT,file:LT,directory:vQ,"hamt-sharded-directory":EQ,metadata:(t,e,r,i,n,s,o)=>()=>[],symlink:(t,e,r,i,n,s,o)=>()=>[]},CKe=async(t,e,r,i,n,s,o,a)=>{let c=await o.get(t,a),u=jc(c),l,d;if(e||(e=t.toString()),u.Data==null)throw(0,i2.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=wi.unmarshal(u.Data)}catch(h){throw(0,i2.default)(h,"ERR_NOT_UNIXFS")}if(r||(r=e),i.length){let h;if(l&&l.type==="hamt-sharded-directory"?h=await yQ(u,i[0],o):h=RKe(u,i[0]),!h)throw(0,i2.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let p=i.shift(),g=`${r}/${p}`;d={cid:h,toResolve:i,name:p||"",path:g}}return{entry:{type:l.isDirectory()?"directory":"file",name:e,path:r,cid:t,content:PKe[l.type](t,u,l,r,n,s,o),unixfs:l,depth:s,node:u,size:l.fileSize()},next:d}},xQ=CKe});var IQ,OKe,kKe,TQ,RQ=xe(()=>{f();IQ=Wt(ue());e2();r2();OKe=t=>{async function*e(r={}){let{offset:i,length:n}=Dp(t.length,r.offset,r.length);yield Vf(t,0,i,i+n)}return e},kKe=async(t,e,r,i,n,s,o,a)=>{if(i.length)throw(0,IQ.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await o.get(t,a);return{entry:{type:"raw",name:e,path:r,cid:t,content:OKe(c),depth:s,size:c.length,node:c}}},TQ=kKe});var PQ,qKe,CQ,OQ=xe(()=>{f();Ie();PQ=Wt(ue());zc();qKe=async(t,e,r,i,n,s,o,a)=>{let c=await o.get(t),u=Pf(c),l=u,d=r;for(;i.length;){let h=i[0];if(h in l){i.shift(),d=`${d}/${h}`;let p=We.asCID(l[h]);if(p)return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield u}},next:{cid:p,name:h,path:d,toResolve:i}};l=l[h]}else throw(0,PQ.default)(new Error(`No property named ${h} found in cbor node ${t}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield u}}}},CQ=qKe});var kQ,DKe,NKe,qQ,DQ=xe(()=>{f();kQ=Wt(ue());e2();r2();xn();DKe=t=>{async function*e(r={}){let{offset:i,length:n}=Dp(t.length,r.offset,r.length);yield Vf(t,0,i,i+n)}return e},NKe=async(t,e,r,i,n,s,o,a)=>{if(i.length)throw(0,kQ.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await Pu(t.multihash.bytes);return{entry:{type:"identity",name:e,path:r,cid:t,content:DKe(c.digest),depth:s,size:c.digest.length,node:c.digest}}},qQ=NKe});function BQ(t,e,r,i,n,s,o){let a=BKe[t.code];if(!a)throw(0,NQ.default)(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return a(t,e,r,i,BQ,n,s,o)}var NQ,BKe,MQ,LQ=xe(()=>{f();NQ=Wt(ue());_t();zc();Rs();Cc();AQ();RQ();OQ();DQ();BKe={[Mg]:xQ,[Oc]:TQ,[Hg]:CQ,[L6.code]:qQ};MQ=BQ});var Ko={};ut(Ko,{exporter:()=>KQ,recursive:()=>UKe,walkPath:()=>FQ});async function*FQ(t,e,r={}){let{cid:i,toResolve:n}=LKe(t),s=i.toString(),o=s,a=n.length;for(;;){let c=await MQ(i,s,o,n,a,e,r);if(!c.entry&&!c.next)throw(0,n2.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function KQ(t,e,r={}){let i=await(0,UQ.default)(FQ(t,e,r));if(!i)throw(0,n2.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");return i}async function*UKe(t,e,r={}){let i=await KQ(t,e,r);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,r))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}var n2,UQ,MKe,LKe,jo=xe(()=>{f();n2=Wt(ue());Ie();LQ();UQ=Wt($n()),MKe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),LKe=t=>{if(t instanceof Uint8Array)return{cid:We.decode(t),toResolve:[]};let e=We.asCID(t);if(e)return{cid:e,toResolve:[]};if(typeof t=="string"){t.indexOf("/ipfs/")===0&&(t=t.substring(6));let r=MKe(t);return{cid:We.parse(r[0]),toResolve:r.slice(1)}}throw(0,n2.default)(new Error(`Unknown path type ${t}`),"ERR_BAD_PATH")}});var VQ=y((RPt,jQ)=>{f();"use strict";var{exporter:FKe}=(jo(),Ko),{normalizeCidPath:KKe}=Ki(),jKe=qe(),{CID:VKe}=(Ie(),Ne);jQ.exports=function({repo:t,preload:e}){async function*r(i,n={}){if(i=KKe(i),n.preload!==!1){let o=i.split("/");e(VKe.parse(o[0]))}let s=await FKe(i,t.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return jKe(r)}});var ul=y((PPt,zQ)=>{f();"use strict";var zKe=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};zQ.exports=zKe});var GQ=y(o2=>{f();var{Buffer:UT}=Vt(),Np=gn(),HKe="0".charCodeAt(0),$Ke=UT.from("ustar\0","binary"),GKe=UT.from("ustar ","binary"),WKe=UT.from(" \0","binary"),s2=257,HQ=263,YKe=function(t,e,r){return typeof t!="number"?r:(t=~~t,t>=e?e:t>=0||(t+=e,t>=0)?t:0)},XKe=function(t){switch(t){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},$Q=function(t,e,r,i){for(;r<i;r++)if(t.get(r)===e)return r;return i},QKe=function(t){let e=8*32;for(let r=0;r<148;r++)e+=t.get(r);for(let r=156;r<512;r++)e+=t.get(r);return e};function ZKe(t){let e;if(t.get(0)===128)e=!0;else if(t.get(0)===255)e=!1;else return null;let r=!1,i=[];for(let o=t.length-1;o>0;o--){let a=t.get(o);e?i.push(a):r&&a===0?i.push(0):r?(r=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var ll=function(t,e,r){if(t=t.shallowSlice(e,e+r),e=0,t.get(e)&128)return ZKe(t);{for(;e<t.length&&t.get(e)===32;)e++;let i=YKe($Q(t,32,e,t.length),t.length,t.length);for(;e<i&&t.get(e)===0;)e++;return i===e?0:parseInt(t.shallowSlice(e,i).toString(),8)}},Bp=function(t,e,r,i){return t.shallowSlice(e,$Q(t,0,e,e+r)).toString(i)};o2.decodeLongPath=function(t,e){return t=Np.isBufferList(t)?t:new Np(t),Bp(t,0,t.length,e)};o2.decodePax=function(t){t=Np.isBufferList(t)?t:new Np(t);let e={};for(;t.length;){let r=0;for(;r<t.length&&t.get(r)!==32;)r++;let i=parseInt(t.shallowSlice(0,r).toString(),10);if(!i)return e;let n=t.shallowSlice(r+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),t=t.shallowSlice(i)}return e};o2.decode=function(t,e){t=Np.isBufferList(t)?t:new Np(t);let r=t.get(156)===0?0:t.get(156)-HKe,i=Bp(t,0,100,e),n=ll(t,100,8),s=ll(t,108,8),o=ll(t,116,8),a=ll(t,124,12),c=ll(t,136,12),u=XKe(r),l=t.get(157)===0?null:Bp(t,157,100,e),d=Bp(t,265,32),h=Bp(t,297,32),p=ll(t,329,8),g=ll(t,337,8),m=QKe(t);if(m===8*32)return null;if(m!==ll(t,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if($Ke.compare(t.slice(s2,s2+6))===0)t.get(345)&&(i=Bp(t,345,155,e)+"/"+i);else if(!(GKe.compare(t.slice(s2,s2+6))===0&&WKe.compare(t.slice(HQ,HQ+2))===0))throw new Error("Invalid tar header: unknown format.");return r===0&&i&&i[i.length-1]==="/"&&(r=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:u,linkname:l,uname:d,gname:h,devmajor:p,devminor:g}}});var a2=y((OPt,WQ)=>{f();var FT=gn();WQ.exports=t=>{let e=async function*(){let r=yield,i=new FT;for await(let n of t){if(!r){r=yield i.append(n),i=new FT;continue}for(i.append(n);i.length>=r;){let s=i.shallowSlice(0,r);if(i.consume(r),r=yield s,!r){i.length&&(r=yield i,i=new FT);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var XQ=y((kPt,YQ)=>{f();var KT=gn(),JKe=a2();YQ.exports=function(e){let r=JKe(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await r.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new KT([i,a]),i=null}return{value:o}}return r.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=KT.isBufferList(a)?a:new KT(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return r.return()}};return n}});var ZQ=y((qPt,QQ)=>{f();var eje=ul(),Lb=GQ(),tje=XQ();function rje(t){return t&=511,t&&512-t}async function Ub(t,e){let r=rje(e);r&&await t.next(r)}QQ.exports=t=>(t=t||{},t.highWaterMark=t.highWaterMark||1024*16,e=>async function*(){let r=tje(e),i,n,s,o;try{for(;;){let a;try{let{done:p,value:g}=await r.next(512);if(p)return;a=g}catch(p){if(p.code==="ERR_UNDER_READ")return;throw p}let c=Lb.decode(a,t.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:p,value:g}=await r.next(c.size);if(p)return;i=Lb.decodeLongPath(g,t.filenameEncoding),await Ub(r,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:p,value:g}=await r.next(c.size);if(p)return;n=Lb.decodeLongPath(g,t.filenameEncoding),await Ub(r,c.size);continue}if(c.type==="pax-global-header"){let{done:p,value:g}=await r.next(c.size);if(p)return;s=Lb.decodePax(g,t.filenameEncoding),await Ub(r,c.size);continue}if(c.type==="pax-header"){let{done:p,value:g}=await r.next(c.size);if(p)return;o=Lb.decodePax(g,t.filenameEncoding),s&&(o={...s,...o}),await Ub(r,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let u=c.size,l=eje(),d=await r.nextLte(Math.min(u,t.highWaterMark));u-=d.value.length,u||l.resolve();let h=async function*(){try{for(yield d.value;u;){let{done:p,value:g}=await r.nextLte(u);if(p){u=0;return}u-=g.length,yield g}}finally{l.resolve()}}();if(yield{header:c,body:h},await l.promise,u)for await(let p of h);await Ub(r,c.size)}}finally{await r.return()}}())});var eZ=y((DPt,JQ)=>{f();"use strict";JQ.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488319,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var rZ=y((NPt,tZ)=>{f();var ije=gn(),jT={string:()=>"",buffer:()=>ije()};tZ.exports=async(t,e)=>{if(e=e||{},e.type&&!jT[e.type])throw new Error(`invalid type "${e.type}"`);let r,i;for await(let n of t)r||(i=e.type||(typeof n=="string"?"string":"buffer"),r=jT[i]()),i==="string"?r+=n:r.append(n);return r||jT[e.type||"buffer"]()}});var iZ=y(zT=>{f();var{Buffer:Va}=Vt(),nje=Va.alloc,sje="0000000000000000000",oje="7777777777777777777",aje="0".charCodeAt(0),cje=Va.from("ustar\0","binary"),uje=Va.from("00","binary"),lje=parseInt("7777",8),fje=257,dje=263,hje=function(t){switch(t){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},pje=function(t){let e=8*32;for(let r=0;r<148;r++)e+=t[r];for(let r=156;r<512;r++)e+=t[r];return e},fl=function(t,e){return t=t.toString(8),t.length>e?oje.slice(0,e)+" ":sje.slice(0,e-t.length)+t+" "},VT=function(t){let e=Va.byteLength(t),r=Math.floor(Math.log(e)/Math.log(10))+1;return e+r>=Math.pow(10,r)&&r++,e+r+t};zT.encodePax=function(t){let e="";t.name&&(e+=VT(" path="+t.name+`
`)),t.linkname&&(e+=VT(" linkpath="+t.linkname+`
`));let r=t.pax;if(r)for(let i in r)e+=VT(" "+i+"="+r[i]+`
`);return Va.from(e)};zT.encode=function(t){let e=nje(512),r=t.name,i="";if(t.typeflag===5&&r[r.length-1]!=="/"&&(r+="/"),Va.byteLength(r)!==r.length)return null;for(;Va.byteLength(r)>100;){let n=r.indexOf("/");if(n===-1)return null;i+=i?"/"+r.slice(0,n):r.slice(0,n),r=r.slice(n+1)}return Va.byteLength(r)>100||Va.byteLength(i)>155||t.linkname&&Va.byteLength(t.linkname)>100?null:(e.write(r),e.write(fl(t.mode&lje,6),100),e.write(fl(t.uid,6),108),e.write(fl(t.gid,6),116),e.write(fl(t.size,11),124),e.write(fl(t.mtime.getTime()/1e3|0,11),136),e[156]=aje+hje(t.type),t.linkname&&e.write(t.linkname,157),cje.copy(e,fje),uje.copy(e,dje),t.uname&&e.write(t.uname,265),t.gname&&e.write(t.gname,297),e.write(fl(t.devmajor||0,6),329),e.write(fl(t.devminor||0,6),337),i&&e.write(i,345),e.write(fl(pje(e),6),148),e)}});var oZ=y((MPt,sZ)=>{f();var{Buffer:HT}=Vt(),zf=gn(),{S_IFMT:yje,S_IFBLK:gje,S_IFCHR:bje,S_IFDIR:mje,S_IFIFO:vje,S_IFLNK:wje}=eZ(),_je=rZ(),c2=iZ(),Eje=parseInt("755",8),Sje=parseInt("644",8),nZ=HT.alloc(1024);function xje(t){switch(t&yje){case gje:return"block-device";case bje:return"character-device";case mje:return"directory";case vje:return"fifo";case wje:return"symlink"}return"file"}function $T(t){if(t&=511,t)return new zf(nZ.slice(0,512-t))}function GT(t){if(!t.pax){let e=c2.encode(t);if(e)return e}return Aje(t)}function Aje(t){let e=c2.encodePax({name:t.name,linkname:t.linkname,pax:t.pax}),r={name:"PaxHeader",mode:t.mode,uid:t.uid,gid:t.gid,size:e.length,mtime:t.mtime,type:"pax-header",linkname:t.linkname&&"PaxHeader",uname:t.uname,gname:t.gname,devmajor:t.devmajor,devminor:t.devminor};return new zf([c2.encode(r),e,$T(e.length),c2.encode({...r,size:t.size,type:t.type})])}sZ.exports=()=>async function*(t){for await(let{header:e,body:r}of t){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=xje(e.mode)),e.mode||(e.mode=e.type==="directory"?Eje:Sje),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof r=="string"&&(r=HT.from(r)),HT.isBuffer(r)||zf.isBufferList(r)){e.size=r.length,yield new zf([GT(e),r,$T(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await _je(r)).toString(),yield GT(e);continue}if(yield GT(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of r)i+=s.length,yield zf.isBufferList(s)?s:new zf(s);if(i!==e.size)throw new Error("size mismatch");let n=$T(e.size);n&&(yield n)}yield new zf(nZ)}});var aZ=y(WT=>{f();WT.extract=ZQ();WT.pack=oZ()});var Yc=y(Cn=>{f();"use strict";var Ije=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function Tje(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Cn.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(var i in r)Tje(r,i)&&(t[i]=r[i])}}return t};Cn.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var Rje={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray){t.set(e.subarray(r,r+i),n);return}for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,o;for(i=0,e=0,r=t.length;e<r;e++)i+=t[e].length;for(o=new Uint8Array(i),n=0,e=0,r=t.length;e<r;e++)s=t[e],o.set(s,n),n+=s.length;return o}},Pje={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};Cn.setTyped=function(t){t?(Cn.Buf8=Uint8Array,Cn.Buf16=Uint16Array,Cn.Buf32=Int32Array,Cn.assign(Cn,Rje)):(Cn.Buf8=Array,Cn.Buf16=Array,Cn.Buf32=Array,Cn.assign(Cn,Pje))};Cn.setTyped(Ije)});var CZ=y(Up=>{f();"use strict";var Cje=Yc(),Oje=4,cZ=0,uZ=1,kje=2;function Mp(t){for(var e=t.length;--e>=0;)t[e]=0}var qje=0,lZ=1,Dje=2,Nje=3,Bje=258,YT=29,Fb=256,Kb=Fb+1+YT,Lp=30,XT=19,fZ=2*Kb+1,Hf=15,QT=16,Mje=7,ZT=256,dZ=16,hZ=17,pZ=18,JT=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u2=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Lje=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],yZ=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Uje=512,Xc=new Array((Kb+2)*2);Mp(Xc);var jb=new Array(Lp*2);Mp(jb);var Vb=new Array(Uje);Mp(Vb);var zb=new Array(Bje-Nje+1);Mp(zb);var e5=new Array(YT);Mp(e5);var l2=new Array(Lp);Mp(l2);function t5(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}var gZ,bZ,mZ;function r5(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function vZ(t){return t<256?Vb[t]:Vb[256+(t>>>7)]}function Hb(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Qn(t,e,r){t.bi_valid>QT-r?(t.bi_buf|=e<<t.bi_valid&65535,Hb(t,t.bi_buf),t.bi_buf=e>>QT-t.bi_valid,t.bi_valid+=r-QT):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function za(t,e,r){Qn(t,r[e*2],r[e*2+1])}function wZ(t,e){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1}function Fje(t){t.bi_valid===16?(Hb(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function Kje(t,e){var r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,u,l,d,h,p,g,m=0;for(h=0;h<=Hf;h++)t.bl_count[h]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<fZ;u++)l=t.heap[u],h=r[r[l*2+1]*2+1]+1,h>c&&(h=c,m++),r[l*2+1]=h,!(l>i)&&(t.bl_count[h]++,p=0,l>=a&&(p=o[l-a]),g=r[l*2],t.opt_len+=g*(h+p),s&&(t.static_len+=g*(n[l*2+1]+p)));if(m!==0){do{for(h=c-1;t.bl_count[h]===0;)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[c]--,m-=2}while(m>0);for(h=c;h!==0;h--)for(l=t.bl_count[h];l!==0;)d=t.heap[--u],!(d>i)&&(r[d*2+1]!==h&&(t.opt_len+=(h-r[d*2+1])*r[d*2],r[d*2+1]=h),l--)}}function _Z(t,e,r){var i=new Array(Hf+1),n=0,s,o;for(s=1;s<=Hf;s++)i[s]=n=n+r[s-1]<<1;for(o=0;o<=e;o++){var a=t[o*2+1];a!==0&&(t[o*2]=wZ(i[a]++,a))}}function jje(){var t,e,r,i,n,s=new Array(Hf+1);for(r=0,i=0;i<YT-1;i++)for(e5[i]=r,t=0;t<1<<JT[i];t++)zb[r++]=i;for(zb[r-1]=i,n=0,i=0;i<16;i++)for(l2[i]=n,t=0;t<1<<u2[i];t++)Vb[n++]=i;for(n>>=7;i<Lp;i++)for(l2[i]=n<<7,t=0;t<1<<u2[i]-7;t++)Vb[256+n++]=i;for(e=0;e<=Hf;e++)s[e]=0;for(t=0;t<=143;)Xc[t*2+1]=8,t++,s[8]++;for(;t<=255;)Xc[t*2+1]=9,t++,s[9]++;for(;t<=279;)Xc[t*2+1]=7,t++,s[7]++;for(;t<=287;)Xc[t*2+1]=8,t++,s[8]++;for(_Z(Xc,Kb+1,s),t=0;t<Lp;t++)jb[t*2+1]=5,jb[t*2]=wZ(t,5);gZ=new t5(Xc,JT,Fb+1,Kb,Hf),bZ=new t5(jb,u2,0,Lp,Hf),mZ=new t5(new Array(0),Lje,0,XT,Mje)}function EZ(t){var e;for(e=0;e<Kb;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Lp;e++)t.dyn_dtree[e*2]=0;for(e=0;e<XT;e++)t.bl_tree[e*2]=0;t.dyn_ltree[ZT*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function SZ(t){t.bi_valid>8?Hb(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function Vje(t,e,r,i){SZ(t),i&&(Hb(t,r),Hb(t,~r)),Cje.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function xZ(t,e,r,i){var n=e*2,s=r*2;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function i5(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&xZ(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!xZ(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function AZ(t,e,r){var i,n,s=0,o,a;if(t.last_lit!==0)do i=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1],n=t.pending_buf[t.l_buf+s],s++,i===0?za(t,n,e):(o=zb[n],za(t,o+Fb+1,e),a=JT[o],a!==0&&(n-=e5[o],Qn(t,n,a)),i--,o=vZ(i),za(t,o,r),a=u2[o],a!==0&&(i-=l2[o],Qn(t,i,a)));while(s<t.last_lit);za(t,ZT,e)}function n5(t,e){var r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,u;for(t.heap_len=0,t.heap_max=fZ,o=0;o<s;o++)r[o*2]!==0?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=c<2?++c:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,n&&(t.static_len-=i[u*2+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)i5(t,r,o);u=s;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],i5(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[u*2]=r[o*2]+r[a*2],t.depth[u]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=u,t.heap[1]=u++,i5(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],Kje(t,e),_Z(r,c,t.bl_count)}function IZ(t,e,r){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),e[(r+1)*2+1]=65535,i=0;i<=r;i++)s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)&&(a<u?t.bl_tree[s*2]+=a:s!==0?(s!==n&&t.bl_tree[s*2]++,t.bl_tree[dZ*2]++):a<=10?t.bl_tree[hZ*2]++:t.bl_tree[pZ*2]++,a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4))}function TZ(t,e,r){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),i=0;i<=r;i++)if(s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)){if(a<u)do za(t,s,t.bl_tree);while(--a!=0);else s!==0?(s!==n&&(za(t,s,t.bl_tree),a--),za(t,dZ,t.bl_tree),Qn(t,a-3,2)):a<=10?(za(t,hZ,t.bl_tree),Qn(t,a-3,3)):(za(t,pZ,t.bl_tree),Qn(t,a-11,7));a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4)}}function zje(t){var e;for(IZ(t,t.dyn_ltree,t.l_desc.max_code),IZ(t,t.dyn_dtree,t.d_desc.max_code),n5(t,t.bl_desc),e=XT-1;e>=3&&t.bl_tree[yZ[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function Hje(t,e,r,i){var n;for(Qn(t,e-257,5),Qn(t,r-1,5),Qn(t,i-4,4),n=0;n<i;n++)Qn(t,t.bl_tree[yZ[n]*2+1],3);TZ(t,t.dyn_ltree,e-1),TZ(t,t.dyn_dtree,r-1)}function $je(t){var e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return cZ;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return uZ;for(r=32;r<Fb;r++)if(t.dyn_ltree[r*2]!==0)return uZ;return cZ}var RZ=!1;function Gje(t){RZ||(jje(),RZ=!0),t.l_desc=new r5(t.dyn_ltree,gZ),t.d_desc=new r5(t.dyn_dtree,bZ),t.bl_desc=new r5(t.bl_tree,mZ),t.bi_buf=0,t.bi_valid=0,EZ(t)}function PZ(t,e,r,i){Qn(t,(qje<<1)+(i?1:0),3),Vje(t,e,r,!0)}function Wje(t){Qn(t,lZ<<1,3),za(t,ZT,Xc),Fje(t)}function Yje(t,e,r,i){var n,s,o=0;t.level>0?(t.strm.data_type===kje&&(t.strm.data_type=$je(t)),n5(t,t.l_desc),n5(t,t.d_desc),o=zje(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&e!==-1?PZ(t,e,r,i):t.strategy===Oje||s===n?(Qn(t,(lZ<<1)+(i?1:0),3),AZ(t,Xc,jb)):(Qn(t,(Dje<<1)+(i?1:0),3),Hje(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),AZ(t,t.dyn_ltree,t.dyn_dtree)),EZ(t),i&&SZ(t)}function Xje(t,e,r){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(zb[r]+Fb+1)*2]++,t.dyn_dtree[vZ(e)*2]++),t.last_lit===t.lit_bufsize-1}Up._tr_init=Gje;Up._tr_stored_block=PZ;Up._tr_flush_block=Yje;Up._tr_tally=Xje;Up._tr_align=Wje});var s5=y((KPt,OZ)=>{f();"use strict";function Qje(t,e,r,i){for(var n=t&65535|0,s=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0}OZ.exports=Qje});var o5=y((jPt,kZ)=>{f();"use strict";function Zje(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var Jje=Zje();function eVe(t,e,r,i){var n=Jje,s=i+r;t^=-1;for(var o=i;o<s;o++)t=t>>>8^n[(t^e[o])&255];return t^-1}kZ.exports=eVe});var f2=y((VPt,qZ)=>{f();"use strict";qZ.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var jZ=y(Ga=>{f();"use strict";var On=Yc(),$s=CZ(),DZ=s5(),dl=o5(),tVe=f2(),$f=0,rVe=1,iVe=3,hl=4,NZ=5,Ha=0,BZ=1,Gs=-2,nVe=-3,a5=-5,sVe=-1,oVe=1,d2=2,aVe=3,cVe=4,uVe=0,lVe=2,h2=8,fVe=9,dVe=15,hVe=8,pVe=29,yVe=256,c5=yVe+1+pVe,gVe=30,bVe=19,mVe=2*c5+1,vVe=15,Tt=3,pl=258,Vo=pl+Tt+1,wVe=32,p2=42,u5=69,y2=73,g2=91,b2=103,Gf=113,$b=666,Ei=1,Gb=2,Wf=3,Fp=4,_Ve=3;function yl(t,e){return t.msg=tVe[e],e}function MZ(t){return(t<<1)-(t>4?9:0)}function gl(t){for(var e=t.length;--e>=0;)t[e]=0}function bl(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(On.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))}function Ji(t,e){$s._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,bl(t.strm)}function Ft(t,e){t.pending_buf[t.pending++]=e}function Wb(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function EVe(t,e,r,i){var n=t.avail_in;return n>i&&(n=i),n===0?0:(t.avail_in-=n,On.arraySet(e,t.input,t.next_in,n,r),t.state.wrap===1?t.adler=DZ(t.adler,e,n,r):t.state.wrap===2&&(t.adler=dl(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)}function LZ(t,e){var r=t.max_chain_length,i=t.strstart,n,s,o=t.prev_length,a=t.nice_match,c=t.strstart>t.w_size-Vo?t.strstart-(t.w_size-Vo):0,u=t.window,l=t.w_mask,d=t.prev,h=t.strstart+pl,p=u[i+o-1],g=u[i+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(n=e,!(u[n+o]!==g||u[n+o-1]!==p||u[n]!==u[i]||u[++n]!==u[i+1])){i+=2,n++;do;while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<h);if(s=pl-(h-i),i=h-pl,s>o){if(t.match_start=e,o=s,s>=a)break;p=u[i+o-1],g=u[i+o]}}while((e=d[e&l])>c&&--r!=0);return o<=t.lookahead?o:t.lookahead}function Yf(t){var e=t.w_size,r,i,n,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Vo)){On.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,r=i;do n=t.head[--r],t.head[r]=n>=e?n-e:0;while(--i);i=e,r=i;do n=t.prev[--r],t.prev[r]=n>=e?n-e:0;while(--i);s+=e}if(t.strm.avail_in===0)break;if(i=EVe(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=i,t.lookahead+t.insert>=Tt)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+Tt-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<Tt)););}while(t.lookahead<Vo&&t.strm.avail_in!==0)}function SVe(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Yf(t),t.lookahead===0&&e===$f)return Ei;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((t.strstart===0||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,Ji(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Vo&&(Ji(t,!1),t.strm.avail_out===0))return Ei}return t.insert=0,e===hl?(Ji(t,!0),t.strm.avail_out===0?Wf:Fp):(t.strstart>t.block_start&&(Ji(t,!1),t.strm.avail_out===0),Ei)}function l5(t,e){for(var r,i;;){if(t.lookahead<Vo){if(Yf(t),t.lookahead<Vo&&e===$f)return Ei;if(t.lookahead===0)break}if(r=0,t.lookahead>=Tt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Tt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Vo&&(t.match_length=LZ(t,r)),t.match_length>=Tt)if(i=$s._tr_tally(t,t.strstart-t.match_start,t.match_length-Tt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Tt){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Tt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=$s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Ji(t,!1),t.strm.avail_out===0))return Ei}return t.insert=t.strstart<Tt-1?t.strstart:Tt-1,e===hl?(Ji(t,!0),t.strm.avail_out===0?Wf:Fp):t.last_lit&&(Ji(t,!1),t.strm.avail_out===0)?Ei:Gb}function Kp(t,e){for(var r,i,n;;){if(t.lookahead<Vo){if(Yf(t),t.lookahead<Vo&&e===$f)return Ei;if(t.lookahead===0)break}if(r=0,t.lookahead>=Tt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Tt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Tt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Vo&&(t.match_length=LZ(t,r),t.match_length<=5&&(t.strategy===oVe||t.match_length===Tt&&t.strstart-t.match_start>4096)&&(t.match_length=Tt-1)),t.prev_length>=Tt&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-Tt,i=$s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-Tt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Tt-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=Tt-1,t.strstart++,i&&(Ji(t,!1),t.strm.avail_out===0))return Ei}else if(t.match_available){if(i=$s._tr_tally(t,0,t.window[t.strstart-1]),i&&Ji(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Ei}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=$s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Tt-1?t.strstart:Tt-1,e===hl?(Ji(t,!0),t.strm.avail_out===0?Wf:Fp):t.last_lit&&(Ji(t,!1),t.strm.avail_out===0)?Ei:Gb}function xVe(t,e){for(var r,i,n,s,o=t.window;;){if(t.lookahead<=pl){if(Yf(t),t.lookahead<=pl&&e===$f)return Ei;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Tt&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=t.strstart+pl;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);t.match_length=pl-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Tt?(r=$s._tr_tally(t,1,t.match_length-Tt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=$s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Ji(t,!1),t.strm.avail_out===0))return Ei}return t.insert=0,e===hl?(Ji(t,!0),t.strm.avail_out===0?Wf:Fp):t.last_lit&&(Ji(t,!1),t.strm.avail_out===0)?Ei:Gb}function AVe(t,e){for(var r;;){if(t.lookahead===0&&(Yf(t),t.lookahead===0)){if(e===$f)return Ei;break}if(t.match_length=0,r=$s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Ji(t,!1),t.strm.avail_out===0))return Ei}return t.insert=0,e===hl?(Ji(t,!0),t.strm.avail_out===0?Wf:Fp):t.last_lit&&(Ji(t,!1),t.strm.avail_out===0)?Ei:Gb}function $a(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}var jp;jp=[new $a(0,0,0,0,SVe),new $a(4,4,8,4,l5),new $a(4,5,16,8,l5),new $a(4,6,32,32,l5),new $a(4,4,16,16,Kp),new $a(8,16,32,32,Kp),new $a(8,16,128,128,Kp),new $a(8,32,128,256,Kp),new $a(32,128,258,1024,Kp),new $a(32,258,258,4096,Kp)];function IVe(t){t.window_size=2*t.w_size,gl(t.head),t.max_lazy_match=jp[t.level].max_lazy,t.good_match=jp[t.level].good_length,t.nice_match=jp[t.level].nice_length,t.max_chain_length=jp[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Tt-1,t.match_available=0,t.ins_h=0}function TVe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=h2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new On.Buf16(mVe*2),this.dyn_dtree=new On.Buf16((2*gVe+1)*2),this.bl_tree=new On.Buf16((2*bVe+1)*2),gl(this.dyn_ltree),gl(this.dyn_dtree),gl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new On.Buf16(vVe+1),this.heap=new On.Buf16(2*c5+1),gl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new On.Buf16(2*c5+1),gl(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function UZ(t){var e;return!t||!t.state?yl(t,Gs):(t.total_in=t.total_out=0,t.data_type=lVe,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?p2:Gf,t.adler=e.wrap===2?0:1,e.last_flush=$f,$s._tr_init(e),Ha)}function FZ(t){var e=UZ(t);return e===Ha&&IVe(t.state),e}function RVe(t,e){return!t||!t.state||t.state.wrap!==2?Gs:(t.state.gzhead=e,Ha)}function KZ(t,e,r,i,n,s){if(!t)return Gs;var o=1;if(e===sVe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>fVe||r!==h2||i<8||i>15||e<0||e>9||s<0||s>cVe)return yl(t,Gs);i===8&&(i=9);var a=new TVe;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Tt-1)/Tt),a.window=new On.Buf8(a.w_size*2),a.head=new On.Buf16(a.hash_size),a.prev=new On.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new On.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=r,FZ(t)}function PVe(t,e){return KZ(t,e,h2,dVe,hVe,uVe)}function CVe(t,e){var r,i,n,s;if(!t||!t.state||e>NZ||e<0)return t?yl(t,Gs):Gs;if(i=t.state,!t.output||!t.input&&t.avail_in!==0||i.status===$b&&e!==hl)return yl(t,t.avail_out===0?a5:Gs);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===p2)if(i.wrap===2)t.adler=0,Ft(i,31),Ft(i,139),Ft(i,8),i.gzhead?(Ft(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Ft(i,i.gzhead.time&255),Ft(i,i.gzhead.time>>8&255),Ft(i,i.gzhead.time>>16&255),Ft(i,i.gzhead.time>>24&255),Ft(i,i.level===9?2:i.strategy>=d2||i.level<2?4:0),Ft(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Ft(i,i.gzhead.extra.length&255),Ft(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=dl(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=u5):(Ft(i,0),Ft(i,0),Ft(i,0),Ft(i,0),Ft(i,0),Ft(i,i.level===9?2:i.strategy>=d2||i.level<2?4:0),Ft(i,_Ve),i.status=Gf);else{var o=h2+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=d2||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=wVe),o+=31-o%31,i.status=Gf,Wb(i,o),i.strstart!==0&&(Wb(i,t.adler>>>16),Wb(i,t.adler&65535)),t.adler=1}if(i.status===u5)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=dl(t.adler,i.pending_buf,i.pending-n,n)),bl(t),n=i.pending,i.pending===i.pending_buf_size));)Ft(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(t.adler=dl(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=y2)}else i.status=y2;if(i.status===y2)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=dl(t.adler,i.pending_buf,i.pending-n,n)),bl(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,Ft(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=dl(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=g2)}else i.status=g2;if(i.status===g2)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=dl(t.adler,i.pending_buf,i.pending-n,n)),bl(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,Ft(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=dl(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=b2)}else i.status=b2;if(i.status===b2&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&bl(t),i.pending+2<=i.pending_buf_size&&(Ft(i,t.adler&255),Ft(i,t.adler>>8&255),t.adler=0,i.status=Gf)):i.status=Gf),i.pending!==0){if(bl(t),t.avail_out===0)return i.last_flush=-1,Ha}else if(t.avail_in===0&&MZ(e)<=MZ(r)&&e!==hl)return yl(t,a5);if(i.status===$b&&t.avail_in!==0)return yl(t,a5);if(t.avail_in!==0||i.lookahead!==0||e!==$f&&i.status!==$b){var c=i.strategy===d2?AVe(i,e):i.strategy===aVe?xVe(i,e):jp[i.level].func(i,e);if((c===Wf||c===Fp)&&(i.status=$b),c===Ei||c===Wf)return t.avail_out===0&&(i.last_flush=-1),Ha;if(c===Gb&&(e===rVe?$s._tr_align(i):e!==NZ&&($s._tr_stored_block(i,0,0,!1),e===iVe&&(gl(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),bl(t),t.avail_out===0))return i.last_flush=-1,Ha}return e!==hl?Ha:i.wrap<=0?BZ:(i.wrap===2?(Ft(i,t.adler&255),Ft(i,t.adler>>8&255),Ft(i,t.adler>>16&255),Ft(i,t.adler>>24&255),Ft(i,t.total_in&255),Ft(i,t.total_in>>8&255),Ft(i,t.total_in>>16&255),Ft(i,t.total_in>>24&255)):(Wb(i,t.adler>>>16),Wb(i,t.adler&65535)),bl(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ha:BZ)}function OVe(t){var e;return!t||!t.state?Gs:(e=t.state.status,e!==p2&&e!==u5&&e!==y2&&e!==g2&&e!==b2&&e!==Gf&&e!==$b?yl(t,Gs):(t.state=null,e===Gf?yl(t,nVe):Ha))}function kVe(t,e){var r=e.length,i,n,s,o,a,c,u,l;if(!t||!t.state||(i=t.state,o=i.wrap,o===2||o===1&&i.status!==p2||i.lookahead))return Gs;for(o===1&&(t.adler=DZ(t.adler,e,r,0)),i.wrap=0,r>=i.w_size&&(o===0&&(gl(i.head),i.strstart=0,i.block_start=0,i.insert=0),l=new On.Buf8(i.w_size),On.arraySet(l,e,r-i.w_size,i.w_size,0),e=l,r=i.w_size),a=t.avail_in,c=t.next_in,u=t.input,t.avail_in=r,t.next_in=0,t.input=e,Yf(i);i.lookahead>=Tt;){n=i.strstart,s=i.lookahead-(Tt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+Tt-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=Tt-1,Yf(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Tt-1,i.match_available=0,t.next_in=c,t.input=u,t.avail_in=a,i.wrap=o,Ha}Ga.deflateInit=PVe;Ga.deflateInit2=KZ;Ga.deflateReset=FZ;Ga.deflateResetKeep=UZ;Ga.deflateSetHeader=RVe;Ga.deflate=CVe;Ga.deflateEnd=OVe;Ga.deflateSetDictionary=kVe;Ga.deflateInfo="pako deflate (from Nodeca project)"});var f5=y(Vp=>{f();"use strict";var m2=Yc(),VZ=!0,zZ=!0;try{String.fromCharCode.apply(null,[0])}catch(t){VZ=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){zZ=!1}var Yb=new m2.Buf8(256);for(Qc=0;Qc<256;Qc++)Yb[Qc]=Qc>=252?6:Qc>=248?5:Qc>=240?4:Qc>=224?3:Qc>=192?2:1;var Qc;Yb[254]=Yb[254]=1;Vp.string2buf=function(t){var e,r,i,n,s,o=t.length,a=0;for(n=0;n<o;n++)r=t.charCodeAt(n),(r&64512)==55296&&n+1<o&&(i=t.charCodeAt(n+1),(i&64512)==56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new m2.Buf8(a),s=0,n=0;s<a;n++)r=t.charCodeAt(n),(r&64512)==55296&&n+1<o&&(i=t.charCodeAt(n+1),(i&64512)==56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};function HZ(t,e){if(e<65534&&(t.subarray&&zZ||!t.subarray&&VZ))return String.fromCharCode.apply(null,m2.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}Vp.buf2binstring=function(t){return HZ(t,t.length)};Vp.binstring2buf=function(t){for(var e=new m2.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e};Vp.buf2string=function(t,e){var r,i,n,s,o=e||t.length,a=new Array(o*2);for(i=0,r=0;r<o;){if(n=t[r++],n<128){a[i++]=n;continue}if(s=Yb[n],s>4){a[i++]=65533,r+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&r<o;)n=n<<6|t[r++]&63,s--;if(s>1){a[i++]=65533;continue}n<65536?a[i++]=n:(n-=65536,a[i++]=55296|n>>10&1023,a[i++]=56320|n&1023)}return HZ(a,i)};Vp.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+Yb[t[r]]>e?r:e}});var d5=y(($Pt,$Z)=>{f();"use strict";function qVe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}$Z.exports=qVe});var XZ=y(Zb=>{f();"use strict";var Xb=jZ(),Qb=Yc(),h5=f5(),p5=f2(),DVe=d5(),GZ=Object.prototype.toString,NVe=0,y5=4,zp=0,WZ=1,YZ=2,BVe=-1,MVe=0,LVe=8;function Xf(t){if(!(this instanceof Xf))return new Xf(t);this.options=Qb.assign({level:BVe,method:LVe,chunkSize:16384,windowBits:15,memLevel:8,strategy:MVe,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new DVe,this.strm.avail_out=0;var r=Xb.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==zp)throw new Error(p5[r]);if(e.header&&Xb.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=h5.string2buf(e.dictionary):GZ.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,r=Xb.deflateSetDictionary(this.strm,i),r!==zp)throw new Error(p5[r]);this._dict_set=!0}}Xf.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?y5:NVe,typeof t=="string"?r.input=h5.string2buf(t):GZ.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Qb.Buf8(i),r.next_out=0,r.avail_out=i),n=Xb.deflate(r,s),n!==WZ&&n!==zp)return this.onEnd(n),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(s===y5||s===YZ))&&(this.options.to==="string"?this.onData(h5.buf2binstring(Qb.shrinkBuf(r.output,r.next_out))):this.onData(Qb.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&n!==WZ);return s===y5?(n=Xb.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===zp):(s===YZ&&(this.onEnd(zp),r.avail_out=0),!0)};Xf.prototype.onData=function(t){this.chunks.push(t)};Xf.prototype.onEnd=function(t){t===zp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Qb.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function g5(t,e){var r=new Xf(e);if(r.push(t,!0),r.err)throw r.msg||p5[r.err];return r.result}function UVe(t,e){return e=e||{},e.raw=!0,g5(t,e)}function FVe(t,e){return e=e||{},e.gzip=!0,g5(t,e)}Zb.Deflate=Xf;Zb.deflate=g5;Zb.deflateRaw=UVe;Zb.gzip=FVe});var ZZ=y((WPt,QZ)=>{f();"use strict";var v2=30,KVe=12;QZ.exports=function(e,r){var i,n,s,o,a,c,u,l,d,h,p,g,m,E,v,A,R,F,q,D,z,G,Y,P,b;i=e.state,n=e.next_in,P=e.input,s=n+(e.avail_in-5),o=e.next_out,b=e.output,a=o-(r-e.avail_out),c=o+(e.avail_out-257),u=i.dmax,l=i.wsize,d=i.whave,h=i.wnext,p=i.window,g=i.hold,m=i.bits,E=i.lencode,v=i.distcode,A=(1<<i.lenbits)-1,R=(1<<i.distbits)-1;e:do{m<15&&(g+=P[n++]<<m,m+=8,g+=P[n++]<<m,m+=8),F=E[g&A];t:for(;;){if(q=F>>>24,g>>>=q,m-=q,q=F>>>16&255,q===0)b[o++]=F&65535;else if(q&16){D=F&65535,q&=15,q&&(m<q&&(g+=P[n++]<<m,m+=8),D+=g&(1<<q)-1,g>>>=q,m-=q),m<15&&(g+=P[n++]<<m,m+=8,g+=P[n++]<<m,m+=8),F=v[g&R];r:for(;;){if(q=F>>>24,g>>>=q,m-=q,q=F>>>16&255,q&16){if(z=F&65535,q&=15,m<q&&(g+=P[n++]<<m,m+=8,m<q&&(g+=P[n++]<<m,m+=8)),z+=g&(1<<q)-1,z>u){e.msg="invalid distance too far back",i.mode=v2;break e}if(g>>>=q,m-=q,q=o-a,z>q){if(q=z-q,q>d&&i.sane){e.msg="invalid distance too far back",i.mode=v2;break e}if(G=0,Y=p,h===0){if(G+=l-q,q<D){D-=q;do b[o++]=p[G++];while(--q);G=o-z,Y=b}}else if(h<q){if(G+=l+h-q,q-=h,q<D){D-=q;do b[o++]=p[G++];while(--q);if(G=0,h<D){q=h,D-=q;do b[o++]=p[G++];while(--q);G=o-z,Y=b}}}else if(G+=h-q,q<D){D-=q;do b[o++]=p[G++];while(--q);G=o-z,Y=b}for(;D>2;)b[o++]=Y[G++],b[o++]=Y[G++],b[o++]=Y[G++],D-=3;D&&(b[o++]=Y[G++],D>1&&(b[o++]=Y[G++]))}else{G=o-z;do b[o++]=b[G++],b[o++]=b[G++],b[o++]=b[G++],D-=3;while(D>2);D&&(b[o++]=b[G++],D>1&&(b[o++]=b[G++]))}}else if((q&64)==0){F=v[(F&65535)+(g&(1<<q)-1)];continue r}else{e.msg="invalid distance code",i.mode=v2;break e}break}}else if((q&64)==0){F=E[(F&65535)+(g&(1<<q)-1)];continue t}else if(q&32){i.mode=KVe;break e}else{e.msg="invalid literal/length code",i.mode=v2;break e}break}}while(n<s&&o<c);D=m>>3,n-=D,m-=D<<3,g&=(1<<m)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),i.hold=g,i.bits=m}});var sJ=y((YPt,nJ)=>{f();"use strict";var JZ=Yc(),Hp=15,eJ=852,tJ=592,rJ=0,b5=1,iJ=2,jVe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],VVe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],zVe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],HVe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];nJ.exports=function(e,r,i,n,s,o,a,c){var u=c.bits,l=0,d=0,h=0,p=0,g=0,m=0,E=0,v=0,A=0,R=0,F,q,D,z,G,Y=null,P=0,b,w=new JZ.Buf16(Hp+1),S=new JZ.Buf16(Hp+1),C=null,B=0,W,j,M;for(l=0;l<=Hp;l++)w[l]=0;for(d=0;d<n;d++)w[r[i+d]]++;for(g=u,p=Hp;p>=1&&w[p]===0;p--);if(g>p&&(g=p),p===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(h=1;h<p&&w[h]===0;h++);for(g<h&&(g=h),v=1,l=1;l<=Hp;l++)if(v<<=1,v-=w[l],v<0)return-1;if(v>0&&(e===rJ||p!==1))return-1;for(S[1]=0,l=1;l<Hp;l++)S[l+1]=S[l]+w[l];for(d=0;d<n;d++)r[i+d]!==0&&(a[S[r[i+d]]++]=d);if(e===rJ?(Y=C=a,b=19):e===b5?(Y=jVe,P-=257,C=VVe,B-=257,b=256):(Y=zVe,C=HVe,b=-1),R=0,d=0,l=h,G=o,m=g,E=0,D=-1,A=1<<g,z=A-1,e===b5&&A>eJ||e===iJ&&A>tJ)return 1;for(;;){W=l-E,a[d]<b?(j=0,M=a[d]):a[d]>b?(j=C[B+a[d]],M=Y[P+a[d]]):(j=32+64,M=0),F=1<<l-E,q=1<<m,h=q;do q-=F,s[G+(R>>E)+q]=W<<24|j<<16|M|0;while(q!==0);for(F=1<<l-1;R&F;)F>>=1;if(F!==0?(R&=F-1,R+=F):R=0,d++,--w[l]==0){if(l===p)break;l=r[i+a[d]]}if(l>g&&(R&z)!==D){for(E===0&&(E=g),G+=h,m=l-E,v=1<<m;m+E<p&&(v-=w[m+E],!(v<=0));)m++,v<<=1;if(A+=1<<m,e===b5&&A>eJ||e===iJ&&A>tJ)return 1;D=R&z,s[D]=g<<24|m<<16|G-o|0}}return R!==0&&(s[G+R]=l-E<<24|64<<16|0),c.bits=g,0}});var FJ=y(zo=>{f();"use strict";var ys=Yc(),m5=s5(),Wa=o5(),$Ve=ZZ(),Jb=sJ(),GVe=0,oJ=1,aJ=2,cJ=4,WVe=5,w2=6,Qf=0,YVe=1,XVe=2,Ws=-2,uJ=-3,v5=-4,QVe=-5,lJ=8,fJ=1,dJ=2,hJ=3,pJ=4,yJ=5,gJ=6,bJ=7,mJ=8,vJ=9,wJ=10,_2=11,Zc=12,w5=13,_J=14,_5=15,EJ=16,SJ=17,xJ=18,AJ=19,E2=20,S2=21,IJ=22,TJ=23,RJ=24,PJ=25,CJ=26,E5=27,OJ=28,kJ=29,vr=30,S5=31,ZVe=32,JVe=852,eze=592,tze=15,rze=tze;function qJ(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function ize(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ys.Buf16(320),this.work=new ys.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function DJ(t){var e;return!t||!t.state?Ws:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=fJ,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new ys.Buf32(JVe),e.distcode=e.distdyn=new ys.Buf32(eze),e.sane=1,e.back=-1,Qf)}function NJ(t){var e;return!t||!t.state?Ws:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,DJ(t))}function BJ(t,e){var r,i;return!t||!t.state||(i=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?Ws:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,NJ(t))}function MJ(t,e){var r,i;return t?(i=new ize,t.state=i,i.window=null,r=BJ(t,e),r!==Qf&&(t.state=null),r):Ws}function nze(t){return MJ(t,rze)}var LJ=!0,x5,A5;function sze(t){if(LJ){var e;for(x5=new ys.Buf32(512),A5=new ys.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Jb(oJ,t.lens,0,288,x5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Jb(aJ,t.lens,0,32,A5,0,t.work,{bits:5}),LJ=!1}t.lencode=x5,t.lenbits=9,t.distcode=A5,t.distbits=5}function UJ(t,e,r,i){var n,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new ys.Buf8(s.wsize)),i>=s.wsize?(ys.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),ys.arraySet(s.window,e,r-i,n,s.wnext),i-=n,i?(ys.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function oze(t,e){var r,i,n,s,o,a,c,u,l,d,h,p,g,m,E=0,v,A,R,F,q,D,z,G,Y=new ys.Buf8(4),P,b,w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return Ws;r=t.state,r.mode===Zc&&(r.mode=w5),o=t.next_out,n=t.output,c=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,u=r.hold,l=r.bits,d=a,h=c,G=Qf;e:for(;;)switch(r.mode){case fJ:if(r.wrap===0){r.mode=w5;break}for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(r.wrap&2&&u===35615){r.check=0,Y[0]=u&255,Y[1]=u>>>8&255,r.check=Wa(r.check,Y,2,0),u=0,l=0,r.mode=dJ;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=vr;break}if((u&15)!==lJ){t.msg="unknown compression method",r.mode=vr;break}if(u>>>=4,l-=4,z=(u&15)+8,r.wbits===0)r.wbits=z;else if(z>r.wbits){t.msg="invalid window size",r.mode=vr;break}r.dmax=1<<z,t.adler=r.check=1,r.mode=u&512?wJ:Zc,u=0,l=0;break;case dJ:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(r.flags=u,(r.flags&255)!==lJ){t.msg="unknown compression method",r.mode=vr;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=vr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,r.check=Wa(r.check,Y,2,0)),u=0,l=0,r.mode=hJ;case hJ:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.head&&(r.head.time=u),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,Y[2]=u>>>16&255,Y[3]=u>>>24&255,r.check=Wa(r.check,Y,4,0)),u=0,l=0,r.mode=pJ;case pJ:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,r.check=Wa(r.check,Y,2,0)),u=0,l=0,r.mode=yJ;case yJ:if(r.flags&1024){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,r.check=Wa(r.check,Y,2,0)),u=0,l=0}else r.head&&(r.head.extra=null);r.mode=gJ;case gJ:if(r.flags&1024&&(p=r.length,p>a&&(p=a),p&&(r.head&&(z=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),ys.arraySet(r.head.extra,i,s,p,z)),r.flags&512&&(r.check=Wa(r.check,i,p,s)),a-=p,s+=p,r.length-=p),r.length))break e;r.length=0,r.mode=bJ;case bJ:if(r.flags&2048){if(a===0)break e;p=0;do z=i[s+p++],r.head&&z&&r.length<65536&&(r.head.name+=String.fromCharCode(z));while(z&&p<a);if(r.flags&512&&(r.check=Wa(r.check,i,p,s)),a-=p,s+=p,z)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=mJ;case mJ:if(r.flags&4096){if(a===0)break e;p=0;do z=i[s+p++],r.head&&z&&r.length<65536&&(r.head.comment+=String.fromCharCode(z));while(z&&p<a);if(r.flags&512&&(r.check=Wa(r.check,i,p,s)),a-=p,s+=p,z)break e}else r.head&&(r.head.comment=null);r.mode=vJ;case vJ:if(r.flags&512){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=vr;break}u=0,l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Zc;break;case wJ:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.adler=r.check=qJ(u),u=0,l=0,r.mode=_2;case _2:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,XVe;t.adler=r.check=1,r.mode=Zc;case Zc:if(e===WVe||e===w2)break e;case w5:if(r.last){u>>>=l&7,l-=l&7,r.mode=E5;break}for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}switch(r.last=u&1,u>>>=1,l-=1,u&3){case 0:r.mode=_J;break;case 1:if(sze(r),r.mode=E2,e===w2){u>>>=2,l-=2;break e}break;case 2:r.mode=SJ;break;case 3:t.msg="invalid block type",r.mode=vr}u>>>=2,l-=2;break;case _J:for(u>>>=l&7,l-=l&7;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((u&65535)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=vr;break}if(r.length=u&65535,u=0,l=0,r.mode=_5,e===w2)break e;case _5:r.mode=EJ;case EJ:if(p=r.length,p){if(p>a&&(p=a),p>c&&(p=c),p===0)break e;ys.arraySet(n,i,s,p,o),a-=p,s+=p,c-=p,o+=p,r.length-=p;break}r.mode=Zc;break;case SJ:for(;l<14;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(r.nlen=(u&31)+257,u>>>=5,l-=5,r.ndist=(u&31)+1,u>>>=5,l-=5,r.ncode=(u&15)+4,u>>>=4,l-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=vr;break}r.have=0,r.mode=xJ;case xJ:for(;r.have<r.ncode;){for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.lens[w[r.have++]]=u&7,u>>>=3,l-=3}for(;r.have<19;)r.lens[w[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,P={bits:r.lenbits},G=Jb(GVe,r.lens,0,19,r.lencode,0,r.work,P),r.lenbits=P.bits,G){t.msg="invalid code lengths set",r.mode=vr;break}r.have=0,r.mode=AJ;case AJ:for(;r.have<r.nlen+r.ndist;){for(;E=r.lencode[u&(1<<r.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(R<16)u>>>=v,l-=v,r.lens[r.have++]=R;else{if(R===16){for(b=v+2;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u>>>=v,l-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=vr;break}z=r.lens[r.have-1],p=3+(u&3),u>>>=2,l-=2}else if(R===17){for(b=v+3;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,z=0,p=3+(u&7),u>>>=3,l-=3}else{for(b=v+7;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,z=0,p=11+(u&127),u>>>=7,l-=7}if(r.have+p>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=vr;break}for(;p--;)r.lens[r.have++]=z}}if(r.mode===vr)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=vr;break}if(r.lenbits=9,P={bits:r.lenbits},G=Jb(oJ,r.lens,0,r.nlen,r.lencode,0,r.work,P),r.lenbits=P.bits,G){t.msg="invalid literal/lengths set",r.mode=vr;break}if(r.distbits=6,r.distcode=r.distdyn,P={bits:r.distbits},G=Jb(aJ,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,P),r.distbits=P.bits,G){t.msg="invalid distances set",r.mode=vr;break}if(r.mode=E2,e===w2)break e;case E2:r.mode=S2;case S2:if(a>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,$Ve(t,h),o=t.next_out,n=t.output,c=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,u=r.hold,l=r.bits,r.mode===Zc&&(r.back=-1);break}for(r.back=0;E=r.lencode[u&(1<<r.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(A&&(A&240)==0){for(F=v,q=A,D=R;E=r.lencode[D+((u&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=F,l-=F,r.back+=F}if(u>>>=v,l-=v,r.back+=v,r.length=R,A===0){r.mode=CJ;break}if(A&32){r.back=-1,r.mode=Zc;break}if(A&64){t.msg="invalid literal/length code",r.mode=vr;break}r.extra=A&15,r.mode=IJ;case IJ:if(r.extra){for(b=r.extra;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=TJ;case TJ:for(;E=r.distcode[u&(1<<r.distbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((A&240)==0){for(F=v,q=A,D=R;E=r.distcode[D+((u&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=F,l-=F,r.back+=F}if(u>>>=v,l-=v,r.back+=v,A&64){t.msg="invalid distance code",r.mode=vr;break}r.offset=R,r.extra=A&15,r.mode=RJ;case RJ:if(r.extra){for(b=r.extra;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=vr;break}r.mode=PJ;case PJ:if(c===0)break e;if(p=h-c,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=vr;break}p>r.wnext?(p-=r.wnext,g=r.wsize-p):g=r.wnext-p,p>r.length&&(p=r.length),m=r.window}else m=n,g=o-r.offset,p=r.length;p>c&&(p=c),c-=p,r.length-=p;do n[o++]=m[g++];while(--p);r.length===0&&(r.mode=S2);break;case CJ:if(c===0)break e;n[o++]=r.length,c--,r.mode=S2;break;case E5:if(r.wrap){for(;l<32;){if(a===0)break e;a--,u|=i[s++]<<l,l+=8}if(h-=c,t.total_out+=h,r.total+=h,h&&(t.adler=r.check=r.flags?Wa(r.check,n,h,o-h):m5(r.check,n,h,o-h)),h=c,(r.flags?u:qJ(u))!==r.check){t.msg="incorrect data check",r.mode=vr;break}u=0,l=0}r.mode=OJ;case OJ:if(r.wrap&&r.flags){for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=vr;break}u=0,l=0}r.mode=kJ;case kJ:G=YVe;break e;case vr:G=uJ;break e;case S5:return v5;case ZVe:default:return Ws}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,(r.wsize||h!==t.avail_out&&r.mode<vr&&(r.mode<E5||e!==cJ))&&UJ(t,t.output,t.next_out,h-t.avail_out)?(r.mode=S5,v5):(d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,r.total+=h,r.wrap&&h&&(t.adler=r.check=r.flags?Wa(r.check,n,h,t.next_out-h):m5(r.check,n,h,t.next_out-h)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Zc?128:0)+(r.mode===E2||r.mode===_5?256:0),(d===0&&h===0||e===cJ)&&G===Qf&&(G=QVe),G)}function aze(t){if(!t||!t.state)return Ws;var e=t.state;return e.window&&(e.window=null),t.state=null,Qf}function cze(t,e){var r;return!t||!t.state||(r=t.state,(r.wrap&2)==0)?Ws:(r.head=e,e.done=!1,Qf)}function uze(t,e){var r=e.length,i,n,s;return!t||!t.state||(i=t.state,i.wrap!==0&&i.mode!==_2)?Ws:i.mode===_2&&(n=1,n=m5(n,e,r,0),n!==i.check)?uJ:(s=UJ(t,e,r,r),s?(i.mode=S5,v5):(i.havedict=1,Qf))}zo.inflateReset=NJ;zo.inflateReset2=BJ;zo.inflateResetKeep=DJ;zo.inflateInit=nze;zo.inflateInit2=MJ;zo.inflate=oze;zo.inflateEnd=aze;zo.inflateGetHeader=cze;zo.inflateSetDictionary=uze;zo.inflateInfo="pako inflate (from Nodeca project)"});var I5=y((QPt,KJ)=>{f();"use strict";KJ.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var VJ=y((ZPt,jJ)=>{f();"use strict";function lze(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}jJ.exports=lze});var HJ=y(t1=>{f();"use strict";var $p=FJ(),e1=Yc(),x2=f5(),ii=I5(),T5=f2(),fze=d5(),dze=VJ(),zJ=Object.prototype.toString;function Zf(t){if(!(this instanceof Zf))return new Zf(t);this.options=e1.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new fze,this.strm.avail_out=0;var r=$p.inflateInit2(this.strm,e.windowBits);if(r!==ii.Z_OK)throw new Error(T5[r]);if(this.header=new dze,$p.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=x2.string2buf(e.dictionary):zJ.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=$p.inflateSetDictionary(this.strm,e.dictionary),r!==ii.Z_OK)))throw new Error(T5[r])}Zf.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a,c,u,l=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?ii.Z_FINISH:ii.Z_NO_FLUSH,typeof t=="string"?r.input=x2.binstring2buf(t):zJ.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new e1.Buf8(i),r.next_out=0,r.avail_out=i),s=$p.inflate(r,ii.Z_NO_FLUSH),s===ii.Z_NEED_DICT&&n&&(s=$p.inflateSetDictionary(this.strm,n)),s===ii.Z_BUF_ERROR&&l===!0&&(s=ii.Z_OK,l=!1),s!==ii.Z_STREAM_END&&s!==ii.Z_OK)return this.onEnd(s),this.ended=!0,!1;r.next_out&&(r.avail_out===0||s===ii.Z_STREAM_END||r.avail_in===0&&(o===ii.Z_FINISH||o===ii.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=x2.utf8border(r.output,r.next_out),c=r.next_out-a,u=x2.buf2string(r.output,a),r.next_out=c,r.avail_out=i-c,c&&e1.arraySet(r.output,r.output,a,c,0),this.onData(u)):this.onData(e1.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(l=!0)}while((r.avail_in>0||r.avail_out===0)&&s!==ii.Z_STREAM_END);return s===ii.Z_STREAM_END&&(o=ii.Z_FINISH),o===ii.Z_FINISH?(s=$p.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===ii.Z_OK):(o===ii.Z_SYNC_FLUSH&&(this.onEnd(ii.Z_OK),r.avail_out=0),!0)};Zf.prototype.onData=function(t){this.chunks.push(t)};Zf.prototype.onEnd=function(t){t===ii.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=e1.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function R5(t,e){var r=new Zf(e);if(r.push(t,!0),r.err)throw r.msg||T5[r.err];return r.result}function hze(t,e){return e=e||{},e.raw=!0,R5(t,e)}t1.Inflate=Zf;t1.inflate=R5;t1.inflateRaw=hze;t1.ungzip=R5});var WJ=y((eCt,GJ)=>{f();"use strict";var pze=Yc().assign,yze=XZ(),gze=HJ(),bze=I5(),$J={};pze($J,yze,gze,bze);GJ.exports=$J});var XJ=y((tCt,YJ)=>{f();"use strict";var{concat:mze}=(un(),cn);async function vze(t){let e=new Uint8Array(0);for await(let r of t)e=mze([e,r],e.length+r.length);return e}YJ.exports=vze});var see=y((rCt,nee)=>{f();"use strict";var{exporter:wze,recursive:_ze}=(jo(),Ko),r1=ue(),{normalizeCidPath:Eze}=Ki(),Sze=qe(),{CID:QJ}=(Ie(),Ne),{pack:ZJ}=aZ(),{pipe:JJ}=Ar(),{gzip:eee}=WJ(),tee=No(),ree=XJ(),iee=6;nee.exports=function({repo:t,preload:e}){async function*r(i,n={}){if(n.compressionLevel<0||n.compressionLevel>9)throw r1(new Error("Compression level must be between 1 and 9"),"ERR_INVALID_PARAMS");if(n.preload!==!1){let a;try{a=Eze(i).split("/")}catch(c){throw r1(c,"ERR_INVALID_PATH")}e(QJ.parse(a[0]))}let s=QJ.asCID(i)||i,o=await wze(s,t.blocks,n);if(o.type==="file"||o.type==="raw"){let a=[];!n.compress||n.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],ZJ(),c=>tee(c,u=>u.slice())):a.push(o.content),n.compress&&a.push(async function*(c){let u=await ree(c);yield eee(u,{level:n.compressionLevel||iee})}),yield*JJ(...a);return}if(o.type==="directory"){let a=[_ze(s,t.blocks,n),async function*(c){for await(let u of c){let l={header:{name:u.path,size:u.size}};if(u.type==="file")l.header.type="file",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,l.body=u.content();else if(u.type==="raw")l.header.type="file",l.body=u.content();else if(u.type==="directory")l.header.type="directory",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw r1(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield l}},ZJ(),c=>tee(c,u=>u.slice())];if(n.compress){if(!n.archive)throw r1(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&a.push(async function*(c){let u=await ree(c);yield eee(u,{level:n.compressionLevel||iee})})}yield*JJ(...a);return}throw r1(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return Sze(r)}});var uee=y((iCt,cee)=>{f();"use strict";var{exporter:xze}=(jo(),Ko),Aze=ue(),{normalizeCidPath:Ize,mapFile:oee}=Ki(),Tze=qe(),{CID:aee}=(Ie(),Ne);cee.exports=function({repo:t,preload:e}){async function*r(i,n={}){let s=Ize(i),o=s.split("/");n.preload!==!1&&e(aee.parse(o[0]));let a=aee.asCID(s)||s,c=await xze(a,t.blocks,n);if(c.type==="file"){yield oee(c);return}if(c.type==="directory"){for await(let u of c.content())yield oee(u);return}throw Aze(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return Tze(r)}});var dee=y((nCt,fee)=>{f();"use strict";var Rze=fY(),Pze=dQ(),Cze=VQ(),Oze=see(),kze=uee(),lee=class{constructor({preload:e,repo:r,options:i}){let n=Pze({preload:e,repo:r,options:i});this.addAll=n,this.add=Rze({addAll:n}),this.cat=Cze({repo:r,preload:e}),this.get=Oze({repo:r,preload:e}),this.ls=kze({repo:r,preload:e})}};fee.exports=lee});var A2=y((sCt,qze)=>{qze.exports={name:"ipfs-core",version:"0.10.4",description:"JavaScript implementation of the IPFS specification",keywords:["IPFS"],homepage:"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme",bugs:"https://github.com/ipfs/js-ipfs/issues",license:"(Apache-2.0 OR MIT)",leadMaintainer:"Alex Potsides <alex@achingbrain.net>",main:"src/index.js",types:"dist/src/index.d.ts",files:["src","dist","!dist/*.tsbuildinfo"],browser:{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","ipfs-utils/src/files/glob-source":!1},typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},repository:{type:"git",url:"git+https://github.com/ipfs/js-ipfs.git"},scripts:{build:"aegir build",lint:"aegir ts -p check && aegir lint",test:"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",clean:"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},dependencies:{"@chainsafe/libp2p-noise":"^4.0.0","@ipld/car":"^3.1.0","@ipld/dag-cbor":"^6.0.5","@ipld/dag-pb":"^2.1.3","@multiformats/murmur3":"^1.0.1","abort-controller":"^3.0.0","any-signal":"^2.1.2","array-shuffle":"^2.0.0","blockstore-datastore-adapter":"^1.0.0","datastore-core":"^5.0.1","datastore-fs":"^5.0.2","datastore-level":"^6.0.2","datastore-pubsub":"^0.7.0",debug:"^4.1.1",dlv:"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0",hashlru:"^2.3.0","interface-blockstore":"^1.0.0","interface-datastore":"^5.0.0","ipfs-bitswap":"^6.0.0","ipfs-core-types":"^0.7.0","ipfs-core-utils":"^0.10.2","ipfs-http-client":"^52.0.2","ipfs-repo":"^12.0.0","ipfs-unixfs":"^6.0.3","ipfs-unixfs-exporter":"^7.0.3","ipfs-unixfs-importer":"^9.0.3","ipfs-utils":"^8.1.4",ipns:"^0.14.0","is-domain-name":"^1.0.1","is-ipfs":"^6.0.1","it-all":"^1.0.4","it-drain":"^1.0.3","it-filter":"^1.0.2","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-merge":"^1.0.2","it-peekable":"^1.0.2","it-pipe":"^1.1.0","it-pushable":"^1.4.2","it-tar":"^4.0.0","it-to-buffer":"^2.0.0","just-safe-set":"^2.2.1",libp2p:"^0.32.0","libp2p-bootstrap":"^0.13.0","libp2p-crypto":"^0.19.7","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.1","libp2p-kad-dht":"^0.23.1","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.2","libp2p-record":"^0.10.3","libp2p-tcp":"^0.17.1","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.1",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.0",multiaddr:"^10.0.0","multiaddr-to-uri":"^8.0.0",multiformats:"^9.4.1","native-abort-controller":"^1.0.3","p-queue":"^6.6.1",pako:"^1.0.2","parse-duration":"^1.0.0","peer-id":"^0.15.1","streaming-iterables":"^6.0.0","timeout-abort-controller":"^1.1.1",uint8arrays:"^3.0.0"},devDependencies:{"@types/dlv":"^1.1.2","@types/pako":"^1.0.2","@types/rimraf":"^3.0.1",aegir:"^35.0.3",delay:"^5.0.0","go-ipfs":"0.9.1","interface-blockstore-tests":"^1.0.0","interface-ipfs-core":"^0.150.1","ipfsd-ctl":"^10.0.3","iso-url":"^1.0.0",nanoid:"^3.1.12","p-defer":"^3.0.0",rimraf:"^3.0.2",sinon:"^11.1.1"}}});var pee=y((oCt,hee)=>{f();"use strict";var P5=A2(),Dze=qe();hee.exports=({repo:t})=>{async function e(r={}){let i=await t.version.get();return{version:P5.version,repo:`${i}`,commit:P5.gitHead||"","interface-ipfs-core":P5.devDependencies["interface-ipfs-core"]}}return Dze(e)}});var gee=y((aCt,yee)=>{f();"use strict";var Nze=A2().version,{Multiaddr:Bze}=it(),Mze=qe(),{toString:I2}=(tt(),et),Lze=rt(),{NotStartedError:Uze}=tl();yee.exports=({peerId:t,network:e})=>{async function r(i={}){i.peerId===t.toB58String()&&delete i.peerId;let n=e.try();if(!n){if(i.peerId)throw new Uze;return{id:t.toB58String(),publicKey:I2(t.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Nze}`,protocolVersion:"9000",protocols:[]}}let s=i.peerId?Lze.createFromB58String(i.peerId.toString()):t,{libp2p:o}=n,a=i.peerId?o.peerStore.keyBook.get(s):s.pubKey,c=i.peerId?o.peerStore.addressBook.getMultiaddrsForPeer(s):o.multiaddrs,u=i.peerId?o.peerStore.protoBook.get(s):Array.from(o.upgrader.protocols.keys()),l=I2(o.peerStore.metadataBook.getValue(s,"AgentVersion")||new Uint8Array),d=I2(o.peerStore.metadataBook.getValue(s,"ProtocolVersion")||new Uint8Array),h=s.toB58String();return{id:h,publicKey:I2(a.bytes,"base64pad"),addresses:(c||[]).map(p=>{let g=p.toString();return g.endsWith(`/p2p/${h}`)?g:`${g}/p2p/${h}`}).sort().map(p=>new Bze(p)),agentVersion:l,protocolVersion:d,protocols:(u||[]).sort()}}return Mze(r)}});var k5=y((cCt,O5)=>{f();"use strict";var ni=p4(),C5=U_(),Gp=qe(),Fze=me()("ipfs:core:config");O5.exports=({repo:t})=>{return{getAll:Gp(e),get:Gp(r),set:Gp(i),replace:Gp(n),profiles:{apply:Gp(s),list:Gp(Kze)}};async function e(o={}){return t.config.getAll(o)}async function r(o,a){return o?t.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return t.config.set(o,a,c)}async function n(o,a){return t.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=T2[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let l=await t.config.getAll(a),d=JSON.parse(JSON.stringify(l));return d=u.transform(d),c||await t.config.replace(d,a),delete l.Identity.PrivKey,delete d.Identity.PrivKey,{original:l,updated:d}}catch(l){throw Fze(l),new Error(`Could not apply profile '${o}' to config: ${l.message}`)}}};async function Kze(t){return Object.keys(T2).map(e=>({name:e,description:T2[e].description}))}var T2={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:t=>(ni(t,"Discovery.MDNS.Enabled",!1),ni(t,"Discovery.webRTCStar.Enabled",!1),t.Swarm={...t.Swarm||{},DisableNatPortMap:!0},t)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:t=>(ni(t,"Discovery.MDNS.Enabled",!0),ni(t,"Discovery.webRTCStar.Enabled",!0),ni(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:t=>{let e=C5();return ni(t,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),ni(t,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),ni(t,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),ni(t,"Addresses.Delegates",[]),ni(t,"Bootstrap",[]),ni(t,"Discovery.MDNS.Enabled",!1),ni(t,"Discovery.webRTCStar.Enabled",!1),ni(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!0}),t}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:t=>{let e=C5();return ni(t,"Addresses.API",e.Addresses.API),ni(t,"Addresses.Gateway",e.Addresses.Gateway),ni(t,"Addresses.Swarm",e.Addresses.Swarm),ni(t,"Addresses.Delegates",e.Addresses.Delegates),ni(t,"Bootstrap",e.Bootstrap),ni(t,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),ni(t,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),ni(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:t=>{let e=t.Swarm||{},r=e.ConnMgr||{};return r.LowWater=20,r.HighWater=40,e.ConnMgr=r,t.Swarm=e,t}},"default-power":{description:'Inverse of "lowpower" profile.',transform:t=>{let e=C5();return t.Swarm=e.Swarm,t}}};O5.exports.profiles=T2});function D5(t){let e=II({version:1,roots:t}),r=q5.default.encode(e.length),i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i}function bee(t){return{async setRoots(e){let r=D5(e);await t.write(r)},async writeBlock(e){let{cid:r,bytes:i}=e;await t.write(new Uint8Array(q5.default.encode(r.bytes.length+i.length))),await t.write(r.bytes),i.length&&await t.write(i)},async close(){return t.end()}}}var q5,mee=xe(()=>{f();q5=Wt(ss());zc()});function R2(){}function vee(){let t=[],e=null,r=R2,i=!1,n=null,s=R2,o=()=>(e||(e=new Promise(u=>{r=()=>{e=null,r=R2,u()}})),e),a={write(u){t.push(u);let l=o();return s(),l},async end(){i=!0;let u=o();return s(),u}},c={async next(){let u=t.shift();return u?(t.length===0&&r(),{done:!1,value:u}):i?(r(),{done:!0,value:void 0}):(n||(n=new Promise(l=>{s=()=>(n=null,s=R2,l(c.next()))})),n)}};return{writer:a,iterator:c}}var wee=xe(()=>{f()});async function P2(t){let e=await t.upTo(8),r=ml.default.decode(e);return t.seek(ml.default.decode.bytes),r}async function B5(t){let e=await P2(t);if(e===0)throw new Error("Invalid CAR header (zero length)");let r=await t.exactly(e);t.seek(e);let i=Pf(r);if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("Invalid CAR header format");if(i.version!==1)throw typeof i.version=="string"?new Error(`Invalid CAR version: "${i.version}"`):new Error(`Invalid CAR version: ${i.version}`);if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");if(Object.keys(i).filter(n=>n!=="roots"&&n!=="version").length)throw new Error("Invalid CAR header format");return i}async function jze(t){let e=await t.upTo(8);ml.default.decode(e);let r=ml.default.decode.bytes,i=ml.default.decode(e.subarray(ml.default.decode.bytes)),n=ml.default.decode.bytes,s=r+n+i,o=await t.exactly(s);return t.seek(s),o}async function Vze(t){let e=await t.exactly(2);if(e[0]===N5.SHA2_256&&e[1]===N5.LENGTH){let o=await t.exactly(34);t.seek(34);let a=Pu(o);return We.create(0,N5.DAG_PB,a)}let r=await P2(t);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let i=await P2(t),n=await jze(t),s=Pu(n);return We.create(r,i,s)}async function _ee(t){let e=t.pos,r=await P2(t);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=t.pos-e;let i=await Vze(t),n=r-(t.pos-e);return{cid:i,length:r,blockLength:n}}async function zze(t){let{cid:e,blockLength:r}=await _ee(t),i=await t.exactly(r);return t.seek(r),{bytes:i,cid:e}}async function Hze(t){let e=t.pos,{cid:r,length:i,blockLength:n}=await _ee(t),s={cid:r,length:i,blockLength:n,offset:e,blockOffset:t.pos};return t.seek(s.blockLength),s}function Eee(t){let e=B5(t);return{header:()=>e,async*blocks(){for(await e;(await t.upTo(8)).length>0;)yield await zze(t)},async*blocksIndex(){for(await e;(await t.upTo(8)).length>0;)yield await Hze(t)}}}function C2(t){let e=0;return{async upTo(r){return t.subarray(e,e+Math.min(r,t.length-e))},async exactly(r){if(r>t.length-e)throw new Error("Unexpected end of data");return t.subarray(e,e+r)},seek(r){e+=r},get pos(){return e}}}function $ze(t){let e=0,r=0,i=0,n=new Uint8Array(0),s=async o=>{r=n.length-i;let a=[n.subarray(i)];for(;r<o;){let u=await t();if(u==null)break;r<0?u.length>r&&a.push(u.subarray(-r)):a.push(u),r+=u.length}n=new Uint8Array(a.reduce((u,l)=>u+l.length,0));let c=0;for(let u of a)n.set(u,c),c+=u.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function See(t){let e=t[Symbol.asyncIterator]();async function r(){let i=await e.next();return i.done?null:i.value}return $ze(r)}var ml,N5,M5=xe(()=>{f();ml=Wt(ss());Ie();xn();zc();N5={SHA2_256:18,LENGTH:32,DAG_PB:112}});var Aee={};ut(Aee,{CarWriter:()=>i1,CarWriterOut:()=>O2,__browser:()=>Wze});function xee(){let t=vee(),{writer:e,iterator:r}=t;return{encoder:bee(e),iterator:r}}function Gze(t){if(t===void 0)return[];if(!Array.isArray(t)){let r=We.asCID(t);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let e=[];for(let r of t){let i=We.asCID(r);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var i1,O2,Wze,Iee=xe(()=>{f();Ie();mee();wee();M5();i1=class{constructor(e,r){this._encoder=r,this._mutex=r.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let r=We.asCID(e.cid);if(!r)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:r,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=Gze(e);let{encoder:r,iterator:i}=xee(),n=new i1(e,r),s=new O2(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:r}=xee();e.setRoots=()=>Promise.resolve();let i=new i1([],e),n=new O2(r);return{writer:i,out:n}}static async updateRootsInBytes(e,r){let i=C2(e);await B5(i);let n=D5(r);if(i.pos!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},O2=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};Wze=!0});var Cee=y((wCt,Pee)=>{f();"use strict";var{CID:Yze}=(Ie(),Ne),Xze=(h_(),d_),{base58btc:Qze}=(ei(),Jr),{CarWriter:Zze}=(Iee(),Aee),Jze=qe(),Tee=me()("ipfs:components:dag:import"),eHe=(Rs(),wo),tHe=(U6(),Kv),rHe=[eHe.code,tHe.code];Pee.exports=({repo:t,preload:e,codecs:r})=>{async function*i(n,s={}){s.preload!==!1&&e(n);let o=Yze.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);Tee(`Exporting ${o} as car`);let{writer:a,out:c}=await Zze.create([o]),u=null;(async()=>{try{await Ree(t,{signal:s.signal,timeout:s.timeout},o,a,r),a.close()}catch(l){u=l}})();for await(let l of c){if(u)break;yield l}if(u)throw u}return Jze(i)};async function Ree(t,e,r,i,n,s=new Set){let o=r.toString(Qze);if(s.has(o))return;let a=await iHe(t,e,r,n);Tee(`Adding block ${r} to car`),await i.put(a),s.add(o);for(let c of a.links)await Ree(t,e,c,i,n,s)}async function iHe(t,e,r,i){let n=await t.blocks.get(r,e),s=[],o=await i.getCodec(r.code);if(o)s=[...Xze.createUnsafe({bytes:n,cid:r,codec:o}).links()].map(c=>c[1]);else if(!rHe.includes(r.code))throw new Error(`Can't decode links in block with codec 0x${r.code.toString(16)} to form complete DAG`);return{cid:r,bytes:n,links:s}}});var qee=y((_Ct,kee)=>{f();"use strict";var nHe=qe(),sHe=Df(),oHe=$n(),{resolve:Oee}=Ki(),aHe=ue();kee.exports=({codecs:t,repo:e,preload:r})=>nHe(async function(s,o={}){if(o.preload!==!1&&r(s),o.path){let d=o.localResolve?await sHe(Oee(s,o.path,t,e,o)):await oHe(Oee(s,o.path,t,e,o));if(!d)throw aHe(new Error("Not found"),"ERR_NOT_FOUND");return d}let a=await t.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})});var Mee={};ut(Mee,{CarBlockIterator:()=>n1,CarCIDIterator:()=>s1,CarIteratorBase:()=>k2});async function Dee(t){if(!(t instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Bee(C2(t))}async function Nee(t){if(!t||typeof t[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return Bee(See(t))}async function Bee(t){let e=Eee(t),{version:r,roots:i}=await e.header();return{version:r,roots:i,iterator:e.blocks()}}var k2,n1,s1,Lee=xe(()=>{f();M5();k2=class{constructor(e,r,i){this._version=e,this._roots=r,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},n1=class extends k2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:r,roots:i,iterator:n}=await Dee(e);return new n1(r,i,n)}static async fromIterable(e){let{version:r,roots:i,iterator:n}=await Nee(e);return new n1(r,i,n)}},s1=class extends k2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let r=await e.next();return r.done?r:{done:!1,value:r.value.cid}}}}static async fromBytes(e){let{version:r,roots:i,iterator:n}=await Dee(e);return new s1(r,i,n)}static async fromIterable(e){let{version:r,roots:i,iterator:n}=await Nee(e);return new s1(r,i,n)}}});var Kee=y((SCt,Fee)=>{f();"use strict";var{CarBlockIterator:cHe}=(Lee(),Mee),uHe=qe(),lHe=Bb(),fHe=Ua(),dHe=No(),Uee=me()("ipfs:components:dag:import");Fee.exports=({repo:t})=>{async function*e(r,i={}){let n=await t.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=lHe(r),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let u;a instanceof Uint8Array?u=[o]:u=o;for await(let l of u){let d=await hHe(t,s,l);if(i.pinRoots!==!1)for(let h of d){let p="";try{await t.blocks.has(h)?(Uee(`Pinning root ${h}`),await t.pins.pinRecursively(h)):p="blockstore: block not found"}catch(g){p=g.message}yield{root:{cid:h,pinErrorMsg:p}}}}}finally{n()}}return uHe(e)};async function hHe(t,e,r){let i=await cHe.fromIterable(r),n=await i.getRoots();return await fHe(t.blocks.putMany(dHe(i,({cid:s,bytes:o})=>(Uee(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}});var Vee=y((xCt,jee)=>{f();"use strict";var{CID:pHe}=(Ie(),Ne),yHe=qe();jee.exports=({repo:t,codecs:e,hashers:r,preload:i})=>{async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.format||"dag-cbor",u=o.version!=null?o.version:c==="dag-pb"?0:1,l=await e.getCodec(c);if(!l)throw new Error(`Unknown codec ${o.format}, please configure additional BlockCodecs for this IPFS instance`);let d=await r.getHasher(o.hashAlg||"sha2-256");if(!d)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let h=l.encode(s),p=await d.digest(h),g=pHe.create(u,l.code,p);return await t.blocks.put(g,h,{signal:o.signal}),o.pin&&await t.pins.pinRecursively(g),o.preload!==!1&&i(g),g}finally{a&&a()}}return yHe(n)}});var Hee=y((ACt,zee)=>{f();"use strict";var gHe=qe(),bHe=ib(),{resolvePath:mHe}=Ki();zee.exports=({repo:t,codecs:e,preload:r})=>{async function i(n,s={}){let{cid:o}=bHe(n);return s.preload!==!1&&r(o),mHe(t,e,n,s)}return gHe(i)}});var Wee=y((ICt,Gee)=>{f();"use strict";var vHe=Cee(),wHe=qee(),_He=Kee(),EHe=Vee(),SHe=Hee(),$ee=class{constructor({repo:e,codecs:r,hashers:i,preload:n}){this.export=vHe({repo:e,preload:n,codecs:r}),this.get=wHe({codecs:r,repo:e,preload:n}),this.import=_He({repo:e}),this.resolve=SHe({repo:e,codecs:r,preload:n}),this.put=EHe({repo:e,codecs:r,hashers:i,preload:n})}};Gee.exports=$ee});var D2=y((TCt,Yee)=>{f();var{Multiaddr:xHe}=it(),q2=(t,e)=>e,AHe=(t,e,r,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${t}:${e}`;let n="tcp",s=`:${e}`;return r[r.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${t}${s}`},IHe={ip4:q2,ip6:(t,e,r,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(t,e,r,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${t}:${e}`:AHe(t,e,i,n),udp:(t,e)=>`udp://${t}:${e}`,dnsaddr:q2,dns4:q2,dns6:q2,ipfs:(t,e)=>`${t}/ipfs/${e}`,p2p:(t,e)=>`${t}/p2p/${e}`,http:t=>`http://${t}`,https:t=>`https://${t}`,ws:t=>`ws://${t}`,wss:t=>`wss://${t}`,"p2p-websocket-star":t=>`${t}/p2p-websocket-star`,"p2p-webrtc-star":t=>`${t}/p2p-webrtc-star`,"p2p-webrtc-direct":t=>`${t}/p2p-webrtc-direct`};Yee.exports=(t,e)=>{let r=new xHe(t),i=t.toString().split("/").slice(1);return r.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=IHe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var Qee=y((RCt,Xee)=>{f();"use strict";Xee.exports=t=>{if(!Array.isArray(t))throw new TypeError(`Expected an array, got ${typeof t}`);t=[...t];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}});var ete=y((PCt,Jee)=>{f();"use strict";var{default:THe}=$c(),RHe=Gy(),Zee=me(),PHe=Object.assign(Zee("ipfs:preload"),{error:Zee("ipfs:preload:error")}),CHe=new THe({concurrency:4});Jee.exports=function(e,r={}){return PHe(e),CHe.add(async()=>{let n=(await RHe.post(e,{signal:r.signal})).body.getReader();try{for(;;){let{done:s}=await n.read();if(s)return}}finally{n.releaseLock()}})}});var ite=y((CCt,rte)=>{f();"use strict";var OHe=D2(),tte=me(),kHe=Qee(),{AbortController:qHe}=nn(),DHe=ete(),NHe=sb(),o1=Object.assign(tte("ipfs:preload"),{error:tte("ipfs:preload:error")}),BHe=(t={})=>{if(t.enabled=Boolean(t.enabled),t.addresses=t.addresses||[],t.cache=t.cache||1e3,!t.enabled||!t.addresses.length)return o1("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,r=[],i=t.addresses.map(OHe),n=NHe(t.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=kHe(i),u=!1,l=Date.now();for(let d of c){if(e)throw new Error(`preload aborted for ${a}`);let h;try{h=new qHe,r=r.concat(h),await DHe(`${d}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:h.signal}),u=!0}catch(p){p.type!=="aborted"&&o1.error(p)}finally{r=r.filter(p=>p!==h)}if(u)break}o1(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-l}ms`)}catch(a){o1.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,o1(`aborting ${r.length} pending preload request(s)`),r.forEach(o=>o.abort()),r=[]},s};rte.exports=BHe});var ote=y((OCt,ste)=>{f();"use strict";var nte=me(),N2=Object.assign(nte("ipfs:mfs-preload"),{error:nte("ipfs:mfs-preload:error")});ste.exports=({preload:t,files:e,options:r={}})=>{if(r.interval=r.interval||30*1e3,!r.enabled){N2("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(N2(`preloading updated MFS root ${i} -> ${o.cid}`),await t(o.cid),i=a)}catch(o){N2.error("failed to preload MFS root",o)}finally{n=setTimeout(s,r.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),N2(`monitoring MFS root ${o.cid}`),n=setTimeout(s,r.interval)},stop(){clearTimeout(n)}}}});var L5=y((kCt,ate)=>{f();"use strict";var MHe=D4(),B2;ate.exports=(t=!1)=>{if(B2)return B2;let e=MHe({singleProcess:t});return B2={readLock:r=>async(...i)=>{let n=await e.readLock();try{return await r.apply(null,i)}finally{n()}},writeLock:r=>async(...i)=>{let n=await e.writeLock();try{return await r.apply(null,i)}finally{n()}}},B2}});var M2=y((qCt,dte)=>{f();"use strict";var{CID:cte}=(Ie(),Ne),{UnixFS:LHe}=(pi(),as),UHe=(_t(),Mt),{sha256:FHe}=(ri(),li),ute=me()("ipfs:mfs:utils:with-mfs-root"),lte=ue(),{MFS_ROOT_KEY:fte}=Ki(),KHe=async(t,e)=>{if(e&&e.signal&&e.signal.aborted)throw lte(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.open();let r;try{let i=await t.repo.datastore.get(fte);r=cte.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;ute("Creating new MFS root");let n=UHe.encode({Data:new LHe({type:"directory"}).marshal(),Links:[]}),s=await FHe.digest(n);if(r=cte.createV0(s),await t.repo.blocks.put(r,n),e&&e.signal&&e.signal.aborted)throw lte(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.put(fte,r.bytes)}return ute(`Loaded MFS root /ipfs/${r}`),r};dte.exports=KHe});var L2=y((DCt,hte)=>{f();"use strict";var jHe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);hte.exports=jHe});var Jc=y((NCt,yte)=>{f();"use strict";var VHe=M2(),zHe=L2(),{exporter:HHe}=(jo(),Ko),pte=ue(),{CID:$He}=(Ie(),Ne),U5="ipfs",GHe=async(t,e,r)=>{let i=await VHe(t,r),n={entryType:"file"},s="";if($He.asCID(e)?s=`/ipfs/${e}`:s=e.toString(),s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw pte(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw pte(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=zHe(s);if(o[0]===U5){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${U5}/${i}${o.length?"/"+o.join("/"):""}`,u=`/${U5}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:u,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await HHe(a,t.repo.blocks,r);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};yte.exports=GHe});var a1=y((BCt,mte)=>{f();"use strict";var WHe=gr().bind({ignoreUndefined:!0}),YHe=Jc(),{exporter:XHe}=(jo(),Ko),QHe=me()("ipfs:mfs:stat"),ZHe=ue(),JHe=qe(),gte=(_t(),Mt),e$e={withLocal:!1};mte.exports=t=>{async function e(r,i={}){i=WHe(e$e,i),QHe(`Fetching stats for ${r}`);let{type:n,cid:s,mfsPath:o}=await YHe(t,r,i),a=n==="ipfs"&&s?s:o,c;try{c=await XHe(a,t.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?ZHe(new Error(`${r} does not exist`),"ERR_NOT_FOUND"):u}if(!bte[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return bte[c.type](c)}return JHe(e)};var bte={raw:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:t=>{let e={cid:t.cid,type:"file",size:t.unixfs.fileSize(),cumulativeSize:gte.encode(t.node).length+(t.node.Links||[]).reduce((r,i)=>r+(i.Tsize||0),0),blocks:t.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},directory:t=>{let e={cid:t.cid,type:"directory",size:0,cumulativeSize:gte.encode(t.node).length+(t.node.Links||[]).reduce((r,i)=>r+(i.Tsize||0),0),blocks:t.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},object:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});var Wp=y((MCt,vte)=>{f();"use strict";var{walkPath:t$e}=(jo(),Ko),r$e=me()("ipfs:mfs:utils:to-trail"),i$e=async(t,e)=>{r$e(`Creating trail for path ${e}`);let r=[];for await(let i of t$e(e,t.repo.blocks))r.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return r};vte.exports=i$e});var F5=y((LCt,Ete)=>{f();"use strict";var{CID:n$e}=(Ie(),Ne),wte=(_t(),Mt),{sha256:_te}=(ri(),li),s$e=async(t,e,r)=>{r.codec||(r.codec=wte),r.hasher||(r.hasher=_te),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===wte&&r.hasher!==_te&&(r.cidVersion=1);let i=await r.hasher.digest(t),n=n$e.create(r.cidVersion,r.codec.code,i);return r.onlyHash||await e.put(n,t,{signal:r.signal}),n};Ete.exports=s$e});var K5=y((UCt,xte)=>{f();"use strict";var{murmur3128:Ste}=(j_(),bY);xte.exports={hamtHashCode:Ste.code,hamtBucketBits:8,async hamtHashFn(t){return(await Ste.encode(t)).slice(0,8).reverse()}}});var j5=y((FCt,Rte)=>{f();"use strict";var{encode:o$e,prepare:a$e}=(_t(),Mt),{UnixFS:c$e}=(pi(),as),u$e=F5(),{createHAMT:l$e,Bucket:f$e}=Db(),{hamtHashCode:d$e,hamtHashFn:h$e,hamtBucketBits:p$e}=K5(),Ate=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},Ite=class extends Ate{constructor(e,r){super(e,r);this._bucket=l$e({hashFn:h$e,bits:p$e})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){yield*Tte(this._bucket,e,this,this.options)}};Rte.exports=Ite;async function*Tte(t,e,r,i){let n=t._children,s=[],o=0;for(let p=0;p<n.length;p++){let g=n.get(p);if(!g)continue;let m=p.toString(16).toUpperCase().padStart(2,"0");if(g instanceof f$e){let E;for await(let v of await Tte(g,e,null,i))E=v;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:m,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,v;for await(let R of E.flush(e))v=R,yield v;let A=m+g.key;s.push({Name:A,Tsize:v.size,Hash:v.cid}),o+=v.size}else{let E=g.value;if(!E.cid)continue;let v=m+g.key,A=E.size;s.push({Name:v,Tsize:A,Hash:E.cid}),o+=A}}let a=Uint8Array.from(n.bitField().reverse()),u={Data:new c$e({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:d$e,mtime:r&&r.mtime,mode:r&&r.mode}).marshal(),Links:s},l=o$e(a$e(u)),d=await u$e(l,e,i),h=l.length+o;yield{cid:d,node:u,size:h}}});var z5=y((KCt,qte)=>{f();"use strict";var V5=(_t(),Mt),{Bucket:Pte,createHAMT:y$e}=Db(),g$e=j5(),U2=me()("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:Cte}=(pi(),as),b$e=$n(),{CID:m$e}=(Ie(),Ne),{hamtHashCode:v$e,hamtHashFn:w$e,hamtBucketBits:_$e}=K5(),E$e=async(t,e,r,i)=>{if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let n=Uint8Array.from(r._children.bitField().reverse()),s=Cte.unmarshal(i.parent.Data),o=new Cte({type:"hamt-sharded-directory",data:n,fanout:r.tableSize(),hashType:v$e,mode:s.mode,mtime:s.mtime}),a=await t.hashers.getHasher(i.hashAlg),c={Data:o.marshal(),Links:e.sort((h,p)=>(h.Name||"").localeCompare(p.Name||""))},u=V5.encode(c),l=await a.digest(u),d=m$e.create(i.cidVersion,V5.code,l);return i.flush&&await t.repo.blocks.put(d,u),{node:c,cid:d,size:e.reduce((h,p)=>h+(p.Tsize||0),u.length)}},Ote=async(t,e,r,i)=>{let n=new Pte({hash:e._options.hash,bits:e._options.bits},r,i);return r._putObjectAt(i,n),await F2(t,n,e),n},kte=async t=>{let e=y$e({hashFn:w$e,bits:_$e});return await F2(t,e,e),e},F2=async(t,e,r)=>{await Promise.all(t.map(i=>{let n=i.Name||"";if(n.length===2){let s=parseInt(n,16);return e._putObjectAt(s,new Pte({hash:r._options.hash,bits:r._options.bits},e,s)),Promise.resolve()}return r.put(n.substring(2),{size:i.Tsize,cid:i.Hash})}))},K2=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),S$e=async(t,e,r)=>{let i=await kte(r.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:K2(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:K2(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=r;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(p=>(p.Name||"").substring(0,2)===c.prefix).pop();if(!u){U2(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){U2(`Link ${c.prefix}${e} will be replaced`);continue}U2(`Found subshard ${c.prefix}`);let l=await t.repo.blocks.get(u.Hash),d=V5.decode(l);if(!s[a+1]){U2(`Loaded new subshard ${c.prefix}`),await Ote(d.Links,i,c.bucket,parseInt(c.prefix,16));let p=await i._findNewBucketAndPos(e);s.push({bucket:p.bucket,prefix:K2(p.pos),node:d});continue}let h=s[a+1];await F2(d.Links,h.bucket,i),h.node=d}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},x$e=async(t,e,r={})=>{let i=new g$e({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let s=0;s<e.length;s++)await i._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});let n=await b$e(i.flush(t.repo.blocks));if(!n)throw new Error("Flushing shard yielded no result");return n};qte.exports={generatePath:S$e,updateHamtDirectory:E$e,recreateHamtLevel:Ote,recreateInitialHamtLevel:kte,addLinksToHamtBucket:F2,toPrefix:K2,createShard:x$e}});var ed=y((jCt,Nte)=>{f();"use strict";var Jf=(_t(),Mt),{CID:Dte}=(Ie(),Ne),Ya=me()("ipfs:mfs:core:utils:add-link"),{UnixFS:H5}=(pi(),as),A$e=j5(),{updateHamtDirectory:I$e,recreateHamtLevel:T$e,recreateInitialHamtLevel:R$e,createShard:P$e,toPrefix:$5,addLinksToHamtBucket:C$e}=z5(),eu=ue(),O$e=$n(),k$e=async(t,e)=>{let r=e.parent;if(e.parentCid){let n=Dte.asCID(e.parentCid);if(n===null)throw eu(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==Jf.code)throw eu(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");Ya(`Loading parent node ${n}`);let s=await t.repo.blocks.get(n);r=Jf.decode(s)}if(!r)throw eu(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw eu(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw eu(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw eu(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw eu(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=H5.unmarshal(r.Data);return i.type==="hamt-sharded-directory"?(Ya("Adding link to sharded directory"),N$e(t,{...e,parent:r})):r.Links.length>=e.shardSplitThreshold?(Ya("Converting directory to sharded directory"),q$e(t,{...e,parent:r,mtime:i.mtime,mode:i.mode})):(Ya(`Adding ${e.name} (${e.cid}) to regular directory`),D$e(t,{...e,parent:r}))},q$e=async(t,e)=>{let r=await P$e(t,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return Ya(`Converted directory to sharded directory ${r.cid}`),r},D$e=async(t,e)=>{let r=e.parent.Links.filter(u=>u.Name!==e.name);if(r.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw eu(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=H5.unmarshal(e.parent.Data),n;if(i.mtime){let u=Date.now(),l=Math.floor(u/1e3);i.mtime={secs:l,nsecs:(u-l*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=Jf.prepare({Data:n,Links:r});let s=await t.hashers.getHasher(e.hashAlg),o=Jf.encode(e.parent),a=await s.digest(o),c=Dte.create(e.cidVersion,Jf.code,a);return e.flush&&await t.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},N$e=async(t,e)=>{let{shard:r,path:i}=await B$e(t,e),n=await O$e(r.flush(t.repo.blocks));if(!n)throw new Error("No result from flushing shard");let s=await t.repo.blocks.get(n.cid),o=Jf.decode(s),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(u=>(u.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),I$e(t,a,i[0].bucket,e)},B$e=async(t,e)=>{let r={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw eu(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await R$e(e.parent.Links),n=H5.unmarshal(e.parent.Data),s=new A$e({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:n.mode},e);s._bucket=i,n.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});let o=await i._findNewBucketAndPos(r.name),a=M$e(o);a[0].node=e.parent;let c=0;for(;c<a.length;){let u=a[c];c++;let l=u.node;if(!l)throw new Error("Segment had no node");let d=l.Links.find(m=>(m.Name||"").substring(0,2)===u.prefix);if(!d){Ya(`Link ${u.prefix}${r.name} will be added`),c=a.length;break}if(d.Name===`${u.prefix}${r.name}`){Ya(`Link ${u.prefix}${r.name} will be replaced`),c=a.length;break}if((d.Name||"").length>2){Ya(`Link ${d.Name} ${d.Hash} will be replaced with a subshard`),c=a.length;break}Ya(`Found subshard ${u.prefix}`);let h=await t.repo.blocks.get(d.Hash),p=Jf.decode(h);if(!a[c]){Ya(`Loaded new subshard ${u.prefix}`),await T$e(p.Links,i,u.bucket,parseInt(u.prefix,16));let m=await i._findNewBucketAndPos(r.name);a.push({bucket:m.bucket,prefix:$5(m.pos),node:p});break}let g=a[c];await C$e(p.Links,g.bucket,i),g.node=p}return await s._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:s,path:a}},M$e=t=>{let e=[{bucket:t.bucket,prefix:$5(t.pos)}],r=t.bucket._parent,i=t.bucket._posAtParent;for(;r;)e.push({bucket:r,prefix:$5(i)}),i=r._posAtParent,r=r._parent;return e.reverse(),e};Nte.exports=k$e});var td=y((VCt,Mte)=>{f();"use strict";var Bte=me()("ipfs:mfs:utils:update-tree"),L$e=ed(),{decode:U$e}=(_t(),Mt),F$e={shardSplitThreshold:1e3},K$e=async(t,e,r)=>{r=Object.assign({},F$e,r),Bte("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of t.repo.blocks.getMany(e.map(a=>a.cid))){let a=U$e(o),c=e[i].cid,u=e[i].name;if(i++,!n){n={cid:c,name:u,size:o.length};continue}let l=await L$e(t,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});n={cid:l.cid,name:u,size:l.size}}let{cid:s}=n;return Bte(`Final CID ${s}`),s};Mte.exports=K$e});var rd=y((zCt,Lte)=>{f();"use strict";var j$e=me()("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:V$e}=Ki(),z$e=ue(),H$e=async(t,e,r)=>{if(r&&r.signal&&r.signal.aborted)throw z$e(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return j$e(`New MFS root will be ${e}`),await t.repo.datastore.put(V$e,e.bytes),e};Lte.exports=H$e});var Kte=y((HCt,Fte)=>{f();"use strict";var{UnixFS:$$e}=(pi(),as),Ute=(_t(),Mt),{CID:G$e}=(Ie(),Ne),W$e=async(t,e,r)=>{let i=new $$e({type:e,mode:r.mode,mtime:r.mtime}),n=await t.hashers.getHasher(r.hashAlg),s={Data:i.marshal(),Links:[]},o=Ute.encode(s),a=await n.digest(o),c=G$e.create(r.cidVersion,Ute.code,a);return r.flush&&await t.repo.blocks.put(c,o),{cid:c,node:s}};Fte.exports=W$e});var j2=y(($Ct,Vte)=>{f();"use strict";var Yp=ue(),jte=me()("ipfs:mfs:mkdir"),{exporter:Y$e}=(jo(),Ko),X$e=Kte(),Q$e=L2(),Z$e=rd(),J$e=td(),eGe=ed(),tGe=M2(),rGe=gr().bind({ignoreUndefined:!0}),iGe=qe(),nGe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};Vte.exports=t=>{async function e(r,i={}){let n=rGe(nGe,i);if(!r)throw new Error("no path given to Mkdir");if(r=r.trim(),r==="/"){if(n.parents)return;throw Yp(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(r.substring(0,1)!=="/")throw Yp(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");jte(`Creating ${r}`);let s=Q$e(r);if(s[0]==="ipfs")throw Yp(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await tGe(t,n),a,c=[],u=await X$e(t,"directory",n);for(let d=0;d<=s.length;d++){let h=s.slice(0,d),p=`/ipfs/${o}/${h.join("/")}`;try{if(a=await Y$e(p,t.repo.blocks),a.type!=="file"&&a.type!=="directory")throw Yp(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(d===s.length){if(n.parents)return;throw Yp(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(g){if(g.code==="ERR_NOT_FOUND"){if(d<s.length&&!n.parents)throw Yp(new Error(`Intermediate directory path ${p} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await sGe(t,h[h.length-1],u,c[c.length-1],c,n)}else throw g}}let l=await J$e(t,c,n);await Z$e(t,l,n)}return iGe(e)};var sGe=async(t,e,r,i,n,s)=>{jte(`Adding empty dir called ${e} to ${i.cid}`);let o=await eGe(t,{parent:i.node,parentCid:i.cid,size:0,cid:r.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:r.cid})}});var H2=y((GCt,Yte)=>{f();"use strict";var zte=j2(),oGe=a1(),V2=me()("ipfs:mfs:cp"),id=ue(),Hte=td(),$te=rd(),aGe=ed(),z2=Jc(),cGe=gr().bind({ignoreUndefined:!0}),uGe=Wp(),lGe=qe(),fGe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};Yte.exports=t=>{async function e(r,i,n={}){let s=cGe(fGe,n);Array.isArray(r)||(r=[r]);let o=await Promise.all(r.map(h=>z2(t,h,s))),a=await z2(t,i,s);if(!o.length||!a)throw id(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(h=>!h.exists);if(c)throw id(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=Gte(a);if(a.exists){if(V2("Destination exists"),o.length===1&&!u)throw id(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(V2("Destination does not exist"),o.length>1){if(!s.parents)throw id(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await zte(t)(a.path,s),a=await z2(t,a.path,s)}else if(a.parts.length>1){let h=`/${a.parts.slice(0,-1).join("/")}`;try{await oGe(t)(h,s)}catch(p){if(p.code!=="ERR_NOT_FOUND")throw p;if(!s.parents)throw id(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await zte(t)(h,s),a=await z2(t,a.path,s)}}let l=Gte(a)?a.mfsPath:a.mfsDirectory,d=await uGe(t,l);if(o.length===1){let h=o.pop();if(!h)throw id(new Error("could not find source"),"ERR_INVALID_PARAMS");let p=u?h.name:a.name;return V2(`Only one source, copying to destination ${u?"directory":"file"} ${p}`),dGe(t,h,p,d,s)}return V2("Multiple sources, wrapping in a directory"),hGe(t,o,a,d,s)}return lGe(e)};var Gte=t=>t.unixfs&&t.unixfs.type&&t.unixfs.type.includes("directory"),dGe=async(t,e,r,i,n)=>{let s=i.pop();if(!s)throw id(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await Wte(t,e,r,s,n),i.push(s);let o=await Hte(t,i,n);await $te(t,o,n)},hGe=async(t,e,r,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];r=await Wte(t,a,a.name,r,n)}i[i.length-1]=r;let s=await Hte(t,i,n);await $te(t,s,n)},Wte=async(t,e,r,i,n)=>{let s=await t.repo.blocks.get(e.cid),{node:o,cid:a,size:c}=await aGe(t,{parentCid:i.cid,size:s.length,cid:e.cid,name:r,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=c,i}});var Jte=y((WCt,Zte)=>{f();"use strict";var G5=(_t(),Mt),{CID:Xte}=(Ie(),Ne),vl=me()("ipfs:mfs:core:utils:remove-link"),{UnixFS:pGe}=(pi(),as),{generatePath:yGe,updateHamtDirectory:W5}=z5(),nd=ue(),gGe=async(t,e)=>{let r=e.parent;if(e.parentCid){let n=Xte.asCID(e.parentCid);if(n===null)throw nd(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");vl(`Loading parent node ${n}`);let s=await t.repo.blocks.get(n);r=G5.decode(s)}if(!r)throw nd(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw nd(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw nd(new Error("Parent node had no data"),"ERR_INVALID_NODE");return pGe.unmarshal(r.Data).type==="hamt-sharded-directory"?(vl(`Removing ${e.name} from sharded directory`),mGe(t,{...e,parent:r})):(vl(`Removing link ${e.name} regular directory`),bGe(t,{...e,parent:r}))},bGe=async(t,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let r=await G5.encode(e.parent),n=await(await t.hashers.getHasher(e.hashAlg)).digest(r),s=Xte.create(e.cidVersion,G5.code,n);return await t.repo.blocks.put(s,r),vl(`Updated regular directory ${s}`),{node:e.parent,cid:s}},mGe=async(t,e)=>{let{rootBucket:r,path:i}=await yGe(t,e.name,e.parent);await r.del(e.name);let{node:n}=await Qte(t,i,e.name,e);return W5(t,n.Links,r,e)},Qte=async(t,e,r,i)=>{let n=e.pop();if(!n)throw nd(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw nd(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(p=>(p.Name||"").substring(0,2)===o);if(!c)throw nd(new Error(`No link found with prefix ${o} for file ${r}`),"ERR_NOT_FOUND");if(c.Name===`${o}${r}`){vl(`Removing existing link ${c.Name}`);let p=a.Links.filter(g=>g.Name!==c.Name);return await s.del(r),W5(t,p,s,i)}vl(`Descending into sub-shard ${c.Name} for ${o}${r}`);let u=await Qte(t,e,r,i),l=u.cid,d=u.size,h=o;if(u.node.Links.length===1){vl(`Removing subshard for ${o}`);let p=u.node.Links[0];h=`${o}${(p.Name||"").substring(2)}`,l=p.Hash,d=p.Tsize||0}return vl(`Updating shard ${o} with name ${h}`),vGe(t,s,a,o,h,d,l,i)},vGe=(t,e,r,i,n,s,o,a)=>{let c=r.Links.filter(u=>u.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),W5(t,c,e,a)};Zte.exports=gGe});var G2=y((YCt,tre)=>{f();"use strict";var $2=ue(),wGe=td(),_Ge=rd(),EGe=Jte(),ere=Jc(),SGe=Wp(),xGe=qe(),AGe=gr().bind({ignoreUndefined:!0}),IGe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};tre.exports=t=>{async function e(r,i={}){let n=AGe(IGe,i);Array.isArray(r)||(r=[r]);let s=await Promise.all(r.map(o=>ere(t,o,n)));if(!s.length)throw $2(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw $2(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await TGe(t,o.path,n)}return xGe(e)};var TGe=async(t,e,r)=>{let i=await ere(t,e,r),n=await SGe(t,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw $2(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!r.recursive)throw $2(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await EGe(t,{parentCid:o.cid,name:s.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});o.cid=a;let c=await wGe(t,n,r);await _Ge(t,c,r)}});var are=y((XCt,ore)=>{f();"use strict";var RGe=gr().bind({ignoreUndefined:!0}),PGe=Jc(),CGe=me()("ipfs:mfs:touch"),c1=ue(),{UnixFS:rre}=(pi(),as),OGe=Wp(),kGe=ed(),qGe=td(),DGe=rd(),sd=(_t(),Mt),{CID:ire}=(Ie(),Ne),{pipe:NGe}=Ar(),{importer:BGe}=(Q_(),X_),{recursive:MGe}=(jo(),Ko),LGe=$n(),UGe=H2(),FGe=G2(),KGe=F5(),jGe=qe(),nre={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function VGe(t,e,r){let i=0;return(t.includes("x")||t.includes("X")&&(r||e&1||e&8||e&64))&&(i+=1),t.includes("w")&&(i+=2),t.includes("r")&&(i+=4),i}function zGe(t,e){let r=0;return t.includes("u")&&(r+=e<<6),t.includes("g")&&(r+=e<<3),t.includes("o")&&(r+=e),r}function HGe(t,e,r){return e.includes("t")&&(r+=parseInt("1000",8)),e.includes("s")&&(t.includes("u")&&(r+=parseInt("4000",8)),t.includes("g")&&(r+=parseInt("2000",8))),r}function $Ge(t,e,r){e||(e=0);let i=t.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${t}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=VGe(o,e,r);return a=zGe(n,a),a=HGe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function sre(t,e){if(t instanceof String||typeof t=="string"){let r=`${t}`;r.match(/^\d+$/g)?t=parseInt(r,8):t=0+r.split(",").reduce((i,n)=>$Ge(n,i,e.isDirectory()),e.mode||0)}return t}ore.exports=t=>{async function e(r,i,n={}){let s=RGe(nre,n);CGe(`Fetching stats for ${r}`);let{cid:o,mfsDirectory:a,name:c}=await PGe(t,r,s);if(o.code!==sd.code)throw c1(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let G=await NGe(async function*(){for await(let Y of MGe(o,t.repo.blocks)){if(Y.type!=="file"&&Y.type!=="directory")throw c1(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");Y.unixfs.mode=sre(i,Y.unixfs);let P=sd.prepare({Data:Y.unixfs.marshal(),Links:Y.node.Links});yield{path:Y.path,content:P}}},Y=>BGe(Y,t.repo.blocks,{...s,pin:!1,dagBuilder:async function*(P,b,w){for await(let S of P)yield async function(){let C=S.content,B=sd.encode(C),W=await KGe(B,b,w);if(!C.Data)throw c1(new Error(`${W} had no data`),"ERR_INVALID_NODE");let j=rre.unmarshal(C.Data);return{cid:W,size:B.length,path:S.path,unixfs:j}}}}),Y=>LGe(Y));if(!G)throw c1(new Error(`Could not chmod ${r}`),"ERR_COULD_NOT_CHMOD");await FGe(t)(r,s),await UGe(t)(`/ipfs/${G.cid}`,r,s);return}let u=await t.repo.blocks.get(o),l=sd.decode(u);if(!l.Data)throw c1(new Error(`${o} had no data`),"ERR_INVALID_NODE");let d=rre.unmarshal(l.Data);d.mode=sre(i,d);let h=sd.encode({Data:d.marshal(),Links:l.Links}),p=s.hashAlg||nre.hashAlg,m=await(await t.hashers.getHasher(p)).digest(h),E=ire.create(s.cidVersion,sd.code,m);s.flush&&await t.repo.blocks.put(E,h);let v=await OGe(t,a),A=v[v.length-1],R=ire.decode(A.cid.bytes),F=await t.repo.blocks.get(R),q=sd.decode(F),D=await kGe(t,{parent:q,name:c,cid:E,size:h.length,flush:s.flush,hashAlg:p,cidVersion:o.version,shardSplitThreshold:1/0});A.cid=D.cid;let z=await qGe(t,v,s);await DGe(t,z,s)}return jGe(e)}});var ure=y((QCt,cre)=>{f();"use strict";var GGe=a1(),WGe=qe(),YGe=gr().bind({ignoreUndefined:!0}),XGe={};cre.exports=t=>{async function e(r,i={}){i=YGe(XGe,i);let{cid:n}=await GGe(t)(r,i);return n}return WGe(e)}});var fre=y((ZCt,lre)=>{f();"use strict";var QGe=H2(),ZGe=G2(),JGe=gr().bind({ignoreUndefined:!0}),eWe=qe(),tWe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};lre.exports=t=>{async function e(r,i,n={}){let s=JGe(tWe,n);await QGe(t)(r,i,s),await ZGe(t)(r,{...s,recursive:!0})}return eWe(e)}});var bre=y((JCt,gre)=>{f();"use strict";var rWe=gr().bind({ignoreUndefined:!0}),iWe=Jc(),nWe=me()("ipfs:mfs:touch"),dre=ue(),{UnixFS:hre}=(pi(),as),sWe=Wp(),oWe=ed(),aWe=td(),cWe=rd(),od=(_t(),Mt),{CID:pre}=(Ie(),Ne),uWe=qe(),yre={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};gre.exports=t=>{async function e(r,i={}){let n=rWe(yre,i);n.mtime=n.mtime||new Date,nWe(`Touching ${r} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await iWe(t,r,n),u=i.hashAlg||yre.hashAlg,l=await t.hashers.getHasher(u),d,h,p=n.cidVersion;if(c){if(s.code!==od.code)throw dre(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");p=s.version;let q=await t.repo.blocks.get(s),D=od.decode(q);if(!D.Data)throw dre(new Error(`${r} had no data`),"ERR_INVALID_NODE");let z=hre.unmarshal(D.Data);z.mtime=n.mtime,d=od.encode({Data:z.marshal(),Links:D.Links});let G=await l.digest(d);h=pre.create(n.cidVersion,od.code,G),n.flush&&await t.repo.blocks.put(h,d)}else{let q=new hre({type:"file",mtime:n.mtime});d=od.encode({Data:q.marshal(),Links:[]});let D=await l.digest(d);h=pre.create(n.cidVersion,od.code,D),n.flush&&await t.repo.blocks.put(h,d)}let g=await sWe(t,o),m=g[g.length-1],E=m.cid,v=await t.repo.blocks.get(E),A=od.decode(v),R=await oWe(t,{parent:A,name:a,cid:h,size:d.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:p});m.cid=R.cid;let F=await aWe(t,g,n);await cWe(t,F,n)}return uWe(e)}});var _re=y((eOt,wre)=>{f();"use strict";var mre=ue(),u1=me()("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:vre}=Ki(),{fromString:lWe}=(ft(),ht),fWe=t=>{if(!t)throw mre(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof t=="string"||t instanceof String)&&(u1("Content was a string"),t=lWe(t.toString())),t.length)return u1("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield t}};if(t[Symbol.asyncIterator])return u1("Content was an async iterator"),t;if(t[Symbol.iterator])return u1("Content was an iterator"),t;if(globalThis.Blob&&t instanceof globalThis.Blob){u1("Content was an HTML5 Blob");let e=0,r={next:()=>e>t.size?{done:!0}:new Promise((i,n)=>{let s=t.slice(e,vre);e+=vre;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>r}}throw mre(new Error(`Don't know how to convert ${t} into an async iterator`),"ERR_INVALID_PARAMS")};wre.exports=fWe});var Ire=y((tOt,Are)=>{f();"use strict";var Xa=me()("ipfs:mfs:write"),{importer:dWe}=(Q_(),X_),{decode:hWe}=(_t(),Mt),{sha256:pWe,sha512:yWe}=(ri(),li),gWe=a1(),bWe=j2(),mWe=ed(),vWe=gr().bind({ignoreUndefined:!0}),Ere=L5(),wWe=_re(),Y5=Jc(),_We=L2(),EWe=Wp(),SWe=td(),xWe=rd(),tu=ue(),{MFS_MAX_CHUNK_SIZE:AWe}=Ki(),IWe=$n(),TWe=qe(),{parseMode:RWe,parseMtime:PWe}=(pi(),as),CWe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(t,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};Are.exports=t=>{async function e(r,i,n={}){let s=vWe(CWe,n),o,a,c;if(Xa("Reading source, destination and parent"),await Ere().readLock(async()=>{o=await wWe(i),a=await Y5(t,r,s),c=await Y5(t,a.mfsDirectory,s)})(),Xa("Read source, destination and parent"),!s.parents&&!c.exists)throw tu(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw tu(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw tu(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw tu(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw tu(new Error("not a file"),"ERR_NOT_A_FILE");return OWe(t,r,o,a,s)}return TWe(e)};var OWe=async(t,e,r,i,n)=>{let s=await kWe(t,r,i,n);await Ere().writeLock(async()=>{let o=_We(e),a=o.pop();if(a==null)throw tu(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await gWe(t)(`/${o.join("/")}`,n),c=!0}catch(E){if(E.code!=="ERR_NOT_FOUND")throw E}c||await bWe(t)(`/${o.join("/")}`,n);let u=await Y5(t,e,n),l=await EWe(t,u.mfsDirectory),d=l[l.length-1];if(!d)throw tu(new Error("directory does not exist"),"ERR_NO_EXIST");if(!d.type||!d.type.includes("directory"))throw tu(new Error(`cannot write to ${d.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let h=await t.repo.blocks.get(d.cid),p=hWe(h),g=await mWe(t,{parent:p,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});d.cid=g.cid;let m=await SWe(t,l,n);await xWe(t,m,n)})()},kWe=async(t,e,r,i)=>{r.exists?Xa(`Overwriting file ${r.cid} offset ${i.offset} length ${i.length}`):Xa(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(r.unixfs){if(Xa(`Writing first ${i.offset} bytes of original file`),n.push(()=>r.content({offset:0,length:i.offset})),r.unixfs.fileSize()<i.offset){let l=i.offset-r.unixfs.fileSize();Xa(`Writing zeros for extra ${l} bytes`),n.push(xre(l))}}else Xa(`Writing zeros for first ${i.offset} bytes`),n.push(xre(i.offset));n.push(Sre(e,i.length));let s=DWe(qWe(n),l=>{if(r.unixfs&&!i.truncate){let d=r.unixfs.fileSize();if(d>l)return Xa(`Writing last ${d-l} of ${d} bytes from original file starting at offset ${l}`),r.content({offset:l});Xa("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=RWe(i.mode):r&&r.unixfs&&(o=r.unixfs.mode);let a;i.mtime!=null?a=PWe(i.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);let c;switch(i.hashAlg){case"sha2-256":c=pWe;break;case"sha2-512":c=yWe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${i.hashAlg}`)}let u=await IWe(dWe([{content:s,mode:o,mtime:a}],t.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!u)throw tu(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return Xa(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},Sre=(t,e)=>async function*(){let i=0;for await(let n of t){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},xre=(t,e=AWe)=>{let r=new Uint8Array(e);async function*i(){for(;;)yield r.slice()}return Sre(i(),t)},qWe=async function*(t){for(let e=0;e<t.length;e++)yield*t[e]()},DWe=async function*(t,e){let r=0;for await(let i of t)r+=i.length,yield i;for await(let i of e(r))r+=i.length,yield i}});var Pre=y((rOt,Rre)=>{f();"use strict";var{exporter:NWe}=(jo(),Ko),BWe=gr().bind({ignoreUndefined:!0}),MWe=Jc(),Tre=ue(),LWe=qe(),UWe={offset:0,length:1/0};Rre.exports=t=>{function e(r,i={}){return i=BWe(UWe,i),{[Symbol.asyncIterator]:async function*(){let s=await MWe(t,r,i),o=await NWe(s.mfsPath,t.repo.blocks);if(o.type!=="file")throw Tre(new Error(`${r} was not a file`),"ERR_NOT_FILE");if(!o.content)throw Tre(new Error(`Could not load content stream from ${r}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return LWe(e)}});var kre=y((iOt,Ore)=>{f();"use strict";var{exporter:FWe}=(jo(),Ko),KWe=Jc(),jWe=qe(),VWe=No(),Cre=t=>{let e={cid:t.cid,name:t.name,type:t.type==="directory"?"directory":"file",size:t.size};return(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,e.mtime=t.unixfs.mtime),e};Ore.exports=t=>{async function*e(r,i={}){let n=await KWe(t,r,i),s=await FWe(n.mfsPath,t.repo.blocks);if(s.type==="directory"){yield*VWe(s.content(i),Cre);return}yield Cre(s)}return jWe(e)}});var Mre=y((nOt,Bre)=>{f();"use strict";var zWe=L5(),qre=Yh(),HWe={stat:a1()},$We={chmod:are(),cp:H2(),flush:ure(),mkdir:j2(),mv:fre(),rm:G2(),touch:bre()},Dre={write:Ire(),read:Pre(),ls:kre()},Nre=({options:t,mfs:e,operations:r,lock:i})=>{Object.keys(r).forEach(n=>{e[n]=i(r[n](t))})},GWe={repoOwner:!0,repo:null};function WWe(t){let{repoOwner:e}=Object.assign({},GWe||{},t),r=zWe(e),i=o=>r.readLock(o),n=o=>r.writeLock(o),s={};return Nre({options:t,mfs:s,operations:HWe,lock:i}),Nre({options:t,mfs:s,operations:$We,lock:n}),Object.keys(Dre).forEach(o=>{s[o]=Dre[o](t)}),s}Bre.exports=({repo:t,preload:e,hashers:r,options:i})=>{let n=WWe({repo:t,repoOwner:Boolean(i.repoOwner),hashers:r}),s=o=>(...c)=>{let u=c.filter(l=>qre.ipfsPath(l)||qre.cid(l));if(u.length){let l=c[c.length-1];l&&l.preload!==!1&&u.forEach(d=>e(d))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}});var Ure=y((sOt,Lre)=>{f();"use strict";var YWe=qe();Lre.exports=({keychain:t})=>YWe((r,i)=>t.exportKey(r,i))});var Vre=y((oOt,jre)=>{f();"use strict";var XWe=qe(),Fre="ed25519",Kre=2048;jre.exports=({keychain:t})=>XWe((r,i={type:Fre,size:Kre})=>t.createKey(r,i.type||Fre,i.size||Kre))});var Hre=y((aOt,zre)=>{f();"use strict";var QWe=qe();zre.exports=({keychain:t})=>QWe((r,i,n)=>t.importKey(r,i,n))});var Gre=y((cOt,$re)=>{f();"use strict";var ZWe=qe();$re.exports=({keychain:t})=>ZWe(r=>t.findKeyByName(r))});var Yre=y((uOt,Wre)=>{f();"use strict";var JWe=qe();Wre.exports=({keychain:t})=>JWe(()=>t.listKeys())});var Qre=y((lOt,Xre)=>{f();"use strict";var eYe=qe();Xre.exports=({keychain:t})=>eYe(async(r,i)=>{let n=await t.renameKey(r,i);return{was:r,now:n.name,id:n.id,overwrite:!1}})});var Jre=y((fOt,Zre)=>{f();"use strict";var tYe=qe();Zre.exports=({keychain:t})=>tYe(r=>t.removeKey(r))});var rie=y((dOt,tie)=>{f();"use strict";var rYe=Ure(),iYe=Vre(),nYe=Hre(),sYe=Gre(),oYe=Yre(),aYe=Qre(),cYe=Jre(),eie=class{constructor({keychain:e}){this.gen=iYe({keychain:e}),this.list=oYe({keychain:e}),this.rm=cYe({keychain:e}),this.rename=aYe({keychain:e}),this.export=rYe({keychain:e}),this.import=nYe({keychain:e}),this.info=sYe({keychain:e})}};tie.exports=eie});var wl=y((hOt,iie)=>{f();"use strict";var uYe=(_t(),Mt),lYe=qe();iie.exports=({repo:t,preload:e})=>{async function r(i,n={}){n.preload!==!1&&e(i);let s=await t.blocks.get(i,n);return uYe.decode(s)}return lYe(r)}});var sie=y((pOt,nie)=>{f();"use strict";var fYe=qe();nie.exports=({repo:t,preload:e})=>{let r=wl()({repo:t,preload:e});async function i(n,s={}){return(await r(n,s)).Data||new Uint8Array(0)}return fYe(i)}});var cie=y((yOt,aie)=>{f();"use strict";var dYe=(_t(),Mt),hYe=(zc(),Xw),pYe=(Rs(),wo),{CID:oie}=(Ie(),Ne),yYe=qe();function X5(t,e=[]){for(let r in t){let i=t[r];if(r==="/"&&Object.keys(t).length===1)try{e.push({Name:"",Tsize:0,Hash:oie.parse(i)});continue}catch(s){}let n=oie.asCID(i);if(n){e.push({Name:"",Tsize:0,Hash:n});continue}Array.isArray(i)&&X5(i,e),i&&typeof i=="object"&&X5(i,e)}return e}aie.exports=({repo:t,codecs:e})=>{async function r(i,n={}){let s=await e.getCodec(i.code),o=await t.blocks.get(i,n),a=s.decode(o);if(i.code===pYe.code)return[];if(i.code===dYe.code)return a.Links;if(i.code===hYe.code)return X5(a);throw new Error(`Cannot resolve links from codec ${i.code}`)}return yYe(r)}});var lie=y((gOt,uie)=>{f();"use strict";var gYe=(_t(),Mt),{sha256:bYe}=(ri(),li),{UnixFS:mYe}=(pi(),as),vYe=qe(),{CID:wYe}=(Ie(),Ne);uie.exports=({repo:t,preload:e})=>{async function r(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new mYe({type:"directory"}).marshal();else throw new Error("unknown template");let s=gYe.encode({Data:n,Links:[]}),o=await bYe.digest(s),a=wYe.createV0(o);return await t.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return vYe(r)}});var Xp=y((bOt,fie)=>{f();"use strict";var _Ye=(_t(),Mt),{CID:EYe}=(Ie(),Ne),{sha256:SYe}=(ri(),li),xYe=qe();fie.exports=({repo:t,preload:e})=>{async function r(i,n={}){let s=await t.gcLock.readLock();try{let o=_Ye.encode(i),a=await SYe.digest(o),c=EYe.createV0(a);return await t.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await t.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return xYe(r)}});var hie=y((mOt,die)=>{f();"use strict";var AYe=(_t(),Mt),IYe=qe();die.exports=({repo:t,preload:e})=>{let r=wl()({repo:t,preload:e});async function i(n,s={}){let o=await r(n,s),c=AYe.encode(o).length,u=o.Links.reduce((l,d)=>l+(d.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+u}}return IYe(i)}});var yie=y((vOt,pie)=>{f();"use strict";var TYe=qe();pie.exports=({repo:t,preload:e})=>{let r=wl()({repo:t,preload:e}),i=Xp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a);return i({...c,Links:c.Links.concat([o])},a)}return TYe(n)}});var bie=y((wOt,gie)=>{f();"use strict";var RYe=qe(),{concat:PYe}=(un(),cn);gie.exports=({repo:t,preload:e})=>{let r=wl()({repo:t,preload:e}),i=Xp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a),u=PYe([c.Data||[],o]);return i({...c,Data:u},a)}return RYe(n)}});var vie=y((_Ot,mie)=>{f();"use strict";var CYe=qe();mie.exports=({repo:t,preload:e})=>{let r=wl()({repo:t,preload:e}),i=Xp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a),u=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(l=>l.Name!==u),i(c,a)}return CYe(n)}});var _ie=y((EOt,wie)=>{f();"use strict";var OYe=qe();wie.exports=({repo:t,preload:e})=>{let r=wl()({repo:t,preload:e}),i=Xp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a);return i({...c,Data:o},a)}return OYe(n)}});var xie=y((SOt,Sie)=>{f();"use strict";var kYe=yie(),qYe=bie(),DYe=vie(),NYe=_ie(),Eie=class{constructor({repo:e,preload:r}){this.addLink=kYe({repo:e,preload:r}),this.appendData=qYe({repo:e,preload:r}),this.rmLink=DYe({repo:e,preload:r}),this.setData=NYe({repo:e,preload:r})}};Sie.exports=Eie});var Tie=y((xOt,Iie)=>{f();"use strict";var BYe=sie(),MYe=wl(),LYe=cie(),UYe=lie(),FYe=Xp(),KYe=hie(),jYe=xie(),Aie=class{constructor({repo:e,codecs:r,preload:i}){this.data=BYe({repo:e,preload:i}),this.get=MYe({repo:e,preload:i}),this.links=LYe({repo:e,codecs:r}),this.new=UYe({repo:e,preload:i}),this.put=FYe({repo:e,preload:i}),this.stat=KYe({repo:e,preload:i}),this.patch=new jYe({repo:e,preload:i})}};Iie.exports=Aie});var Pie=y((AOt,Rie)=>{f();"use strict";var VYe=me()("ipfs:repo:gc"),zYe=qe(),HYe=M2();Rie.exports=({repo:t,hashers:e})=>{async function*r(i={}){let n=Date.now(),s;try{s=await HYe({repo:t,hashers:e},i),await t.pins.pinRecursively(s),yield*t.gc()}finally{s&&await t.pins.unpin(s)}VYe(`Complete (${Date.now()-n}ms)`)}return zYe(r)}});var Q5=y((IOt,Cie)=>{f();"use strict";var $Ye=qe();Cie.exports=({repo:t})=>{async function e(r={}){let i=await t.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return $Ye(e)}});var kie=y((TOt,Oie)=>{f();"use strict";var{repoVersion:GYe}=Bf(),WYe=qe();Oie.exports=({repo:t})=>{async function e(r={}){try{await t._checkInitialized(r)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return GYe;throw i}return t.version.get()}return WYe(e)}});var Nie=y((ROt,Die)=>{f();"use strict";var YYe=Pie(),XYe=Q5(),QYe=kie(),qie=class{constructor({repo:e,hashers:r}){this.gc=YYe({repo:e,hashers:r}),this.stat=XYe({repo:e}),this.version=QYe({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};Die.exports=qie});var Lie=y((POt,Mie)=>{f();"use strict";var{default:ZYe}=tb(),JYe=ue(),eXe=qe();function Bie(t,e){let r;if(t.metrics?e.peer?r=t.metrics.forPeer(e.peer):e.proto?r=t.metrics.forProtocol(e.proto):r=t.metrics.global:r=void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:i,snapshot:n}=r;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:i.dataReceived[6e4].movingAverage()/60,rateOut:i.dataSent[6e4].movingAverage()/60}}Mie.exports=({network:t})=>eXe(async function*(r={}){let{libp2p:i}=await t.use(r);if(!r.poll){yield Bie(i,r);return}let n=r.interval||1e3,s=-1;try{if(s=typeof n=="string"?ZYe(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw JYe(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield Bie(i,r),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})});var Kie=y((COt,Fie)=>{f();"use strict";var tXe=Lie(),rXe=Q5(),iXe=vT(),Uie=class{constructor({repo:e,network:r}){this.repo=rXe({repo:e}),this.bw=tXe({network:r}),this.bitswap=iXe({network:r})}};Fie.exports=Uie});var Z5=y((OOt,jie)=>{f();"use strict";jie.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),i=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[r]=n;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,r);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var l1=y((kOt,Vie)=>{f();"use strict";var nXe=Z5();Vie.exports=function(){return nXe()&&!!Symbol.toStringTag}});var $ie=y((qOt,Hie)=>{f();"use strict";var zie=typeof Symbol!="undefined"&&Symbol,sXe=Z5();Hie.exports=function(){return typeof zie!="function"||typeof Symbol!="function"||typeof zie("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:sXe()}});var Wie=y((DOt,Gie)=>{f();"use strict";var oXe="Function.prototype.bind called on incompatible ",J5=Array.prototype.slice,aXe=Object.prototype.toString,cXe="[object Function]";Gie.exports=function(e){var r=this;if(typeof r!="function"||aXe.call(r)!==cXe)throw new TypeError(oXe+r);for(var i=J5.call(arguments,1),n,s=function(){if(this instanceof n){var l=r.apply(this,i.concat(J5.call(arguments)));return Object(l)===l?l:this}else return r.apply(e,i.concat(J5.call(arguments)))},o=Math.max(0,r.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var u=function(){};u.prototype=r.prototype,n.prototype=new u,u.prototype=null}return n}});var W2=y((NOt,Yie)=>{f();"use strict";var uXe=Wie();Yie.exports=Function.prototype.bind||uXe});var Qie=y((BOt,Xie)=>{f();"use strict";var lXe=W2();Xie.exports=lXe.call(Function.call,Object.prototype.hasOwnProperty)});var Z2=y((MOt,tne)=>{f();"use strict";var Ot,f1=SyntaxError,Zie=Function,Qp=TypeError,eR=function(t){try{return Zie('"use strict"; return ('+t+").constructor;")()}catch(e){}},ad=Object.getOwnPropertyDescriptor;if(ad)try{ad({},"")}catch(t){ad=null}var tR=function(){throw new Qp},fXe=ad?function(){try{return arguments.callee,tR}catch(t){try{return ad(arguments,"callee").get}catch(e){return tR}}}():tR,Zp=$ie()(),_l=Object.getPrototypeOf||function(t){return t.__proto__},Jp={},dXe=typeof Uint8Array=="undefined"?Ot:_l(Uint8Array),e0={"%AggregateError%":typeof AggregateError=="undefined"?Ot:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Ot:ArrayBuffer,"%ArrayIteratorPrototype%":Zp?_l([][Symbol.iterator]()):Ot,"%AsyncFromSyncIteratorPrototype%":Ot,"%AsyncFunction%":Jp,"%AsyncGenerator%":Jp,"%AsyncGeneratorFunction%":Jp,"%AsyncIteratorPrototype%":Jp,"%Atomics%":typeof Atomics=="undefined"?Ot:Atomics,"%BigInt%":typeof BigInt=="undefined"?Ot:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Ot:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Ot:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Ot:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Ot:FinalizationRegistry,"%Function%":Zie,"%GeneratorFunction%":Jp,"%Int8Array%":typeof Int8Array=="undefined"?Ot:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Ot:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Ot:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Zp?_l(_l([][Symbol.iterator]())):Ot,"%JSON%":typeof JSON=="object"?JSON:Ot,"%Map%":typeof Map=="undefined"?Ot:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!Zp?Ot:_l(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Ot:Promise,"%Proxy%":typeof Proxy=="undefined"?Ot:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Ot:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Ot:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!Zp?Ot:_l(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Ot:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Zp?_l(""[Symbol.iterator]()):Ot,"%Symbol%":Zp?Symbol:Ot,"%SyntaxError%":f1,"%ThrowTypeError%":fXe,"%TypedArray%":dXe,"%TypeError%":Qp,"%Uint8Array%":typeof Uint8Array=="undefined"?Ot:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Ot:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Ot:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Ot:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Ot:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Ot:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Ot:WeakSet},hXe=function t(e){var r;if(e==="%AsyncFunction%")r=eR("async function () {}");else if(e==="%GeneratorFunction%")r=eR("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=eR("async function* () {}");else if(e==="%AsyncGenerator%"){var i=t("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=t("%AsyncGenerator%");n&&(r=_l(n.prototype))}return e0[e]=r,r},Jie={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Y2=W2(),X2=Qie(),pXe=Y2.call(Function.call,Array.prototype.concat),yXe=Y2.call(Function.apply,Array.prototype.splice),ene=Y2.call(Function.call,String.prototype.replace),Q2=Y2.call(Function.call,String.prototype.slice),gXe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,bXe=/\\(\\)?/g,mXe=function(e){var r=Q2(e,0,1),i=Q2(e,-1);if(r==="%"&&i!=="%")throw new f1("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&r!=="%")throw new f1("invalid intrinsic syntax, expected opening `%`");var n=[];return ene(e,gXe,function(s,o,a,c){n[n.length]=a?ene(c,bXe,"$1"):o||s}),n},vXe=function(e,r){var i=e,n;if(X2(Jie,i)&&(n=Jie[i],i="%"+n[0]+"%"),X2(e0,i)){var s=e0[i];if(s===Jp&&(s=hXe(i)),typeof s=="undefined"&&!r)throw new Qp("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new f1("intrinsic "+e+" does not exist!")};tne.exports=function(e,r){if(typeof e!="string"||e.length===0)throw new Qp("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Qp('"allowMissing" argument must be a boolean');var i=mXe(e),n=i.length>0?i[0]:"",s=vXe("%"+n+"%",r),o=s.name,a=s.value,c=!1,u=s.alias;u&&(n=u[0],yXe(i,pXe([0,1],u)));for(var l=1,d=!0;l<i.length;l+=1){var h=i[l],p=Q2(h,0,1),g=Q2(h,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new f1("property names with quotes must have matching quotes");if((h==="constructor"||!d)&&(c=!0),n+="."+h,o="%"+n+"%",X2(e0,o))a=e0[o];else if(a!=null){if(!(h in a)){if(!r)throw new Qp("base intrinsic for "+e+" exists, but the property is not available.");return}if(ad&&l+1>=i.length){var m=ad(a,h);d=!!m,d&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[h]}else d=X2(a,h),a=a[h];d&&!c&&(e0[o]=a)}}return a}});var ane=y((LOt,J2)=>{f();"use strict";var rR=W2(),t0=Z2(),rne=t0("%Function.prototype.apply%"),ine=t0("%Function.prototype.call%"),nne=t0("%Reflect.apply%",!0)||rR.call(ine,rne),sne=t0("%Object.getOwnPropertyDescriptor%",!0),cd=t0("%Object.defineProperty%",!0),wXe=t0("%Math.max%");if(cd)try{cd({},"a",{value:1})}catch(t){cd=null}J2.exports=function(e){var r=nne(rR,ine,arguments);if(sne&&cd){var i=sne(r,"length");i.configurable&&cd(r,"length",{value:1+wXe(0,e.length-(arguments.length-1))})}return r};var one=function(){return nne(rR,rne,arguments)};cd?cd(J2.exports,"apply",{value:one}):J2.exports.apply=one});var eE=y((UOt,lne)=>{f();"use strict";var cne=Z2(),une=ane(),_Xe=une(cne("String.prototype.indexOf"));lne.exports=function(e,r){var i=cne(e,!!r);return typeof i=="function"&&_Xe(e,".prototype.")>-1?une(i):i}});var hne=y((FOt,dne)=>{f();"use strict";var EXe=l1()(),SXe=eE(),iR=SXe("Object.prototype.toString"),tE=function(e){return EXe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:iR(e)==="[object Arguments]"},fne=function(e){return tE(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&iR(e)!=="[object Array]"&&iR(e.callee)==="[object Function]"},xXe=function(){return tE(arguments)}();tE.isLegacyArguments=fne;dne.exports=xXe?tE:fne});var gne=y((KOt,yne)=>{f();"use strict";var AXe=Object.prototype.toString,IXe=Function.prototype.toString,TXe=/^\s*(?:function)?\*/,pne=l1()(),nR=Object.getPrototypeOf,RXe=function(){if(!pne)return!1;try{return Function("return function*() {}")()}catch(t){}},sR;yne.exports=function(e){if(typeof e!="function")return!1;if(TXe.test(IXe.call(e)))return!0;if(!pne){var r=AXe.call(e);return r==="[object GeneratorFunction]"}if(!nR)return!1;if(typeof sR=="undefined"){var i=RXe();sR=i?nR(i):!1}return nR(e)===sR}});var oR=y((jOt,bne)=>{f();var PXe=Object.prototype.hasOwnProperty,CXe=Object.prototype.toString;bne.exports=function(e,r,i){if(CXe.call(r)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)r.call(i,e[s],s,e);else for(var o in e)PXe.call(e,o)&&r.call(i,e[o],o,e)}});var cR=y((VOt,mne)=>{f();"use strict";var aR=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];mne.exports=function(){for(var e=[],r=0;r<aR.length;r++)typeof globalThis[aR[r]]=="function"&&(e[e.length]=aR[r]);return e}});var uR=y((zOt,vne)=>{f();"use strict";var OXe=Z2(),rE=OXe("%Object.getOwnPropertyDescriptor%");if(rE)try{rE([],"length")}catch(t){rE=null}vne.exports=rE});var dR=y((HOt,xne)=>{f();"use strict";var wne=oR(),kXe=cR(),lR=eE(),qXe=lR("Object.prototype.toString"),_ne=l1()(),Ene=kXe(),DXe=lR("Array.prototype.indexOf",!0)||function(e,r){for(var i=0;i<e.length;i+=1)if(e[i]===r)return i;return-1},NXe=lR("String.prototype.slice"),Sne={},iE=uR(),fR=Object.getPrototypeOf;_ne&&iE&&fR&&wne(Ene,function(t){var e=new globalThis[t];if(Symbol.toStringTag in e){var r=fR(e),i=iE(r,Symbol.toStringTag);if(!i){var n=fR(r);i=iE(n,Symbol.toStringTag)}Sne[t]=i.get}});var BXe=function(e){var r=!1;return wne(Sne,function(i,n){if(!r)try{r=i.call(e)===n}catch(s){}}),r};xne.exports=function(e){if(!e||typeof e!="object")return!1;if(!_ne||!(Symbol.toStringTag in e)){var r=NXe(qXe(e),8,-1);return DXe(Ene,r)>-1}return iE?BXe(e):!1}});var Cne=y(($Ot,Pne)=>{f();"use strict";var Ane=oR(),MXe=cR(),Ine=eE(),LXe=Ine("Object.prototype.toString"),Tne=l1()(),UXe=MXe(),FXe=Ine("String.prototype.slice"),Rne={},hR=uR(),pR=Object.getPrototypeOf;Tne&&hR&&pR&&Ane(UXe,function(t){if(typeof globalThis[t]=="function"){var e=new globalThis[t];if(Symbol.toStringTag in e){var r=pR(e),i=hR(r,Symbol.toStringTag);if(!i){var n=pR(r);i=hR(n,Symbol.toStringTag)}Rne[t]=i.get}}});var KXe=function(e){var r=!1;return Ane(Rne,function(i,n){if(!r)try{var s=i.call(e);s===n&&(r=s)}catch(o){}}),r},jXe=dR();Pne.exports=function(e){return jXe(e)?!Tne||!(Symbol.toStringTag in e)?FXe(LXe(e),8,-1):KXe(e):!1}});var zne=y(Et=>{f();"use strict";var VXe=hne(),zXe=gne(),Ho=Cne(),One=dR();function r0(t){return t.call.bind(t)}var kne=typeof BigInt!="undefined",qne=typeof Symbol!="undefined",Ys=r0(Object.prototype.toString),HXe=r0(Number.prototype.valueOf),$Xe=r0(String.prototype.valueOf),GXe=r0(Boolean.prototype.valueOf);kne&&(Dne=r0(BigInt.prototype.valueOf));var Dne;qne&&(Nne=r0(Symbol.prototype.valueOf));var Nne;function d1(t,e){if(typeof t!="object")return!1;try{return e(t),!0}catch(r){return!1}}Et.isArgumentsObject=VXe;Et.isGeneratorFunction=zXe;Et.isTypedArray=One;function WXe(t){return typeof Promise!="undefined"&&t instanceof Promise||t!==null&&typeof t=="object"&&typeof t.then=="function"&&typeof t.catch=="function"}Et.isPromise=WXe;function YXe(t){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(t):One(t)||Mne(t)}Et.isArrayBufferView=YXe;function XXe(t){return Ho(t)==="Uint8Array"}Et.isUint8Array=XXe;function QXe(t){return Ho(t)==="Uint8ClampedArray"}Et.isUint8ClampedArray=QXe;function ZXe(t){return Ho(t)==="Uint16Array"}Et.isUint16Array=ZXe;function JXe(t){return Ho(t)==="Uint32Array"}Et.isUint32Array=JXe;function eQe(t){return Ho(t)==="Int8Array"}Et.isInt8Array=eQe;function tQe(t){return Ho(t)==="Int16Array"}Et.isInt16Array=tQe;function rQe(t){return Ho(t)==="Int32Array"}Et.isInt32Array=rQe;function iQe(t){return Ho(t)==="Float32Array"}Et.isFloat32Array=iQe;function nQe(t){return Ho(t)==="Float64Array"}Et.isFloat64Array=nQe;function sQe(t){return Ho(t)==="BigInt64Array"}Et.isBigInt64Array=sQe;function oQe(t){return Ho(t)==="BigUint64Array"}Et.isBigUint64Array=oQe;function nE(t){return Ys(t)==="[object Map]"}nE.working=typeof Map!="undefined"&&nE(new Map);function aQe(t){return typeof Map=="undefined"?!1:nE.working?nE(t):t instanceof Map}Et.isMap=aQe;function sE(t){return Ys(t)==="[object Set]"}sE.working=typeof Set!="undefined"&&sE(new Set);function cQe(t){return typeof Set=="undefined"?!1:sE.working?sE(t):t instanceof Set}Et.isSet=cQe;function oE(t){return Ys(t)==="[object WeakMap]"}oE.working=typeof WeakMap!="undefined"&&oE(new WeakMap);function uQe(t){return typeof WeakMap=="undefined"?!1:oE.working?oE(t):t instanceof WeakMap}Et.isWeakMap=uQe;function yR(t){return Ys(t)==="[object WeakSet]"}yR.working=typeof WeakSet!="undefined"&&yR(new WeakSet);function lQe(t){return yR(t)}Et.isWeakSet=lQe;function aE(t){return Ys(t)==="[object ArrayBuffer]"}aE.working=typeof ArrayBuffer!="undefined"&&aE(new ArrayBuffer);function Bne(t){return typeof ArrayBuffer=="undefined"?!1:aE.working?aE(t):t instanceof ArrayBuffer}Et.isArrayBuffer=Bne;function cE(t){return Ys(t)==="[object DataView]"}cE.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&cE(new DataView(new ArrayBuffer(1),0,1));function Mne(t){return typeof DataView=="undefined"?!1:cE.working?cE(t):t instanceof DataView}Et.isDataView=Mne;var gR=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function h1(t){return Ys(t)==="[object SharedArrayBuffer]"}function Lne(t){return typeof gR=="undefined"?!1:(typeof h1.working=="undefined"&&(h1.working=h1(new gR)),h1.working?h1(t):t instanceof gR)}Et.isSharedArrayBuffer=Lne;function fQe(t){return Ys(t)==="[object AsyncFunction]"}Et.isAsyncFunction=fQe;function dQe(t){return Ys(t)==="[object Map Iterator]"}Et.isMapIterator=dQe;function hQe(t){return Ys(t)==="[object Set Iterator]"}Et.isSetIterator=hQe;function pQe(t){return Ys(t)==="[object Generator]"}Et.isGeneratorObject=pQe;function yQe(t){return Ys(t)==="[object WebAssembly.Module]"}Et.isWebAssemblyCompiledModule=yQe;function Une(t){return d1(t,HXe)}Et.isNumberObject=Une;function Fne(t){return d1(t,$Xe)}Et.isStringObject=Fne;function Kne(t){return d1(t,GXe)}Et.isBooleanObject=Kne;function jne(t){return kne&&d1(t,Dne)}Et.isBigIntObject=jne;function Vne(t){return qne&&d1(t,Nne)}Et.isSymbolObject=Vne;function gQe(t){return Une(t)||Fne(t)||Kne(t)||jne(t)||Vne(t)}Et.isBoxedPrimitive=gQe;function bQe(t){return typeof Uint8Array!="undefined"&&(Bne(t)||Lne(t))}Et.isAnyArrayBuffer=bQe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(t){Object.defineProperty(Et,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})})});var $ne=y((WOt,Hne)=>{f();Hne.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var Zne=y(St=>{f();var Gne=Object.getOwnPropertyDescriptors||function(e){for(var r=Object.keys(e),i={},n=0;n<r.length;n++)i[r[n]]=Object.getOwnPropertyDescriptor(e,r[n]);return i},mQe=/%[sdj%]/g;St.format=function(t){if(!hE(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(El(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,n=i.length,s=String(t).replace(mQe,function(a){if(a==="%%")return"%";if(r>=n)return a;switch(a){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(c){return"[Circular]"}default:return a}}),o=i[r];r<n;o=i[++r])dE(o)||!i0(o)?s+=" "+o:s+=" "+El(o);return s};St.deprecate=function(t,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return t;if(typeof process=="undefined")return function(){return St.deprecate(t,e).apply(this,arguments)};var r=!1;function i(){if(!r){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return i};var uE={},Wne=/^$/;process.env.NODE_DEBUG&&(lE=process.env.NODE_DEBUG,lE=lE.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),Wne=new RegExp("^"+lE+"$","i"));var lE;St.debuglog=function(t){if(t=t.toUpperCase(),!uE[t])if(Wne.test(t)){var e=process.pid;uE[t]=function(){var r=St.format.apply(St,arguments);console.error("%s %d: %s",t,e,r)}}else uE[t]=function(){};return uE[t]};function El(t,e){var r={seen:[],stylize:wQe};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),vR(e)?r.showHidden=e:e&&St._extend(r,e),ud(r.showHidden)&&(r.showHidden=!1),ud(r.depth)&&(r.depth=2),ud(r.colors)&&(r.colors=!1),ud(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=vQe),fE(r,t,r.depth)}St.inspect=El;El.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};El.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function vQe(t,e){var r=El.styles[e];return r?"["+El.colors[r][0]+"m"+t+"["+El.colors[r][1]+"m":t}function wQe(t,e){return t}function _Qe(t){var e={};return t.forEach(function(r,i){e[r]=!0}),e}function fE(t,e,r){if(t.customInspect&&e&&yE(e.inspect)&&e.inspect!==St.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(r,t);return hE(i)||(i=fE(t,i,r)),i}var n=EQe(t,e);if(n)return n;var s=Object.keys(e),o=_Qe(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),y1(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return bR(e);if(s.length===0){if(yE(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(p1(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(pE(e))return t.stylize(Date.prototype.toString.call(e),"date");if(y1(e))return bR(e)}var c="",u=!1,l=["{","}"];if(Yne(e)&&(u=!0,l=["[","]"]),yE(e)){var d=e.name?": "+e.name:"";c=" [Function"+d+"]"}if(p1(e)&&(c=" "+RegExp.prototype.toString.call(e)),pE(e)&&(c=" "+Date.prototype.toUTCString.call(e)),y1(e)&&(c=" "+bR(e)),s.length===0&&(!u||e.length==0))return l[0]+c+l[1];if(r<0)return p1(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var h;return u?h=SQe(t,e,r,o,s):h=s.map(function(p){return mR(t,e,r,o,p,u)}),t.seen.pop(),xQe(h,c,l)}function EQe(t,e){if(ud(e))return t.stylize("undefined","undefined");if(hE(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(Xne(e))return t.stylize(""+e,"number");if(vR(e))return t.stylize(""+e,"boolean");if(dE(e))return t.stylize("null","null")}function bR(t){return"["+Error.prototype.toString.call(t)+"]"}function SQe(t,e,r,i,n){for(var s=[],o=0,a=e.length;o<a;++o)Qne(e,String(o))?s.push(mR(t,e,r,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(mR(t,e,r,i,c,!0))}),s}function mR(t,e,r,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=t.stylize("[Getter/Setter]","special"):a=t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),Qne(i,n)||(o="["+n+"]"),a||(t.seen.indexOf(c.value)<0?(dE(r)?a=fE(t,c.value,null):a=fE(t,c.value,r-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=t.stylize("[Circular]","special")),ud(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function xQe(t,e,r){var i=0,n=t.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}St.types=zne();function Yne(t){return Array.isArray(t)}St.isArray=Yne;function vR(t){return typeof t=="boolean"}St.isBoolean=vR;function dE(t){return t===null}St.isNull=dE;function AQe(t){return t==null}St.isNullOrUndefined=AQe;function Xne(t){return typeof t=="number"}St.isNumber=Xne;function hE(t){return typeof t=="string"}St.isString=hE;function IQe(t){return typeof t=="symbol"}St.isSymbol=IQe;function ud(t){return t===void 0}St.isUndefined=ud;function p1(t){return i0(t)&&wR(t)==="[object RegExp]"}St.isRegExp=p1;St.types.isRegExp=p1;function i0(t){return typeof t=="object"&&t!==null}St.isObject=i0;function pE(t){return i0(t)&&wR(t)==="[object Date]"}St.isDate=pE;St.types.isDate=pE;function y1(t){return i0(t)&&(wR(t)==="[object Error]"||t instanceof Error)}St.isError=y1;St.types.isNativeError=y1;function yE(t){return typeof t=="function"}St.isFunction=yE;function TQe(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t=="undefined"}St.isPrimitive=TQe;St.isBuffer=$ne();function wR(t){return Object.prototype.toString.call(t)}function _R(t){return t<10?"0"+t.toString(10):t.toString(10)}var RQe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function PQe(){var t=new Date,e=[_R(t.getHours()),_R(t.getMinutes()),_R(t.getSeconds())].join(":");return[t.getDate(),RQe[t.getMonth()],e].join(" ")}St.log=function(){console.log("%s - %s",PQe(),St.format.apply(St,arguments))};St.inherits=Yi();St._extend=function(t,e){if(!e||!i0(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t};function Qne(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var ld=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;St.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(ld&&e[ld]){var r=e[ld];if(typeof r!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,ld,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var i,n,s=new Promise(function(c,u){i=c,n=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?n(c):i(u)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),ld&&Object.defineProperty(r,ld,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,Gne(e))};St.promisify.custom=ld;function CQe(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}function OQe(t){if(typeof t!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var r=[],i=0;i<arguments.length;i++)r.push(arguments[i]);var n=r.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};t.apply(this,r).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(CQe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,Gne(t)),e}St.callbackify=OQe});var ER=y((XOt,Jne)=>{f();"use strict";Jne.exports=function(...e){let r=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(r,{bufferKeys:r.bufferKeys||!1,snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,openCallback:r.openCallback||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:r.encodings||!1,additionalMethods:Object.assign({},r.additionalMethods)})}});var SR=y((QOt,ese)=>{f();ese.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var gE=y((ZOt,rse)=>{f();var tse;rse.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):t=>(tse||(tse=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var bE=y((JOt,nse)=>{f();"use strict";var ise=gE();nse.exports=function(t,...e){e.length===0?ise(t):ise(()=>t(...e))}});var xR=y((ekt,sse)=>{f();"use strict";function Sl(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}Sl.prototype.next=function(t){if(typeof t!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(t,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(t,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((e,...r)=>{this._nexting=!1,t(e,...r)}),this)};Sl.prototype._next=function(t){this._nextTick(t)};Sl.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)};Sl.prototype._seek=function(t){};Sl.prototype.end=function(t){if(typeof t!="function")throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)};Sl.prototype._end=function(t){this._nextTick(t)};Sl.prototype._nextTick=bE();sse.exports=Sl});var AR=y((tkt,ase)=>{f();"use strict";var ose=Object.freeze({});function $o(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}$o.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};$o.prototype.put=function(t,e,r){this._checkWritten();let i=this.db._checkKey(t)||this.db._checkValue(e);if(i)throw i;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e,r??ose),this};$o.prototype._put=function(t,e,r){this._operations.push({...r,type:"put",key:t,value:e})};$o.prototype.del=function(t,e){this._checkWritten();let r=this.db._checkKey(t);if(r)throw r;return t=this.db._serializeKey(t),this._del(t,e??ose),this};$o.prototype._del=function(t,e){this._operations.push({...e,type:"del",key:t})};$o.prototype.clear=function(){return this._checkWritten(),this._clear(),this};$o.prototype._clear=function(){this._operations=[]};$o.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)};$o.prototype._write=function(t,e){this.db._batch(this._operations,t,e)};$o.prototype._nextTick=bE();ase.exports=$o});var lse=y((rkt,use)=>{f();"use strict";var kQe=ER(),qQe=SR(),DQe=xR(),NQe=AR(),BQe=Object.prototype.hasOwnProperty,MQe=["lt","lte","gt","gte"];function wr(t){this.status="new",this.supports=kQe(t,{status:!0})}wr.prototype.open=function(t,e){let r=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,i=>{if(i)return this.status=r,e(i);this.status="open",e()})};wr.prototype._open=function(t,e){this._nextTick(e)};wr.prototype.close=function(t){let e=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(r=>{if(r)return this.status=e,t(r);this.status="closed",t()})};wr.prototype._close=function(t){this._nextTick(t)};wr.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(t);if(i)return this._nextTick(r,i);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)};wr.prototype._get=function(t,e,r){this._nextTick(function(){r(new Error("NotFound"))})};wr.prototype.put=function(t,e,r,i){if(typeof r=="function"&&(i=r),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(t)||this._checkValue(e);if(n)return this._nextTick(i,n);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,i)};wr.prototype._put=function(t,e,r,i){this._nextTick(i)};wr.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(t);if(i)return this._nextTick(r,i);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)};wr.prototype._del=function(t,e,r){this._nextTick(r)};wr.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return this._nextTick(r,new Error("batch(array) requires an array argument"));if(t.length===0)return this._nextTick(r);(typeof e!="object"||e===null)&&(e={});let i=new Array(t.length);for(let n=0;n<t.length;n++){if(typeof t[n]!="object"||t[n]===null)return this._nextTick(r,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},t[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(r,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(r,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(r,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,r)};wr.prototype._batch=function(t,e,r){this._nextTick(r)};wr.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=cse(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)};wr.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;let r=this._iterator(t),i={},n=s=>{if(s)return r.end(function(){e(s)});r.next((o,a)=>{if(o)return n(o);if(a===void 0)return r.end(e);this._del(a,i,n)})};n()};wr.prototype._setupIteratorOptions=function(t){return t=cse(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function cse(t,e){let r={};for(let i in e){if(!BQe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];LQe(i)&&(n=t._serializeKey(n)),r[i]=n}return r}function LQe(t){return MQe.indexOf(t)!==-1}wr.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)};wr.prototype._iterator=function(t){return new DQe(this)};wr.prototype._chainedBatch=function(){return new NQe(this)};wr.prototype._serializeKey=function(t){return t};wr.prototype._serializeValue=function(t){return t};wr.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(qQe(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")};wr.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")};wr.prototype._nextTick=bE();use.exports=wr});var xl=y(mE=>{f();"use strict";mE.AbstractLevelDOWN=lse();mE.AbstractIterator=xR();mE.AbstractChainedBatch=AR()});var hse=y((nkt,dse)=>{f();"use strict";var fse=xl().AbstractIterator,UQe=Yi();function n0(t,e){fse.call(this,t),this._options=e,this._iterator=null,this._operations=[]}UQe(n0,fse);n0.prototype.setDb=function(t){let e=this._iterator=t.iterator(this._options);for(let r of this._operations)e[r.method](...r.args)};n0.prototype._operation=function(t,e){if(this._iterator)return this._iterator[t](...e);this._operations.push({method:t,args:e})};for(let t of["next","end"])n0.prototype["_"+t]=function(...e){this._operation(t,e)};n0.prototype.seek=function(...t){this._operation("seek",t)};dse.exports=n0});var mse=y((skt,IR)=>{f();"use strict";var pse=xl().AbstractLevelDOWN,FQe=Yi(),yse=hse(),gse="put get del batch clear".split(" "),KQe="approximateSize compactRange".split(" ");function fd(t){pse.call(this,t.supports||{});for(let e of KQe)typeof t[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this._db=t,this._operations=[],bse(this)}FQe(fd,pse);fd.prototype.type="deferred-leveldown";fd.prototype._open=function(t,e){this._db.open(t,r=>{if(r)return e(r);for(let i of this._operations)i.iterator?i.iterator.setDb(this._db):this._db[i.method](...i.args);this._operations=[],jQe(this),e()})};fd.prototype._close=function(t){this._db.close(e=>{if(e)return t(e);bse(this),t()})};function jQe(t){for(let e of gse.concat("iterator"))t["_"+e]=function(...r){return this._db[e](...r)};for(let e of Object.keys(t.supports.additionalMethods))t[e]=function(...r){return this._db[e](...r)}}function bse(t){for(let e of gse)t["_"+e]=function(...r){this._operations.push({method:e,args:r})};for(let e of Object.keys(t.supports.additionalMethods))t[e]=function(...r){this._operations.push({method:e,args:r})};t._iterator=function(e){let r=new yse(t,e);return this._operations.push({iterator:r}),r}}fd.prototype._serializeKey=function(t){return t};fd.prototype._serializeValue=function(t){return t};IR.exports=fd;IR.exports.DeferredIterator=yse});var TR=y((okt,vse)=>{f();vse.exports=yr().EventEmitter});var RR=y(()=>{f()});var Sse=y((ukt,Ese)=>{f();"use strict";function wse(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function VQe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wse(Object(r),!0).forEach(function(i){zQe(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wse(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function zQe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _se(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $Qe(t,e,r){return e&&_se(t.prototype,e),r&&_se(t,r),t}var GQe=Vt(),vE=GQe.Buffer,WQe=RR(),PR=WQe.inspect,YQe=PR&&PR.custom||"inspect";function XQe(t,e,r){vE.prototype.copy.call(t,e,r)}Ese.exports=function(){function t(){HQe(this,t),this.head=null,this.tail=null,this.length=0}return $Qe(t,[{key:"push",value:function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n}},{key:"concat",value:function(r){if(this.length===0)return vE.alloc(0);for(var i=vE.allocUnsafe(r>>>0),n=this.head,s=0;n;)XQe(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(r,i){var n;return r<this.head.data.length?(n=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?n=this.shift():n=i?this._getString(r):this._getBuffer(r),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var i=this.head,n=1,s=i.data;for(r-=s.length;i=i.next;){var o=i.data,a=r>o.length?o.length:r;if(a===o.length?s+=o:s+=o.slice(0,r),r-=a,r===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(r){var i=vE.allocUnsafe(r),n=this.head,s=1;for(n.data.copy(i),r-=n.data.length;n=n.next;){var o=n.data,a=r>o.length?o.length:r;if(o.copy(i,i.length-r,0,a),r-=a,r===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:YQe,value:function(r,i){return PR(this,VQe({},i,{depth:0,customInspect:!1}))}}]),t}()});var OR=y((lkt,Ase)=>{f();"use strict";function QQe(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(CR,this,t)):process.nextTick(CR,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(wE,r):(r._writableState.errorEmitted=!0,process.nextTick(xse,r,s)):process.nextTick(xse,r,s):e?(process.nextTick(wE,r),e(s)):process.nextTick(wE,r)}),this)}function xse(t,e){CR(t,e),wE(t)}function wE(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function ZQe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function CR(t,e){t.emit("error",e)}function JQe(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}Ase.exports={destroy:QQe,undestroy:ZQe,errorOrDestroy:JQe}});var dd=y((fkt,Rse)=>{f();"use strict";function eZe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Ise={};function Xs(t,e,r){r||(r=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){eZe(o,s);function o(a,c,u){return s.call(this,i(a,c,u))||this}return o}(r);n.prototype.name=r.name,n.prototype.code=t,Ise[t]=n}function Tse(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(i){return String(i)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function tZe(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function rZe(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function iZe(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}Xs("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Xs("ERR_INVALID_ARG_TYPE",function(t,e,r){var i;typeof e=="string"&&tZe(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(rZe(t," argument"))n="The ".concat(t," ").concat(i," ").concat(Tse(e,"type"));else{var s=iZe(t,".")?"property":"argument";n='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat(Tse(e,"type"))}return n+=". Received type ".concat(typeof r),n},TypeError);Xs("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Xs("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Xs("ERR_STREAM_PREMATURE_CLOSE","Premature close");Xs("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Xs("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Xs("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Xs("ERR_STREAM_WRITE_AFTER_END","write after end");Xs("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Xs("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Xs("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Rse.exports.codes=Ise});var kR=y((dkt,Pse)=>{f();"use strict";var nZe=dd().codes.ERR_INVALID_OPT_VALUE;function sZe(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function oZe(t,e,r,i){var n=sZe(e,i,r);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?r:"highWaterMark";throw new nZe(s,n)}return Math.floor(n)}return t.objectMode?16:16*1024}Pse.exports={getHighWaterMark:oZe}});var Ose=y((hkt,Cse)=>{f();Cse.exports=aZe;function aZe(t,e){if(qR("noDeprecation"))return t;var r=!1;function i(){if(!r){if(qR("throwDeprecation"))throw new Error(e);qR("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return i}function qR(t){try{if(!globalThis.localStorage)return!1}catch(r){return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var BR=y((pkt,Mse)=>{f();"use strict";Mse.exports=Vr;function kse(t){var e=this;this.next=null,this.entry=null,this.finish=function(){DZe(e,t)}}var s0;Vr.WritableState=g1;var cZe={deprecate:Ose()},qse=TR(),_E=Vt().Buffer,uZe=globalThis.Uint8Array||function(){};function lZe(t){return _E.from(t)}function fZe(t){return _E.isBuffer(t)||t instanceof uZe}var DR=OR(),dZe=kR(),hZe=dZe.getHighWaterMark,Al=dd().codes,pZe=Al.ERR_INVALID_ARG_TYPE,yZe=Al.ERR_METHOD_NOT_IMPLEMENTED,gZe=Al.ERR_MULTIPLE_CALLBACK,bZe=Al.ERR_STREAM_CANNOT_PIPE,mZe=Al.ERR_STREAM_DESTROYED,vZe=Al.ERR_STREAM_NULL_VALUES,wZe=Al.ERR_STREAM_WRITE_AFTER_END,_Ze=Al.ERR_UNKNOWN_ENCODING,o0=DR.errorOrDestroy;Yi()(Vr,qse);function EZe(){}function g1(t,e,r){s0=s0||hd(),t=t||{},typeof r!="boolean"&&(r=e instanceof s0),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=hZe(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=t.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){PZe(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new kse(this)}g1.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(g1.prototype,"buffer",{get:cZe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}})();var EE;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(EE=Function.prototype[Symbol.hasInstance],Object.defineProperty(Vr,Symbol.hasInstance,{value:function(e){return EE.call(this,e)?!0:this!==Vr?!1:e&&e._writableState instanceof g1}})):EE=function(e){return e instanceof this};function Vr(t){s0=s0||hd();var e=this instanceof s0;if(!e&&!EE.call(Vr,this))return new Vr(t);this._writableState=new g1(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),qse.call(this)}Vr.prototype.pipe=function(){o0(this,new bZe)};function SZe(t,e){var r=new wZe;o0(t,r),process.nextTick(e,r)}function xZe(t,e,r,i){var n;return r===null?n=new vZe:typeof r!="string"&&!e.objectMode&&(n=new pZe("chunk",["string","Buffer"],r)),n?(o0(t,n),process.nextTick(i,n),!1):!0}Vr.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&fZe(t);return s&&!_E.isBuffer(t)&&(t=lZe(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=EZe),i.ending?SZe(this,r):(s||xZe(this,i,t,r))&&(i.pendingcb++,n=IZe(this,i,s,t,e,r)),n};Vr.prototype.cork=function(){this._writableState.corked++};Vr.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Nse(this,t))};Vr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _Ze(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Vr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function AZe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=_E.from(e,r)),e}Object.defineProperty(Vr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function IZe(t,e,r,i,n,s){if(!r){var o=AZe(e,i,n);i!==o&&(r=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else NR(t,e,!1,a,i,n,s);return c}function NR(t,e,r,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new mZe("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function TZe(t,e,r,i,n){--e.pendingcb,r?(process.nextTick(n,i),process.nextTick(b1,t,e),t._writableState.errorEmitted=!0,o0(t,i)):(n(i),t._writableState.errorEmitted=!0,o0(t,i),b1(t,e))}function RZe(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function PZe(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(typeof n!="function")throw new gZe;if(RZe(r),e)TZe(t,r,i,e,n);else{var s=Bse(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Nse(t,r),i?process.nextTick(Dse,t,r,s,n):Dse(t,r,s,n)}}function Dse(t,e,r,i){r||CZe(t,e),e.pendingcb--,i(),b1(t,e)}function CZe(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Nse(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var o=0,a=!0;r;)n[o]=r,r.isBuf||(a=!1),r=r.next,o+=1;n.allBuffers=a,NR(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new kse(e),e.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,l=r.callback,d=e.objectMode?1:c.length;if(NR(t,e,!1,d,c,u,l),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Vr.prototype._write=function(t,e,r){r(new yZe("_write()"))};Vr.prototype._writev=null;Vr.prototype.end=function(t,e,r){var i=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||qZe(this,i,r),this};Object.defineProperty(Vr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Bse(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function OZe(t,e){t._final(function(r){e.pendingcb--,r&&o0(t,r),e.prefinished=!0,t.emit("prefinish"),b1(t,e)})}function kZe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(OZe,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function b1(t,e){var r=Bse(e);if(r&&(kZe(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}function qZe(t,e,r){e.ending=!0,b1(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function DZe(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(Vr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Vr.prototype.destroy=DR.destroy;Vr.prototype._undestroy=DR.undestroy;Vr.prototype._destroy=function(t,e){e(t)}});var hd=y((ykt,Use)=>{f();"use strict";var NZe=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};Use.exports=Qa;var Lse=UR(),MR=BR();Yi()(Qa,Lse);for(LR=NZe(MR.prototype),SE=0;SE<LR.length;SE++)xE=LR[SE],Qa.prototype[xE]||(Qa.prototype[xE]=MR.prototype[xE]);var LR,xE,SE;function Qa(t){if(!(this instanceof Qa))return new Qa(t);Lse.call(this,t),MR.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",BZe)))}Object.defineProperty(Qa.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Qa.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Qa.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function BZe(){this._writableState.ended||process.nextTick(MZe,this)}function MZe(t){t.end()}Object.defineProperty(Qa.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var KR=y((FR,Kse)=>{f();var AE=Vt(),Za=AE.Buffer;function Fse(t,e){for(var r in t)e[r]=t[r]}Za.from&&Za.alloc&&Za.allocUnsafe&&Za.allocUnsafeSlow?Kse.exports=AE:(Fse(AE,FR),FR.Buffer=pd);function pd(t,e,r){return Za(t,e,r)}pd.prototype=Object.create(Za.prototype);Fse(Za,pd);pd.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Za(t,e,r)};pd.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=Za(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};pd.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Za(t)};pd.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return AE.SlowBuffer(t)}});var zR=y(Vse=>{f();"use strict";var jR=KR().Buffer,jse=jR.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function LZe(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function UZe(t){var e=LZe(t);if(typeof e!="string"&&(jR.isEncoding===jse||!jse(t)))throw new Error("Unknown encoding: "+t);return e||t}Vse.StringDecoder=m1;function m1(t){this.encoding=UZe(t);var e;switch(this.encoding){case"utf16le":this.text=HZe,this.end=$Ze,e=4;break;case"utf8":this.fillLast=jZe,e=4;break;case"base64":this.text=GZe,this.end=WZe,e=3;break;default:this.write=YZe,this.end=XZe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=jR.allocUnsafe(e)}m1.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};m1.prototype.end=zZe;m1.prototype.text=VZe;m1.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function VR(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function FZe(t,e,r){var i=e.length-1;if(i<r)return 0;var n=VR(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=VR(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=VR(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function KZe(t,e,r){if((e[0]&192)!=128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return t.lastNeed=2,"\uFFFD"}}function jZe(t){var e=this.lastTotal-this.lastNeed,r=KZe(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function VZe(t,e){var r=FZe(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function zZe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function HZe(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function $Ze(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function GZe(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function WZe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function YZe(t){return t.toString(this.encoding)}function XZe(t){return t&&t.length?this.write(t):""}});var IE=y((bkt,$se)=>{f();"use strict";var zse=dd().codes.ERR_STREAM_PREMATURE_CLOSE;function QZe(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}function ZZe(){}function JZe(t){return t.setHeader&&typeof t.abort=="function"}function Hse(t,e,r){if(typeof e=="function")return Hse(t,null,e);e||(e={}),r=QZe(r||ZZe);var i=e.readable||e.readable!==!1&&t.readable,n=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||a()},o=t._writableState&&t._writableState.finished,a=function(){n=!1,o=!0,i||r.call(t)},c=t._readableState&&t._readableState.endEmitted,u=function(){i=!1,c=!0,n||r.call(t)},l=function(g){r.call(t,g)},d=function(){var g;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(g=new zse),r.call(t,g);if(n&&!o)return(!t._writableState||!t._writableState.ended)&&(g=new zse),r.call(t,g)},h=function(){t.req.on("finish",a)};return JZe(t)?(t.on("complete",a),t.on("abort",d),t.req?h():t.on("request",h)):n&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",l),t.on("close",d),function(){t.removeListener("complete",a),t.removeListener("abort",d),t.removeListener("request",h),t.req&&t.req.removeListener("finish",a),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",l),t.removeListener("close",d)}}$se.exports=Hse});var Wse=y((mkt,Gse)=>{f();"use strict";var TE;function Il(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var eJe=IE(),Tl=Symbol("lastResolve"),yd=Symbol("lastReject"),v1=Symbol("error"),RE=Symbol("ended"),gd=Symbol("lastPromise"),HR=Symbol("handlePromise"),bd=Symbol("stream");function Rl(t,e){return{value:t,done:e}}function tJe(t){var e=t[Tl];if(e!==null){var r=t[bd].read();r!==null&&(t[gd]=null,t[Tl]=null,t[yd]=null,e(Rl(r,!1)))}}function rJe(t){process.nextTick(tJe,t)}function iJe(t,e){return function(r,i){t.then(function(){if(e[RE]){r(Rl(void 0,!0));return}e[HR](r,i)},i)}}var nJe=Object.getPrototypeOf(function(){}),sJe=Object.setPrototypeOf((TE={get stream(){return this[bd]},next:function(){var e=this,r=this[v1];if(r!==null)return Promise.reject(r);if(this[RE])return Promise.resolve(Rl(void 0,!0));if(this[bd].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[v1]?a(e[v1]):o(Rl(void 0,!0))})});var i=this[gd],n;if(i)n=new Promise(iJe(i,this));else{var s=this[bd].read();if(s!==null)return Promise.resolve(Rl(s,!1));n=new Promise(this[HR])}return this[gd]=n,n}},Il(TE,Symbol.asyncIterator,function(){return this}),Il(TE,"return",function(){var e=this;return new Promise(function(r,i){e[bd].destroy(null,function(n){if(n){i(n);return}r(Rl(void 0,!0))})})}),TE),nJe),oJe=function(e){var r,i=Object.create(sJe,(r={},Il(r,bd,{value:e,writable:!0}),Il(r,Tl,{value:null,writable:!0}),Il(r,yd,{value:null,writable:!0}),Il(r,v1,{value:null,writable:!0}),Il(r,RE,{value:e._readableState.endEmitted,writable:!0}),Il(r,HR,{value:function(s,o){var a=i[bd].read();a?(i[gd]=null,i[Tl]=null,i[yd]=null,s(Rl(a,!1))):(i[Tl]=s,i[yd]=o)},writable:!0}),r));return i[gd]=null,eJe(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[yd];s!==null&&(i[gd]=null,i[Tl]=null,i[yd]=null,s(n)),i[v1]=n;return}var o=i[Tl];o!==null&&(i[gd]=null,i[Tl]=null,i[yd]=null,o(Rl(void 0,!0))),i[RE]=!0}),e.on("readable",rJe.bind(null,i)),i};Gse.exports=oJe});var Xse=y((vkt,Yse)=>{f();Yse.exports=function(){throw new Error("Readable.from is not available in the browser")}});var UR=y((_kt,ooe)=>{f();"use strict";ooe.exports=Dt;var a0;Dt.ReadableState=Zse;var wkt=yr().EventEmitter,Qse=function(e,r){return e.listeners(r).length},w1=TR(),PE=Vt().Buffer,aJe=globalThis.Uint8Array||function(){};function cJe(t){return PE.from(t)}function uJe(t){return PE.isBuffer(t)||t instanceof aJe}var $R=RR(),bt;$R&&$R.debuglog?bt=$R.debuglog("stream"):bt=function(){};var lJe=Sse(),GR=OR(),fJe=kR(),dJe=fJe.getHighWaterMark,CE=dd().codes,hJe=CE.ERR_INVALID_ARG_TYPE,pJe=CE.ERR_STREAM_PUSH_AFTER_EOF,yJe=CE.ERR_METHOD_NOT_IMPLEMENTED,gJe=CE.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,c0,WR,YR;Yi()(Dt,w1);var _1=GR.errorOrDestroy,XR=["error","close","destroy","pause","resume"];function bJe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function Zse(t,e,r){a0=a0||hd(),t=t||{},typeof r!="boolean"&&(r=e instanceof a0),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=dJe(this,t,"readableHighWaterMark",r),this.buffer=new lJe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(c0||(c0=zR().StringDecoder),this.decoder=new c0(t.encoding),this.encoding=t.encoding)}function Dt(t){if(a0=a0||hd(),!(this instanceof Dt))return new Dt(t);var e=this instanceof a0;this._readableState=new Zse(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),w1.call(this)}Object.defineProperty(Dt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Dt.prototype.destroy=GR.destroy;Dt.prototype._undestroy=GR.undestroy;Dt.prototype._destroy=function(t,e){e(t)};Dt.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=PE.from(t,e),e=""),i=!0),Jse(this,t,e,!1,i)};Dt.prototype.unshift=function(t){return Jse(this,t,null,!0,!1)};function Jse(t,e,r,i,n){bt("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,wJe(t,s);else{var o;if(n||(o=mJe(s,e)),o)_1(t,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==PE.prototype&&(e=cJe(e)),i)s.endEmitted?_1(t,new gJe):QR(t,s,e,!0);else if(s.ended)_1(t,new pJe);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?QR(t,s,e,!1):ZR(t,s)):QR(t,s,e,!1)}else i||(s.reading=!1,ZR(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function QR(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&OE(t)),ZR(t,e)}function mJe(t,e){var r;return!uJe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new hJe("chunk",["string","Buffer","Uint8Array"],e)),r}Dt.prototype.isPaused=function(){return this._readableState.flowing===!1};Dt.prototype.setEncoding=function(t){c0||(c0=zR().StringDecoder);var e=new c0(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";r!==null;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var eoe=1073741824;function vJe(t){return t>=eoe?t=eoe:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function toe(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=vJe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Dt.prototype.read=function(t){bt("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return bt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?e8(this):OE(this),null;if(t=toe(t,e),t===0&&e.ended)return e.length===0&&e8(this),null;var i=e.needReadable;bt("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,bt("length less than watermark",i)),e.ended||e.reading?(i=!1,bt("reading or ended",i)):i&&(bt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=toe(r,e)));var n;return t>0?n=noe(t,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&e8(this)),n!==null&&this.emit("data",n),n};function wJe(t,e){if(bt("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?OE(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,roe(t)))}}function OE(t){var e=t._readableState;bt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(bt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(roe,t))}function roe(t){var e=t._readableState;bt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,JR(t)}function ZR(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(_Je,t,e))}function _Je(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(bt("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Dt.prototype._read=function(t){_1(this,new yJe("_read()"))};Dt.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,bt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?a:m;i.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",o);function o(E,v){bt("onunpipe"),E===r&&v&&v.hasUnpiped===!1&&(v.hasUnpiped=!0,l())}function a(){bt("onend"),t.end()}var c=EJe(r);t.on("drain",c);var u=!1;function l(){bt("cleanup"),t.removeListener("close",p),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",h),t.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",m),r.removeListener("data",d),u=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}r.on("data",d);function d(E){bt("ondata");var v=t.write(E);bt("dest.write",v),v===!1&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&soe(i.pipes,t)!==-1)&&!u&&(bt("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function h(E){bt("onerror",E),m(),t.removeListener("error",h),Qse(t,"error")===0&&_1(t,E)}bJe(t,"error",h);function p(){t.removeListener("finish",g),m()}t.once("close",p);function g(){bt("onfinish"),t.removeListener("close",p),m()}t.once("finish",g);function m(){bt("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(bt("pipe resume"),r.resume()),t};function EJe(t){return function(){var r=t._readableState;bt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Qse(t,"data")&&(r.flowing=!0,JR(t))}}Dt.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=soe(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Dt.prototype.on=function(t,e){var r=w1.prototype.on.call(this,t,e),i=this._readableState;return t==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):t==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,bt("on readable",i.length,i.reading),i.length?OE(this):i.reading||process.nextTick(SJe,this)),r};Dt.prototype.addListener=Dt.prototype.on;Dt.prototype.removeListener=function(t,e){var r=w1.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(ioe,this),r};Dt.prototype.removeAllListeners=function(t){var e=w1.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(ioe,this),e};function ioe(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function SJe(t){bt("readable nexttick read 0"),t.read(0)}Dt.prototype.resume=function(){var t=this._readableState;return t.flowing||(bt("resume"),t.flowing=!t.readableListening,xJe(this,t)),t.paused=!1,this};function xJe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(AJe,t,e))}function AJe(t,e){bt("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),JR(t),e.flowing&&!e.reading&&t.read(0)}Dt.prototype.pause=function(){return bt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(bt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function JR(t){var e=t._readableState;for(bt("flow",e.flowing);e.flowing&&t.read()!==null;);}Dt.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(bt("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),t.on("data",function(o){if(bt("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var s=0;s<XR.length;s++)t.on(XR[s],this.emit.bind(this,XR[s]));return this._read=function(o){bt("wrapped _read",o),i&&(i=!1,t.resume())},this};typeof Symbol=="function"&&(Dt.prototype[Symbol.asyncIterator]=function(){return WR===void 0&&(WR=Wse()),WR(this)});Object.defineProperty(Dt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Dt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Dt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Dt._fromList=noe;Object.defineProperty(Dt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function noe(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function e8(t){var e=t._readableState;bt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(IJe,e,t))}function IJe(t,e){if(bt("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Dt.from=function(t,e){return YR===void 0&&(YR=Xse()),YR(Dt,t,e)});function soe(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var t8=y((Ekt,coe)=>{f();"use strict";coe.exports=ru;var kE=dd().codes,TJe=kE.ERR_METHOD_NOT_IMPLEMENTED,RJe=kE.ERR_MULTIPLE_CALLBACK,PJe=kE.ERR_TRANSFORM_ALREADY_TRANSFORMING,CJe=kE.ERR_TRANSFORM_WITH_LENGTH_0,qE=hd();Yi()(ru,qE);function OJe(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(i===null)return this.emit("error",new RJe);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function ru(t){if(!(this instanceof ru))return new ru(t);qE.call(this,t),this._transformState={afterTransform:OJe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",kJe)}function kJe(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){aoe(t,e,r)}):aoe(this,null,null)}ru.prototype.push=function(t,e){return this._transformState.needTransform=!1,qE.prototype.push.call(this,t,e)};ru.prototype._transform=function(t,e,r){r(new TJe("_transform()"))};ru.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};ru.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};ru.prototype._destroy=function(t,e){qE.prototype._destroy.call(this,t,function(r){e(r)})};function aoe(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new CJe;if(t._transformState.transforming)throw new PJe;return t.push(null)}});var foe=y((Skt,loe)=>{f();"use strict";loe.exports=E1;var uoe=t8();Yi()(E1,uoe);function E1(t){if(!(this instanceof E1))return new E1(t);uoe.call(this,t)}E1.prototype._transform=function(t,e,r){r(null,t)}});var goe=y((xkt,yoe)=>{f();"use strict";var r8;function qJe(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var doe=dd().codes,DJe=doe.ERR_MISSING_ARGS,NJe=doe.ERR_STREAM_DESTROYED;function hoe(t){if(t)throw t}function BJe(t){return t.setHeader&&typeof t.abort=="function"}function MJe(t,e,r,i){i=qJe(i);var n=!1;t.on("close",function(){n=!0}),r8===void 0&&(r8=IE()),r8(t,{readable:e,writable:r},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,BJe(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(o||new NJe("pipe"))}}}function poe(t){t()}function LJe(t,e){return t.pipe(e)}function UJe(t){return!t.length||typeof t[t.length-1]!="function"?hoe:t.pop()}function FJe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=UJe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new DJe("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return MJe(o,c,u,function(l){n||(n=l),l&&s.forEach(poe),!c&&(s.forEach(poe),i(n))})});return e.reduce(LJe)}yoe.exports=FJe});var i8=y((Qs,boe)=>{f();Qs=boe.exports=UR();Qs.Stream=Qs;Qs.Readable=Qs;Qs.Writable=BR();Qs.Duplex=hd();Qs.Transform=t8();Qs.PassThrough=foe();Qs.finished=IE();Qs.pipeline=goe()});var woe=y((Akt,voe)=>{f();"use strict";var KJe=Yi(),{Readable:moe}=i8();voe.exports=u0;KJe(u0,moe);function u0(t,e){if(!(this instanceof u0))return new u0(t,e);e=e||{},moe.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=t,this._options=e,this.on("end",this.destroy.bind(this,null,null))}u0.prototype._read=function(){this.destroyed||this._iterator.next((t,e,r)=>{if(!this.destroyed){if(t)return this.destroy(t);e===void 0&&r===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(r):this.push({key:e,value:r})}})};u0.prototype._destroy=function(t,e){this._iterator.end(function(r){e(t||r)})}});var Eoe=y((_oe,DE)=>{f();(function(t,e,r){typeof DE!="undefined"&&DE.exports?DE.exports=r():e[t]=r()})("prr",_oe,function(){var t=typeof Object.defineProperty=="function"?function(i,n,s){return Object.defineProperty(i,n,s),i}:function(i,n,s){return i[n]=s.value,i},e=function(i,n){var s=typeof n=="object",o=!s&&typeof n=="string",a=function(c){return s?!!n[c]:o?n.indexOf(c[0])>-1:!1};return{enumerable:a("enumerable"),configurable:a("configurable"),writable:a("writable"),value:i}},r=function(i,n,s,o){var a;if(o=e(s,o),typeof n=="object"){for(a in n)Object.hasOwnProperty.call(n,a)&&(o.value=n[a],t(i,a,o));return i}return t(i,n,o)};return r})});var Aoe=y((Ikt,xoe)=>{f();var jJe=Eoe();function Soe(t,e,r){!!e&&typeof e!="string"&&(e=e.message||e.name),jJe(this,{type:t,name:t,cause:typeof e!="string"?e:r,message:e},"ewr")}function n8(t,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Soe.call(this,"CustomError",t,e)}n8.prototype=new Error;function VJe(t,e,r){var i=function(n,s){Soe.call(this,e,n,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(t.errno[this.cause.errno]?t.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,i)};return i.prototype=r?new r:new n8,i}xoe.exports=function(t){var e=function(r,i){return VJe(t,r,i)};return{CustomError:n8,FilesystemError:e("FilesystemError"),createError:e}}});var Ioe=y((Tkt,Ja)=>{f();var zJe=Ja.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];Ja.exports.errno={};Ja.exports.code={};zJe.forEach(function(t){Ja.exports.errno[t.errno]=t,Ja.exports.code[t.code]=t});Ja.exports.custom=Aoe()(Ja.exports);Ja.exports.create=Ja.exports.custom.createError});var NE=y((Rkt,Toe)=>{f();"use strict";var md=Ioe().create,vd=md("LevelUPError"),s8=md("NotFoundError",vd);s8.prototype.notFound=!0;s8.prototype.status=404;Toe.exports={LevelUPError:vd,InitializationError:md("InitializationError",vd),OpenError:md("OpenError",vd),ReadError:md("ReadError",vd),WriteError:md("WriteError",vd),NotFoundError:s8,EncodingError:md("EncodingError",vd)}});var a8=y(o8=>{f();"use strict";o8.fromCallback=function(t){if(t===void 0){var e=new Promise(function(r,i){t=function(n,s){n?i(n):r(s)}});t.promise=e}return t};o8.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){process.nextTick(e,null,r)}).catch(function(r){process.nextTick(e,r)})}});var S1=y(c8=>{f();"use strict";c8.getCallback=function(t,e){return typeof t=="function"?t:e};c8.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var Poe=y((Okt,Roe)=>{f();"use strict";var x1=NE().WriteError,HJe=a8(),$Je=S1().getCallback,GJe=S1().getOptions;function A1(t){this.db=t,this.batch=t.db.batch(),this.ops=[],this.length=0}A1.prototype.put=function(t,e,r){try{this.batch.put(t,e,r)}catch(i){throw new x1(i)}return this.ops.push({...r,type:"put",key:t,value:e}),this.length++,this};A1.prototype.del=function(t,e){try{this.batch.del(t,e)}catch(r){throw new x1(r)}return this.ops.push({...e,type:"del",key:t}),this.length++,this};A1.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new x1(t)}return this.ops=[],this.length=0,this};A1.prototype.write=function(t,e){let r=this.db,i=this.ops;e=$Je(t,e),e=HJe.fromCallback(e),t=GJe(t);try{this.batch.write(t,function(n){if(n)return e(new x1(n));r.emit("batch",i),e()})}catch(n){throw new x1(n)}return e.promise};Roe.exports=A1});var koe=y((kkt,Ooe)=>{f();"use strict";var Coe=gE();Ooe.exports=function(t,...e){e.length===0?Coe(t):Coe(()=>t(...e))}});var Boe=y((qkt,Noe)=>{f();"use strict";var BE=yr().EventEmitter,WJe=Zne().inherits,qoe=mse(),YJe=woe(),XJe=Poe(),l0=NE(),QJe=ER(),wd=a8(),I1=S1().getCallback,f0=S1().getOptions,ME=koe(),LE=l0.WriteError,Doe=l0.ReadError,ZJe=l0.NotFoundError,JJe=l0.OpenError,eet=l0.InitializationError;function lr(t,e,r){if(!(this instanceof lr))return new lr(t,e,r);let i;if(BE.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(r=e,e={}),e=e||{},!t||typeof t!="object"){if(i=new eet("First argument must be an abstract-leveldown compliant store"),typeof r=="function")return ME(r,i);throw i}if(typeof t.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=f0(e),this._db=t,this.db=new qoe(t),this.open(r||(n=>{n&&this.emit("error",n)})),this.supports=QJe(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}lr.prototype.emit=BE.prototype.emit;lr.prototype.once=BE.prototype.once;WJe(lr,BE);lr.prototype.open=function(t,e){return typeof t=="function"&&(e=t,t=null),e=wd.fromCallback(e),t||(t=this.options),this.isOpen()?(ME(e,null,this),e.promise):this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.emit("opening"),this.db.open(t,r=>{if(r)return e(new JJe(r));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};lr.prototype.close=function(t){return t=wd.fromCallback(t),this.isOpen()?(this.db.close((e,...r)=>{this.emit("closed"),t(e,...r)}),this.emit("closing"),this.db=new qoe(this._db)):this.isClosed()?ME(t):this.db.status==="closing"?this.once("closed",t):this._isOpening()&&this.once("open",()=>{this.close(t)}),t.promise};lr.prototype.isOpen=function(){return this.db.status==="open"};lr.prototype._isOpening=function(){return this.db.status==="opening"};lr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};lr.prototype.get=function(t,e,r){return r=I1(e,r),r=wd.fromCallback(r),T1(this,r)||(e=f0(e),this.db.get(t,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new ZJe("Key not found in database ["+t+"]",i):i=new Doe(i),r(i);r(null,n)})),r.promise};lr.prototype.put=function(t,e,r,i){return i=I1(r,i),i=wd.fromCallback(i),T1(this,i)||(r=f0(r),this.db.put(t,e,r,n=>{if(n)return i(new LE(n));this.emit("put",t,e),i()})),i.promise};lr.prototype.del=function(t,e,r){return r=I1(e,r),r=wd.fromCallback(r),T1(this,r)||(e=f0(e),this.db.del(t,e,i=>{if(i)return r(new LE(i));this.emit("del",t),r()})),r.promise};lr.prototype.batch=function(t,e,r){return arguments.length?(typeof t=="function"?r=t:r=I1(e,r),r=wd.fromCallback(r),T1(this,r)||(e=f0(e),this.db.batch(t,e,i=>{if(i)return r(new LE(i));this.emit("batch",t),r()})),r.promise):new XJe(this)};lr.prototype.iterator=function(t){return this.db.iterator(t)};lr.prototype.clear=function(t,e){return e=I1(t,e),t=f0(t),e=wd.fromCallback(e),T1(this,e)||this.db.clear(t,r=>{if(r)return e(new LE(r));this.emit("clear",t),e()}),e.promise};lr.prototype.readStream=lr.prototype.createReadStream=function(t){return t=Object.assign({keys:!0,values:!0},t),typeof t.limit!="number"&&(t.limit=-1),new YJe(this.db.iterator(t),t)};lr.prototype.keyStream=lr.prototype.createKeyStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!0,values:!1}))};lr.prototype.valueStream=lr.prototype.createValueStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!1,values:!0}))};lr.prototype.toString=function(){return"LevelUP"};lr.prototype.type="levelup";function T1(t,e){if(!t._isOpening()&&!t.isOpen())return ME(e,new Doe("Database is not open")),!0}lr.errors=l0;Noe.exports=lr});var Moe=y(iu=>{f();"use strict";var{Buffer:u8}=Vt();iu.utf8=iu["utf-8"]={encode:function(t){return l8(t)?t:String(t)},decode:UE,buffer:!1,type:"utf8"};iu.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};iu.binary={encode:function(t){return l8(t)?t:u8.from(t)},decode:UE,buffer:!0,type:"binary"};iu.none={encode:UE,decode:UE,buffer:!1,type:"id"};iu.id=iu.none;var tet=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let t of tet)iu[t]={encode:function(e){return l8(e)?e:u8.from(e,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t};function UE(t){return t}function l8(t){return t==null||u8.isBuffer(t)}});var Uoe=y((Nkt,Loe)=>{f();"use strict";var f8=Moe(),ret=new Set(["lt","gt","lte","gte"]);Loe.exports=kn;function kn(t){if(!(this instanceof kn))return new kn(t);this.opts=t||{},this.encodings=f8}kn.prototype._encoding=function(t){return typeof t=="string"&&(t=f8[t]),t||(t=f8.id),t};kn.prototype._keyEncoding=function(t,e){return this._encoding(e&&e.keyEncoding||t&&t.keyEncoding||this.opts.keyEncoding)};kn.prototype._valueEncoding=function(t,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||t&&(t.valueEncoding||t.encoding)||this.opts.valueEncoding||this.opts.encoding)};kn.prototype.encodeKey=function(t,e,r){return this._keyEncoding(e,r).encode(t)};kn.prototype.encodeValue=function(t,e,r){return this._valueEncoding(e,r).encode(t)};kn.prototype.decodeKey=function(t,e){return this._keyEncoding(e).decode(t)};kn.prototype.decodeValue=function(t,e){return this._valueEncoding(e).decode(t)};kn.prototype.encodeBatch=function(t,e){return t.map(r=>{let i={type:r.type,key:this.encodeKey(r.key,e,r)};return this.keyAsBuffer(e,r)&&(i.keyEncoding="binary"),r.prefix&&(i.prefix=r.prefix),"value"in r&&(i.value=this.encodeValue(r.value,e,r),this.valueAsBuffer(e,r)&&(i.valueEncoding="binary")),i})};kn.prototype.encodeLtgt=function(t){let e={};for(let r of Object.keys(t)){if(r==="start"||r==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[r]=ret.has(r)?this.encodeKey(t[r],t):t[r]}return e};kn.prototype.createStreamDecoder=function(t){return t.keys&&t.values?(e,r)=>({key:this.decodeKey(e,t),value:this.decodeValue(r,t)}):t.keys?e=>this.decodeKey(e,t):t.values?(e,r)=>this.decodeValue(r,t):function(){}};kn.prototype.keyAsBuffer=function(t){return this._keyEncoding(t).buffer};kn.prototype.valueAsBuffer=function(t){return this._valueEncoding(t).buffer}});var Hoe=y((Bkt,zoe)=>{f();"use strict";var Foe=xl().AbstractLevelDOWN,Koe=xl().AbstractChainedBatch,joe=xl().AbstractIterator,d8=Yi(),iet=Uoe(),Voe=NE().EncodingError,net=["approximateSize","compactRange"];zoe.exports=bn;function bn(t,e){if(!(this instanceof bn))return new bn(t,e);let r=t.supports||{},i=r.additionalMethods||{};Foe.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},net.forEach(function(n){let s=typeof t[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=t,this.codec=new iet(e)}d8(bn,Foe);bn.prototype.type="encoding-down";bn.prototype._serializeKey=bn.prototype._serializeValue=function(t){return t};bn.prototype._open=function(t,e){this.db.open(t,e)};bn.prototype._close=function(t){this.db.close(t)};bn.prototype._put=function(t,e,r,i){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,i)};bn.prototype._get=function(t,e,r){t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,(i,n)=>{if(i)return r(i);try{n=this.codec.decodeValue(n,e)}catch(s){return r(new Voe(s))}r(null,n)})};bn.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)};bn.prototype._chainedBatch=function(){return new d0(this)};bn.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)};bn.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new R1(this,t)};bn.prototype._clear=function(t,e){t=this.codec.encodeLtgt(t),this.db.clear(t,e)};function R1(t,e){joe.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}d8(R1,joe);R1.prototype._next=function(t){this.it.next((e,r,i)=>{if(e)return t(e);try{this.keys&&typeof r!="undefined"?r=this.codec.decodeKey(r,this.opts):r=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return t(new Voe(n))}t(null,r,i)})};R1.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)};R1.prototype._end=function(t){this.it.end(t)};function d0(t,e){Koe.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}d8(d0,Koe);d0.prototype._put=function(t,e,r){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.batch.put(t,e)};d0.prototype._del=function(t,e){t=this.codec.encodeKey(t,e),this.batch.del(t)};d0.prototype._clear=function(){this.batch.clear()};d0.prototype._write=function(t,e){this.batch.write(t,e)}});var Woe=y((Mkt,Goe)=>{f();"use strict";var $oe=Boe(),set=Hoe();function oet(t){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),r(n)||(n=r(i)?i:{}),$oe(set(t(i,n),n),n,s)}function r(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof t[i]=="function"&&(e[i]=function(...n){t[i](...n)});return e.errors=$oe.errors,e}Goe.exports=oet});var Xoe=y(si=>{f();si.compare=function(t,e){if(Buffer.isBuffer(t)){for(var r=Math.min(t.length,e.length),i=0;i<r;i++){var n=t[i]-e[i];if(n)return n}return t.length-e.length}return t<e?-1:t>e?1:0};function Yoe(t){return t!==void 0&&t!==""}function h0(t,e){return Object.hasOwnProperty.call(t,e)}function ec(t,e){return Object.hasOwnProperty.call(t,e)&&e}var aet=si.lowerBoundKey=function(t){return ec(t,"gt")||ec(t,"gte")||ec(t,"min")||(t.reverse?ec(t,"end"):ec(t,"start"))||void 0},h8=si.lowerBound=function(t,e){var r=aet(t);return r?t[r]:e},p8=si.lowerBoundInclusive=function(t){return!h0(t,"gt")},y8=si.upperBoundInclusive=function(t){return!h0(t,"lt")},cet=si.lowerBoundExclusive=function(t){return!p8(t)},uet=si.upperBoundExclusive=function(t){return!y8(t)},fet=si.upperBoundKey=function(t){return ec(t,"lt")||ec(t,"lte")||ec(t,"max")||(t.reverse?ec(t,"start"):ec(t,"end"))||void 0},g8=si.upperBound=function(t,e){var r=fet(t);return r?t[r]:e};si.start=function(t,e){return t.reverse?g8(t,e):h8(t,e)};si.end=function(t,e){return t.reverse?h8(t,e):g8(t,e)};si.startInclusive=function(t){return t.reverse?y8(t):p8(t)};si.endInclusive=function(t){return t.reverse?p8(t):y8(t)};function det(t){return t}si.toLtgt=function(t,e,r,i,n){e=e||{},r=r||det;var s=arguments.length>3,o=si.lowerBoundKey(t),a=si.upperBoundKey(t);return o?o==="gt"?e.gt=r(t.gt,!1):e.gte=r(t[o],!1):s&&(e.gte=r(i,!1)),a?a==="lt"?e.lt=r(t.lt,!0):e.lte=r(t[a],!0):s&&(e.lte=r(n,!0)),t.reverse!=null&&(e.reverse=!!t.reverse),h0(e,"max")&&delete e.max,h0(e,"min")&&delete e.min,h0(e,"start")&&delete e.start,h0(e,"end")&&delete e.end,e};si.contains=function(t,e,r){r=r||si.compare;var i=h8(t);if(Yoe(i)){var n=r(e,i);if(n<0||n===0&&cet(t))return!1}var s=g8(t);if(Yoe(s)){var n=r(e,s);if(n>0||n===0&&uet(t))return!1}return!0};si.filter=function(t,e){return function(r){return si.contains(t,r,e)}}});var b8=y((Ukt,Qoe)=>{f();"use strict";var FE=Xoe(),Pl=Symbol("none");Qoe.exports=function(e){let r=FE.lowerBound(e,Pl),i=FE.upperBound(e,Pl),n=FE.lowerBoundExclusive(e,Pl),s=FE.upperBoundExclusive(e,Pl);return r!==Pl&&i!==Pl?IDBKeyRange.bound(r,i,n,s):r!==Pl?IDBKeyRange.lowerBound(r,n):i!==Pl?IDBKeyRange.upperBound(i,s):null}});var m8=y((Fkt,Joe)=>{f();"use strict";var KE=Vt().Buffer,het=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return Zoe(e).toString()}}(),pet=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return KE.from(e).toString()}}();function Zoe(t){let e=KE.from(t.buffer);return t.byteLength===t.buffer.byteLength?e:e.slice(t.byteOffset,t.byteOffset+t.byteLength)}Joe.exports=function(t,e){return t instanceof Uint8Array?e?Zoe(t):het(t):t instanceof ArrayBuffer?e?KE.from(t):pet(t):e?KE.from(String(t)):String(t)}});var iae=y((Kkt,rae)=>{f();"use strict";var yet=Yi(),eae=xl().AbstractIterator,get=b8(),tae=m8(),bet=function(){};rae.exports=Go;function Go(t,e,r){if(eae.call(this,t),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=r.keys,this._values=r.values,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=get(r)}catch(n){this._completed=!0;return}this.createIterator(e,i,r.reverse)}yet(Go,eae);Go.prototype.createIterator=function(t,e,r){let i=this.db.db.transaction([t],"readonly"),s=i.objectStore(t).openCursor(e,r?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};Go.prototype.onItem=function(t){this._cache.push(t.key,t.value),(this._limit<=0||++this._count<this._limit)&&t.continue(),this.maybeNext()};Go.prototype.onAbort=function(t){this._aborted=!0,this._error=t,this.maybeNext()};Go.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};Go.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};Go.prototype._next=function(t){if(this._aborted){let e=this._error;this._error=null,this._nextTick(t,e)}else if(this._cache.length>0){let e=this._cache.shift(),r=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&r!==void 0?r=this._deserializeValue(r,this._valueAsBuffer):r=void 0,this._nextTick(t,null,e,r)}else this._completed?this._nextTick(t):this._callback=t};Go.prototype._deserializeKey=tae;Go.prototype._deserializeValue=tae;Go.prototype._end=function(t){if(this._aborted||this._completed)return this._nextTick(t,this._error);this.onItem=bet,this.onAbort=t,this.onComplete=t}});var oae=y((jkt,sae)=>{f();"use strict";var nae=Vt().Buffer,met=function(){if(globalThis.TextEncoder){let t=new TextEncoder("utf-8");return t.encode.bind(t)}else return nae.from}();sae.exports=function(t,e){return e?nae.isBuffer(t)?t:met(String(t)):String(t)}});var aae=y(jE=>{f();"use strict";var vet=Vt().Buffer;jE.test=function(t){return function(r){try{return r.cmp(t,0),!0}catch(i){return!1}}};jE.bufferKeys=jE.test(vet.alloc(0))});var uae=y((zkt,cae)=>{f();"use strict";cae.exports=function(e,r,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([r],"readwrite"),a=o.objectStore(r),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",l=n.reverse?"prev":"next";a[u](i,l).onsuccess=function(d){let h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&h.continue()})}}});var pae=y((Hkt,hae)=>{f();"use strict";hae.exports=Si;var lae=xl().AbstractLevelDOWN,wet=Yi(),_et=iae(),fae=oae(),v8=m8(),Eet=aae(),xet=uae(),Aet=b8(),dae="level-js-";function Si(t,e){if(!(this instanceof Si))return new Si(t,e);if(lae.call(this,{bufferKeys:Eet.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),e=e||{},typeof t!="string")throw new Error("constructor requires a location string argument");this.location=t,this.prefix=e.prefix==null?dae:e.prefix,this.version=parseInt(e.version||1,10)}wet(Si,lae);Si.prototype.type="level-js";Si.prototype._open=function(t,e){let r=indexedDB.open(this.prefix+this.location,this.version);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};Si.prototype.store=function(t){return this.db.transaction([this.location],t).objectStore(this.location)};Si.prototype.await=function(t,e){let r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}};Si.prototype._get=function(t,e,r){let i=this.store("readonly"),n;try{n=i.get(t)}catch(s){return this._nextTick(r,s)}this.await(n,function(s,o){if(s)return r(s);if(o===void 0)return r(new Error("NotFound"));r(null,v8(o,e.asBuffer))})};Si.prototype._del=function(t,e,r){let i=this.store("readwrite"),n;try{n=i.delete(t)}catch(s){return this._nextTick(r,s)}this.await(n,r)};Si.prototype._put=function(t,e,r,i){let n=this.store("readwrite"),s;try{s=n.put(e,t)}catch(o){return this._nextTick(i,o)}this.await(s,i)};Si.prototype._serializeKey=function(t){return fae(t,this.supports.bufferKeys)};Si.prototype._serializeValue=function(t){return fae(t,!0)};Si.prototype._iterator=function(t){return new _et(this,this.location,t)};Si.prototype._batch=function(t,e,r){if(t.length===0)return this._nextTick(r);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){r(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){r()};function a(){let c=t[s++],u=c.key,l;try{l=c.type==="del"?i.delete(u):i.put(c.value,u)}catch(d){o=d,n.abort();return}s<t.length&&(l.onsuccess=a)}a()};Si.prototype._clear=function(t,e){let r,i;try{r=Aet(t)}catch(n){return this._nextTick(e)}if(t.limit>=0)return xet(this,this.location,r,t,e);try{let n=this.store("readwrite");i=r?n.delete(r):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};Si.prototype._close=function(t){this.db.close(),this._nextTick(t)};Si.prototype.upgrade=function(t){if(this.status!=="open")return this._nextTick(t,new Error("cannot upgrade() before open()"));let e=this.iterator(),r={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,u,l){if(c||u===void 0)return o(c);let d=i._serializeKey(v8(u,!0)),h=i._serializeValue(v8(l,!0));i._batch([{type:"del",key:u},{type:"put",key:d,value:h}],r,n)}function o(c){e.end(function(u){t(c||u)})}function a(c){return c}};Si.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=dae);let i=indexedDB.deleteDatabase(e+t);i.onsuccess=function(){r()},i.onerror=function(n){r(n)}}});var gae=y(($kt,yae)=>{f();yae.exports=Woe()(pae())});var _ae=y((Gkt,wae)=>{f();"use strict";var{Key:Iet,Errors:P1,Adapter:Tet,utils:{sortAll:bae}}=Ut(),VE=Fa(),Ret=No(),mae=cp(),vae=class extends Tet{constructor(e,r){super();this.path=e,this.opts=r,r&&r.db?(this.database=r.db,delete r.db):this.database=gae()}_initDb(){return new Promise((e,r)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return r(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw P1.dbOpenFailedError(e)}}async put(e,r){try{await this.db.put(e.toString(),r)}catch(i){throw P1.dbWriteFailedError(i)}}async get(e){let r;try{r=await this.db.get(e.toString())}catch(i){throw i.notFound?P1.notFoundError(i):P1.dbWriteFailedError(i)}return r}async has(e){try{await this.db.get(e.toString())}catch(r){if(r.notFound)return!1;throw r}return!0}async delete(e){try{await this.db.del(e.toString())}catch(r){throw P1.dbDeleteFailedError(r)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(r,i)=>{e.push({type:"put",key:r.toString(),value:i})},delete:r=>{e.push({type:"del",key:r.toString()})},commit:()=>this.db.batch(e)}}query(e){let r=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>VE(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>bae(s,o),r));let{offset:i,limit:n}=e;if(i){let s=0;r=VE(r,()=>s++>=i)}return n&&(r=mae(r,n)),r}queryKeys(e){let r=Ret(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>VE(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>bae(s,o),r));let{offset:i,limit:n}=e;if(i){let s=0;r=VE(r,()=>s++>=i)}return n&&(r=mae(r,n)),r}_query(e){let r={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();r.gte=i,r.lt=i+"\xFF"}return Pet(this.db.iterator(r))}};function Pet(t){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,r)=>{t.next((i,n,s)=>{if(i)return r(i);if(n==null)return t.end(o=>{if(o)return r(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new Iet(n,!1),value:s}})})}),return:()=>new Promise((e,r)=>{t.end(i=>{if(i)return r(i);e({done:!0,value:void 0})})})}}}}wae.exports=vae});var w8=y((Wkt,Iae)=>{f();"use strict";var Eae=Ua(),p0=Fa(),Sae=cp(),Cet=ap(),xae=(t,e)=>async function*(){yield*(await Cet(t)).sort(e)}(),Aae=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await Eae(this.putMany(e,i)),e=[],await Eae(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=p0(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>p0(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>xae(n,s),i)),e.offset!=null){let n=0;i=p0(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=Sae(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=p0(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>p0(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>xae(n,s),i)),e.offset!=null){let n=0;i=p0(i,()=>n++>=e.offset)}return e.limit!=null&&(i=Sae(i,e.limit)),i}};Iae.exports=Aae});var Rae=y((Ykt,Tae)=>{f();"use strict";var Oet=ue();function ket(t){return t=t||new Error("Not Found"),Oet(t,"ERR_NOT_FOUND")}Tae.exports={notFoundError:ket}});var Dae=y((Xkt,qae)=>{f();"use strict";var qet=w8(),{base32:y0}=(on(),sn),Pae=(Rs(),wo),{CID:Cae}=(Ie(),Ne),Oae=(xn(),Ln),Det=Rae(),kae=class extends qet{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[y0.encode(e.multihash.bytes)]=r}async get(e){if(!await this.has(e))throw Det.notFoundError();return this.data[y0.encode(e.multihash.bytes)]}async has(e){return this.data[y0.encode(e.multihash.bytes)]!==void 0}async delete(e){delete this.data[y0.encode(e.multihash.bytes)]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:Cae.createV1(Pae.code,Oae.decode(y0.decode(e))),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>Cae.createV1(Pae.code,Oae.decode(y0.decode(e))))}};qae.exports=kae});var zE=y((Qkt,Nae)=>{f();"use strict";var Net=w8(),Bet=Dae();Nae.exports={BlockstoreAdapter:Net,MemoryBlockstore:Bet}});var jae=y((Zkt,Kae)=>{f();"use strict";var Bae=Ua(),Mae=ja(),{Key:Met}=Ut(),{CID:Lae}=(Ie(),Ne),Let=(Rs(),wo),Uet=(xn(),Ln),{base32:C1,base32pad:Fet}=(on(),sn),{base58btc:Uae}=(ei(),Jr),Ket=ue(),{BlockstoreAdapter:jet}=zE();function g0(t){if(!(t instanceof Lae))throw Ket(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Met("/"+C1.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function Cl(t){return Lae.createV1(Let.code,Uet.decode(C1.decode("b"+t.toString().slice(1).toLowerCase())))}function _8(t){let e,r=t.substring(0,1);return r==="/"?_8(t.substring(1)):(r.toLowerCase()==="b"?e=C1.decode(t.toLowerCase()).subarray(2):r.toLowerCase()==="c"?e=Fet.decode(t.toLowerCase()).subarray(2):r==="z"?e=Uae.decode(t).subarray(2):r==="Q"?e=Uae.decode("z"+t):e=C1.decode("b"+t.toLowerCase()).subarray(2),C1.encode(e).substring(1).toUpperCase()||"C")}function Vet(t){return{...t,prefix:t.prefix?`/${_8(t.prefix)}`:void 0,filters:t.filters?t.filters.map(e=>r=>e({key:Cl(r.key),value:r.value})):void 0,orders:t.orders?t.orders.map(e=>(r,i)=>e({key:Cl(r.key),value:r.value},{key:Cl(i.key),value:i.value})):void 0}}function zet(t){return{...t,prefix:t.prefix?`/${_8(t.prefix)}`:void 0,filters:t.filters?t.filters.map(e=>r=>e(Cl(r))):void 0,orders:t.orders?t.orders.map(e=>(r,i)=>e(Cl(r),Cl(i))):void 0}}var Fae=class extends jet{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,r){for await(let{key:i,value:n}of this.child.query(Vet(e),r))yield{key:Cl(i),value:n}}async*queryKeys(e,r){for await(let i of this.child.queryKeys(zet(e),r))yield Cl(i)}async get(e,r){return this.child.get(g0(e),r)}async*getMany(e,r){for await(let i of e)yield this.get(i,r)}async put(e,r,i){await this.child.put(g0(e),r,i)}async*putMany(e,r){let i=Mae();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{let s=this.child;await Bae(this.child.putMany(async function*(){for await(let o of e){let a=g0(o.key);await s.has(a,r)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,r){return this.child.has(g0(e),r)}delete(e,r){return this.child.delete(g0(e),r)}deleteMany(e,r){let i=Mae();return Bae(this.child.deleteMany(async function*(){for await(let n of e)yield g0(n),i.push(n);i.end()}(),r)).catch(n=>{i.end(n)}),i}};Kae.exports=Fae});var zae=y((Jkt,Vae)=>{f();"use strict";var{createRepo:Het}=Bf(),O1=_ae(),$et=jae();Vae.exports=(t,e,r)=>{let i=r.path||"ipfs";return Het(i,n=>e.getCodec(n),{root:new O1(i,{prefix:"",version:2}),blocks:new $et(new O1(`${i}/blocks`,{prefix:"",version:2})),datastore:new O1(`${i}/datastore`,{prefix:"",version:2}),keys:new O1(`${i}/keys`,{prefix:"",version:2}),pins:new O1(`${i}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||t})}});var E8=y((eqt,Wae)=>{f();"use strict";var Hae=()=>{},$ae=Symbol.for("@libp2p/js-interfaces/topology"),Gae=class{constructor({min:e=0,max:r=1/0,handlers:i={}}){this.min=e,this.max=r,this._onConnect=i.onConnect||Hae,this._onDisconnect=i.onDisconnect||Hae,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[$ae](){return!0}static isTopology(e){return Boolean(e&&e[$ae])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};Wae.exports=Gae});var HE=y((tqt,Qae)=>{f();"use strict";var Get=E8(),Yae=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),Xae=class extends Get{constructor({min:e,max:r,multicodecs:i,handlers:n}){super({min:e,max:r,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[Yae](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[Yae])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:r,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(r.toB58String());let n=this._registrar.getConnection(r);n&&this._onConnect(r,n)}else this.peers.delete(r.toB58String())}_onProtocolChange({peerId:e,protocols:r}){let i=this.peers.has(e.toB58String()),n=r.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let r=e.remotePeer,i=this._registrar.peerStore.protoBook.get(r);!i||this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}};Qae.exports=Xae});var $E=y(Zae=>{f();"use strict";Zae.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var x8=y((iqt,Jae)=>{f();"use strict";var Ol=ki(),b0=Ol.Reader,S8=Ol.Writer,xt=Ol.util,xi=Ol.roots["libp2p-pubsub-rpc"]||(Ol.roots["libp2p-pubsub-rpc"]={});xi.RPC=function(){function t(e){if(this.subscriptions=[],this.msgs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.subscriptions=xt.emptyArray,t.prototype.msgs=xt.emptyArray,t.encode=function(r,i){if(i||(i=S8.create()),r.subscriptions!=null&&r.subscriptions.length)for(var n=0;n<r.subscriptions.length;++n)xi.RPC.SubOpts.encode(r.subscriptions[n],i.uint32(10).fork()).ldelim();if(r.msgs!=null&&r.msgs.length)for(var n=0;n<r.msgs.length;++n)xi.RPC.Message.encode(r.msgs[n],i.uint32(18).fork()).ldelim();return i},t.decode=function(r,i){r instanceof b0||(r=b0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new xi.RPC;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(xi.RPC.SubOpts.decode(r,r.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(xi.RPC.Message.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof xi.RPC)return r;var i=new xi.RPC;if(r.subscriptions){if(!Array.isArray(r.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<r.subscriptions.length;++n){if(typeof r.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=xi.RPC.SubOpts.fromObject(r.subscriptions[n])}}if(r.msgs){if(!Array.isArray(r.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<r.msgs.length;++n){if(typeof r.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=xi.RPC.Message.fromObject(r.msgs[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),r.subscriptions&&r.subscriptions.length){n.subscriptions=[];for(var s=0;s<r.subscriptions.length;++s)n.subscriptions[s]=xi.RPC.SubOpts.toObject(r.subscriptions[s],i)}if(r.msgs&&r.msgs.length){n.msgs=[];for(var s=0;s<r.msgs.length;++s)n.msgs[s]=xi.RPC.Message.toObject(r.msgs[s],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ol.util.toJSONOptions)},t.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var r;return Object.defineProperty(e.prototype,"_subscribe",{get:xt.oneOfGetter(r=["subscribe"]),set:xt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_topicID",{get:xt.oneOfGetter(r=["topicID"]),set:xt.oneOfSetter(r)}),e.encode=function(n,s){return s||(s=S8.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof b0||(n=b0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new xi.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof xi.RPC.SubOpts)return n;var s=new xi.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ol.util.toJSONOptions)},e}(),t.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=xt.emptyArray,e.prototype.signature=null,e.prototype.key=null;var r;return Object.defineProperty(e.prototype,"_from",{get:xt.oneOfGetter(r=["from"]),set:xt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_data",{get:xt.oneOfGetter(r=["data"]),set:xt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_seqno",{get:xt.oneOfGetter(r=["seqno"]),set:xt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_signature",{get:xt.oneOfGetter(r=["signature"]),set:xt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_key",{get:xt.oneOfGetter(r=["key"]),set:xt.oneOfSetter(r)}),e.encode=function(n,s){if(s||(s=S8.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof b0||(n=b0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new xi.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof xi.RPC.Message)return n;var s=new xi.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?xt.base64.decode(n.from,s.from=xt.newBuffer(xt.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?xt.base64.decode(n.data,s.data=xt.newBuffer(xt.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?xt.base64.decode(n.seqno,s.seqno=xt.newBuffer(xt.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?xt.base64.decode(n.signature,s.signature=xt.newBuffer(xt.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?xt.base64.decode(n.key,s.key=xt.newBuffer(xt.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?xt.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?xt.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?xt.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?xt.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?xt.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ol.util.toJSONOptions)},e}(),t}();Jae.exports=xi});var A8=y((nqt,rce)=>{f();"use strict";var ece=ss(),{Buffer:Wet}=Vt(),tce=(t,e,r)=>{let i=ece.encode(t,e,r);return tce.bytes=ece.encode.bytes,e||Wet.from(i)};rce.exports=tce});var cce=y((sqt,GE)=>{f();"use strict";var{Buffer:ice}=Vt(),nce=gn(),sce=A8(),I8=8,oce=10*1024;function ace(t){t=t||{};let e=Math.max(t.poolSize||oce,t.minPoolSize||I8),r=t.lengthEncoder||sce;return async function*(n){let s=ice.alloc(e),o=0;for await(let a of n){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<I8&&(s=ice.alloc(e),o=0),yield new nce().append(c).append(a)}}}ace.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||sce;return new nce([r(t.length),t.slice()])};GE.exports=ace;GE.exports.MIN_POOL_SIZE=I8;GE.exports.DEFAULT_POOL_SIZE=oce});var T8=y((oqt,fce)=>{f();"use strict";var uce=ss(),{Buffer:Yet}=Vt(),Xet=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),lce=t=>{let e=uce.decode(Yet.isBuffer(t)?t:Xet(t));return lce.bytes=uce.decode.bytes,e};fce.exports=lce});var yce=y((aqt,WE)=>{f();"use strict";var{Buffer:Qet}=Vt(),R8=gn(),Zet=T8(),dce=8,hce=1024*1024*4,pce=Qet.alloc(0),kl={LENGTH:"readLength",DATA:"readData"},Jet={[kl.LENGTH]:(t,e,r,i)=>{e=e.append(t);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:kl.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(i.lengthDecoder.bytes),e=new R8,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(pce),{mode:kl.LENGTH,chunk:t,buffer:e,data:pce}):{mode:kl.DATA,chunk:t,buffer:e,state:{dataLength:n},data:void 0}},[kl.DATA]:(t,e,r,i)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:kl.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:n}=r,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new R8,i.onData&&i.onData(s),{mode:kl.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function P8(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||Zet,maxLengthLength:t.maxLengthLength||dce,maxDataLength:t.maxDataLength||hce,onLength:t.onLength,onData:t.onData};return async function*(i){let n=new R8,s=kl.LENGTH,o;for await(let a of i){let c=a;for(;c;){let u=Jet[s](c,n,o,e);s=u.mode,c=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}P8.fromReader=(t,e)=>{let r=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return P8({...e||{},onLength:s=>{r=s}})(i)};WE.exports=P8;WE.exports.MAX_LENGTH_LENGTH=dce;WE.exports.MAX_DATA_LENGTH=hce});var mce=y((cqt,bce)=>{f();"use strict";var{Buffer:ett}=Vt(),gce=(t,e,r)=>(e=e||ett.allocUnsafe(4),e.writeInt32BE(t,r),e);gce.bytes=4;bce.exports=gce});var _ce=y((uqt,wce)=>{f();"use strict";var vce=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};vce.bytes=4;wce.exports=vce});var Wo=y(_d=>{f();"use strict";_d.encode=cce();_d.decode=yce();_d.varintEncode=A8();_d.varintDecode=T8();_d.int32BEEncode=mce();_d.int32BEDecode=_ce()});var YE=y((fqt,Ece)=>{f();Ece.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var xce=y((hqt,Sce)=>{f();Sce.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var tc=y((pqt,Ed)=>{f();var ttt=YE(),C8=xce(),Ace=(t,e,r)=>O8(t,Array.isArray(e)?e:[{signal:e,options:r}]),O8=(t,e)=>{t=ttt(t),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*r(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new C8(u,l)}let o=new Promise((a,c)=>{i=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:l,abortCode:d}=u;c(new C8(l,d))}});s=await Promise.race([o,t.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function"&&await t.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return r()},Ice=(t,e,r)=>Tce(t,Array.isArray(e)?e:[{signal:e,options:r}]),Tce=(t,e)=>r=>t(O8(r,e)),rtt=(t,e,r)=>itt(t,Array.isArray(e)?e:[{signal:e,options:r}]),itt=(t,e)=>({sink:Tce(t.sink,e),source:O8(t.source,e)});Ed.exports=Ace;Ed.exports.AbortError=C8;Ed.exports.source=Ace;Ed.exports.sink=Ice;Ed.exports.transform=Ice;Ed.exports.duplex=rtt});var qce=y((yqt,kce)=>{f();"use strict";var Rce=me(),ntt=Object.assign(Rce("libp2p-pubsub:peer-streams"),{error:Rce("libp2p-pubsub:peer-streams:err")}),{EventEmitter:stt}=yr(),Pce=Wo(),ott=ja(),{pipe:Cce}=Ar(),{source:att}=tc(),ctt=nf().default,Oce=class extends stt{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new ctt,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=att(Cce(this._rawInboundStream,Pce.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=ott({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),Cce(this.outboundStream,Pce.encode(),this._rawOutboundStream).catch(i=>{ntt.error(i)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};kce.exports=Oce});var Nce=y(Dce=>{f();"use strict";var utt={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};Dce.SignaturePolicy=utt});var k8=y((bqt,Lce)=>{f();"use strict";var ltt=hg(),{toString:ftt}=(tt(),et),{fromString:Bce}=(ft(),ht),Mce=rt(),{sha256:dtt}=(ri(),li),htt=()=>ltt(8),ptt=(t,e)=>{let r;t instanceof Uint8Array?r=Mce.createFromBytes(t).id:r=Mce.parse(t).id;let i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i},ytt=t=>dtt.encode(t),gtt=(t,e)=>{let r;Array.isArray(e)?r=i=>e.indexOf(i)>-1:r=i=>e.has(i);for(let i of t)if(r(i))return!0;return!1},btt=t=>Array.isArray(t)?t:[t],mtt=(t,e)=>{let r=Object.assign({},t);return t.from instanceof Uint8Array&&(r.from=ftt(t.from,"base58btc")),e&&(r.receivedFrom=e),r},vtt=t=>{let e=Object.assign({},t);return typeof t.from=="string"&&(e.from=Bce(t.from,"base58btc")),typeof t.data=="string"&&(e.data=Bce(t.data)),e};Lce.exports={randomSeqno:htt,msgId:ptt,noSignMsgId:ytt,anyMatch:gtt,ensureArray:btt,normalizeInRpcMessage:mtt,normalizeOutRpcMessage:vtt}});var Vce=y((mqt,jce)=>{f();"use strict";var q8=rt(),{RPC:Uce}=x8(),{concat:Fce}=(un(),cn),{fromString:wtt}=(ft(),ht),D8=wtt("libp2p-pubsub:"),{normalizeOutRpcMessage:_tt}=k8();async function Ett(t,e){let r=Fce([D8,Uce.Message.encode(_tt(e)).finish()]),i=await t.privKey.sign(r);return{...e,signature:i,key:t.pubKey.bytes}}async function Stt(t){if(!t.signature)throw new Error("Message must contain a signature to be verified");if(!t.from)throw new Error("Message must contain a from property to be verified");let e=Fce([D8,Uce.Message.encode({...t,from:q8.createFromB58String(t.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await Kce(t)).verify(e,t.signature)}async function Kce(t){if(!t.from)throw new Error("Could not get the public key from the originator id");let e=q8.createFromB58String(t.from);if(t.key){let r=await q8.createFromPubKey(t.key);if(r.equals(e))return r.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}jce.exports={messagePublicKey:Kce,signMessage:Ett,SignPrefix:D8,verifySignature:Stt}});var Gce=y((vqt,$ce)=>{f();"use strict";var zce=me(),{EventEmitter:xtt}=yr(),Zn=ue(),{pipe:Att}=Ar(),Itt=HE(),{codes:Yo}=$E(),{RPC:Hce}=x8(),Ttt=qce(),{SignaturePolicy:nu}=Nce(),ql=k8(),{signMessage:Rtt,verifySignature:Ptt}=Vce(),XE=class extends xtt{constructor({debugName:e,multicodecs:r,libp2p:i,globalSignaturePolicy:n=nu.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!r)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(zce(e),{err:zce(`${e}:error`)}),this.multicodecs=ql.ensureArray(r),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!nu[n])throw Zn(new Error("Invalid global signature policy"),Yo.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new Itt({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:r,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(r);this._processMessages(s,a,o)}async _onPeerConnected(e,r){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await r.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,r){let i=e.toB58String();this.log("connection ended",i,r?r.message:""),this._removePeer(e)}_addPeer(e,r){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new Ttt({id:e,protocol:r});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let r=e.toB58String(),i=this.peers.get(r);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",r),this.peers.delete(r);for(let n of this.topics.values())n.delete(r);return i}}async _processMessages(e,r,i){try{await Att(r,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);await this._processRpc(e,i,a)}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,r,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;if(n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",r.id,n)),!this._acceptFrom(e))return this.log("received message from unacceptable peer %s",e),!1;if(s.length)for(let o of s){if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");continue}let a=ql.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}return!0}_processRpcSubOpt(e,r){let i=r.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),r.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(r){this.log("Message is invalid, dropping it. %O",r);return}return this._emitMessage(e),this._publish(ql.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(r=>{this.subscriptions.has(r)&&this.emit(r,e)})}getMsgId(e){let r=this.globalSignaturePolicy;switch(r){case nu.StrictSign:return ql.msgId(e.from,e.seqno);case nu.StrictNoSign:return ql.noSignMsgId(e.data);default:throw Zn(new Error("Cannot get message id: unhandled signature policy: "+r),Yo.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return Hce.decode(e)}_encodeRpc(e){return Hce.encode(e).finish()}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(r))}_sendSubscriptions(e,r,i){return this._sendRpc(e,{subscriptions:r.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let r=this.globalSignaturePolicy;switch(r){case nu.StrictNoSign:if(e.from)throw Zn(new Error("StrictNoSigning: from should not be present"),Yo.ERR_UNEXPECTED_FROM);if(e.signature)throw Zn(new Error("StrictNoSigning: signature should not be present"),Yo.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw Zn(new Error("StrictNoSigning: key should not be present"),Yo.ERR_UNEXPECTED_KEY);if(e.seqno)throw Zn(new Error("StrictNoSigning: seqno should not be present"),Yo.ERR_UNEXPECTED_SEQNO);break;case nu.StrictSign:if(!e.signature)throw Zn(new Error("StrictSigning: Signing required and no signature was present"),Yo.ERR_MISSING_SIGNATURE);if(!e.seqno)throw Zn(new Error("StrictSigning: Signing required and no seqno was present"),Yo.ERR_MISSING_SEQNO);if(!await Ptt(e))throw Zn(new Error("StrictSigning: Invalid message signature"),Yo.ERR_INVALID_SIGNATURE);break;default:throw Zn(new Error("Cannot validate message: unhandled signature policy: "+r),Yo.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let r=this.globalSignaturePolicy;switch(r){case nu.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=ql.randomSeqno(),Rtt(this.peerId,e);case nu.StrictNoSign:return Promise.resolve(e);default:throw Zn(new Error("Cannot build message: unhandled signature policy: "+r),Yo.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw Zn(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw Zn(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let r=this.topics.get(e);return r?Array.from(r):[]}async publish(e,r){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,r);let n={receivedFrom:this.peerId.toB58String(),data:r,topicIDs:[e]},s=await this._buildMessage(n),o=ql.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw Zn(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};XE.utils=ql;XE.SignaturePolicy=nu;$ce.exports=XE});var Wce=y(QE=>{f();"use strict";Object.defineProperty(QE,"__esModule",{value:!0});QE.createGossipRpc=void 0;function Ctt(t=[],e={}){return{subscriptions:[],msgs:t,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}QE.createGossipRpc=Ctt});var Yce=y(ZE=>{f();"use strict";Object.defineProperty(ZE,"__esModule",{value:!0});ZE.shuffle=void 0;function Ott(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let i=e(),n=t[r];t[r]=t[i],t[i]=n}return t}ZE.shuffle=Ott});var Sd=y(Ce=>{f();"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.ERR_TOPIC_VALIDATOR_IGNORE=Ce.ERR_TOPIC_VALIDATOR_REJECT=Ce.TimeCacheDuration=Ce.GossipsubIWantFollowupTime=Ce.GossipsubMaxIHaveMessages=Ce.GossipsubMaxIHaveLength=Ce.GossipsubGraftFloodThreshold=Ce.GossipsubOpportunisticGraftPeers=Ce.GossipsubOpportunisticGraftTicks=Ce.GossipsubDirectConnectInitialDelay=Ce.GossipsubDirectConnectTicks=Ce.GossipsubConnectionTimeout=Ce.GossipsubMaxPendingConnections=Ce.GossipsubConnectors=Ce.GossipsubPruneBackoffTicks=Ce.GossipsubPruneBackoff=Ce.GossipsubPrunePeers=Ce.GossipsubFanoutTTL=Ce.GossipsubHeartbeatInterval=Ce.GossipsubHeartbeatInitialDelay=Ce.GossipsubGossipRetransmission=Ce.GossipsubGossipFactor=Ce.GossipsubDlazy=Ce.GossipsubHistoryGossip=Ce.GossipsubHistoryLength=Ce.GossipsubDout=Ce.GossipsubDscore=Ce.GossipsubDhi=Ce.GossipsubDlo=Ce.GossipsubD=Ce.GossipsubIDv11=Ce.GossipsubIDv10=Ce.FloodsubID=Ce.minute=Ce.second=void 0;Ce.second=1e3;Ce.minute=60*Ce.second;Ce.FloodsubID="/floodsub/1.0.0";Ce.GossipsubIDv10="/meshsub/1.0.0";Ce.GossipsubIDv11="/meshsub/1.1.0";Ce.GossipsubD=6;Ce.GossipsubDlo=4;Ce.GossipsubDhi=12;Ce.GossipsubDscore=4;Ce.GossipsubDout=2;Ce.GossipsubHistoryLength=5;Ce.GossipsubHistoryGossip=3;Ce.GossipsubDlazy=6;Ce.GossipsubGossipFactor=.25;Ce.GossipsubGossipRetransmission=3;Ce.GossipsubHeartbeatInitialDelay=100;Ce.GossipsubHeartbeatInterval=Ce.second;Ce.GossipsubFanoutTTL=Ce.minute;Ce.GossipsubPrunePeers=16;Ce.GossipsubPruneBackoff=Ce.minute;Ce.GossipsubPruneBackoffTicks=15;Ce.GossipsubConnectors=8;Ce.GossipsubMaxPendingConnections=128;Ce.GossipsubConnectionTimeout=30*Ce.second;Ce.GossipsubDirectConnectTicks=300;Ce.GossipsubDirectConnectInitialDelay=Ce.second;Ce.GossipsubOpportunisticGraftTicks=60;Ce.GossipsubOpportunisticGraftPeers=2;Ce.GossipsubGraftFloodThreshold=10*Ce.second;Ce.GossipsubMaxIHaveLength=5e3;Ce.GossipsubMaxIHaveMessages=10;Ce.GossipsubIWantFollowupTime=3*Ce.second;Ce.TimeCacheDuration=120*1e3;Ce.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Ce.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var Qce=y(JE=>{f();"use strict";Object.defineProperty(JE,"__esModule",{value:!0});JE.hasGossipProtocol=void 0;var Xce=Sd();function ktt(t){return t===Xce.GossipsubIDv10||t===Xce.GossipsubIDv11}JE.hasGossipProtocol=ktt});var Zce=y(eS=>{f();"use strict";Object.defineProperty(eS,"__esModule",{value:!0});eS.messageIdToString=void 0;var qtt=(tt(),et);function Dtt(t){return qtt.toString(t,"base64")}eS.messageIdToString=Dtt});var xd=y(rc=>{f();"use strict";var Ntt=rc&&rc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),tS=rc&&rc.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Ntt(e,t,r)};Object.defineProperty(rc,"__esModule",{value:!0});tS(Wce(),rc);tS(Yce(),rc);tS(Qce(),rc);tS(Zce(),rc)});var eue=y(m0=>{f();"use strict";var Btt=m0&&m0.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};Object.defineProperty(m0,"__esModule",{value:!0});m0.MessageCache=void 0;var rS=xd(),Jce=class{constructor(e,r,i){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<r;n++)this.history[n]=[];this.gossip=e,this.msgIdFn=i}put(e){return Btt(this,void 0,void 0,function*(){let r=yield this.getMsgId(e),i=rS.messageIdToString(r);this.msgs.set(i,e),this.history[0].push({msgID:r,topics:e.topicIDs})})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(rS.messageIdToString(e))}getForPeer(e,r){let i=rS.messageIdToString(e),n=this.msgs.get(i);if(!n)return[void 0,0];let s=this.peertx.get(i);s||(s=new Map,this.peertx.set(i,s));let o=(s.get(r)||0)+1;return s.set(r,o),[n,o]}getGossipIDs(e){let r=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){r.push(n.msgID);break}});return r}shift(){this.history[this.history.length-1].forEach(r=>{let i=rS.messageIdToString(r.msgID);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};m0.MessageCache=Jce});var rue=y((tue,k1)=>{f();(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof oa=="function"&&typeof k1=="object"&&k1&&k1.exports&&(k1.exports=e(ki()))})(tue,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots.default||(t.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)n.RPC.SubOpts.encode(c.subscriptions[l],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var l=0;l<c.msgs.length;++l)n.RPC.Message.encode(c.msgs[l],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.RPC;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.subscriptions&&d.subscriptions.length||(d.subscriptions=[]),d.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:d.msgs&&d.msgs.length||(d.msgs=[]),d.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:d.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return d},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[l]=n.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var l=0;l<c.msgs.length;++l){if(typeof c.msgs[l]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[l]=n.RPC.Message.fromObject(c.msgs[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.subscriptions=[],l.msgs=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var d=0;d<c.subscriptions.length;++d)l.subscriptions[d]=n.RPC.SubOpts.toObject(c.subscriptions[d],u)}if(c.msgs&&c.msgs.length){l.msgs=[];for(var d=0;d<c.msgs.length;++d)l.msgs[d]=n.RPC.Message.toObject(c.msgs[d],u)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=r.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&d.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(18).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.SubOpts;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.subscribe=l.bool();break;case 2:p.topicID=l.string();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.SubOpts)return l;var d=new n.RPC.SubOpts;return l.subscribe!=null&&(d.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(h.subscribe=l.subscribe,d.oneofs&&(h._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=r.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&d.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&d.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&d.uint32(26).bytes(l.seqno),l.topicIDs!=null&&l.topicIDs.length)for(var h=0;h<l.topicIDs.length;++h)d.uint32(34).string(l.topicIDs[h]);return l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&d.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&d.uint32(50).bytes(l.key),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.Message;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.from=l.bytes();break;case 2:p.data=l.bytes();break;case 3:p.seqno=l.bytes();break;case 4:p.topicIDs&&p.topicIDs.length||(p.topicIDs=[]),p.topicIDs.push(l.string());break;case 5:p.signature=l.bytes();break;case 6:p.key=l.bytes();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.Message)return l;var d=new n.RPC.Message;if(l.from!=null&&(typeof l.from=="string"?i.base64.decode(l.from,d.from=i.newBuffer(i.base64.length(l.from)),0):l.from.length&&(d.from=l.from)),l.data!=null&&(typeof l.data=="string"?i.base64.decode(l.data,d.data=i.newBuffer(i.base64.length(l.data)),0):l.data.length&&(d.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?i.base64.decode(l.seqno,d.seqno=i.newBuffer(i.base64.length(l.seqno)),0):l.seqno.length&&(d.seqno=l.seqno)),l.topicIDs){if(!Array.isArray(l.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");d.topicIDs=[];for(var h=0;h<l.topicIDs.length;++h)d.topicIDs[h]=String(l.topicIDs[h])}return l.signature!=null&&(typeof l.signature=="string"?i.base64.decode(l.signature,d.signature=i.newBuffer(i.base64.length(l.signature)),0):l.signature.length&&(d.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?i.base64.decode(l.key,d.key=i.newBuffer(i.base64.length(l.key)),0):l.key.length&&(d.key=l.key)),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.topicIDs=[]),l.from!=null&&l.hasOwnProperty("from")&&(h.from=d.bytes===String?i.base64.encode(l.from,0,l.from.length):d.bytes===Array?Array.prototype.slice.call(l.from):l.from,d.oneofs&&(h._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(h.data=d.bytes===String?i.base64.encode(l.data,0,l.data.length):d.bytes===Array?Array.prototype.slice.call(l.data):l.data,d.oneofs&&(h._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(h.seqno=d.bytes===String?i.base64.encode(l.seqno,0,l.seqno.length):d.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,d.oneofs&&(h._seqno="seqno")),l.topicIDs&&l.topicIDs.length){h.topicIDs=[];for(var p=0;p<l.topicIDs.length;++p)h.topicIDs[p]=l.topicIDs[p]}return l.signature!=null&&l.hasOwnProperty("signature")&&(h.signature=d.bytes===String?i.base64.encode(l.signature,0,l.signature.length):d.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,d.oneofs&&(h._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(h.key=d.bytes===String?i.base64.encode(l.key,0,l.key.length):d.bytes===Array?Array.prototype.slice.call(l.key):l.key,d.oneofs&&(h._key="key")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(u,l){if(l||(l=r.create()),u.ihave!=null&&u.ihave.length)for(var d=0;d<u.ihave.length;++d)n.RPC.ControlIHave.encode(u.ihave[d],l.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var d=0;d<u.iwant.length;++d)n.RPC.ControlIWant.encode(u.iwant[d],l.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var d=0;d<u.graft.length;++d)n.RPC.ControlGraft.encode(u.graft[d],l.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var d=0;d<u.prune.length;++d)n.RPC.ControlPrune.encode(u.prune[d],l.uint32(34).fork()).ldelim();return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlMessage;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var l=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var d=0;d<u.ihave.length;++d){if(typeof u.ihave[d]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[d]=n.RPC.ControlIHave.fromObject(u.ihave[d])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var d=0;d<u.iwant.length;++d){if(typeof u.iwant[d]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[d]=n.RPC.ControlIWant.fromObject(u.iwant[d])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var d=0;d<u.graft.length;++d){if(typeof u.graft[d]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[d]=n.RPC.ControlGraft.fromObject(u.graft[d])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var d=0;d<u.prune.length;++d){if(typeof u.prune[d]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[d]=n.RPC.ControlPrune.fromObject(u.prune[d])}}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.ihave=[],d.iwant=[],d.graft=[],d.prune=[]),u.ihave&&u.ihave.length){d.ihave=[];for(var h=0;h<u.ihave.length;++h)d.ihave[h]=n.RPC.ControlIHave.toObject(u.ihave[h],l)}if(u.iwant&&u.iwant.length){d.iwant=[];for(var h=0;h<u.iwant.length;++h)d.iwant[h]=n.RPC.ControlIWant.toObject(u.iwant[h],l)}if(u.graft&&u.graft.length){d.graft=[];for(var h=0;h<u.graft.length;++h)d.graft[h]=n.RPC.ControlGraft.toObject(u.graft[h],l)}if(u.prune&&u.prune.length){d.prune=[];for(var h=0;h<u.prune.length;++h)d.prune[h]=n.RPC.ControlPrune.toObject(u.prune[h],l)}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)d.uint32(18).bytes(l.messageIDs[h]);return d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlIHave;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.topicID=l.string();break;case 2:p.messageIDs&&p.messageIDs.length||(p.messageIDs=[]),p.messageIDs.push(l.bytes());break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlIHave)return l;var d=new n.RPC.ControlIHave;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");d.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?i.base64.decode(l.messageIDs[h],d.messageIDs[h]=i.newBuffer(i.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(d.messageIDs[h]=l.messageIDs[h])}return d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var p=0;p<l.messageIDs.length;++p)h.messageIDs[p]=d.bytes===String?i.base64.encode(l.messageIDs[p],0,l.messageIDs[p].length):d.bytes===Array?Array.prototype.slice.call(l.messageIDs[p]):l.messageIDs[p]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(u,l){if(l||(l=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var d=0;d<u.messageIDs.length;++d)l.uint32(10).bytes(u.messageIDs[d]);return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlIWant;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var l=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)typeof u.messageIDs[d]=="string"?i.base64.decode(u.messageIDs[d],l.messageIDs[d]=i.newBuffer(i.base64.length(u.messageIDs[d])),0):u.messageIDs[d].length&&(l.messageIDs[d]=u.messageIDs[d])}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.messageIDs=[]),u.messageIDs&&u.messageIDs.length){d.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)d.messageIDs[h]=l.bytes===String?i.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):l.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlGraft;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.topicID=l.string();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlGraft)return l;var d=new n.RPC.ControlGraft;return l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var h=0;h<l.peers.length;++h)n.RPC.PeerInfo.encode(l.peers[h],d.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&d.uint32(24).uint64(l.backoff),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlPrune;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.topicID=l.string();break;case 2:p.peers&&p.peers.length||(p.peers=[]),p.peers.push(n.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:p.backoff=l.uint64();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlPrune)return l;var d=new n.RPC.ControlPrune;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");d.peers=[];for(var h=0;h<l.peers.length;++h){if(typeof l.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");d.peers[h]=n.RPC.PeerInfo.fromObject(l.peers[h])}}return l.backoff!=null&&(i.Long?(d.backoff=i.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?d.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?d.backoff=l.backoff:typeof l.backoff=="object"&&(d.backoff=new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.peers&&l.peers.length){h.peers=[];for(var p=0;p<l.peers.length;++p)h.peers[p]=n.RPC.PeerInfo.toObject(l.peers[p],d)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?h.backoff=d.longs===String?String(l.backoff):l.backoff:h.backoff=d.longs===String?i.Long.prototype.toString.call(l.backoff):d.longs===Number?new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,d.oneofs&&(h._backoff="backoff")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=r.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&d.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&d.uint32(18).bytes(l.signedPeerRecord),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.PeerInfo;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.peerID=l.bytes();break;case 2:p.signedPeerRecord=l.bytes();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.PeerInfo)return l;var d=new n.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?i.base64.decode(l.peerID,d.peerID=i.newBuffer(i.base64.length(l.peerID)),0):l.peerID.length&&(d.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?i.base64.decode(l.signedPeerRecord,d.signedPeerRecord=i.newBuffer(i.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(d.signedPeerRecord=l.signedPeerRecord)),d},a.toObject=function(l,d){d||(d={});var h={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(h.peerID=d.bytes===String?i.base64.encode(l.peerID,0,l.peerID.length):d.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,d.oneofs&&(h._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=d.bytes===String?i.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):d.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,d.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s}(),n})});var N8=y(iS=>{f();"use strict";Object.defineProperty(iS,"__esModule",{value:!0});iS.getGossipPeers=void 0;var iue=xd();function Mtt(t,e,r,i=()=>!0){let n=t.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=t.peers.get(o);!a||iue.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=iue.shuffle(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}iS.getGossipPeers=Mtt});var sue=y(ic=>{f();"use strict";var Ltt=ic&&ic.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Utt=ic&&ic.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ftt=ic&&ic.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ltt(e,t,r);return Utt(e,t),e};Object.defineProperty(ic,"__esModule",{value:!0});ic.Heartbeat=void 0;var q1=Ftt(Sd()),nS=N8(),Ktt=xd(),nue=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),r=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,q1.GossipsubHeartbeatInterval)},q1.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(r),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:r,Dhi:i,Dscore:n,Dout:s}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let o=new Map,a=h=>{let p=o.get(h);return p===void 0&&(p=this.gossipsub.score.score(h),o.set(h,p)),p},c=new Map,u=new Map,l=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((h,p)=>{let g=E=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",E,p),this.gossipsub.score.prune(E,p),this.gossipsub._addBackoff(E,p),h.delete(E);let v=u.get(E);v?v.push(p):u.set(E,[p])},m=E=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",E,p),this.gossipsub.score.graft(E,p),h.add(E);let v=c.get(E);v?v.push(p):c.set(E,[p])};if(h.forEach(E=>{let v=a(E);v<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",E,v,p),g(E),l.set(E,!0))}),h.size<r){let E=this.gossipsub.backoff.get(p),v=e-h.size;nS.getGossipPeers(this.gossipsub,p,v,R=>!h.has(R)&&!this.gossipsub.direct.has(R)&&(!E||!E.has(R))&&a(R)>=0).forEach(m)}if(h.size>i){let E=Array.from(h);E.sort((A,R)=>a(R)-a(A)),E=E.slice(0,n).concat(Ktt.shuffle(E.slice(n)));let v=0;if(E.slice(0,e).forEach(A=>{this.gossipsub.outbound.get(A)&&v++}),v<s){let A=F=>{let q=E[F];for(let D=F;D>0;D--)E[D]=E[D-1];E[0]=q};if(v>0){let F=v;for(let q=1;q<e&&F>0;q++)this.gossipsub.outbound.get(E[q])&&(A(q),F--)}let R=e-v;for(let F=e;F<E.length&&R>0;F++)this.gossipsub.outbound.get(E[F])&&(A(F),R--)}E.slice(e).forEach(g)}if(h.size>=r){let E=0;if(h.forEach(v=>{this.gossipsub.outbound.get(v)&&E++}),E<s){let v=s-E,A=this.gossipsub.backoff.get(p);nS.getGossipPeers(this.gossipsub,p,v,R=>!h.has(R)&&!this.gossipsub.direct.has(R)&&(!A||!A.has(R))&&a(R)>=0).forEach(m)}}if(this.gossipsub.heartbeatTicks%q1.GossipsubOpportunisticGraftTicks==0&&h.size>1){let E=Array.from(h).sort((R,F)=>a(R)-a(F)),v=h.size/2,A=a(E[v]);if(A<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let R=this.gossipsub.backoff.get(p);nS.getGossipPeers(this.gossipsub,p,q1.GossipsubOpportunisticGraftPeers,q=>h.has(q)&&!this.gossipsub.direct.has(q)&&(!R||!R.has(q))&&a(q)>A).forEach(q=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",q,p),m(q)})}}this.gossipsub._emitGossip(p,h)});let d=this.gossipsub._now();this.gossipsub.lastpub.forEach((h,p)=>{h+q1.GossipsubFanoutTTL<d&&(this.gossipsub.fanout.delete(p),this.gossipsub.lastpub.delete(p))}),this.gossipsub.fanout.forEach((h,p)=>{let g=this.gossipsub.topics.get(p);if(h.forEach(m=>{(!g.has(m)||a(m)<this.gossipsub._options.scoreThresholds.publishThreshold)&&h.delete(m)}),h.size<e){let m=e-h.size;nS.getGossipPeers(this.gossipsub,p,m,v=>!h.has(v)&&!this.gossipsub.direct.has(v)&&a(v)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(v=>{h.add(v)})}this.gossipsub._emitGossip(p,h)}),this.gossipsub._sendGraftPrune(c,u,l),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};ic.Heartbeat=nue});var B8=y(v0=>{f();"use strict";Object.defineProperty(v0,"__esModule",{value:!0});v0.ERR_INVALID_PEER_SCORE_THRESHOLDS=v0.ERR_INVALID_PEER_SCORE_PARAMS=void 0;v0.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";v0.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var M8=y(mn=>{f();"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.validateTopicScoreParams=mn.validatePeerScoreParams=mn.createTopicScoreParams=mn.createPeerScoreParams=mn.defaultTopicScoreParams=mn.defaultPeerScoreParams=void 0;var tr=B8(),rr=ue();mn.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};mn.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function jtt(t={}){return Object.assign(Object.assign(Object.assign({},mn.defaultPeerScoreParams),t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=oue(i),e),{}):{}})}mn.createPeerScoreParams=jtt;function oue(t={}){return Object.assign(Object.assign({},mn.defaultTopicScoreParams),t)}mn.createTopicScoreParams=oue;function Vtt(t){for(let[e,r]of Object.entries(t.topics))try{aue(r)}catch(i){throw rr(new Error(`invalid score parameters for topic ${e}: ${i.message}`),tr.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw rr(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw rr(new Error("missing application specific score function"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw rr(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw rr(new Error("invalid IPColocationFactorThreshold; must be at least 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw rr(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw rr(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw rr(new Error("invalid DecayInterval; must be at least 1s"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw rr(new Error("invalid DecayToZero; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS)}mn.validatePeerScoreParams=Vtt;function aue(t){if(t.topicWeight<0)throw rr(new Error("invalid topic weight; must be >= 0"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw rr(new Error("invalid TimeInMeshQuantum; must be non zero"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw rr(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw rr(new Error("invalid TimeInMeshQuantum; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw rr(new Error("invalid TimeInMeshCap; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw rr(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw rr(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw rr(new Error("invalid FirstMessageDeliveriesCap; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw rr(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw rr(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw rr(new Error("invalid MeshMessageDeliveriesCap; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw rr(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw rr(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw rr(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw rr(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw rr(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw rr(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw rr(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS)}mn.validateTopicScoreParams=aue});var cue=y(su=>{f();"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.validatePeerScoreThresholds=su.createPeerScoreThresholds=su.defaultPeerScoreThresholds=void 0;var D1=B8(),N1=ue();su.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function ztt(t={}){return Object.assign(Object.assign({},su.defaultPeerScoreThresholds),t)}su.createPeerScoreThresholds=ztt;function Htt(t){if(t.gossipThreshold>0)throw N1(new Error("invalid gossip threshold; it must be <= 0"),D1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw N1(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),D1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw N1(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),D1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw N1(new Error("invalid accept PX threshold; it must be >= 0"),D1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw N1(new Error("invalid opportunistic grafting threshold; it must be >= 0"),D1.ERR_INVALID_PEER_SCORE_THRESHOLDS)}su.validatePeerScoreThresholds=Htt});var uue=y(Dl=>{f();"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});Dl.ensureTopicStats=Dl.createTopicStats=Dl.createPeerStats=void 0;function $tt(t={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=L8(i),e),{}):{}})}Dl.createPeerStats=$tt;function L8(t={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t)}Dl.createTopicStats=L8;function Gtt(t,e,r){let i=e.topics[t];if(i)return i;if(!!r.topics[t])return e.topics[t]=i=L8(),i}Dl.ensureTopicStats=Gtt});var lue=y(sS=>{f();"use strict";Object.defineProperty(sS,"__esModule",{value:!0});sS.computeScore=void 0;function Wtt(t,e,r,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=r.topics[a];if(!u)return;let l=0;if(c.inMesh){let g=c.meshTime/u.timeInMeshQuantum;g>u.timeInMeshCap&&(g=u.timeInMeshCap),l+=g*u.timeInMeshWeight}if(l+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let g=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;l+=g*g*u.meshMessageDeliveriesWeight}l+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,l+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=l*u.topicWeight}),r.topicScoreCap>0&&n>r.topicScoreCap&&(n=r.topicScoreCap),n+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(a=>{if(r.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),u=c?c.size:0;if(u>r.IPColocationFactorThreshold){let l=u-r.IPColocationFactorThreshold;n+=l*l*r.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,n}sS.computeScore=Wtt});var due=y((Dqt,fue)=>{f();"use strict";function zr(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}zr.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};zr.prototype.get=function(e){return this.peekAt(e)};zr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};zr.prototype.peekFront=function(){return this.peek()};zr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(zr.prototype,"length",{get:function(){return this.size()}});zr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};zr.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};zr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};zr.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};zr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),i}};zr.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<i/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};zr.prototype.remove=function(e,r){var i=e,n,s=r;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||r<1)){if(i<0&&(i+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+r>=o)return n=this.toArray(),this.clear(),n;i+r>o&&(r=o-i);var c;for(n=new Array(r),c=0;c<r;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};zr.prototype.splice=function(e,r){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,l=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,r),this._head=this._head+i+u&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+r));var d=o.length;for(s=0;s<d;s++)o[s]=this._list[this._head+i+r+s&this._capacityMask];for(r===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,r),this._tail=this._tail-d+u&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<d;s++)this.push(o[s])}return a}else return this.remove(i,r)}};zr.prototype.clear=function(){this._head=0,this._tail=0};zr.prototype.isEmpty=function(){return this._head===this._tail};zr.prototype.toArray=function(){return this._copyArray(!1)};zr.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};zr.prototype._copyArray=function(e){var r=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)r.push(i[s]);for(s=0;s<this._tail;s++)r.push(i[s])}else for(s=this._head;s<this._tail;s++)r.push(i[s]);return r};zr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};zr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};fue.exports=zr});var yue=y(ou=>{f();"use strict";var Ytt=ou&&ou.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ou,"__esModule",{value:!0});ou.MessageDeliveries=ou.DeliveryRecordStatus=void 0;var Xtt=Sd(),Qtt=Ytt(due()),Ztt=xd(),hue;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(hue=ou.DeliveryRecordStatus||(ou.DeliveryRecordStatus={}));var pue=class{constructor(){this.records=new Map,this.queue=new Qtt.default}ensureRecord(e){let r=Ztt.messageIdToString(e),i=this.records.get(r);if(i)return i;i={status:hue.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(r,i);let n={msgId:r,expire:Date.now()+Xtt.TimeCacheDuration};return this.queue.push(n),i}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};ou.MessageDeliveries=pue});var bue=y(Nl=>{f();"use strict";var oS=Nl&&Nl.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(t,e||[])).next())})},Jtt=Nl&&Nl.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Nl,"__esModule",{value:!0});Nl.PeerScore=void 0;var ert=M8(),w0=uue(),trt=lue(),Xo=yue(),rrt=Sd(),irt=Jtt(rt()),nrt=me(),srt=$E(),{ERR_INVALID_SIGNATURE:ort,ERR_MISSING_SIGNATURE:art}=srt.codes,_0=nrt("libp2p:gossipsub:score"),gue=class{constructor(e,r,i){ert.validatePeerScoreParams(e),this.params=e,this._connectionManager=r,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new Xo.MessageDeliveries,this.msgId=i}start(){if(this._backgroundInterval){_0("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),_0("started")}stop(){if(!this._backgroundInterval){_0("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),_0("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<r&&(i.behaviourPenalty=0)})}score(e){let r=this.peerStats.get(e);return r?trt.computeScore(e,r,this.params,this.peerIPs):0}addPenalty(e,r){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=r)}addPeer(e){let r=w0.createPeerStats({connected:!0});this.peerStats.set(e,r);let i=this._getIPs(e);this._setIPs(e,i,r.ips),r.ips=i}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this._removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let i=this.peerStats.get(e);if(!i)return;let n=w0.ensureTopicStats(r,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}prune(e,r){let i=this.peerStats.get(e);if(!i)return;let n=w0.ensureTopicStats(r,i,this.params);if(!n)return;let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}validateMessage(e){return oS(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(yield this.msgId(e))})}deliverMessage(e){return oS(this,void 0,void 0,function*(){let r=e.receivedFrom;this._markFirstMessageDelivery(r,e);let i=this.deliveryRecords.ensureRecord(yield this.msgId(e)),n=Date.now();if(i.status!==Xo.DeliveryRecordStatus.unknown){_0("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",r,n-i.firstSeen,Xo.DeliveryRecordStatus[i.status]);return}i.status=Xo.DeliveryRecordStatus.valid,i.validated=n,i.peers.forEach(s=>{s!==r&&this._markDuplicateMessageDelivery(s,e)})})}rejectMessage(e,r){return oS(this,void 0,void 0,function*(){let i=e.receivedFrom;switch(r){case art:case ort:this._markInvalidMessageDelivery(i,e);return}let n=this.deliveryRecords.ensureRecord(yield this.msgId(e));if(n.status!==Xo.DeliveryRecordStatus.unknown){_0("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-n.firstSeen,Xo.DeliveryRecordStatus[n.status]);return}switch(r){case rrt.ERR_TOPIC_VALIDATOR_IGNORE:n.status=Xo.DeliveryRecordStatus.ignored;return}n.status=Xo.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),n.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})})}duplicateMessage(e){return oS(this,void 0,void 0,function*(){let r=e.receivedFrom,i=this.deliveryRecords.ensureRecord(yield this.msgId(e));if(!i.peers.has(r))switch(i.status){case Xo.DeliveryRecordStatus.unknown:i.peers.add(r);break;case Xo.DeliveryRecordStatus.valid:i.peers.add(r),this._markDuplicateMessageDelivery(r,e,i.validated);break;case Xo.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(r,e);break}})}_markInvalidMessageDelivery(e,r){let i=this.peerStats.get(e);!i||r.topicIDs.forEach(n=>{let s=w0.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,r){let i=this.peerStats.get(e);!i||r.topicIDs.forEach(n=>{let s=w0.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,r,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;r.topicIDs.forEach(o=>{let a=w0.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)})}_getIPs(e){return this._connectionManager.getAll(irt.default.createFromB58String(e)).map(r=>r.remoteAddr.toOptions().host)}_setIPs(e,r,i){e:for(let n of r){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of r)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}_removeIPs(e,r){r.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}_updateIPs(){this.peerStats.forEach((e,r)=>{let i=this._getIPs(r);this._setIPs(r,i,e.ips),e.ips=i})}};Nl.PeerScore=gue});var mue=y(au=>{f();"use strict";var crt=au&&au.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),U8=au&&au.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&crt(e,t,r)};Object.defineProperty(au,"__esModule",{value:!0});U8(M8(),au);U8(cue(),au);U8(bue(),au)});var _ue=y(E0=>{f();"use strict";var vue=E0&&E0.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(t,e||[])).next())})};Object.defineProperty(E0,"__esModule",{value:!0});E0.IWantTracer=void 0;var urt=Sd(),F8=xd(),lrt=$E(),{ERR_INVALID_SIGNATURE:frt,ERR_MISSING_SIGNATURE:drt}=lrt.codes,wue=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,r){let i=Math.floor(Math.random()*r.length),n=r[i],s=F8.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+urt.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),r=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(r.set(o,(r.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),r}deliverMessage(e){return vue(this,void 0,void 0,function*(){let r=yield this.getMsgId(e),i=F8.messageIdToString(r);this.promises.delete(i)})}rejectMessage(e,r){return vue(this,void 0,void 0,function*(){switch(r){case frt:case drt:return}let i=yield this.getMsgId(e),n=F8.messageIdToString(i);this.promises.delete(n)})}clear(){this.promises.clear()}};E0.IWantTracer=wue});var Iue=y((Uqt,Aue)=>{f();var Eue="Expected a function",Sue=0/0,hrt="[object Symbol]",prt=/^\s+|\s+$/g,yrt=/^[-+]0x[0-9a-f]+$/i,grt=/^0b[01]+$/i,brt=/^0o[0-7]+$/i,mrt=parseInt,vrt=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,wrt=typeof self=="object"&&self&&self.Object===Object&&self,_rt=vrt||wrt||Function("return this")(),Ert=Object.prototype,Srt=Ert.toString,xrt=Math.max,Art=Math.min,K8=function(){return _rt.Date.now()};function Irt(t,e,r){var i,n,s,o,a,c,u=0,l=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(Eue);e=xue(e)||0,aS(r)&&(l=!!r.leading,d="maxWait"in r,s=d?xrt(xue(r.maxWait)||0,e):s,h="trailing"in r?!!r.trailing:h);function p(D){var z=i,G=n;return i=n=void 0,u=D,o=t.apply(G,z),o}function g(D){return u=D,a=setTimeout(v,e),l?p(D):o}function m(D){var z=D-c,G=D-u,Y=e-z;return d?Art(Y,s-G):Y}function E(D){var z=D-c,G=D-u;return c===void 0||z>=e||z<0||d&&G>=s}function v(){var D=K8();if(E(D))return A(D);a=setTimeout(v,m(D))}function A(D){return a=void 0,h&&i?p(D):(i=n=void 0,o)}function R(){a!==void 0&&clearTimeout(a),u=0,i=c=n=a=void 0}function F(){return a===void 0?o:A(K8())}function q(){var D=K8(),z=E(D);if(i=arguments,n=this,c=D,z){if(a===void 0)return g(c);if(d)return a=setTimeout(v,e),p(c)}return a===void 0&&(a=setTimeout(v,e)),o}return q.cancel=R,q.flush=F,q}function Trt(t,e,r){var i=!0,n=!0;if(typeof t!="function")throw new TypeError(Eue);return aS(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),Irt(t,e,{leading:i,maxWait:e,trailing:n})}function aS(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Rrt(t){return!!t&&typeof t=="object"}function Prt(t){return typeof t=="symbol"||Rrt(t)&&Srt.call(t)==hrt}function xue(t){if(typeof t=="number")return t;if(Prt(t))return Sue;if(aS(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=aS(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(prt,"");var r=grt.test(t);return r||brt.test(t)?mrt(t.slice(2),r?2:8):yrt.test(t)?Sue:+t}Aue.exports=Trt});var Pue=y((Tue,Rue)=>{f();"use strict";var Crt=Iue();Tue=Rue.exports=j8;function j8(t){if(!(this instanceof j8))return new j8(t);t=t||{};let e=t.validity||30,r=new Map,i=Crt(()=>{r.forEach((n,s)=>{let o=n.validity||e;Ort(n.timestamp)>o&&r.delete(s)})},200);this.put=(n,s,o)=>{this.has(n)||r.set(n,{value:s,timestamp:new Date,validity:o}),i()},this.get=n=>{if(r.has(n))return r.get(n).value;throw new Error("key does not exist")},this.has=n=>r.has(n)}function Ort(t){let r=new Date().getTime()-t.getTime();return Math.floor(r/1e3)}});var yi=y(V8=>{f();"use strict";V8.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"};V8.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var kue=y((Kqt,Oue)=>{f();"use strict";var S0=ki(),Cue=S0.Reader,krt=S0.Writer,_r=S0.util,B1=S0.roots["libp2p-envelope"]||(S0.roots["libp2p-envelope"]={});B1.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.publicKey=_r.newBuffer([]),t.prototype.payloadType=_r.newBuffer([]),t.prototype.payload=_r.newBuffer([]),t.prototype.signature=_r.newBuffer([]),t.encode=function(r,i){return i||(i=krt.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&i.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&i.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(42).bytes(r.signature),i},t.decode=function(r,i){r instanceof Cue||(r=Cue.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new B1.Envelope;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof B1.Envelope)return r;var i=new B1.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?_r.base64.decode(r.publicKey,i.publicKey=_r.newBuffer(_r.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?_r.base64.decode(r.payloadType,i.payloadType=_r.newBuffer(_r.base64.length(r.payloadType)),0):r.payloadType.length&&(i.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?_r.base64.decode(r.payload,i.payload=_r.newBuffer(_r.base64.length(r.payload)),0):r.payload.length&&(i.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?_r.base64.decode(r.signature,i.signature=_r.newBuffer(_r.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=_r.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=_r.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=_r.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=_r.newBuffer(n.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?_r.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?_r.base64.encode(r.payloadType,0,r.payloadType.length):i.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(n.payload=i.bytes===String?_r.base64.encode(r.payload,0,r.payload.length):i.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?_r.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,S0.util.toJSONOptions)},t}();Oue.exports=B1});var M1=y((jqt,Nue)=>{f();"use strict";var qrt=ue(),{concat:Drt}=(un(),cn),{fromString:Nrt}=(ft(),ht),Brt=vw(),Mrt=rt(),z8=ss(),{equals:cS}=(di(),fi),{codes:Lrt}=yi(),{Envelope:que}=kue(),Bl=class{constructor({peerId:e,payloadType:r,payload:i,signature:n}){this.peerId=e,this.payloadType=r,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=Brt.marshalPublicKey(this.peerId.pubKey);return this._marshal=que.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return cS(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&cS(this.payloadType,e.payloadType)&&cS(this.payload,e.payload)&&cS(this.signature,e.signature)}validate(e){let r=Due(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},Due=(t,e,r)=>{let i=Nrt(t),n=z8.encode(i.byteLength),s=z8.encode(e.length),o=z8.encode(r.length);return Drt([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),r])};Bl.createFromProtobuf=async t=>{let e=que.decode(t),r=await Mrt.createFromPubKey(e.publicKey);return new Bl({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Bl.seal=async(t,e)=>{let r=t.domain,i=t.codec,n=t.marshal(),s=Due(r,i,n),o=await e.privKey.sign(s);return new Bl({peerId:e,payloadType:i,payload:n,signature:o})};Bl.openAndCertify=async(t,e)=>{let r=await Bl.createFromProtobuf(t);if(!await r.validate(e))throw qrt(new Error("envelope signature is not valid for the given domain"),Lrt.ERR_SIGNATURE_NOT_VALID);return r};Nue.exports=Bl});var X8=y((cu,Mue)=>{f();"use strict";var Urt=cu&&cu.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Frt=cu&&cu.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bue=cu&&cu.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Urt(e,t,r);return Frt(e,t),e},x0=cu&&cu.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(t,e||[])).next())})},H8=Bue(Gce()),Krt=eue(),$8=rue(),Nt=Bue(Sd()),jrt=sue(),uS=N8(),zi=xd(),G8=mue(),Vrt=_ue(),zrt=Pue(),W8=rt(),Hrt=M1(),Y8=class extends H8.default{constructor(e,r={}){let i=[Nt.GossipsubIDv11,Nt.GossipsubIDv10],n=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:Nt.GossipsubD,Dlo:Nt.GossipsubDlo,Dhi:Nt.GossipsubDhi,Dscore:Nt.GossipsubDscore,Dout:Nt.GossipsubDout,Dlazy:Nt.GossipsubDlazy},r),{scoreParams:G8.createPeerScoreParams(r.scoreParams),scoreThresholds:G8.createPeerScoreThresholds(r.scoreThresholds)});n.fallbackToFloodsub&&i.push(Nt.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},n));this._options=n,this.direct=new Set(n.directPeers.map(s=>s.id.toB58String())),n.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new zrt,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=r.messageCache||new Krt.MessageCache(Nt.GossipsubHistoryGossip,Nt.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new jrt.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new Vrt.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new G8.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return $8.RPC.decode(e)}_encodeRpc(e){return $8.RPC.encode(e).finish()}_addPeer(e,r){let i=super._addPeer(e,r);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>r===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let r=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),r}_processRpc(e,r,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return x0(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,r,i))?(i.control&&this._processRpcControlMessage(e,i.control),!0):!1})}_processRpcControlMessage(e,r){if(!r)return;let i=r.ihave?this._handleIHave(e,r.ihave):[],n=r.iwant?this._handleIWant(e,r.iwant):[],s=r.graft?this._handleGraft(e,r.graft):[];if(r.prune&&this._handlePrune(e,r.prune),!i.length&&!n.length&&!s.length)return;let o=zi.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let r=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return x0(this,void 0,void 0,function*(){let i=yield this.getMsgId(e),n=zi.messageIdToString(i);if(this.seenCache.has(n)){this.score.duplicateMessage(e);return}this.seenCache.put(n),yield this.score.validateMessage(e),yield r._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let r=Object.create(null,{validate:{get:()=>super.validate}});return x0(this,void 0,void 0,function*(){try{yield r.validate.call(this,e)}catch(i){throw this.score.rejectMessage(e,i.code),this.gossipTracer.rejectMessage(e,i.code),i}})}_handleIHave(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>Nt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=Nt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:l})=>{!u||!l||!this.mesh.has(u)||l.forEach(d=>{let h=zi.messageIdToString(d);this.seenCache.has(h)||o.set(h,d)})}),!o.size)return[];let a=o.size;a+s>Nt.GossipsubMaxIHaveLength&&(a=Nt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return zi.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return r.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[a,c]=this.messageCache.getForPeer(o,e);if(!!a){if(c>Nt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(zi.messageIdToString(o),a)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(H8.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,r){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return r.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let l=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof l=="number"&&s<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let d=l+Nt.GossipsubGraftFloodThreshold-Nt.GossipsubPruneBackoff;s<d&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),i.length?i.map(a=>this._makePrune(e,a,o)):[]}_handlePrune(e,r){let i=this.score.score(e);r.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,r){this._doAddBackoff(e,r,Nt.GossipsubPruneBackoff)}_doAddBackoff(e,r,i){let n=this.backoff.get(r);n||(n=new Map,this.backoff.set(r,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e)})}_clearBackoff(){if(this.heartbeatTicks%Nt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((r,i)=>{r.forEach((n,s)=>{n<e&&r.delete(s)}),r.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%Nt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(r=>{let i=this.peers.get(r);(!i||!i.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this._connect(r)})}_pxConnect(e){return x0(this,void 0,void 0,function*(){e.length>Nt.GossipsubPrunePeers&&(zi.shuffle(e),e=e.slice(0,Nt.GossipsubPrunePeers));let r=[];yield Promise.all(e.map(i=>x0(this,void 0,void 0,function*(){if(!i.peerID)return;let s=W8.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){r.push(s);return}try{let o=yield Hrt.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!r.length&&r.forEach(i=>this._connect(i))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},Nt.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(W8.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let r=this.fanout.get(e);if(r)r.forEach(i=>{this.score.score(i)<0&&r.delete(i)}),r.size<this._options.D&&uS.getGossipPeers(this,e,this._options.D-r.size,i=>!r.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>r.add(i)),this.mesh.set(e,r),this.fanout.delete(e),this.lastpub.delete(e);else{let i=uS.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let r=this.mesh.get(e);r&&(r.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}_publish(e){return x0(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let r=yield this.getMsgId(e),i=zi.messageIdToString(r);this.seenCache.put(i),this.messageCache.put(e);let n=new Set;e.topicIDs.forEach(o=>{let a=this.topics.get(o);if(!!a)if(this._options.floodPublish&&e.from===this.peerId.toB58String())a.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&n.add(c)});else{this.direct.forEach(u=>{n.add(u)}),a.forEach(u=>{let l=this.score.score(u),d=this.peers.get(u);!d||d.protocol===Nt.FloodsubID&&l>=this._options.scoreThresholds.publishThreshold&&n.add(u)});let c=this.mesh.get(o);if(!c||!c.size){if(c=this.fanout.get(o),!c){let u=uS.getGossipPeers(this,o,this._options.D,l=>this.score.score(l)>=this._options.scoreThresholds.publishThreshold);u.size>0?(c=u,this.fanout.set(o,u)):c=new Set}this.lastpub.set(o,this._now())}c.forEach(u=>{n.add(u)})}});let s=zi.createGossipRpc([H8.utils.normalizeOutRpcMessage(e)]);n.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,r){let i=[{topicID:r}],n=zi.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,r){let i=[this._makePrune(e,r,this._options.doPX)],n=zi.createGossipRpc([],{prune:i});this._sendRpc(e,n)}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,r,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,r,s),this.gossip.delete(e)),i.write($8.RPC.encode(r).finish())}_piggybackControl(e,r,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(n),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,r,i){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=i}_sendGraftPrune(e,r,i){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(d=>({topicID:d})),c=[],u=r.get(s);u&&(c=u.map(d=>this._makePrune(s,d,n&&!i.get(s))),r.delete(s));let l=zi.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,l)}for(let[s,o]of r){let a=o.map(u=>this._makePrune(s,u,n&&!i.get(s))),c=zi.createGossipRpc([],{prune:a});this._sendRpc(s,c)}}_emitGossip(e,r){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;zi.shuffle(i),i.length>Nt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!r.has(c)&&!this.direct.has(c)&&zi.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=Nt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:zi.shuffle(n),n.slice(0,o).forEach(c=>{let u=i;i.length>Nt.GossipsubMaxIHaveLength&&(u=zi.shuffle(u.slice()).slice(0,Nt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,r]of this.gossip.entries()){this.gossip.delete(e);let i=zi.createGossipRpc([],{ihave:r});this._sendRpc(e,i)}for(let[e,r]of this.control.entries()){this.control.delete(e);let i=zi.createGossipRpc([],{graft:r.graft,prune:r.prune});this._sendRpc(e,i)}}_pushGossip(e,r){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(r))}_now(){return Date.now()}_makePrune(e,r,i){if(this.peers.get(e).protocol===Nt.GossipsubIDv10)return{topicID:r,peers:[]};let n=Nt.GossipsubPruneBackoff/1e3,s=[];return i&&uS.getGossipPeers(this,r,Nt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0).forEach(a=>{let c=W8.createFromB58String(a);s.push({peerID:c.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(c)})}),{topicID:r,peers:s,backoff:n}}};Y8.multicodec=Nt.GossipsubIDv11;Mue.exports=Y8});var Uue=y((Vqt,Lue)=>{f();"use strict";Lue.exports={gossipsub:X8()}});var Hue=y((zqt,zue)=>{f();"use strict";var Q8=rt(),{base58btc:$rt}=(ei(),Jr),{default:Grt}=$c(),Fue=ul(),Kue=me(),Ml=Kue("libp2p-delegated-peer-routing");Ml.error=Kue("libp2p-delegated-peer-routing:error");var jue=3e4,Wrt=4,Vue=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new Grt({concurrency:Wrt});let{protocol:r,host:i,port:n}=e.getEndpointConfig();Ml(`enabled DelegatedPeerRouting via ${r}://${i}:${n}`)}async findPeer(e,r={}){let i=e;Q8.isPeerId(i)&&(i=e.toB58String()),Ml("findPeer starts: "+e),r.timeout=r.timeout||jue;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:r.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{Ml("findPeer finished: "+e)}}async*getClosestPeers(e,r={}){let i=$rt.encode(e).substring(1);Ml("getClosestPeers starts:",i),r.timeout=r.timeout||jue;let n=Fue(),s=Fue();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;let o=new Map;for await(let a of this._client.dht.query(i,{timeout:r.timeout}))switch(a.type){case 1:a.responses.forEach(c=>{o.set(c.id,{id:Q8.parse(c.id),multiaddrs:c.addrs})});break;case 2:yield o.get(a.id.string)||{id:Q8.createFromCID(a.id),multiaddrs:[]};break;default:Ml("getClosestPeers unhandled response",a)}}catch(o){throw Ml.error("getClosestPeers errored:",o),o}finally{s.resolve(),Ml("getClosestPeers finished:",i)}}};zue.exports=Vue});var Que=y((Hqt,Xue)=>{f();"use strict";var $ue=me(),Yrt=rt(),Xrt=Ua(),{default:Gue}=$c(),Wue=ul(),Ad=$ue("libp2p-delegated-content-routing");Ad.error=$ue("libp2p-delegated-content-routing:error");var Qrt=3e4,Zrt=4,Yue=class{constructor(e,r){if(e==null)throw new Error("missing self peerId");if(r==null)throw new Error("missing ipfs http client");this._client=r,this.peerId=e;let i={concurrency:Zrt};this._httpQueue=new Gue(i),this._httpQueueRefs=new Gue(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=r.getEndpointConfig();Ad(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,r={}){Ad(`findProviders starts: ${e}`),r.timeout=r.timeout||Qrt;let i=0,n=Wue(),s=Wue();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:r.numProviders,timeout:r.timeout}))yield{id:Yrt.parse(o),multiaddrs:a},i++}catch(o){throw Ad.error("findProviders errored:",o),o}finally{s.resolve(),Ad(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){Ad(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await Xrt(this._client.dht.provide(e))}),Ad(`provide finished: ${e}`)}};Xue.exports=Yue});var Z8=y(($qt,Jue)=>{f();"use strict";var Jrt=t=>Promise.reject(new Error(`No codec found for "${t}"`)),Zue=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||Jrt;for(let r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let r=typeof e=="string"?this._codecsByName:this._codecsByCode;if(r[e])return r[e];let i=await this._loadCodec(e);return r[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};Jue.exports=Zue});var J8=y((Gqt,tle)=>{f();"use strict";var eit=t=>Promise.reject(new Error(`No hasher found for "${t}"`)),ele=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||eit;for(let r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let r=typeof e=="string"?this._hashersByName:this._hashersByCode;if(r[e])return r[e];let i=await this._loadHasher(e);return r[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};tle.exports=ele});var eP=y((Wqt,ile)=>{f();"use strict";var tit=t=>Promise.reject(new Error(`No base found for "${t}"`)),rle=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||tit;for(let r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let r=await this._loadBase(e);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}};ile.exports=rle});var Hr=y((Yqt,nle)=>{f();"use strict";nle.exports=t=>{if(t==null)return t;let e=/^[A-Z]+$/,r={};return Object.keys(t).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=t[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=t[n]:i[n]=t[n],i),r)}});var ole=y((Xqt,sle)=>{f();"use strict";var{Multiaddr:rit}=it(),iit=D2();sle.exports=t=>{try{t=iit(new rit(t))}catch(e){}return t=t.toString(),t}});var ale=y(()=>{f()});var cle=y(()=>{f()});var lS=y((tDt,ple)=>{f();"use strict";var{Multiaddr:ule}=it(),{isBrowser:tP,isWebWorker:rP,isNode:nit}=zy(),{default:sit}=tb(),lle=me()("ipfs-http-client:lib:error-handler"),L1=Gy(),oit=gr().bind({ignoreUndefined:!0}),fle=ole(),ait=ale(),cit=cle(),uit=tP||rP?location.protocol:"http",lit=tP||rP?location.hostname:"localhost",fit=tP||rP?location.port:"5001",dit=(t={})=>{let e,r={},i;if(typeof t=="string"||ule.isMultiaddr(t))e=new URL(fle(t));else if(t instanceof URL)e=t;else if(typeof t.url=="string"||ule.isMultiaddr(t.url))e=new URL(fle(t.url)),r=t;else if(t.url instanceof URL)e=t.url,r=t;else{r=t||{};let n=(r.protocol||uit).replace(":",""),s=(r.host||lit).split(":")[0],o=r.port||fit;e=new URL(`${n}://${s}:${o}`)}if(r.apiPath?e.pathname=r.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),nit){let n=e.protocol.startsWith("https")?cit.Agent:ait.Agent;i=r.agent||new n({keepAlive:!0,maxSockets:6})}return{...r,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},dle=async t=>{let e;try{if((t.headers.get("Content-Type")||"").startsWith("application/json")){let i=await t.json();lle(i),e=i.Message||i.message}else e=await t.text()}catch(i){lle("Failed to parse error response",i),e=i.message}let r=new L1.HTTPError(t);throw e&&(e.includes("deadline has elapsed")&&(r=new L1.TimeoutError),e&&e.includes("context deadline exceeded")&&(r=new L1.TimeoutError)),e&&e.includes("request timed out")&&(r=new L1.TimeoutError),e&&(r.message=e),r},hit=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,hle=t=>t.replace(hit,function(e){return"-"+e.toLowerCase()}),pit=t=>typeof t=="string"?sit(t):t,iP=class extends L1{constructor(e={}){let r=dit(e);super({timeout:pit(r.timeout||0)||void 0,headers:r.headers,base:`${r.url}`,handleError:dle,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(hle(o),a),o==="timeout"&&!isNaN(a)&&s.append(hle(o),a);return s},agent:r.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${r.url}/${n}`),i.call(this,n,oit(s,{method:"POST"})))}};iP.errorHandler=dle;ple.exports=iP});var ve=y((rDt,yle)=>{f();"use strict";var yit=lS(),git=t=>e=>t(new yit(e),e);yle.exports=git});var vle=y((iDt,mle)=>{f();"use strict";var bit=ue(),mit=Bb(),vit=Nb(),wit=ap(),{isBytes:gle,isBlob:_it,isReadableStream:Eit}=Z_();async function Sit(t){if(gle(t))return new Blob([t]);if(typeof t=="string"||t instanceof String)return new Blob([t.toString()]);if(_it(t))return t;if(Eit(t)&&(t=vit(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=mit(t),{value:r,done:i}=await e.peek();if(i)return ble(e);if(e.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await wit(e))]);if(gle(r)||typeof r=="string"||r instanceof String)return ble(e)}throw bit(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}async function ble(t){let e=[];for await(let r of t)e.push(r);return new Blob(e)}mle.exports=Sit});var _le=y((nDt,wle)=>{f();"use strict";var xit=vle(),Ait=BT();function Iit(t){return Ait(t,xit)}wle.exports={normaliseInput:Iit}});var fS=y((sDt,Ele)=>{f();"use strict";Ele.exports=t=>{if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}});var Qo=y((oDt,Sle)=>{f();"use strict";var{normaliseInput:Tit}=_le(),Rit=fS();async function Pit(t,e,r={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:u,mtime:l}of Tit(t)){let d="",h=a?"file":"dir";s>0&&(d=`-${s}`);let p=h+d,g=[];if(u!=null&&g.push(`mode=${Rit(u)}`),l!=null){let{secs:m,nsecs:E}=l;g.push(`mtime=${m}`),E!=null&&g.push(`mtime-nsecs=${E}`)}if(g.length&&(p=`${p}?${g.join("&")}`),a){n.set(p,a,c!=null?encodeURIComponent(c):void 0);let m=o+a.size;i.push({name:c,start:o,end:m}),o=m}else if(c!=null)n.set(p,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:r,body:n}}Sle.exports=Pit});var nP=y((aDt,xle)=>{f();"use strict";var Cit=ue();function Oit(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),i=Math.floor(r/1e3);e={secs:i,nsecs:(r-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw Cit(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}xle.exports=Oit});var Se=y((cDt,Ale)=>{f();"use strict";var kit=fS(),qit=nP();Ale.exports=({arg:t,searchParams:e,hashAlg:r,mtime:i,mode:n,...s}={})=>{e&&(s={...s,...e}),r&&(s.hash=r),i!=null&&(i=qit(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=kit(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),t==null?t=[]:Array.isArray(t)||(t=[t]);let o=new URLSearchParams(s);return t.forEach(a=>o.append("arg",a)),o}});var Zo=y((uDt,Ile)=>{f();"use strict";var{anySignal:Dit}=Tu();function Nit(t){return t.filter(Boolean)}Ile.exports=(...t)=>Dit(Nit(t))});var sP=y((lDt,Tle)=>{f();"use strict";var{CID:Bit}=(Ie(),Ne),Mit=Hr(),Lit=ve(),Uit=Qo(),Fit=Se(),Kit=Zo(),{AbortController:jit}=nn();Tle.exports=Lit(t=>{async function*e(r,i={}){let n=new jit,s=Kit(n.signal,i.signal),{headers:o,body:a,total:c,parts:u}=await Uit(r,n,i.headers),[l,d]=typeof i.progress=="function"?Vit(c,u,i.progress):[void 0,void 0],h=await t.post("add",{searchParams:Fit({"stream-channels":!0,...i,progress:Boolean(l)}),onUploadProgress:d,signal:s,headers:o,body:a});for await(let p of h.ndjson())p=Mit(p),p.hash!==void 0?yield Hit(p):l&&l(p.bytes||0,p.name)}return e});var Vit=(t,e,r)=>e?[void 0,zit(t,e,r)]:[r,void 0],zit=(t,e,r)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*t);for(;i<n;){let{start:c,end:u,name:l}=e[i];if(a<u){r(a-c,l);break}else r(u-c,l),i+=1}}};function Hit({name:t,hash:e,size:r,mode:i,mtime:n,mtimeNsecs:s}){let o={path:t,cid:Bit.parse(e),size:parseInt(r)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}});var Ple=y((fDt,Rle)=>{f();"use strict";var $it=sP(),Git=$n(),Wit=ve();Rle.exports=t=>{let e=$it(t);return Wit(()=>{async function r(i,n={}){return await Git(e(i,n))}return r})(t)}});var Ole=y((dDt,Cle)=>{f();"use strict";var{CID:Yit}=(Ie(),Ne),Xit=ve(),Qit=Se();Cle.exports=Xit(t=>{async function e(r={}){return((await(await t.post("bitswap/wantlist",{signal:r.signal,searchParams:Qit(r),headers:r.headers})).json()).Keys||[]).map(n=>Yit.parse(n["/"]))}return e})});var qle=y((hDt,kle)=>{f();"use strict";var{CID:Zit}=(Ie(),Ne),Jit=ve(),ent=Se();kle.exports=Jit(t=>{async function e(r,i={}){return((await(await t.post("bitswap/wantlist",{signal:i.signal,searchParams:ent({...i,peer:r.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>Zit.parse(s["/"]))}return e})});var oP=y((pDt,Dle)=>{f();"use strict";var{CID:tnt}=(Ie(),Ne),rnt=ve(),int=Se();Dle.exports=rnt(t=>{async function e(r={}){let i=await t.post("bitswap/stat",{searchParams:int(r),signal:r.signal,headers:r.headers});return nnt(await i.json())}return e});function nnt(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist||[]).map(e=>tnt.parse(e["/"])),peers:t.Peers||[],blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}});var Ble=y((yDt,Nle)=>{f();"use strict";var snt=ve(),ont=Se();Nle.exports=snt(t=>{async function e(r,i={}){return(await t.post("bitswap/unwant",{signal:i.signal,searchParams:ont({arg:r.toString(),...i}),headers:i.headers})).json()}return e})});var Lle=y((gDt,Mle)=>{f();"use strict";Mle.exports=t=>({wantlist:Ole()(t),wantlistForPeer:qle()(t),stat:oP()(t),unwant:Ble()(t)})});var aP=y((bDt,Ule)=>{f();"use strict";var ant=ve(),cnt=Se();Ule.exports=ant(t=>{async function e(r,i={}){let n=await t.post("block/get",{signal:i.signal,searchParams:cnt({arg:r.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e})});var Kle=y((mDt,Fle)=>{f();"use strict";var{CID:unt}=(Ie(),Ne),lnt=ve(),fnt=Se();Fle.exports=lnt(t=>{async function e(r,i={}){let s=await(await t.post("block/stat",{signal:i.signal,searchParams:fnt({arg:r.toString(),...i}),headers:i.headers})).json();return{cid:unt.parse(s.Key),size:s.Size}}return e})});var Vle=y((vDt,jle)=>{f();"use strict";var{CID:dnt}=(Ie(),Ne),hnt=Qo(),pnt=ve(),ynt=Se(),gnt=Zo(),{AbortController:bnt}=nn();jle.exports=pnt(t=>{async function e(r,i={}){let n=new bnt,s=gnt(n.signal,i.signal),o;try{o=await(await t.post("block/put",{signal:s,searchParams:ynt(i),...await hnt(r,n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(r,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(r,{...i,format:"cbor"});throw a}return dnt.parse(o.Key)}return e})});var Hle=y((wDt,zle)=>{f();"use strict";var{CID:mnt}=(Ie(),Ne),vnt=ve(),wnt=Se();zle.exports=vnt(t=>{async function*e(r,i={}){Array.isArray(r)||(r=[r]);let n=await t.post("block/rm",{signal:i.signal,searchParams:wnt({arg:r.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield _nt(s)}return e});function _nt(t){let e={cid:mnt.parse(t.Hash)};return t.Error&&(e.error=new Error(t.Error)),e}});var Gle=y((_Dt,$le)=>{f();"use strict";$le.exports=t=>({get:aP()(t),stat:Kle()(t),put:Vle()(t),rm:Hle()(t)})});var Yle=y((EDt,Wle)=>{f();"use strict";var Ent=ve(),Snt=Se(),{Multiaddr:xnt}=it();Wle.exports=Ent(t=>{async function e(r,i={}){let n=await t.post("bootstrap/add",{signal:i.signal,searchParams:Snt({arg:r,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new xnt(o))}}return e})});var Qle=y((SDt,Xle)=>{f();"use strict";var Ant=ve(),Int=Se(),{Multiaddr:Tnt}=it();Xle.exports=Ant(t=>{async function e(r={}){let i=await t.post("bootstrap/rm",{signal:r.signal,searchParams:Int({...r,all:!0}),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Tnt(s))}}return e})});var Jle=y((xDt,Zle)=>{f();"use strict";var Rnt=ve(),Pnt=Se(),{Multiaddr:Cnt}=it();Zle.exports=Rnt(t=>{async function e(r,i={}){let n=await t.post("bootstrap/rm",{signal:i.signal,searchParams:Pnt({arg:r,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new Cnt(o))}}return e})});var tfe=y((ADt,efe)=>{f();"use strict";var Ont=ve(),knt=Se(),{Multiaddr:qnt}=it();efe.exports=Ont(t=>{async function e(r={}){let i=await t.post("bootstrap/add",{signal:r.signal,searchParams:knt({...r,default:!0}),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new qnt(s))}}return e})});var ife=y((IDt,rfe)=>{f();"use strict";var Dnt=ve(),Nnt=Se(),{Multiaddr:Bnt}=it();rfe.exports=Dnt(t=>{async function e(r={}){let i=await t.post("bootstrap/list",{signal:r.signal,searchParams:Nnt(r),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Bnt(s))}}return e})});var sfe=y((TDt,nfe)=>{f();"use strict";nfe.exports=t=>({add:Yle()(t),clear:Qle()(t),rm:Jle()(t),reset:tfe()(t),list:ife()(t)})});var afe=y((RDt,ofe)=>{f();"use strict";var Mnt=ve(),Lnt=Se();ofe.exports=Mnt(t=>{async function*e(r,i={}){yield*(await t.post("cat",{signal:i.signal,searchParams:Lnt({arg:r.toString(),...i}),headers:i.headers})).iterator()}return e})});var ufe=y((PDt,cfe)=>{f();"use strict";var Unt=ve(),Fnt=Se();cfe.exports=Unt(t=>async(r={})=>(await t.post("commands",{signal:r.signal,searchParams:Fnt(r),headers:r.headers})).json())});var ffe=y((CDt,lfe)=>{f();"use strict";var Knt=ve(),jnt=Se();lfe.exports=Knt(t=>async(r={})=>await(await t.post("config/show",{signal:r.signal,searchParams:jnt({...r}),headers:r.headers})).json())});var hfe=y((ODt,dfe)=>{f();"use strict";var Vnt=ve(),znt=Se();dfe.exports=Vnt(t=>async(r,i={})=>{if(!r)throw new Error("key argument is required");return(await(await t.post("config",{signal:i.signal,searchParams:znt({arg:r,...i}),headers:i.headers})).json()).Value})});var yfe=y((kDt,pfe)=>{f();"use strict";var Hnt=ve(),$nt=Se();pfe.exports=Hnt(t=>async(r,i,n={})=>{if(typeof r!="string")throw new Error("Invalid key type");let s={...n,...Gnt(r,i)};await(await t.post("config",{signal:n.signal,searchParams:$nt(s),headers:n.headers})).text()});var Gnt=(t,e)=>{switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}}});var bfe=y((qDt,gfe)=>{f();"use strict";var{fromString:Wnt}=(ft(),ht),Ynt=Qo(),Xnt=ve(),Qnt=Se(),Znt=Zo(),{AbortController:Jnt}=nn();gfe.exports=Xnt(t=>async(r,i={})=>{let n=new Jnt,s=Znt(n.signal,i.signal);await(await t.post("config/replace",{signal:s,searchParams:Qnt(i),...await Ynt(Wnt(JSON.stringify(r)),n,i.headers)})).text()})});var vfe=y((DDt,mfe)=>{f();"use strict";var est=ve(),tst=Se();mfe.exports=est(t=>{async function e(r,i={}){let s=await(await t.post("config/profile/apply",{signal:i.signal,searchParams:tst({arg:r,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e})});var _fe=y((NDt,wfe)=>{f();"use strict";var rst=Hr(),ist=ve(),nst=Se();wfe.exports=ist(t=>{async function e(r={}){return(await(await t.post("config/profile/list",{signal:r.signal,searchParams:nst(r),headers:r.headers})).json()).map(s=>rst(s))}return e})});var Sfe=y((BDt,Efe)=>{f();"use strict";Efe.exports=t=>({apply:vfe()(t),list:_fe()(t)})});var Afe=y((MDt,xfe)=>{f();"use strict";xfe.exports=t=>({getAll:ffe()(t),get:hfe()(t),set:yfe()(t),replace:bfe()(t),profiles:Sfe()(t)})});var Tfe=y((LDt,Ife)=>{f();"use strict";var sst=ve(),ost=Se();Ife.exports=sst(t=>{async function*e(r,i={}){yield*(await t.post("dag/export",{signal:i.signal,searchParams:ost({arg:r.toString()}),headers:i.headers})).iterator()}return e})});var Cfe=y((UDt,Pfe)=>{f();"use strict";var{CID:ast}=(Ie(),Ne),Rfe=ue(),cst=async function*(t,e,r,i,n){let s=async u=>{let l=await r.getCodec(u.code),d=await i(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(o.length||(yield{value:a,remainderPath:""});o.length;){let u=o.shift();if(!u)throw Rfe(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw Rfe(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");let l=ast.asCID(a);l&&(c=l,a=await s(a))}};Pfe.exports=cst});var qfe=y((FDt,kfe)=>{f();"use strict";var ust=ve(),Ofe=Cfe(),lst=Df(),fst=$n(),dst=ue();kfe.exports=(t,e)=>ust((i,n)=>{let s=aP()(n);return async(a,c={})=>{if(c.path){let p=c.localResolve?await lst(Ofe(a,c.path,t,s,c)):await fst(Ofe(a,c.path,t,s,c));if(!p)throw dst(new Error("Not found"),"ERR_NOT_FOUND");return p}let u=await t.getCodec(a.code),l=await s(a,c);return{value:u.decode(l),remainderPath:""}}})(e)});var Nfe=y((KDt,Dfe)=>{f();"use strict";var hst=ve(),pst=Se(),yst=Zo(),gst=Qo(),{AbortController:bst}=nn(),{CID:mst}=(Ie(),Ne);Dfe.exports=hst(t=>{async function*e(r,i={}){let n=new bst,s=yst(n.signal,i.signal),{headers:o,body:a}=await gst(r,n,i.headers),c=await t.post("dag/import",{signal:s,headers:o,body:a,searchParams:pst({"pin-roots":i.pinRoots})});for await(let{Root:u}of c.ndjson())if(u!==void 0){let{Cid:{"/":l},PinErrorMsg:d}=u;yield{root:{cid:mst.parse(l),pinErrorMsg:d}}}}return e})});var cP=y((jDt,Bfe)=>{f();"use strict";var{CID:vst}=(Ie(),Ne),wst=ve(),_st=Qo(),Est=Se(),Sst=Zo(),{AbortController:xst}=nn();Bfe.exports=(t,e)=>wst(i=>async(s,o={})=>{let a={format:"dag-cbor",hashAlg:"sha2-256",inputEnc:"raw",...o},u=(await t.getCodec(a.format)).encode(s),l=new xst,d=Sst(l.signal,a.signal),p=await(await i.post("dag/put",{timeout:a.timeout,signal:d,searchParams:Est(a),...await _st(u,l,a.headers)})).json();return vst.parse(p.Cid["/"])})(e)});var Lfe=y((VDt,Mfe)=>{f();"use strict";var{CID:Ast}=(Ie(),Ne),Ist=ve(),Tst=Se();Mfe.exports=Ist(t=>async(r,i={})=>{let s=await(await t.post("dag/resolve",{signal:i.signal,searchParams:Tst({arg:`${r}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:Ast.parse(s.Cid["/"]),remainderPath:s.RemPath}})});var Ffe=y((zDt,Ufe)=>{f();"use strict";Ufe.exports=(t,e)=>({export:Tfe()(e),get:qfe()(t,e),import:Nfe()(e),put:cP()(t,e),resolve:Lfe()(e)})});var dS=y((HDt,Kfe)=>{f();"use strict";Kfe.exports={SendingQuery:0,PeerResponse:1,FinalPeer:2,QueryError:3,Provider:4,Value:5,AddingPeer:6,DialingPeer:7}});var Vfe=y(($Dt,jfe)=>{f();"use strict";var Rst=ve(),Pst=Se(),{Value:Cst}=dS(),{fromString:Ost}=(ft(),ht),{toString:kst}=(tt(),et);jfe.exports=Rst(t=>{async function e(r,i={}){let n=await t.post("dht/get",{signal:i.signal,searchParams:Pst({arg:r instanceof Uint8Array?kst(r):r,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===Cst)return Ost(s.Extra,"base64pad");throw new Error("not found")}return e})});var Hfe=y((GDt,zfe)=>{f();"use strict";var{Multiaddr:qst}=it(),Dst=Hr(),Nst=ve(),Bst=Se(),Mst=Qo(),Lst=Zo(),{AbortController:Ust}=nn(),{toString:Fst}=(tt(),et);zfe.exports=Nst(t=>{async function*e(r,i,n={}){let s=new Ust,o=Lst(s.signal,n.signal),a=await t.post("dht/put",{signal:o,searchParams:Bst({arg:Fst(r),...n}),...await Mst(i,s,n.headers)});for await(let c of a.ndjson())c=Dst(c),c.responses&&(c.responses=c.responses.map(({ID:u,Addrs:l})=>({id:u,addrs:(l||[]).map(d=>new qst(d))}))),yield c}return e})});var Gfe=y((WDt,$fe)=>{f();"use strict";var{Multiaddr:Kst}=it(),jst=ve(),Vst=Se(),{Provider:zst}=dS();$fe.exports=jst(t=>{async function*e(r,i={}){let n=await t.post("dht/findprovs",{signal:i.signal,searchParams:Vst({arg:r.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===zst&&s.Responses)for(let{ID:o,Addrs:a}of s.Responses)yield{id:o,addrs:(a||[]).map(c=>new Kst(c))}}return e})});var Yfe=y((YDt,Wfe)=>{f();"use strict";var{Multiaddr:Hst}=it(),$st=ve(),Gst=Se(),{FinalPeer:Wst}=dS();Wfe.exports=$st(t=>{async function e(r,i={}){let n=await t.post("dht/findpeer",{signal:i.signal,searchParams:Gst({arg:r,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===Wst&&s.Responses){let{ID:o,Addrs:a}=s.Responses[0];return{id:o,addrs:(a||[]).map(c=>new Hst(c))}}throw new Error("not found")}return e})});var Qfe=y((XDt,Xfe)=>{f();"use strict";var{Multiaddr:Yst}=it(),Xst=Hr(),Qst=ve(),Zst=Se();Xfe.exports=Qst(t=>{async function*e(r,i={recursive:!1}){let n=Array.isArray(r)?r:[r],s=await t.post("dht/provide",{signal:i.signal,searchParams:Zst({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())o=Xst(o),o.responses?o.responses=o.responses.map(({ID:a,Addrs:c})=>({id:a,addrs:(c||[]).map(u=>new Yst(u))})):o.responses=[],yield o}return e})});var Jfe=y((QDt,Zfe)=>{f();"use strict";var{Multiaddr:Jst}=it(),eot=Hr(),tot=ve(),rot=Se();Zfe.exports=tot(t=>{async function*e(r,i={}){let n=await t.post("dht/query",{signal:i.signal,searchParams:rot({arg:r.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())s=eot(s),s.responses=(s.responses||[]).map(({ID:o,Addrs:a})=>({id:o,addrs:(a||[]).map(c=>new Jst(c))})),yield s}return e})});var tde=y((ZDt,ede)=>{f();"use strict";ede.exports=t=>({get:Vfe()(t),put:Hfe()(t),findProvs:Gfe()(t),findPeer:Yfe()(t),provide:Qfe()(t),query:Jfe()(t)})});var ide=y((JDt,rde)=>{f();"use strict";var iot=ve(),not=Se();rde.exports=iot(t=>{async function e(r={}){return(await t.post("diag/net",{signal:r.signal,searchParams:not(r),headers:r.headers})).json()}return e})});var sde=y((eNt,nde)=>{f();"use strict";var sot=ve(),oot=Se();nde.exports=sot(t=>{async function e(r={}){return(await t.post("diag/sys",{signal:r.signal,searchParams:oot(r),headers:r.headers})).json()}return e})});var ade=y((tNt,ode)=>{f();"use strict";var aot=ve(),cot=Se();ode.exports=aot(t=>{async function e(r={}){return(await t.post("diag/cmds",{signal:r.signal,searchParams:cot(r),headers:r.headers})).json()}return e})});var ude=y((rNt,cde)=>{f();"use strict";cde.exports=t=>({net:ide()(t),sys:sde()(t),cmds:ade()(t)})});var fde=y((iNt,lde)=>{f();"use strict";var uot=ve(),lot=Se();lde.exports=uot(t=>async(r,i={})=>(await(await t.post("dns",{signal:i.signal,searchParams:lot({arg:r,...i}),headers:i.headers})).json()).Path)});var hde=y((nNt,dde)=>{f();"use strict";var fot=ve(),dot=Se();dde.exports=fot(t=>{async function e(r,i,n={}){await(await t.post("files/chmod",{signal:n.signal,searchParams:dot({arg:r,mode:i,...n}),headers:n.headers})).text()}return e})});var yde=y((sNt,pde)=>{f();"use strict";var{CID:hot}=(Ie(),Ne),pot=ve(),yot=Se();pde.exports=pot(t=>{async function e(r,i,n={}){let s=Array.isArray(r)?r:[r];await(await t.post("files/cp",{signal:n.signal,searchParams:yot({arg:s.concat(i).map(a=>hot.asCID(a)?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e})});var bde=y((oNt,gde)=>{f();"use strict";var{CID:got}=(Ie(),Ne),bot=ve(),mot=Se();gde.exports=bot(t=>{async function e(r,i={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await t.post("files/flush",{signal:i.signal,searchParams:mot({arg:r,...i}),headers:i.headers})).json();return got.parse(s.Cid)}return e})});var uP=y((aNt,mde)=>{f();"use strict";var vot=Hr();function wot(t){let e=vot(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}mde.exports=wot});var Sde=y((cNt,Ede)=>{f();"use strict";var{CID:vde}=(Ie(),Ne),wde=uP(),_ot=ve(),Eot=Se();Ede.exports=_ot(t=>{async function*e(r,i={}){if(!r)throw new Error("ipfs.files.ls requires a path");let n=await t.post("files/ls",{signal:i.signal,searchParams:Eot({arg:vde.asCID(r)?`/ipfs/${r}`:r,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield _de(wde(o));else yield _de(wde(s))}return e});function _de(t){return t.hash&&(t.cid=vde.parse(t.hash)),delete t.hash,t.type=t.type===1?"directory":"file",t}});var Ade=y((uNt,xde)=>{f();"use strict";var Sot=ve(),xot=Se();xde.exports=Sot(t=>{async function e(r,i={}){await(await t.post("files/mkdir",{signal:i.signal,searchParams:xot({arg:r,...i}),headers:i.headers})).text()}return e})});var Tde=y((lNt,Ide)=>{f();"use strict";var Aot=ve(),Iot=Se();Ide.exports=Aot(t=>{async function e(r,i,n={}){Array.isArray(r)||(r=[r]),await(await t.post("files/mv",{signal:n.signal,searchParams:Iot({arg:r.concat(i),...n}),headers:n.headers})).text()}return e})});var U1=y((fNt,Rde)=>{f();Rde.exports=t=>{if(t[Symbol.asyncIterator])return t;if(t.getReader)return async function*(){let e=t.getReader();try{for(;;){let{done:r,value:i}=await e.read();if(r)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var Cde=y((dNt,Pde)=>{f();"use strict";var Tot=U1(),Rot=ve(),Pot=Se();Pde.exports=Rot(t=>{async function*e(r,i={}){let n=await t.post("files/read",{signal:i.signal,searchParams:Pot({arg:r,count:i.length,...i}),headers:i.headers});yield*Tot(n.body)}return e})});var kde=y((hNt,Ode)=>{f();"use strict";var Cot=ve(),Oot=Se();Ode.exports=Cot(t=>{async function e(r,i={}){await(await t.post("files/rm",{signal:i.signal,searchParams:Oot({arg:r,...i}),headers:i.headers})).text()}return e})});var lP=y((pNt,qde)=>{f();"use strict";var{CID:kot}=(Ie(),Ne),qot=uP(),Dot=ve(),Not=Se();qde.exports=Dot(t=>{async function e(r,i={}){let s=await(await t.post("files/stat",{signal:i.signal,searchParams:Not({arg:r,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,Bot(qot(s))}return e});function Bot(t){return t.cid=kot.parse(t.hash),delete t.hash,t}});var Nde=y((yNt,Dde)=>{f();"use strict";var Mot=ve(),Lot=Se();Dde.exports=Mot(t=>{async function e(r,i={}){await(await t.post("files/touch",{signal:i.signal,searchParams:Lot({arg:r,...i}),headers:i.headers})).text()}return e})});var Mde=y((gNt,Bde)=>{f();"use strict";var Uot=fS(),Fot=nP(),Kot=ve(),jot=Qo(),Vot=Se(),zot=Zo(),{AbortController:Hot}=nn();Bde.exports=Kot(t=>{async function e(r,i,n={}){let s=new Hot,o=zot(s.signal,n.signal);await(await t.post("files/write",{signal:o,searchParams:Vot({arg:r,streamChannels:!0,count:n.length,...n}),...await jot({content:i,path:"arg",mode:Uot(n.mode),mtime:Fot(n.mtime)},s,n.headers)})).text()}return e})});var Ude=y((bNt,Lde)=>{f();"use strict";Lde.exports=t=>({chmod:hde()(t),cp:yde()(t),flush:bde()(t),ls:Sde()(t),mkdir:Ade()(t),mv:Tde()(t),read:Cde()(t),rm:kde()(t),stat:lP()(t),touch:Nde()(t),write:Mde()(t)})});var Kde=y((mNt,Fde)=>{f();"use strict";var{CID:$ot}=(Ie(),Ne),Got=ve(),Wot=Se();Fde.exports=Got(t=>{async function*e(r,i={}){let n={arg:`${r instanceof Uint8Array?$ot.decode(r):r}`,...i};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await t.post("get",{signal:i.signal,searchParams:Wot(n),headers:i.headers})).iterator()}return e})});var Vde=y((vNt,jde)=>{f();"use strict";var Yot=ve();jde.exports=Yot(t=>()=>{let e=new URL(t.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}})});var fP=y((wNt,zde)=>{f();"use strict";var Xot=Hr(),{Multiaddr:Qot}=it(),Zot=ve(),Jot=Se();zde.exports=Zot(t=>{async function e(r={}){let n=await(await t.post("id",{signal:r.signal,searchParams:Jot({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),s={...Xot(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new Qot(o))),s}return e})});var $de=y((_Nt,Hde)=>{f();"use strict";var eat=fP();Hde.exports=t=>{let e=eat(t);async function r(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return r}});var Wde=y((ENt,Gde)=>{f();"use strict";var tat=Hr(),rat=ve(),iat=Se();Gde.exports=rat(t=>{async function e(r,i={type:"rsa",size:2048}){let s=await(await t.post("key/gen",{signal:i.signal,searchParams:iat({arg:r,...i}),headers:i.headers})).json();return tat(s)}return e})});var Xde=y((SNt,Yde)=>{f();"use strict";var nat=Hr(),sat=ve(),oat=Se();Yde.exports=sat(t=>{async function e(r={}){return((await(await t.post("key/list",{signal:r.signal,searchParams:oat(r),headers:r.headers})).json()).Keys||[]).map(s=>nat(s))}return e})});var Zde=y((xNt,Qde)=>{f();"use strict";var aat=Hr(),cat=ve(),uat=Se();Qde.exports=cat(t=>{async function e(r,i,n={}){let s=await t.post("key/rename",{signal:n.signal,searchParams:uat({arg:[r,i],...n}),headers:n.headers});return aat(await s.json())}return e})});var ehe=y((ANt,Jde)=>{f();"use strict";var lat=Hr(),fat=ve(),dat=Se();Jde.exports=fat(t=>{async function e(r,i={}){let s=await(await t.post("key/rm",{signal:i.signal,searchParams:dat({arg:r,...i}),headers:i.headers})).json();return lat(s.Keys[0])}return e})});var rhe=y((INt,the)=>{f();"use strict";var hat=Hr(),pat=ve(),yat=Se();the.exports=pat(t=>{async function e(r,i,n,s={}){let a=await(await t.post("key/import",{signal:s.signal,searchParams:yat({arg:r,pem:i,password:n,...s}),headers:s.headers})).json();return hat(a)}return e})});var nhe=y((TNt,ihe)=>{f();"use strict";var gat=ve(),bat=ue();ihe.exports=gat(t=>async(r,i,n={})=>{throw bat(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var ohe=y((RNt,she)=>{f();"use strict";var mat=ve(),vat=ue();she.exports=mat(t=>async(r,i={})=>{throw vat(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var che=y((PNt,ahe)=>{f();"use strict";ahe.exports=t=>({gen:Wde()(t),list:Xde()(t),rename:Zde()(t),rm:ehe()(t),import:rhe()(t),export:nhe()(t),info:ohe()(t)})});var lhe=y((CNt,uhe)=>{f();"use strict";var wat=ve(),_at=Se();uhe.exports=wat(t=>{async function*e(r={}){yield*(await t.post("log/tail",{signal:r.signal,searchParams:_at(r),headers:r.headers})).ndjson()}return e})});var dhe=y((ONt,fhe)=>{f();"use strict";var Eat=ve(),Sat=Se();fhe.exports=Eat(t=>{async function e(r={}){return(await(await t.post("log/ls",{signal:r.signal,searchParams:Sat(r),headers:r.headers})).json()).Strings}return e})});var phe=y((kNt,hhe)=>{f();"use strict";var xat=Hr(),Aat=ve(),Iat=Se();hhe.exports=Aat(t=>{async function e(r,i,n={}){let s=await t.post("log/level",{signal:n.signal,searchParams:Iat({arg:[r,i],...n}),headers:n.headers});return xat(await s.json())}return e})});var ghe=y((qNt,yhe)=>{f();"use strict";yhe.exports=t=>({tail:lhe()(t),ls:dhe()(t),level:phe()(t)})});var vhe=y((DNt,mhe)=>{f();"use strict";var{CID:bhe}=(Ie(),Ne),Tat=ve(),Rat=Se(),Pat=lP();mhe.exports=Tat((t,e)=>{async function*r(i,n={}){let s=`${i instanceof Uint8Array?bhe.decode(i):i}`;async function o(c){let u=c.Hash;if(u.includes("/")){let d=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await Pat(e)(d)).cid}else u=bhe.parse(u);let l={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:u,type:Cat(c)};return c.Mode&&(l.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(l.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(l.mtime.nsecs=c.MtimeNsecs)),l}let a=await t.post("ls",{signal:n.signal,searchParams:Rat({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let u=c.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(c);return}yield*u.map(o)}}return r});function Cat(t){switch(t.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}});var _he=y((NNt,whe)=>{f();"use strict";var Oat=Hr(),kat=ve(),qat=Se();whe.exports=kat(t=>{async function e(r={}){let i=await t.post("dns",{signal:r.signal,searchParams:qat(r),headers:r.headers});return Oat(await i.json())}return e})});var She=y((BNt,Ehe)=>{f();"use strict";var Dat=Hr(),Nat=ve(),Bat=Se();Ehe.exports=Nat(t=>{async function e(r,i={}){let n=await t.post("name/publish",{signal:i.signal,searchParams:Bat({arg:`${r}`,...i}),headers:i.headers});return Dat(await n.json())}return e})});var Ahe=y((MNt,xhe)=>{f();"use strict";var Mat=ve(),Lat=Se();xhe.exports=Mat(t=>{async function*e(r,i={}){let n=await t.post("name/resolve",{signal:i.signal,searchParams:Lat({arg:r,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e})});var The=y((LNt,Ihe)=>{f();"use strict";var Uat=Hr(),Fat=ve(),Kat=Se();Ihe.exports=Fat(t=>{async function e(r,i={}){let n=await t.post("name/pubsub/cancel",{signal:i.signal,searchParams:Kat({arg:r,...i}),headers:i.headers});return Uat(await n.json())}return e})});var Phe=y((UNt,Rhe)=>{f();"use strict";var jat=Hr(),Vat=ve(),zat=Se();Rhe.exports=Vat(t=>{async function e(r={}){let i=await t.post("name/pubsub/state",{signal:r.signal,searchParams:zat(r),headers:r.headers});return jat(await i.json())}return e})});var Ohe=y((FNt,Che)=>{f();"use strict";var Hat=ve(),$at=Se();Che.exports=Hat(t=>{async function e(r={}){return(await(await t.post("name/pubsub/subs",{signal:r.signal,searchParams:$at(r),headers:r.headers})).json()).Strings||[]}return e})});var qhe=y((KNt,khe)=>{f();"use strict";khe.exports=t=>({cancel:The()(t),state:Phe()(t),subs:Ohe()(t)})});var Nhe=y((jNt,Dhe)=>{f();"use strict";Dhe.exports=t=>({publish:She()(t),resolve:Ahe()(t),pubsub:qhe()(t)})});var Mhe=y((VNt,Bhe)=>{f();"use strict";var{CID:Gat}=(Ie(),Ne),Wat=ve(),Yat=Se();Bhe.exports=Wat(t=>{async function e(r,i={}){let s=await(await t.post("object/data",{signal:i.signal,searchParams:Yat({arg:`${r instanceof Uint8Array?Gat.decode(r):r}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e})});var Fhe=y((zNt,Uhe)=>{f();"use strict";var{CID:Lhe}=(Ie(),Ne),Xat=ve(),Qat=Se(),{fromString:Zat}=(ft(),ht);Uhe.exports=Xat(t=>{async function e(r,i={}){let s=await(await t.post("object/get",{signal:i.signal,searchParams:Qat({arg:`${r instanceof Uint8Array?Lhe.decode(r):r}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:Zat(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:Lhe.parse(o.Hash),Tsize:o.Size}))}}return e})});var Vhe=y((HNt,jhe)=>{f();"use strict";var{CID:Khe}=(Ie(),Ne),Jat=ve(),ect=Se();jhe.exports=Jat(t=>{async function e(r,i={}){return((await(await t.post("object/links",{signal:i.signal,searchParams:ect({arg:`${r instanceof Uint8Array?Khe.decode(r):r}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:Khe.parse(o.Hash)}))}return e})});var Hhe=y(($Nt,zhe)=>{f();"use strict";var{CID:tct}=(Ie(),Ne),rct=ve(),ict=Se();zhe.exports=rct(t=>{async function e(r={}){let i=await t.post("object/new",{signal:r.signal,searchParams:ict({arg:r.template,...r}),headers:r.headers}),{Hash:n}=await i.json();return tct.parse(n)}return e})});var Ghe=y((GNt,$he)=>{f();"use strict";var{CID:nct}=(Ie(),Ne),sct=ve(),oct=Se();$he.exports=sct(t=>{async function e(r,i,n={}){let s=await t.post("object/patch/add-link",{signal:n.signal,searchParams:oct({arg:[`${r}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return nct.parse(o)}return e})});var Yhe=y((WNt,Whe)=>{f();"use strict";var{CID:act}=(Ie(),Ne),cct=Qo(),uct=ve(),lct=Se(),fct=Zo(),{AbortController:dct}=nn();Whe.exports=uct(t=>{async function e(r,i,n={}){let s=new dct,o=fct(s.signal,n.signal),a=await t.post("object/patch/append-data",{signal:o,searchParams:lct({arg:`${r}`,...n}),...await cct(i,s,n.headers)}),{Hash:c}=await a.json();return act.parse(c)}return e})});var Qhe=y((YNt,Xhe)=>{f();"use strict";var{CID:hct}=(Ie(),Ne),pct=ve(),yct=Se();Xhe.exports=pct(t=>{async function e(r,i,n={}){let s=await t.post("object/patch/rm-link",{signal:n.signal,searchParams:yct({arg:[`${r}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return hct.parse(o)}return e})});var Jhe=y((XNt,Zhe)=>{f();"use strict";var{CID:gct}=(Ie(),Ne),bct=Qo(),mct=ve(),vct=Se(),wct=Zo(),{AbortController:_ct}=nn();Zhe.exports=mct(t=>{async function e(r,i,n={}){let s=new _ct,o=wct(s.signal,n.signal),a=await t.post("object/patch/set-data",{signal:o,searchParams:vct({arg:[`${r}`],...n}),...await bct(i,s,n.headers)}),{Hash:c}=await a.json();return gct.parse(c)}return e})});var tpe=y((QNt,epe)=>{f();"use strict";epe.exports=t=>({addLink:Ghe()(t),appendData:Yhe()(t),rmLink:Qhe()(t),setData:Jhe()(t)})});var ipe=y((ZNt,rpe)=>{f();"use strict";var Ect=ve();rpe.exports=(t,e)=>Ect(i=>{let n=cP()(t,e);async function s(o,a={}){return n(o,{...a,format:"dag-pb",hashAlg:"sha2-256",version:0})}return s})(e)});var spe=y((JNt,npe)=>{f();"use strict";var{CID:Sct}=(Ie(),Ne),xct=ve(),Act=Se();npe.exports=xct(t=>{async function e(r,i={}){let s=await(await t.post("object/stat",{signal:i.signal,searchParams:Act({arg:`${r}`,...i}),headers:i.headers})).json();return{...s,Hash:Sct.parse(s.Hash)}}return e})});var ape=y((eBt,ope)=>{f();"use strict";ope.exports=(t,e)=>({data:Mhe()(e),get:Fhe()(e),links:Vhe()(e),new:Hhe()(e),patch:tpe()(e),put:ipe()(t,e),stat:spe()(e)})});var upe=y((tBt,cpe)=>{f();"use strict";var Ict=lS(),dP=Se(),uu=class{constructor(e){this.client=new Ict(e)}static encodeEndpoint(e){let r=String(e);if(r==="undefined")throw Error("endpoint is required");return r[r.length-1]==="/"?r.slice(0,-1):r}static decodeRemoteService(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:uu.decodeStat(e.Stat)}}}static decodeStat(e){switch(e.Status){case"valid":{let{Pinning:r,Pinned:i,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:r,pinned:i,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}};uu.prototype.add=async function(e,r){let{endpoint:i,key:n,headers:s,timeout:o,signal:a}=r;await this.client.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:dP({arg:[e,uu.encodeEndpoint(i),n]}),headers:s})};uu.prototype.rm=async function(e,r={}){await this.client.post("pin/remote/service/rm",{signal:r.signal,headers:r.headers,searchParams:dP({arg:e})})};uu.prototype.ls=async function(e={}){let{stat:r,headers:i,timeout:n,signal:s}=e,o=await this.client.post("pin/remote/service/ls",{timeout:n,signal:s,headers:i,searchParams:r===!0?dP({stat:r}):void 0}),{RemoteServices:a}=await o.json();return a.map(uu.decodeRemoteService)};cpe.exports=uu});var gpe=y((rBt,ype)=>{f();"use strict";var{CID:lpe}=(Ie(),Ne),Tct=lS(),Rct=upe(),fpe=Se(),A0=class{constructor(e){this.client=new Tct(e),this.service=new Rct(e)}};A0.prototype.add=async function(e,{timeout:r,signal:i,headers:n,...s}){let o=await this.client.post("pin/remote/add",{timeout:r,signal:i,headers:n,searchParams:Pct({cid:e,...s})});return dpe(await o.json())};A0.prototype.ls=async function*({timeout:e,signal:r,headers:i,...n}){let s=await this.client.post("pin/remote/ls",{timeout:e,signal:r,headers:i,searchParams:hP(n)});for await(let o of s.ndjson())yield dpe(o)};A0.prototype.rm=async function({timeout:e,signal:r,headers:i,...n}){await this.client.post("pin/remote/rm",{timeout:e,signal:r,headers:i,searchParams:hP({...n,all:!1})})};A0.prototype.rmAll=async function({timeout:t,signal:e,headers:r,...i}){await this.client.post("pin/remote/rm",{timeout:t,signal:e,headers:r,searchParams:hP({...i,all:!0})})};var dpe=({Name:t,Status:e,Cid:r})=>({cid:lpe.parse(r),name:t,status:e}),hpe=t=>{if(typeof t=="string"&&t!=="")return t;throw new TypeError("service name must be passed")},ppe=t=>{if(lpe.asCID(t))return t.toString();throw new TypeError(`CID instance expected instead of ${typeof t}`)},hP=({service:t,cid:e,name:r,status:i,all:n})=>{let s=fpe({service:hpe(t),name:r,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",ppe(o));if(i)for(let o of i)s.append("status",o);return s},Pct=({cid:t,service:e,background:r,name:i,origins:n})=>{let s=fpe({arg:ppe(t),service:hpe(e),name:i,background:r?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};ype.exports=A0});var pP=y((iBt,mpe)=>{f();"use strict";var{CID:bpe}=(Ie(),Ne),Cct=ve(),{normaliseInput:Oct}=lp(),kct=Se();mpe.exports=Cct(t=>{async function*e(r,i={}){for await(let{path:n,recursive:s,metadata:o}of Oct(r)){let a=await t.post("pin/add",{signal:i.signal,searchParams:kct({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let u of c.Pins)yield bpe.parse(u);continue}yield bpe.parse(c)}}}return e})});var wpe=y((nBt,vpe)=>{f();"use strict";var qct=pP(),Dct=$n(),Nct=ve();vpe.exports=t=>{let e=qct(t);return Nct(()=>{async function r(i,n={}){return Dct(e([{path:i,...n}],n))}return r})(t)}});var Spe=y((sBt,Epe)=>{f();"use strict";var{CID:Bct}=(Ie(),Ne),Mct=ve(),Lct=Se();function _pe(t,e,r){let i={type:t,cid:Bct.parse(e)};return r&&(i.metadata=r),i}Epe.exports=Mct(t=>{async function*e(r={}){let i=[];r.paths&&(i=Array.isArray(r.paths)?r.paths:[r.paths]);let n=await t.post("pin/ls",{signal:r.signal,searchParams:Lct({...r,arg:i.map(s=>`${s}`),stream:!0}),headers:r.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield _pe(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield _pe(s.Type,s.Cid,s.Metadata)}}return e})});var yP=y((oBt,Ape)=>{f();"use strict";var{CID:xpe}=(Ie(),Ne),Uct=ve(),{normaliseInput:Fct}=lp(),Kct=Se();Ape.exports=Uct(t=>{async function*e(r,i={}){for await(let{path:n,recursive:s}of Fct(r)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await t.post("pin/rm",{signal:i.signal,headers:i.headers,searchParams:Kct({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(u=>xpe.parse(u));continue}yield xpe.parse(c)}}}return e})});var Tpe=y((aBt,Ipe)=>{f();"use strict";var jct=yP(),Vct=$n(),zct=ve();Ipe.exports=t=>{let e=jct(t);return zct(()=>{async function r(i,n={}){return Vct(e([{path:i,...n}],n))}return r})(t)}});var Ppe=y((cBt,Rpe)=>{f();"use strict";var Hct=gpe();Rpe.exports=t=>({add:wpe()(t),addAll:pP()(t),ls:Spe()(t),rm:Tpe()(t),rmAll:yP()(t),remote:new Hct(t)})});var Ope=y((uBt,Cpe)=>{f();"use strict";var $ct=Hr(),Gct=ve(),Wct=Se();Cpe.exports=Gct(t=>{async function*e(r,i={}){yield*(await t.post("ping",{signal:i.signal,searchParams:Wct({arg:`${r}`,...i}),headers:i.headers,transform:$ct})).ndjson()}return e})});var Dpe=y((lBt,qpe)=>{f();"use strict";var{AbortController:Yct}=nn(),kpe=class{constructor(){this._subs=new Map}subscribe(e,r,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===r))throw new Error(`Already subscribed to ${e} with this handler`);let s=new Yct;return this._subs.set(e,[{handler:r,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,r)),s.signal}unsubscribe(e,r){let i=this._subs.get(e)||[],n;r?(this._subs.set(e,i.filter(s=>s.handler!==r)),n=i.filter(s=>s.handler===r)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};qpe.exports=kpe});var Bpe=y((fBt,Npe)=>{f();"use strict";var Xct=ve(),Qct=Se();Npe.exports=Xct(t=>{async function e(r={}){let{Strings:i}=await(await t.post("pubsub/ls",{signal:r.signal,searchParams:Qct(r),headers:r.headers})).json();return i||[]}return e})});var Lpe=y((dBt,Mpe)=>{f();"use strict";var Zct=ve(),Jct=Se();Mpe.exports=Zct(t=>{async function e(r,i={}){let n=await t.post("pubsub/peers",{signal:i.signal,searchParams:Jct({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var Fpe=y((hBt,Upe)=>{f();"use strict";var eut=ve(),tut=Se(),rut=Qo(),iut=Zo(),{AbortController:nut}=nn();Upe.exports=eut(t=>{async function e(r,i,n={}){let s=tut({arg:r,...n}),o=new nut,a=iut(o.signal,n.signal);await(await t.post("pubsub/pub",{signal:a,searchParams:s,...await rut(i,o,n.headers)})).text()}return e})});var jpe=y((pBt,Kpe)=>{f();"use strict";var{fromString:gP}=(ft(),ht),{toString:sut}=(tt(),et),out=me()("ipfs-http-client:pubsub:subscribe"),aut=ve(),cut=Se();Kpe.exports=(t,e)=>aut(r=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,u=new Promise((d,h)=>{a=d,c=h}),l=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{signal:o.signal,searchParams:cut({arg:n,...o}),headers:o.headers}).catch(d=>{e.unsubscribe(n,s),c(d)}).then(d=>{clearTimeout(l),!!d&&(uut(d,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())}),u}return i})(t);async function uut(t,{onMessage:e,onEnd:r,onError:i}){i=i||out;try{for await(let n of t.ndjson())try{if(!n.from)continue;e({from:sut(gP(n.from,"base64pad"),"base58btc"),data:gP(n.data,"base64pad"),seqno:gP(n.seqno,"base64pad"),topicIDs:n.topicIDs})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){lut(n)||i(n,!0)}finally{r()}}var lut=t=>{switch(t.type){case"aborted":return!0;case"abort":return!0;default:return t.name==="AbortError"}}});var zpe=y((yBt,Vpe)=>{f();"use strict";Vpe.exports=(t,e)=>{async function r(i,n){e.unsubscribe(i,n)}return r}});var $pe=y((gBt,Hpe)=>{f();"use strict";var fut=Dpe();Hpe.exports=t=>{let e=new fut;return{ls:Bpe()(t),peers:Lpe()(t),publish:Fpe()(t),subscribe:jpe()(t,e),unsubscribe:zpe()(t,e)}}});var Wpe=y((bBt,Gpe)=>{f();"use strict";var dut=Hr(),hut=ve(),put=Se();Gpe.exports=hut(t=>{async function*e(r={}){yield*(await t.post("refs/local",{signal:r.signal,transform:dut,searchParams:put(r),headers:r.headers})).ndjson()}return e})});var Xpe=y((mBt,Ype)=>{f();"use strict";var{CID:yut}=(Ie(),Ne),gut=Hr(),but=ve(),mut=Se();Ype.exports=but((t,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await t.post("refs",{signal:n.signal,searchParams:mut({arg:s.map(a=>`${a instanceof Uint8Array?yut.decode(a):a}`),...n}),headers:n.headers,transform:gut})).ndjson()},{local:Wpe()(e)}))});var Zpe=y((vBt,Qpe)=>{f();"use strict";var{CID:vut}=(Ie(),Ne),wut=ve(),_ut=Se();Qpe.exports=wut(t=>{async function*e(r={}){yield*(await t.post("repo/gc",{signal:r.signal,searchParams:_ut(r),headers:r.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?vut.parse(n.Key["/"]):null})})).ndjson()}return e})});var bP=y((wBt,Jpe)=>{f();"use strict";var Eut=ve(),Sut=Se();Jpe.exports=Eut(t=>{async function e(r={}){let n=await(await t.post("repo/stat",{signal:r.signal,searchParams:Sut(r),headers:r.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e})});var t0e=y((_Bt,e0e)=>{f();"use strict";var xut=ve(),Aut=Se();e0e.exports=xut(t=>{async function e(r={}){return(await(await t.post("repo/version",{signal:r.signal,searchParams:Aut(r),headers:r.headers})).json()).Version}return e})});var i0e=y((EBt,r0e)=>{f();"use strict";r0e.exports=t=>({gc:Zpe()(t),stat:bP()(t),version:t0e()(t)})});var s0e=y((SBt,n0e)=>{f();"use strict";var Iut=ve(),Tut=Se();n0e.exports=Iut(t=>{async function e(r,i={}){let n=await t.post("resolve",{signal:i.signal,searchParams:Tut({arg:r,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e})});var a0e=y((xBt,o0e)=>{f();"use strict";var Rut=ve(),Put=ue();o0e.exports=Rut(t=>async(r={})=>{throw Put(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var u0e=y((ABt,c0e)=>{f();"use strict";var Cut=ve(),Out=Se();c0e.exports=Cut(t=>{async function*e(r={}){yield*(await t.post("stats/bw",{signal:r.signal,searchParams:Out(r),headers:r.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e})});var f0e=y((IBt,l0e)=>{f();"use strict";l0e.exports=t=>({bitswap:oP()(t),bw:u0e()(t),repo:bP()(t)})});var h0e=y((TBt,d0e)=>{f();"use strict";var kut=ve(),qut=Se();d0e.exports=kut(t=>{async function e(r={}){await(await t.post("shutdown",{signal:r.signal,searchParams:qut(r),headers:r.headers})).text()}return e})});var y0e=y((RBt,p0e)=>{f();"use strict";var{Multiaddr:Dut}=it(),Nut=ve(),But=Se();p0e.exports=Nut(t=>{async function e(r={}){let i=await t.post("swarm/addrs",{signal:r.signal,searchParams:But(r),headers:r.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new Dut(o))}))}return e})});var b0e=y((PBt,g0e)=>{f();"use strict";var Mut=ve(),Lut=Se();g0e.exports=Mut(t=>{async function e(r,i={}){let n=await t.post("swarm/connect",{signal:i.signal,searchParams:Lut({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var v0e=y((CBt,m0e)=>{f();"use strict";var Uut=ve(),Fut=Se();m0e.exports=Uut(t=>{async function e(r,i={}){let n=await t.post("swarm/disconnect",{signal:i.signal,searchParams:Fut({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var _0e=y((OBt,w0e)=>{f();"use strict";var{Multiaddr:Kut}=it(),jut=ve(),Vut=Se();w0e.exports=jut(t=>{async function e(r={}){let i=await t.post("swarm/addrs/local",{signal:r.signal,searchParams:Vut(r),headers:r.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new Kut(s))}return e})});var S0e=y((kBt,E0e)=>{f();"use strict";var{Multiaddr:zut}=it(),Hut=ve(),$ut=Se();E0e.exports=Hut(t=>{async function e(r={}){let i=await t.post("swarm/peers",{signal:r.signal,searchParams:$ut(r),headers:r.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new zut(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e})});var A0e=y((qBt,x0e)=>{f();"use strict";x0e.exports=t=>({addrs:y0e()(t),connect:b0e()(t),disconnect:v0e()(t),localAddrs:_0e()(t),peers:S0e()(t)})});var T0e=y((DBt,I0e)=>{f();"use strict";var Gut=Hr(),Wut=ve(),Yut=Se();I0e.exports=Wut(t=>{async function e(r={}){let i=await t.post("version",{signal:r.signal,searchParams:Yut(r),headers:r.headers});return Gut(await i.json())}return e})});var C0e=y((NBt,P0e)=>{f();"use strict";var{CID:Xut}=(Ie(),Ne),{multiaddr:Qut}=it(),Zut=kx(),Jut=Vx(),elt=Z8(),tlt=J8(),rlt=eP(),ilt=(_t(),Mt),nlt=(zc(),Xw),{identity:R0e}=(Cc(),Pc),{bases:slt,hashes:olt,codecs:alt}=(Vv(),F6);function clt(t={}){let e={name:R0e.name,code:R0e.code,encode:u=>u,decode:u=>u},r=Object.values(slt);(t.ipld&&t.ipld.bases?t.ipld.bases:[]).forEach(u=>r.push(u));let i=new rlt({bases:r,loadBase:t.ipld&&t.ipld.loadBase}),n=Object.values(alt);[ilt,nlt,e].concat(t.ipld&&t.ipld.codecs||[]).forEach(u=>n.push(u));let s=new elt({codecs:n,loadCodec:t.ipld&&t.ipld.loadCodec}),o=Object.values(olt);(t.ipld&&t.ipld.hashers?t.ipld.hashers:[]).forEach(u=>o.push(u));let a=new tlt({hashers:o,loadHasher:t.ipld&&t.ipld.loadHasher});return{add:Ple()(t),addAll:sP()(t),bitswap:Lle()(t),block:Gle()(t),bootstrap:sfe()(t),cat:afe()(t),commands:ufe()(t),config:Afe()(t),dag:Ffe()(s,t),dht:tde()(t),diag:ude()(t),dns:fde()(t),files:Ude()(t),get:Kde()(t),getEndpointConfig:Vde()(t),id:fP()(t),isOnline:$de()(t),key:che()(t),log:ghe()(t),ls:vhe()(t),mount:_he()(t),name:Nhe()(t),object:ape()(s,t),pin:Ppe()(t),ping:Ope()(t),pubsub:$pe()(t),refs:Xpe()(t),repo:i0e()(t),resolve:s0e()(t),start:a0e()(t),stats:f0e()(t),stop:h0e()(t),swarm:A0e()(t),version:T0e()(t),bases:i,codecs:s,hashers:a}}P0e.exports={create:clt,CID:Xut,multiaddr:Qut,globSource:Zut,urlSource:Jut}});var mP=y((BBt,O0e)=>{f();"use strict";var ult=ue(),llt=Fa(),flt=No(),dlt=cp();function hlt(t,e){return flt(t,r=>(e.addressBook.add(r.id,r.multiaddrs),r))}function plt(t){let e=new Set;return llt(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*ylt(t,e=1){let r=0;for await(let i of t)r++,yield i;if(r<e)throw ult(new Error("not found"),"NOT_FOUND")}function glt(t,e){return e?dlt(t,e):t}O0e.exports={storeAddresses:hlt,uniquePeers:plt,requirePeers:ylt,maybeLimitSource:glt}});var vP=y((MBt,k0e)=>{f();"use strict";var I0=new Map,blt=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function mlt(t,e,r){for(;I0.get(r);){try{await t()}catch(i){setTimeout(()=>{throw i},1);break}if(!I0.get(r))break;await new Promise(i=>{let n=setTimeout(i,e);I0.set(r,n)})}}function vlt(t,e,r){r=r||e;let i=blt(),n=setTimeout(()=>{mlt(t,e,i)},r);return I0.set(i,n),i}function wlt(t){let e=I0.get(t);e&&(clearTimeout(e),I0.delete(t))}k0e.exports={setDelayedInterval:vlt,clearDelayedInterval:wlt}});var U0e=y((LBt,L0e)=>{f();"use strict";var q0e=me(),_lt=Object.assign(q0e("libp2p:peer-routing"),{error:q0e("libp2p:peer-routing:err")}),hS=ue(),{storeAddresses:D0e,uniquePeers:Elt,requirePeers:Slt}=mP(),N0e=mp(),{pipe:B0e}=Ar(),xlt=Df(),Alt=Ua(),Ilt=Fa(),{setDelayedInterval:Tlt,clearDelayedInterval:Rlt}=vP(),M0e=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=Tlt(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await Alt(this.getClosestPeers(this._peerId.id))}catch(e){_lt.error(e)}}stop(){Rlt(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw hS(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw hS(new Error("Should not try to find self"),"ERR_FIND_SELF");let i=await B0e(N0e(...this._routers.map(n=>[n.findPeer(e,r)])),n=>Ilt(n,Boolean),n=>D0e(n,this._peerStore),n=>xlt(n));if(i)return i;throw hS(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw hS(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*B0e(N0e(...this._routers.map(i=>i.getClosestPeers(e,r))),i=>D0e(i,this._peerStore),i=>Elt(i),i=>Slt(i))}};L0e.exports=M0e});var j0e=y((UBt,K0e)=>{f();"use strict";var F1=ue(),{messages:wP,codes:_P}=yi(),{storeAddresses:Plt,uniquePeers:Clt,requirePeers:Olt,maybeLimitSource:klt}=mP(),qlt=mp(),{pipe:Dlt}=Ar(),F0e=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,r={}){if(!this.routers.length)throw F1(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*Dlt(qlt(...this.routers.map(i=>i.findProviders(e,r))),i=>Plt(i,this.libp2p.peerStore),i=>Clt(i),i=>klt(i,r.maxNumProviders),i=>Olt(i))}async provide(e){if(!this.routers.length)throw F1(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(r=>r.provide(e)))}put(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw F1(new Error(wP.NOT_STARTED_YET),_P.DHT_NOT_STARTED);return this.dht.put(e,r,i)}get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw F1(new Error(wP.NOT_STARTED_YET),_P.DHT_NOT_STARTED);return this.dht.get(e,r)}async getMany(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw F1(new Error(wP.NOT_STARTED_YET),_P.DHT_NOT_STARTED);return this.dht.getMany(e,r,i)}};K0e.exports=F0e});var EP=y((FBt,$0e)=>{f();"use strict";var Nlt=rt(),{Multiaddr:V0e}=it(),z0e=ue(),{codes:H0e}=yi();function Blt(t){typeof t=="string"&&(t=new V0e(t));let e;if(V0e.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw z0e(new Error(`${t} does not have a valid peer type`),H0e.ERR_INVALID_MULTIADDR);try{t=Nlt.createFromB58String(r)}catch(i){throw z0e(new Error(`${t} is not a valid peer type`),H0e.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}$0e.exports=Blt});var Y0e=y((KBt,W0e)=>{f();"use strict";W0e.exports=G0e;var Mlt=nI(),Ll=G0e.prototype,Llt=new Date%1e9;function Ult(){return(Math.random()*1e9>>>0)+Llt++}function G0e(t){t=t||{},this.id=t.id||Ult(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,i=this.items.length;i--;)e=this.items[i],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Ll.has=function(t){return t in this._lookup};Ll.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Ll.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};Ll.set=function(t,e,r){var i=this._lookup[t],n=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(n.meta=r.meta),r.refresh&&(n.refresh=r.ttl)),this};Ll.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};Ll.expire=function(t,e){var r=e||0,i=this._lookup[t];if(!i)return this;if(typeof r=="string"&&(r=Mlt(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),r),i.expires=Number(new Date)+r,this};Ll.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};Ll.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var Q0e=y((jBt,X0e)=>{f();"use strict";var{default:Flt,Headers:Klt}=Bx();function jlt({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function Vlt(t){return Flt(t,{headers:new Klt({accept:"application/dns-json"})})}function zlt(t,e){return`${e}_${t}`}X0e.exports={buildResource:jlt,fetch:Vlt,getCacheKey:zlt}});var eye=y((VBt,J0e)=>{f();"use strict";var Z0e=me(),pS=Z0e("dns-over-http-resolver");pS.error=Z0e("dns-over-http-resolver:error");var Hlt=Y0e(),Zs=Q0e(),yS=class{constructor({maxCache:e=100}={}){this._cache=new Hlt({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let i=Math.floor(Math.random()*r),n=e[r];e[r]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",i=this._cache.get(Zs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Zs.fetch(Zs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Zs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){pS.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",i=this._cache.get(Zs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Zs.fetch(Zs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Zs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){pS.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",i=this._cache.get(Zs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Zs.fetch(Zs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Zs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){pS.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};yS.Resolver=yS;J0e.exports=yS});var rye=y((zBt,tye)=>{f();"use strict";var $lt=eye();tye.exports=$lt});var nye=y((HBt,iye)=>{f();"use strict";var Glt=Rg(),{code:Wlt}=Glt("dnsaddr");async function Ylt(t){let e=rye(),r=new e,i=t.getPeerId(),[,n]=t.stringTuples().find(([a])=>a===Wlt)||[],o=(await r.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}iye.exports={dnsaddrResolver:Ylt}});var gS=y(($Bt,sye)=>{f();"use strict";sye.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var SP=y((GBt,Xlt)=>{Xlt.exports={name:"libp2p",version:"0.32.4",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=14.0.0"},browser:{"@motrix/nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use"]},dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^5.1.1","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^1.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.15.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^1.1.1",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^4.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0",aegir:"^33.1.1",buffer:"^6.0.3",delay:"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.13.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.0","libp2p-interfaces-compliance-tests":"^1.0.0","libp2p-kad-dht":"^0.23.0","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.1","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^11.1.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","dirkmc <dirkmdev@gmail.com>","Richard Littauer <richard.littauer@gmail.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Ryan Bell <ryan@piing.net>","a1300 <matthias-knopp@gmx.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Elven <mon.samuel@qq.com>","Franck Royer <franck@royer.one>","Giovanni T. Parra <fiatjaf@gmail.com>","Samlior <samlior@foxmail.com>","Thomas Eizinger <thomas@eizinger.io>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Didrik Nordstr\xF6m <didrik@betamos.se>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Ethan Lam <elmemphis2000@gmail.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Diogo Silva <fsdiogo@gmail.com>","Robert Kiel <robert.kiel@hoprnet.org>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","TJKoury <TJKoury@gmail.com>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","swedneck <40505480+swedneck@users.noreply.github.com>","Aleksei <vozhdb@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","Chris Bratlien <chrisbratlien@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","Bernd Strehl <bernd.strehl@gmail.com>","Francis Gulotta <wizard@roborooter.com>","isan_rivkin <isanrivkin@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","mcclure <andi.m.mcclure@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Fei Liu <liu.feiwood@gmail.com>"]}});var xP=y((WBt,nc)=>{f();"use strict";var Qlt=SP().version;nc.exports.PROTOCOL_VERSION="ipfs/0.1.0";nc.exports.AGENT_VERSION=`js-libp2p/${Qlt}`;nc.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";nc.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";nc.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";nc.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";nc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";nc.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";nc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var bS=y((YBt,aye)=>{f();"use strict";var oye=60*1e3;aye.exports={ADVERTISE_BOOT_DELAY:15*oye,ADVERTISE_TTL:30*oye,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var cye=y(K1=>{f();(function(){var t,e,r,i,n,s,o,a;a=function(c){var u,l,d,h;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,d=(c&255<<8)>>>8,h=c&255,[u,l,d,h].join(".")},o=function(c){var u,l,d,h,p,g;for(u=[],d=h=0;h<=3&&c.length!==0;d=++h){if(d>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}g=e(c),p=g[0],l=g[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},i=r("0"),s=r("a"),n=r("A"),e=function(c){var u,l,d,h,p;for(h=0,u=10,l="9",d=0,c.length>1&&c[d]==="0"&&(c[d+1]==="x"||c[d+1]==="X"?(d+=2,u=16):"0"<=c[d+1]&&c[d+1]<="9"&&(d++,u=8,l="7")),p=d;d<c.length;){if("0"<=c[d]&&c[d]<=l)h=h*u+(r(c[d])-i)>>>0;else if(u===16)if("a"<=c[d]&&c[d]<="f")h=h*u+(10+r(c[d])-s)>>>0;else if("A"<=c[d]&&c[d]<="F")h=h*u+(10+r(c[d])-n)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");d++}if(d===p)throw new Error("empty octet");return[h,d]},t=function(){function c(u,l){var d,h,p,g;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(g=u.split("/",2),u=g[0],l=g[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(m){throw d=m,new Error("Invalid mask: "+l)}for(h=p=32;p>=0;h=--p)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(m){throw d=m,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,d,h;for(h=o(this.first),d=o(this.last),l=0;h<=d;)u(a(h),h,l),l++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),K1.ip2long=o,K1.long2ip=a,K1.Netmask=t}).call(K1)});var fye=y((QBt,lye)=>{f();var Zlt=cye().Netmask,uye=MA(),Jlt=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],eft=Jlt.map(t=>new Zlt(t));function tft(t){for(let e of eft)if(e.contains(t))return!0;return!1}function rft(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}lye.exports=t=>uye.v6().test(t)?rft(t):uye().test(t)||t.startsWith("0")?tft(t):!1});var AP=y((ZBt,dye)=>{f();"use strict";dye.exports=fye()});var pye=y((JBt,hye)=>{f();"use strict";var ift=AP();function nft(t){let{address:e}=t.nodeAddress();return ift(e)}hye.exports=nft});var IP=y((eMt,gye)=>{f();"use strict";var yye=pye();function sft(t,e){let r=yye(t.multiaddr),i=yye(e.multiaddr);return r&&!i?1:!r&&i||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function oft(t){return[...t].sort(sft)}gye.exports.publicAddressesFirst=oft});var mye=y((tMt,TP)=>{f();"use strict";var bye=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};TP.exports=bye;TP.exports.default=bye});var wye=y((rMt,RP)=>{f();"use strict";var vye=(t,...e)=>new Promise(r=>{r(t(...e))});RP.exports=vye;RP.exports.default=vye});var Eye=y((iMt,PP)=>{f();"use strict";var aft=wye(),_ye=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,i=()=>{r--,e.length>0&&e.shift()()},n=(a,c,...u)=>{r++;let l=aft(a,...u);c(l),l.then(i,i)},s=(a,c,...u)=>{r<t?n(a,c,...u):e.push(n.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};PP.exports=_ye;PP.exports.default=_ye});var xye=y((nMt,Sye)=>{f();"use strict";var CP=mye(),cft=Eye();Sye.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,i=cft(r);return Promise.all(t.map(n=>n&&typeof n.then=="function"?CP(n):typeof n=="function"?CP(i(()=>n())):CP(Promise.resolve(n))))}});var Iye=y((sMt,Aye)=>{f();"use strict";function uft(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,i)=>e[i].equals(r))}Aye.exports=uft});var Pye=y((oMt,Rye)=>{f();"use strict";var Id=ki(),mS=Id.Reader,Tye=Id.Writer,$r=Id.util,Js=Id.roots["libp2p-peer-record"]||(Id.roots["libp2p-peer-record"]={});Js.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.peerId=$r.newBuffer([]),t.prototype.seq=$r.Long?$r.Long.fromBits(0,0,!0):0,t.prototype.addresses=$r.emptyArray,t.encode=function(r,i){if(i||(i=Tye.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&i.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&i.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var n=0;n<r.addresses.length;++n)Js.PeerRecord.AddressInfo.encode(r.addresses[n],i.uint32(26).fork()).ldelim();return i},t.decode=function(r,i){r instanceof mS||(r=mS.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Js.PeerRecord;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(Js.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Js.PeerRecord)return r;var i=new Js.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?$r.base64.decode(r.peerId,i.peerId=$r.newBuffer($r.base64.length(r.peerId)),0):r.peerId.length&&(i.peerId=r.peerId)),r.seq!=null&&($r.Long?(i.seq=$r.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?i.seq=parseInt(r.seq,10):typeof r.seq=="number"?i.seq=r.seq:typeof r.seq=="object"&&(i.seq=new $r.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<r.addresses.length;++n){if(typeof r.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=Js.PeerRecord.AddressInfo.fromObject(r.addresses[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=$r.newBuffer(n.peerId))),$r.Long){var s=new $r.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?$r.base64.encode(r.peerId,0,r.peerId.length):i.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?n.seq=i.longs===String?String(r.seq):r.seq:n.seq=i.longs===String?$r.Long.prototype.toString.call(r.seq):i.longs===Number?new $r.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){n.addresses=[];for(var o=0;o<r.addresses.length;++o)n.addresses[o]=Js.PeerRecord.AddressInfo.toObject(r.addresses[o],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Id.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=$r.newBuffer([]),e.encode=function(i,n){return n||(n=Tye.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof mS||(i=mS.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Js.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Js.PeerRecord.AddressInfo)return i;var n=new Js.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?$r.base64.decode(i.multiaddr,n.multiaddr=$r.newBuffer($r.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=$r.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?$r.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Id.util.toJSONOptions)},e}(),t}();Rye.exports=Js});var Oye=y((aMt,Cye)=>{f();"use strict";var lft="libp2p-peer-record",fft=Uint8Array.from([3,1]);Cye.exports={ENVELOPE_DOMAIN_PEER_RECORD:lft,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:fft}});var vS=y((cMt,Dye)=>{f();"use strict";var{Multiaddr:dft}=it(),hft=rt(),pft=Iye(),{PeerRecord:kye}=Pye(),{ENVELOPE_DOMAIN_PEER_RECORD:qye,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:yft}=Oye(),Td=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:i=Date.now()}){this.domain=qye,this.codec=yft,this.peerId=e,this.multiaddrs=r,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=kye.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Td)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!pft(this.multiaddrs,e.multiaddrs))}};Td.createFromProtobuf=t=>{let e=kye.decode(t),r=hft.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new dft(s.multiaddr)),n=Number(e.seq);return new Td({peerId:r,multiaddrs:i,seqNumber:n})};Td.DOMAIN=qye;Dye.exports=Td});var OP=y((uMt,Nye)=>{f();"use strict";var gft=M1(),bft=vS();async function mft(t){let e=new bft({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await gft.seal(e,t.peerId);t.peerStore.addressBook.consumePeerRecord(r)}Nye.exports.updateSelfPeerRecord=mft});var qP=y((lMt,Lye)=>{f();"use strict";var Bye=me(),Rd=Object.assign(Bye("libp2p:transports"),{error:Bye("libp2p:transports:err")}),vft=xye(),{codes:T0}=yi(),j1=ue(),{updateSelfPeerRecord:Mye}=OP(),kP=class{constructor({libp2p:e,upgrader:r,faultTolerance:i=wS.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,r,i={}){if(Rd("adding %s",e),!e)throw j1(new Error(`Transport must have a valid key, was given '${e}'`),T0.ERR_INVALID_KEY);if(this._transports.has(e))throw j1(new Error("There is already a transport with this key"),T0.ERR_DUPLICATE_TRANSPORT);let n=new r({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,i]of this._listeners)for(Rd("closing listeners for %s",r);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),Rd("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let i=this.transportForMultiaddr(e);if(!i)throw j1(new Error(`No transport available for address ${String(e)}`),T0.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,r)}catch(n){throw n.code||(n.code=T0.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let i of r)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){Rd("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let u of s){Rd("creating listener for %s on %s",i,u);let l=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(l),l.on("listening",()=>Mye(this.libp2p)),l.on("close",()=>Mye(this.libp2p)),o.push(l.listen(u))}if(o.length===0){r.push(i);continue}if(!(await vft(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==wS.NO_FATAL)throw j1(new Error(`Transport (${i}) could not listen on any available address`),T0.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let i=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===wS.FATAL_ALL)throw j1(new Error(i),T0.ERR_NO_VALID_ADDRESSES);Rd(`libp2p in dial mode only: ${i}`)}}async remove(e){if(Rd("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},wS={FATAL_ALL:0,NO_FATAL:1};kP.FaultTolerance=wS;Lye.exports=kP});var Kye=y((fMt,Fye)=>{f();"use strict";var wft=gr(),{dnsaddrResolver:_ft}=nye(),DP=gS(),{AGENT_VERSION:Eft}=xP(),Uye=bS(),{publicAddressesFirst:Sft}=IP(),{FaultTolerance:xft}=qP(),Aft={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},transportManager:{faultTolerance:xft.FATAL_ALL},dialer:{maxParallelDials:DP.MAX_PARALLEL_DIALS,maxDialsPerPeer:DP.MAX_PER_PEER_DIALS,dialTimeout:DP.DIAL_TIMEOUT,resolvers:{dnsaddr:_ft},addressSorter:Sft},host:{agentVersion:Eft},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:Uye.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:Uye.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};Fye.exports.validate=t=>{let e=wft(Aft,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var zye=y((dMt,Vye)=>{f();"use strict";var{EventEmitter:Ift}=yr(),{Multiaddr:V1}=it(),Tft=rt(),jye=class extends Ift{constructor(e,{listen:r=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new V1(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new V1(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new V1(e))}addObservedAddr(e){let r=new V1(e),i=r.getPeerId();i&&Tft.createFromB58String(i).equals(this.peerId)&&(r=r.decapsulate(new V1(`/p2p/${this.peerId}`)));let n=r.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};Vye.exports=jye});var Gye=y((hMt,$ye)=>{f();"use strict";var{EventEmitter:Rft}=yr(),NP=me()("latency-monitor:VisibilityChangeEmitter"),Hye=class extends Rft{constructor(){super();if(typeof document=="undefined"){NP('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?NP("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];NP(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};$ye.exports=Hye});var Xye=y((pMt,Yye)=>{f();"use strict";var{EventEmitter:Pft}=yr(),Cft=Gye(),lu=me()("latency-monitor:LatencyMonitor"),Wye=class extends Pft{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,lu("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?lu("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):lu("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(lu("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(lu("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(lu("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),Oft()&&(this._visibilityChangeEmitter=new Cft,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),lu("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,lu("MS: %s Data: %O",s,e._latencyData)};lu("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function Oft(){return typeof window!="undefined"}Yye.exports=Wye});var Zye=y((yMt,Qye)=>{f();"use strict";Qye.exports=function(){return Date.now()}});var BP=y((gMt,ege)=>{f();"use strict";var _S=Zye(),Jye=class{constructor(e,r,i){let n=this;this._started=_S(),this._rescheduled=0,this._scheduled=r,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(_S()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=_S();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=_S(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function kft(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new Jye(arguments[0],arguments[1],t)}ege.exports=kft});var oge=y((bMt,sge)=>{f();"use strict";var tge=me(),Jo=Object.assign(tge("libp2p:connection-manager"),{error:tge("libp2p:connection-manager:err")}),rge=ue(),qft=gr(),Dft=Xye(),ES=BP(),{EventEmitter:Nft}=yr(),Bft=rt(),{codes:{ERR_INVALID_PARAMETERS:ige}}=yi(),Mft={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},nge=class extends Nft{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=qft.call({ignoreUndefined:!0},Mft,r),this._options.maxConnections<this._options.minConnections)throw rge(new Error("Connection Manager maxConnections must be greater than minConnections"),ige);Jo("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new Dft({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||ES(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,Jo("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),Jo("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let i of r)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",r);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",i);let n=r+i;this._checkMaxLimit("maxData",n),Jo("metrics update",n),this._timer=ES(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let r=e.remotePeer,i=r.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let r=e.remotePeer.toB58String(),i=this.connections.get(r);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(r,i)):i&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!Bft.isPeerId(e))throw rge(new Error("peerId must be an instance of peer-id"),ige);let r=e.toB58String(),i=this.connections.get(r);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,r){let i=this._options[e];Jo("checking limit of %s. current value: %d of %d",e,r,i),r>i&&(Jo("%s: limit exceeded: %s, %d",this._peerId,e,r),this._maybeDisconnectOne())}async _autoDial(){let e=this._options.minConnections;if(this.size>=e){this._autoDialTimeout=ES(this._autoDial,this._options.autoDialInterval);return}let r=Array.from(this._libp2p.peerStore.peers.values()).sort((i,n)=>n.protocols&&n.protocols.length&&(!i.protocols||!i.protocols.length)||n.id.pubKey&&!i.id.pubKey?1:-1);for(let i=0;i<r.length&&this.size<e;i++)if(!this.get(r[i].id)){Jo("connecting to a peerStore stored peer %s",r[i].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(r[i].id),!this._started)return}catch(n){Jo.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=ES(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));Jo("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let i=r[0];Jo("%s: lowest value peer is %s",this._peerId,i),Jo("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close();break}}}}};sge.exports=nge});var R0=y((mMt,cge)=>{f();"use strict";var Pd=ki(),SS=Pd.Reader,age=Pd.Writer,eo=Pd.util,Hi=Pd.roots["libp2p-circuit"]||(Pd.roots["libp2p-circuit"]={});Hi.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,i){return i||(i=age.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&i.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&Hi.CircuitRelay.Peer.encode(r.srcPeer,i.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&Hi.CircuitRelay.Peer.encode(r.dstPeer,i.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&i.uint32(32).int32(r.code),i},t.decode=function(r,i){r instanceof SS||(r=SS.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Hi.CircuitRelay;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=Hi.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=Hi.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Hi.CircuitRelay)return r;var i=new Hi.CircuitRelay;switch(r.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Hi.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Hi.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(n.type=i.enums===String?Hi.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(n.srcPeer=Hi.CircuitRelay.Peer.toObject(r.srcPeer,i)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(n.dstPeer=Hi.CircuitRelay.Peer.toObject(r.dstPeer,i)),r.code!=null&&r.hasOwnProperty("code")&&(n.code=i.enums===String?Hi.CircuitRelay.Status[r.code]:r.code),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Pd.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.id=eo.newBuffer([]),e.prototype.addrs=eo.emptyArray,e.encode=function(i,n){if(n||(n=age.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof SS||(i=SS.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Hi.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw eo.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Hi.CircuitRelay.Peer)return i;var n=new Hi.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?eo.base64.decode(i.id,n.id=eo.newBuffer(eo.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?eo.base64.decode(i.addrs[s],n.addrs[s]=eo.newBuffer(eo.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=eo.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?eo.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?eo.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Pd.util.toJSONOptions)},e}(),t}();cge.exports=Hi});var fge=y((vMt,lge)=>{f();"use strict";var{source:uge}=tc(),Lft=me(),Uft=Lft("libp2p:stream:converter");function Fft({stream:t,remoteAddr:e,localAddr:r},i={}){let{sink:n,source:s}=t,o={async sink(c){i.signal&&(c=uge(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&Uft(u)}a()},source:i.signal?uge(s,i.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}lge.exports=Fft});var z1=y((wMt,dge)=>{f();"use strict";dge.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var pge=y((_Mt,hge)=>{f();"use strict";var{EventEmitter:Kft}=yr(),{Multiaddr:jft}=it();hge.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await t.dial(new jft(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new Kft,{close:()=>Promise.resolve(),listen:r,getAddrs:i});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var MP=y((EMt,bge)=>{f();"use strict";var{Multiaddr:yge}=it(),{CircuitRelay:Cd}=R0();function gge(t,e){t.write({type:Cd.Type.STATUS,code:e})}function Vft(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new yge(r))}catch(r){throw gge(e,t.type===Cd.Type.HOP?Cd.Status.HOP_DST_MULTIADDR_INVALID:Cd.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new yge(r))}catch(r){throw gge(e,t.type===Cd.Type.HOP?Cd.Status.HOP_SRC_MULTIADDR_INVALID:Cd.Status.STOP_SRC_MULTIADDR_INVALID),r}}bge.exports={validateAddrs:Vft}});var P0=y((SMt,mge)=>{f();"use strict";var zft=a2(),Hft=ja(),$ft=ul();mge.exports=t=>{let e=Hft(),r=zft(t.source),i=$ft(),n,s=t.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:r,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var AS=y((xMt,Sge)=>{f();"use strict";var vge=me(),xS=Object.assign(vge("libp2p:circuit:stream-handler"),{error:vge("libp2p:circuit:stream-handler:err")}),wge=Wo(),Gft=P0(),{CircuitRelay:_ge}=R0(),Ege=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=Gft(this.stream),this.decoder=wge.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=_ge.decode(e.value.slice());return xS("read message type",r.type),r}xS("read received no value, closing stream"),this.close()}write(e){xS("write message type %s",e.type),this.shake.write(wge.encode.single(_ge.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){xS("closing the stream"),this.rest().sink([])}};Sge.exports=Ege});var FP=y((AMt,UP)=>{f();"use strict";var xge=me(),H1=Object.assign(xge("libp2p:circuit:stop"),{error:xge("libp2p:circuit:stop:err")}),{CircuitRelay:LP}=R0(),Wft=z1(),Yft=AS(),{validateAddrs:Xft}=MP();UP.exports.handleStop=function({connection:e,request:r,streamHandler:i}){try{Xft(r,i)}catch(n){return H1.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return H1("stop request is valid"),i.write({type:LP.Type.STATUS,code:LP.Status.SUCCESS}),i.rest()};UP.exports.stop=async function({connection:e,request:r}){let{stream:i}=await e.newStream([Wft.relay]);H1("starting stop request to %s",e.remotePeer.toB58String());let n=new Yft({stream:i});n.write(r);let s=await n.read();if(!s)return n.close();if(s.code===LP.Status.SUCCESS)return H1("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();H1("stop request failed with code %d",s.code),n.close()}});var KP=y((IMt,Cge)=>{f();"use strict";var Age=me(),fu=Object.assign(Age("libp2p:circuit:hop"),{error:Age("libp2p:circuit:hop:err")}),Ige=ue(),Qft=rt(),{validateAddrs:Zft}=MP(),Tge=AS(),{CircuitRelay:gs}=R0(),{pipe:Jft}=Ar(),{codes:Rge}=yi(),{stop:edt}=FP(),Pge=z1();async function tdt({connection:t,request:e,streamHandler:r,circuit:i}){if(!i._options.hop.enabled)return fu("HOP request received but we are not acting as a relay"),r.end({type:gs.Type.STATUS,code:gs.Status.HOP_CANT_SPEAK_RELAY});try{Zft(e,r)}catch(u){return fu.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){fu("HOP request received but we do not receive a dstPeer");return}let n=new Qft(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return fu("HOP request received but we are not connected to the destination peer"),r.end({type:gs.Type.STATUS,code:gs.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:gs.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await edt({connection:s,request:o})}catch(u){return fu.error(u)}fu("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:gs.Type.STATUS,code:gs.Status.SUCCESS});let c=r.rest();return Jft(c,a,c)}async function rdt({connection:t,request:e}){let{stream:r}=await t.newStream([Pge.relay]),i=new Tge({stream:r});i.write(e);let n=await i.read();if(!n)throw Ige(new Error("HOP request had no response"),Rge.ERR_HOP_REQUEST_FAILED);if(n.code===gs.Status.SUCCESS)return fu("hop request was successful"),i.rest();throw fu("hop request failed with code %d, closing stream",n.code),i.close(),Ige(new Error(`HOP request failed with code ${n.code}`),Rge.ERR_HOP_REQUEST_FAILED)}async function idt({connection:t}){let{stream:e}=await t.newStream([Pge.relay]),r=new Tge({stream:e});r.write({type:gs.Type.CAN_HOP});let i=await r.read();return await r.close(),!(!i||i.code!==gs.Status.SUCCESS)}function ndt({connection:t,streamHandler:e,circuit:r}){let i=r._options.hop.enabled;fu("can hop (%s) request from %s",i,t.remotePeer.toB58String()),e.end({type:gs.Type.STATUS,code:i?gs.Status.SUCCESS:gs.Status.HOP_CANT_SPEAK_RELAY})}Cge.exports={handleHop:tdt,hop:rdt,canHop:idt,handleCanHop:ndt}});var Bge=y((TMt,Nge)=>{f();"use strict";var Oge=me(),du=Object.assign(Oge("libp2p:circuit"),{error:Oge("libp2p:circuit:err")}),sdt=ue(),odt=Tf(),{Multiaddr:$1}=it(),kge=rt(),{CircuitRelay:G1}=R0(),{codes:adt}=yi(),qge=fge(),{relay:cdt}=z1(),udt=pge(),{handleCanHop:ldt,handleHop:fdt,hop:ddt}=KP(),{handleStop:hdt}=FP(),pdt=AS(),ydt=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),Dge=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(cdt,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let i=new pdt({stream:r}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case G1.Type.CAN_HOP:{du("received CAN_HOP request from %s",e.remotePeer.toB58String()),await ldt({circuit:s,connection:e,streamHandler:i});break}case G1.Type.HOP:{du("received HOP request from %s",e.remotePeer.toB58String()),o=await fdt({connection:e,request:n,streamHandler:i,circuit:s});break}case G1.Type.STOP:{du("received STOP request from %s",e.remotePeer.toB58String()),o=await hdt({connection:e,request:n,streamHandler:i});break}default:du("Request of type %s not supported",n.type)}if(o){let a=new $1(n.dstPeer.addrs[0]),c=new $1(n.srcPeer.addrs[0]),u=qge({stream:o,remoteAddr:a,localAddr:c}),l=n.type===G1.Type.HOP?"relay":"inbound";du("new %s connection %s",l,u.remoteAddr);let d=await this._upgrader.upgradeInbound(u);du("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(d)}}async dial(e,r){let i=e.toString().split("/p2p-circuit"),n=new $1(i[0]),s=new $1(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let h="Circuit relay dial failed as addresses did not have peer id";throw du.error(h),sdt(new Error(h),adt.ERR_RELAYED_DIAL)}let c=kge.createFromB58String(o),u=kge.createFromB58String(a),l=!1,d=this._connectionManager.get(c);d||(d=await this._dialer.connectToPeer(n,r),l=!0);try{let h=await ddt({connection:d,request:{type:G1.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(m=>m.bytes)},dstPeer:{id:u.toBytes(),addrs:[new $1(s).bytes]}}}),p=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),g=qge({stream:h,remoteAddr:e,localAddr:p});return du("new outbound connection %s",g.remoteAddr),this._upgrader.upgradeOutbound(g)}catch(h){throw du.error("Circuit relay dial failed",h),l&&await d.close(),h}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,udt(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>odt.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[ydt])}};Nge.exports=Dge});var jP=y((RMt,Mge)=>{f();"use strict";var{CID:gdt}=(Ie(),Ne),{sha256:bdt}=(ri(),li);Mge.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await bdt.digest(e);return gdt.createV0(r)}});var zge=y((PMt,Vge)=>{f();"use strict";var Lge=me(),Uge=Object.assign(Lge("libp2p:auto-relay"),{error:Lge("libp2p:auto-relay:err")}),{fromString:mdt}=(ft(),ht),{toString:vdt}=(tt(),et),{Multiaddr:wdt}=it(),_dt=rt(),{relay:Edt}=z1(),{canHop:Sdt}=KP(),{namespaceToCid:xdt}=jP(),{CIRCUIT_PROTO_CODE:Adt,HOP_METADATA_KEY:Fge,HOP_METADATA_VALUE:Kge,RELAY_RENDEZVOUS_NS:Idt}=bS(),jge=class{constructor({libp2p:e,maxListeners:r=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{Uge.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:r}){let i=e.toB58String(),n=r.find(s=>s===Edt);if(!n&&this._listenRelays.has(i)){this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(Adt)){Uge(`relayed connection to ${i} will not be used to hop on`);return}await Sdt({connection:s})&&(this._peerStore.metadataBook.set(e,Fge,mdt(Kge)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i)}async _addListenRelay(e,r){if(this._listenRelays.size>=this.maxListeners)return;let i=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!i||!i.length)return;let n=`${i[0].toString()}/p2p-circuit`;this._listenRelays.add(r);try{await this._transportManager.listen([new wdt(n)])}catch(s){this._onError(s),this._listenRelays.delete(r)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[];for(let[i,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(i)||e.includes(i))continue;let s=n.get(Fge);if(!s||vdt(s)!==Kge)continue;let o=_dt.createFromB58String(i),a=this._connectionManager.get(o);if(!a){r.push(o);continue}if(await this._addListenRelay(a,i),this._listenRelays.size>=this.maxListeners)return}for(let i of r)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await xdt(Idt);for await(let n of this._libp2p.contentRouting.findProviders(i)){if(!n.multiaddrs.length)continue;let s=n.id;if(this._peerStore.addressBook.add(s,n.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};Vge.exports=jge});var Yge=y((CMt,Wge)=>{f();"use strict";var Hge=me(),$ge=Object.assign(Hge("libp2p:relay"),{error:Hge("libp2p:relay:err")}),{setDelayedInterval:Tdt,clearDelayedInterval:Rdt}=vP(),Pdt=zge(),{namespaceToCid:Cdt}=jP(),{RELAY_RENDEZVOUS_NS:Odt}=bS(),Gge=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new Pdt({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=Tdt(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){Rdt(this._timeout)}async _advertiseService(){try{let e=await Cdt(Odt);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?($ge.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):$ge.error(e)}}};Wge.exports=Gge});var Jge=y((kMt,Zge)=>{f();var Xge=w4(),Qge=ul();Zge.exports=class{constructor(){this._buffer=new Xge,this._waitingConsumers=new Xge}push(e){let{promise:r,resolve:i}=Qge();return this._buffer.push({chunk:e,resolve:i}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=Qge();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var tbe=y((qMt,ebe)=>{f();"use strict";ebe.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let i=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(i,r.indent.repeat(e))}});var rbe=y(()=>{f()});var obe=y((BMt,sbe)=>{f();"use strict";var ibe=rbe(),nbe=/\s+at.*(?:\(|\s)(.*)\)?/,kdt=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,qdt=typeof ibe.homedir=="undefined"?"":ibe.homedir();sbe.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let i=r.match(nbe);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!kdt.test(n)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(nbe,(i,n)=>i.replace(n,n.replace(qdt,"~"))):r).join(`
`))});var IS=y((MMt,cbe)=>{f();"use strict";var Ddt=tbe(),Ndt=obe(),Bdt=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),abe=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let r=e.map(i=>typeof i.stack=="string"?Bdt(Ndt(i.stack)):String(i)).join(`
`);r=`
`+Ddt(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};cbe.exports=abe});var ube=y((LMt,zP)=>{f();"use strict";var VP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},W1=class{static fn(e){return(...r)=>new W1((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new VP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(W1.prototype,Promise.prototype);zP.exports=W1;zP.exports.CancelError=VP});var fbe=y((UMt,TS)=>{f();"use strict";var lbe=IS(),Mdt=ube(),HP=class extends Error{},Ldt=(t,e)=>new Mdt((r,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,d=new Set,h=()=>(a.length===s&&(r(a),l=!0),u-c.length<s&&(i(new lbe(c)),l=!0),l),p=()=>{for(let g of t)!d.has(g)&&typeof g.cancel=="function"&&g.cancel()};n(p);for(let g of t)u++,(async()=>{try{let m=await g;if(l)return;if(!o(m))throw new HP("Value does not satisfy filter");a.push(m)}catch(m){c.push(m)}finally{d.add(g),!l&&h()&&p()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});TS.exports=Ldt;TS.exports.AggregateError=lbe;TS.exports.FilterError=HP});var dbe=y((FMt,GP)=>{f();"use strict";var $P=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},Y1=class{static fn(e){return(...r)=>new Y1((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new $P(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Y1.prototype,Promise.prototype);GP.exports=Y1;GP.exports.CancelError=$P});var pbe=y((KMt,WP)=>{f();"use strict";var hbe=fbe(),Udt=dbe();WP.exports=(t,e)=>{let r=hbe(t,{...e,count:1});return Udt.fn(async i=>{i(()=>{r.cancel()});let[n]=await r;return n})()};WP.exports.AggregateError=hbe.AggregateError});var bbe=y((jMt,gbe)=>{f();"use strict";var Fdt=ue(),Kdt=nf().default,{anySignal:jdt}=Tu(),Vdt=Jge(),zdt=pbe(),ybe=class{constructor({addrs:e,dialAction:r,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw Fdt(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let i=new Vdt;r.forEach(o=>i.push(o));let n=this.addrs.map(()=>new Kdt),s=0;try{return await zdt(this.addrs.map(async(o,a)=>{let c=await i.shift(),u;try{let l=n[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?jdt([l,e.signal]):l}),n.splice(a,1)}finally{s++,this.addrs.length-s>=r.length?i.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{n.map(o=>o.abort()),r.forEach(o=>this.dialer.releaseToken(o))}}};gbe.exports=ybe});var _be=y((VMt,wbe)=>{f();"use strict";var mbe=me(),C0=Object.assign(mbe("libp2p:dialer"),{error:mbe("libp2p:dialer:err")}),YP=ue(),{Multiaddr:XP}=it(),Hdt=Zw(),{AbortError:$dt}=tc(),{anySignal:Gdt}=Tu(),Wdt=bbe(),{publicAddressesFirst:Ydt}=IP(),Xdt=EP(),{codes:RS}=yi(),{DIAL_TIMEOUT:Qdt,MAX_PARALLEL_DIALS:Zdt,MAX_PER_PEER_DIALS:Jdt,MAX_ADDRS_TO_DIAL:eht}=gS(),vbe=class{constructor({transportManager:e,peerStore:r,addressSorter:i=Ydt,maxParallelDials:n=Zdt,maxAddrsToDial:s=eht,dialTimeout:o=Qdt,maxDialsPerPeer:a=Jdt,resolvers:c={}}){this.transportManager=e,this.peerStore=r,this.addressSorter=i,this.maxParallelDials=n,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(n)].map((u,l)=>l),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[u,l]of Object.entries(c))XP.resolvers.set(u,l)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){C0.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new $dt("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw YP(new Error("The dial request has no valid addresses"),RS.ERR_NO_VALID_ADDRESSES);let n=this._pendingDials.get(i.id)||this._createPendingDial(i,r);try{let s=await n.promise;return C0("dial succeeded to %s",i.id),s}catch(s){throw n.controller.signal.aborted&&(s.code=RS.ERR_TIMEOUT),C0.error(s),s}finally{n.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((s,o)=>{this._pendingDialTargets.set(r,{resolve:s,reject:o})}),n=await Promise.race([this._createDialTarget(e),i]);return this._pendingDialTargets.delete(r),n}async _createDialTarget(e){let{id:r,multiaddrs:i}=Xdt(e);i&&this.peerStore.addressBook.add(r,i);let n=this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter)||[];XP.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(r),YP(new Error("dial with more addresses than allowed"),RS.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let i=(u,l)=>{if(l.signal.aborted)throw YP(new Error("already aborted"),RS.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},n=new Wdt({addrs:e.addrs,dialAction:i,dialer:this}),s=new Hdt(this.timeout),o=[s.signal];r.signal&&o.push(r.signal);let a=Gdt(o),c={dialRequest:n,controller:s,promise:n.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,r);return C0("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(C0("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new XP(e.toString()),await e.resolve()}catch(r){return C0.error(`multiaddr ${e} could not be resolved`),[]}}};wbe.exports=vbe});var Sbe=y((zMt,Ebe)=>{f();"use strict";function tht(t){return t>=55296&&t<=56319}function rht(t){return t>=56320&&t<=57343}Ebe.exports=function(e,r,i){if(typeof r!="string")throw new Error("Input must be string");for(var n=r.length,s=0,o,a,c=0;c<n;c+=1){if(o=r.charCodeAt(c),a=r[c],tht(o)&&rht(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===i)return r.slice(0,c+1);if(s>i)return r.slice(0,c-a.length+1)}return r}});var Abe=y((HMt,xbe)=>{f();"use strict";function iht(t){return t>=55296&&t<=56319}function nht(t){return t>=56320&&t<=57343}xbe.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,i=0,n=null,s=null,o=0;o<r;o++)n=e.charCodeAt(o),nht(n)?s!=null&&iht(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var Tbe=y(($Mt,Ibe)=>{f();"use strict";var sht=Sbe(),oht=Abe();Ibe.exports=sht.bind(null,oht)});var Cbe=y((GMt,Pbe)=>{f();"use strict";var aht=Tbe(),cht=/[\/\?<>\\:\*\|"]/g,uht=/[\x00-\x1f\x80-\x9f]/g,lht=/^\.+$/,fht=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,dht=/[\. ]+$/;function Rbe(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(cht,e).replace(uht,e).replace(lht,e).replace(fht,e).replace(dht,e);return aht(r,255)}Pbe.exports=function(t,e){var r=e&&e.replacement||"",i=Rbe(t,r);return r===""?i:Rbe(i,"")}});var Dbe=y((WMt,qbe)=>{f();var O0=dt();xc();Qt();var Le=O0.asn1,k0=qbe.exports=O0.pkcs7asn1=O0.pkcs7asn1||{};O0.pkcs7=O0.pkcs7||{};O0.pkcs7.asn1=k0;var Obe={name:"ContentInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};k0.contentInfoValidator=Obe;var kbe={name:"EncryptedContentInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};k0.envelopedDataValidator={name:"EnvelopedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(kbe)};k0.encryptedDataValidator={name:"EncryptedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"}].concat(kbe)};var hht={name:"SignerInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Le.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};k0.signedDataValidator={name:"SignedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Obe,{name:"SignedData.Certificates",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Le.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,capture:"signerInfos",optional:!0,value:[hht]}]};k0.recipientInfoValidator={name:"RecipientInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var Bbe=y((YMt,Nbe)=>{f();var Od=dt();Qt();Od.mgf=Od.mgf||{};var pht=Nbe.exports=Od.mgf.mgf1=Od.mgf1=Od.mgf1||{};pht.create=function(t){var e={generate:function(r,i){for(var n=new Od.util.ByteBuffer,s=Math.ceil(i/t.digestLength),o=0;o<s;o++){var a=new Od.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),n.putBuffer(t.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var Lbe=y((XMt,Mbe)=>{f();var PS=dt();Bbe();Mbe.exports=PS.mgf=PS.mgf||{};PS.mgf.mgf1=PS.mgf1});var Fbe=y((QMt,Ube)=>{f();var kd=dt();Mu();Qt();var yht=Ube.exports=kd.pss=kd.pss||{};yht.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,i=e.digestLength,n=t.salt||null;typeof n=="string"&&(n=kd.util.createBuffer(n));var s;if("saltLength"in t)s=t.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||kd.random,a={};return a.encode=function(c,u){var l,d=u-1,h=Math.ceil(d/8),p=c.digest().getBytes();if(h<i+s+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=o.getBytesSync(s):g=n.bytes();var m=new kd.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(p),m.putBytes(g),e.start(),e.update(m.getBytes());var E=e.digest().getBytes(),v=new kd.util.ByteBuffer;v.fillWithByte(0,h-s-i-2),v.putByte(1),v.putBytes(g);var A=v.getBytes(),R=h-i-1,F=r.generate(E,R),q="";for(l=0;l<R;l++)q+=String.fromCharCode(A.charCodeAt(l)^F.charCodeAt(l));var D=65280>>8*h-d&255;return q=String.fromCharCode(q.charCodeAt(0)&~D)+q.substr(1),q+E+String.fromCharCode(188)},a.verify=function(c,u,l){var d,h=l-1,p=Math.ceil(h/8);if(u=u.substr(-p),p<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=p-i-1,m=u.substr(0,g),E=u.substr(g,i),v=65280>>8*p-h&255;if((m.charCodeAt(0)&v)!=0)throw new Error("Bits beyond keysize not zero as expected.");var A=r.generate(E,g),R="";for(d=0;d<g;d++)R+=String.fromCharCode(m.charCodeAt(d)^A.charCodeAt(d));R=String.fromCharCode(R.charCodeAt(0)&~v)+R.substr(1);var F=p-i-s-2;for(d=0;d<F;d++)if(R.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(F)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var q=R.substr(-s),D=new kd.util.ByteBuffer;D.fillWithByte(0,8),D.putBytes(c),D.putBytes(q),e.start(),e.update(D.getBytes());var z=e.digest().getBytes();return E===z},a}});var ZP=y((ZMt,zbe)=>{f();var Oe=dt();hh();xc();Ov();Bu();Lbe();lh();Nv();Fbe();ag();Qt();var O=Oe.asn1,Te=zbe.exports=Oe.pki=Oe.pki||{},st=Te.oids,Gr={};Gr.CN=st.commonName;Gr.commonName="CN";Gr.C=st.countryName;Gr.countryName="C";Gr.L=st.localityName;Gr.localityName="L";Gr.ST=st.stateOrProvinceName;Gr.stateOrProvinceName="ST";Gr.O=st.organizationName;Gr.organizationName="O";Gr.OU=st.organizationalUnitName;Gr.organizationalUnitName="OU";Gr.E=st.emailAddress;Gr.emailAddress="E";var Kbe=Oe.pki.rsa.publicKeyValidator,ght={name:"Certificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Kbe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},bht={name:"rsapss",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},mht={name:"CertificationRequestInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Kbe,{name:"CertificationRequestInfo.attributes",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:O.Class.UNIVERSAL,type:O.Type.SET,constructed:!0}]}]}]},vht={name:"CertificationRequest",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[mht,{name:"CertificationRequest.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Te.RDNAttributesAsArray=function(t,e){for(var r=[],i,n,s,o=0;o<t.value.length;++o){i=t.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=O.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in st&&(s.name=st[s.type],s.name in Gr&&(s.shortName=Gr[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};Te.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var i=t[r],n=O.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in st&&(a.name=st[a.type],a.name in Gr&&(a.shortName=Gr[a.name])),a.type===st.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Te.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Ul(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,i,n=0;r===null&&n<t.attributes.length;++n)i=t.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(r=i);return r}var CS=function(t,e,r){var i={};if(t!==st["RSASSA-PSS"])return i;r&&(i={hash:{algorithmOid:st.sha1},mgf:{algorithmOid:st.mgf1,hash:{algorithmOid:st.sha1}},saltLength:20});var n={},s=[];if(!O.validate(e,bht,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=O.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=O.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=O.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i};Te.certificateFromPem=function(t,e,r){var i=Oe.pem.decode(t)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=O.fromDer(i.body,r);return Te.certificateFromAsn1(s,e)};Te.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:O.toDer(Te.certificateToAsn1(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Te.publicKeyFromPem=function(t){var e=Oe.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=O.fromDer(e.body);return Te.publicKeyFromAsn1(i)};Te.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:O.toDer(Te.publicKeyToAsn1(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Te.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:O.toDer(Te.publicKeyToRSAPublicKey(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Te.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||Oe.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=O.toDer(Te.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":n=O.toDer(Te.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(n);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Te.certificationRequestFromPem=function(t,e,r){var i=Oe.pem.decode(t)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=O.fromDer(i.body,r);return Te.certificationRequestFromAsn1(s,e)};Te.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:O.toDer(Te.certificationRequestToAsn1(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Te.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Ul(t.issuer,e)},t.issuer.addField=function(e){to([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Ul(t.subject,e)},t.subject.addField=function(e){to([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){to(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){to(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)jbe(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,i,n=0;r===null&&n<t.extensions.length;++n)i=t.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(r=i);return r},t.sign=function(e,r){t.md=r||Oe.md.sha1.create();var i=st[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.tbsCertificate=Te.getTBSCertificate(t);var s=O.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var i=e.issuer,n=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in st){var a=st[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o=Oe.md.sha512.create();break;case"RSASSA-PSS":o=Oe.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||Te.getTBSCertificate(e),u=O.toDer(c);o.update(u.getBytes())}if(o!==null){var l;switch(e.signatureOid){case st.sha1WithRSAEncryption:l=void 0;break;case st["RSASSA-PSS"]:var d,h;if(d=st[e.signatureParameters.mgf.hash.algorithmOid],d===void 0||Oe.md[d]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=d,s}if(h=st[e.signatureParameters.mgf.algorithmOid],h===void 0||Oe.mgf[h]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=h,s}if(h=Oe.mgf[h].create(Oe.md[d].create()),d=st[e.signatureParameters.hash.algorithmOid],d===void 0||Oe.md[d]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:d};l=Oe.pss.create(Oe.md[d].create(),h,e.signatureParameters.saltLength);break}r=t.publicKey.verify(o.digest().getBytes(),e.signature,l)}return r},t.isIssuer=function(e){var r=!1,i=t.issuer,n=e.subject;if(i.hash&&n.hash)r=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){r=!0;for(var s,o,a=0;r&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Te.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=st.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var i=t.extensions[r];if(i.id===e){var n=t.generateSubjectKeyIdentifier().getBytes();return Oe.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},t};Te.certificateFromAsn1=function(t,e){var r={},i=[];if(!O.validate(t,ght,r,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=O.derToOid(r.publicKeyOid);if(s!==Te.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Te.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=Oe.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=Oe.asn1.derToOid(r.certSignatureOid),o.signatureParameters=CS(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=Oe.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=CS(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(O.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(O.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){if(o.md=null,o.signatureOid in st){var s=st[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Oe.md.sha512.create();break;case"RSASSA-PSS":o.md=Oe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var u=O.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=Oe.md.sha1.create();o.issuer.getField=function(h){return Ul(o.issuer,h)},o.issuer.addField=function(h){to([h]),o.issuer.attributes.push(h)},o.issuer.attributes=Te.RDNAttributesAsArray(r.certIssuer,l),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var d=Oe.md.sha1.create();return o.subject.getField=function(h){return Ul(o.subject,h)},o.subject.addField=function(h){to([h]),o.subject.attributes.push(h)},o.subject.attributes=Te.RDNAttributesAsArray(r.certSubject,d),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=d.digest().toHex(),r.certExtensions?o.extensions=Te.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=Te.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};Te.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var i=t.value[r],n=0;n<i.value.length;++n)e.push(Te.certificateExtensionFromAsn1(i.value[n]));return e};Te.certificateExtensionFromAsn1=function(t){var e={};if(e.id=O.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===O.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in st){if(e.name=st[e.id],e.name==="keyUsage"){var r=O.fromDer(e.value),i=0,n=0;r.value.length>1&&(i=r.value.charCodeAt(1),n=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var r=O.fromDer(e.value);r.value.length>0&&r.value[0].type===O.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===O.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=O.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=O.fromDer(e.value),o=0;o<r.value.length;++o){var a=O.derToOid(r.value[o].value);a in st?e[st[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=O.fromDer(e.value),i=0;r.value.length>1&&(i=r.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=O.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=Oe.util.bytesToIP(c.value);break;case 8:l.oid=O.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=O.fromDer(e.value);e.subjectKeyIdentifier=Oe.util.bytesToHex(r.value)}}return e};Te.certificationRequestFromAsn1=function(t,e){var r={},i=[];if(!O.validate(t,vht,r,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=O.derToOid(r.publicKeyOid);if(s!==Te.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Te.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=Oe.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=CS(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=Oe.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=CS(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){if(o.md=null,o.signatureOid in st){var s=st[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Oe.md.sha512.create();break;case"RSASSA-PSS":o.md=Oe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var a=O.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=Oe.md.sha1.create();return o.subject.getField=function(u){return Ul(o.subject,u)},o.subject.addField=function(u){to([u]),o.subject.attributes.push(u)},o.subject.attributes=Te.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Te.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(u){return Ul(o,u)},o.addAttribute=function(u){to([u]),o.attributes.push(u)},o.attributes=Te.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};Te.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Ul(t.subject,e)},t.subject.addField=function(e){to([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Ul(t,e)},t.addAttribute=function(e){to([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){to(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){to(e),t.attributes=e},t.sign=function(e,r){t.md=r||Oe.md.sha1.create();var i=st[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.certificationRequestInfo=Te.getCertificationRequestInfo(t);var s=O.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){if(t.signatureOid in st){var i=st[t.signatureOid];switch(i){case"sha1WithRSAEncryption":r=Oe.md.sha1.create();break;case"md5WithRSAEncryption":r=Oe.md.md5.create();break;case"sha256WithRSAEncryption":r=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":r=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":r=Oe.md.sha512.create();break;case"RSASSA-PSS":r=Oe.md.sha256.create();break}}if(r===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=t.signatureOid,n}var s=t.certificationRequestInfo||Te.getCertificationRequestInfo(t),o=O.toDer(s);r.update(o.getBytes())}if(r!==null){var a;switch(t.signatureOid){case st.sha1WithRSAEncryption:break;case st["RSASSA-PSS"]:var c,u;if(c=st[t.signatureParameters.mgf.hash.algorithmOid],c===void 0||Oe.md[c]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=t.signatureParameters.mgf.hash.algorithmOid,n.name=c,n}if(u=st[t.signatureParameters.mgf.algorithmOid],u===void 0||Oe.mgf[u]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=t.signatureParameters.mgf.algorithmOid,n.name=u,n}if(u=Oe.mgf[u].create(Oe.md[c].create()),c=st[t.signatureParameters.hash.algorithmOid],c===void 0||Oe.md[c]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=t.signatureParameters.hash.algorithmOid,n.name=c,n}a=Oe.pss.create(Oe.md[c].create(),u,t.signatureParameters.saltLength);break}e=t.publicKey.verify(r.digest().getBytes(),t.signature,a)}return e},t};function q0(t){for(var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),r,i,n=t.attributes,s=0;s<n.length;++s){r=n[s];var o=r.value,a=O.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===O.Type.UTF8&&(o=Oe.util.encodeUtf8(o))),i=O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.type).getBytes()),O.create(O.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function to(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in Te.oids?e.name=Te.oids[e.type]:e.shortName&&e.shortName in Gr&&(e.name=Te.oids[Gr[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Te.oids)e.type=Te.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Gr&&(e.shortName=Gr[e.name]),e.type===st.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=O.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(Te.certificateExtensionToAsn1(jbe(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function jbe(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in Te.oids&&(t.name=Te.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in Te.oids)t.id=Te.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var i=0,n=0,s=0;t.digitalSignature&&(n|=128,i=7),t.nonRepudiation&&(n|=64,i=6),t.keyEncipherment&&(n|=32,i=5),t.dataEncipherment&&(n|=16,i=4),t.keyAgreement&&(n|=8,i=3),t.keyCertSign&&(n|=4,i=2),t.cRLSign&&(n|=2,i=1),t.encipherOnly&&(n|=1,i=0),t.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),t.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in st?a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(st[c]).getBytes())):c.indexOf(".")!==-1&&a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var i=0,n=0;t.client&&(n|=128,i=7),t.server&&(n|=64,i=6),t.email&&(n|=32,i=5),t.objsign&&(n|=16,i=4),t.reserved&&(n|=8,i=3),t.sslCA&&(n|=4,i=2),t.emailCA&&(n|=2,i=1),t.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),t.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Oe.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=O.oidToDer(O.oidToDer(u.oid)):o=O.oidToDer(o));t.value.value.push(O.create(O.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=O.create(O.Class.UNIVERSAL,O.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var d=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=d.toHex(),t.value=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,d.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var h=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!1,h))}if(t.authorityCertIssuer){var p=[O.create(O.Class.CONTEXT_SPECIFIC,4,!0,[q0(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,p))}if(t.serialNumber){var g=Oe.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(t.name==="cRLDistributionPoints"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var a=t.value.value,m=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),E=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Oe.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=O.oidToDer(O.oidToDer(u.oid)):o=O.oidToDer(o));E.value.push(O.create(O.Class.CONTEXT_SPECIFIC,u.type,!1,o))}m.value.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[E])),a.push(m)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function QP(t,e){switch(t){case st["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.saltLength).getBytes())])),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,r);default:return O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")}}function wht(t){var e=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,i=0;i<r.length;++i){var n=r[i],s=n.value,o=O.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===O.Type.UTF8&&(s=Oe.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(n.type).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var _ht=new Date("1950-01-01T00:00:00Z"),Eht=new Date("2050-01-01T00:00:00Z");function Vbe(t){return t>=_ht&&t<Eht?O.create(O.Class.UNIVERSAL,O.Type.UTCTIME,!1,O.dateToUtcTime(t)):O.create(O.Class.UNIVERSAL,O.Type.GENERALIZEDTIME,!1,O.dateToGeneralizedTime(t))}Te.getTBSCertificate=function(t){var e=Vbe(t.validity.notBefore),r=Vbe(t.validity.notAfter),i=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.version).getBytes())]),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Oe.util.hexToBytes(t.serialNumber)),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.siginfo.algorithmOid).getBytes()),QP(t.siginfo.algorithmOid,t.siginfo.parameters)]),q0(t.issuer),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,r]),q0(t.subject),Te.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&i.value.push(Te.certificateExtensionsToAsn1(t.extensions)),i};Te.getCertificationRequestInfo=function(t){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.version).getBytes()),q0(t.subject),Te.publicKeyToAsn1(t.publicKey),wht(t)]);return e};Te.distinguishedNameToAsn1=function(t){return q0(t)};Te.certificateToAsn1=function(t){var e=t.tbsCertificate||Te.getTBSCertificate(t);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.signatureOid).getBytes()),QP(t.signatureOid,t.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Te.certificateExtensionsToAsn1=function(t){var e=O.create(O.Class.CONTEXT_SPECIFIC,3,!0,[]),r=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(r);for(var i=0;i<t.length;++i)r.value.push(Te.certificateExtensionToAsn1(t[i]));return e};Te.certificateExtensionToAsn1=function(t){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.id).getBytes())),t.critical&&e.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=O.toDer(r).getBytes()),e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,r)),e};Te.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Te.getCertificationRequestInfo(t);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.signatureOid).getBytes()),QP(t.signatureOid,t.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Te.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=Oe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];Oe.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=Oe.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;Oe.util.isArray(a)||(a=[a]);for(var c=O.toDer(Te.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=O.toDer(Te.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!Oe.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=Oe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!Oe.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=O.toDer(Te.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var d=O.toDer(Te.certificateToAsn1(c[l])).getBytes();u===d&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=Oe.md.sha1.create();o.attributes=Te.RDNAttributesAsArray(q0(o),a),o.hash=a.digest().toHex()}}if(t)for(var n=0;n<t.length;++n){var s=t[n];e.addCertificate(s)}return e};Te.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Te.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var i=e.slice(0),n=r.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Te.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var d=u;Oe.util.isArray(d)||(d=[d]);for(var h=!1;!h&&d.length>0;){u=d.shift();try{h=u.verify(c)}catch(q){}}h||(o={message:"Certificate signature is invalid.",error:Te.certificateError.bad_certificate})}o===null&&(!u||l)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Te.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:Te.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},g=0;o===null&&g<c.extensions.length;++g){var m=c.extensions[g];m.critical&&!(m.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:Te.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var E=c.getExtension("basicConstraints"),v=c.getExtension("keyUsage");if(v!==null&&(!v.keyCertSign||E===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Te.certificateError.bad_certificate}),o===null&&E!==null&&!E.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Te.certificateError.bad_certificate}),o===null&&v!==null&&"pathLenConstraint"in E){var A=a-1;A>E.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Te.certificateError.bad_certificate})}}var R=o===null?!0:o.error,F=r.verify?r.verify(R,a,i):R;if(F===!0)o=null;else throw R===!0&&(o={message:"The application rejected the certificate.",error:Te.certificateError.bad_certificate}),(F||F===0)&&(typeof F=="object"&&!Oe.util.isArray(F)?(F.message&&(o.message=F.message),F.error&&(o.error=F.error)):typeof F=="string"&&(o.error=F)),o;s=!1,++a}while(e.length>0);return!0}});var Gbe=y((JMt,$be)=>{f();var De=dt();hh();xc();Ov();lh();Nv();Dbe();Mu();Qt();ZP();var te=De.asn1,qn=$be.exports=De.pkcs7=De.pkcs7||{};qn.messageFromPem=function(t){var e=De.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=te.fromDer(e.body);return qn.messageFromAsn1(i)};qn.messageToPem=function(t,e){var r={type:"PKCS7",body:te.toDer(t.toAsn1()).getBytes()};return De.pem.encode(r,{maxline:e})};qn.messageFromAsn1=function(t){var e={},r=[];if(!te.validate(t,qn.asn1.contentInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=r,i}var n=te.derToOid(e.contentType),s;switch(n){case De.pki.oids.envelopedData:s=qn.createEnvelopedData();break;case De.pki.oids.encryptedData:s=qn.createEncryptedData();break;case De.pki.oids.signedData:s=qn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};qn.createSignedData=function(){var t=null;return t={type:De.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(eC(t,i,qn.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var n=t.rawCapture.certificates.value,s=0;s<n.length;++s)t.certificates.push(De.pki.certificateFromAsn1(n[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var i=[],n=0;n<t.certificates.length;++n)i.push(De.pki.certificateToAsn1(t.certificates[n]));var s=[],o=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return i.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(te.create(te.Class.UNIVERSAL,te.Type.SET,!0,t.signerInfos)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=De.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=De.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||De.pki.oids.sha1;switch(c){case De.pki.oids.sha1:case De.pki.oids.sha256:case De.pki.oids.sha384:case De.pki.oids.sha512:case De.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var l=!1,d=!1,h=0;h<u.length;++h){var p=u[h];if(!l&&p.type===De.pki.oids.contentType){if(l=!0,d)break;continue}if(!d&&p.type===De.pki.oids.messageDigest){if(d=!0,l)break;continue}}if(!l||!d)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:De.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(De.pki.oids.data).getBytes())]),"content"in t)){var n;t.content instanceof De.util.ByteBuffer?n=t.content.bytes():typeof t.content=="string"&&(n=De.util.encodeUtf8(t.content)),i.detached?t.detachedContent=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n):t.contentInfo.value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=De.pki.certificateFromPem(i)),t.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var i={},n=0;n<t.signers.length;++n){var s=t.signers[n],o=s.digestAlgorithm;o in i||(i[o]=De.md[De.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=De.md[De.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in i)t.digestAlgorithmIdentifiers.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(o).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]));return i}function r(i){var n;if(t.detachedContent?n=t.detachedContent:(n=t.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=te.derToOid(t.contentInfo.value[0].value),o=te.toDer(n);o.getByte(),te.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==De.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[]),h=0;h<l.authenticatedAttributes.length;++h){var p=l.authenticatedAttributes[h];p.type===De.pki.oids.messageDigest?p.value=i[l.digestAlgorithm].digest():p.type===De.pki.oids.signingTime&&(p.value||(p.value=c)),d.value.push(JP(p)),l.authenticatedAttributesAsn1.value.push(JP(p))}o=te.toDer(d).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=Rht(t.signers)}};qn.createEncryptedData=function(){var t=null;return t={type:De.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:De.pki.oids["aes256-CBC"]},fromAsn1:function(e){eC(t,e,qn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),Hbe(t)}},t};qn.createEnvelopedData=function(){var t=null;return t={type:De.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:De.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=eC(t,e,qn.asn1.envelopedDataValidator);t.recipients=Aht(r.recipientInfos.value)},toAsn1:function(){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,Iht(t.recipients)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,Pht(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,i=0;i<t.recipients.length;++i){var n=t.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case De.pki.oids.rsaEncryption:case De.pki.oids.desCBC:var i=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=De.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Hbe(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:De.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var i,n,s;switch(r){case De.pki.oids["aes128-CBC"]:i=16,n=16,s=De.aes.createEncryptionCipher;break;case De.pki.oids["aes192-CBC"]:i=24,n=16,s=De.aes.createEncryptionCipher;break;case De.pki.oids["aes256-CBC"]:i=32,n=16,s=De.aes.createEncryptionCipher;break;case De.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=De.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=De.util.createBuffer(De.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=De.util.createBuffer(De.random.getBytes(n));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case De.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function Sht(t){var e={},r=[];if(!te.validate(t,qn.asn1.recipientInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=r,i}return{version:e.version.charCodeAt(0),issuer:De.pki.RDNAttributesAsArray(e.issuer),serialNumber:De.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:te.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function xht(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[De.pki.distinguishedNameToAsn1({attributes:t.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,De.util.hexToBytes(t.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.encryptedContent.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function Aht(t){for(var e=[],r=0;r<t.length;++r)e.push(Sht(t[r]));return e}function Iht(t){for(var e=[],r=0;r<t.length;++r)e.push(xht(t[r]));return e}function Tht(t){var e=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[De.pki.distinguishedNameToAsn1({attributes:t.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,De.util.hexToBytes(t.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.digestAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.signatureAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=te.create(te.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<t.unauthenticatedAttributes.length;++i){var n=t.unauthenticatedAttributes[i];r.values.push(JP(n))}e.value.push(r)}return e}function Rht(t){for(var e=[],r=0;r<t.length;++r)e.push(Tht(t[r]));return e}function JP(t){var e;if(t.type===De.pki.oids.contentType)e=te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.value).getBytes());else if(t.type===De.pki.oids.messageDigest)e=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===De.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=t.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=te.utcTimeToDate(n):n=te.generalizedTimeToDate(n):n=new Date(s)}n>=r&&n<i?e=te.create(te.Class.UNIVERSAL,te.Type.UTCTIME,!1,te.dateToUtcTime(n)):e=te.create(te.Class.UNIVERSAL,te.Type.GENERALIZEDTIME,!1,te.dateToGeneralizedTime(n))}return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[e])])}function Pht(t){return[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(De.pki.oids.data).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.parameter.getBytes())]),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.content.getBytes())])]}function eC(t,e,r){var i={},n=[];if(!te.validate(e,r,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=te.derToOid(i.contentType);if(o!==De.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(De.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;t.encryptedContent={algorithm:te.derToOid(i.encAlgorithm),parameter:De.util.createBuffer(i.encParameter.value),content:De.util.createBuffer(a)}}if(i.content){var a="";if(De.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;t.content=De.util.createBuffer(a)}return t.version=i.version.charCodeAt(0),t.rawCapture=i,i}function Hbe(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case De.pki.oids["aes128-CBC"]:case De.pki.oids["aes192-CBC"]:case De.pki.oids["aes256-CBC"]:e=De.aes.createDecryptionCipher(t.encryptedContent.key);break;case De.pki.oids.desCBC:case De.pki.oids["des-EDE3-CBC"]:e=De.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var Xbe=y((e7t,Ybe)=>{f();"use strict";ZP();var Cht=dt(),Wbe=Cht.pki,Oht=(t,e)=>{let r=Wbe.setRsaPublicKey(e.n,e.e),i=Wbe.createCertificate();i.publicKey=r,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function kht(t,e){let r=t.map(e),n=(await Promise.all(r)).findIndex(s=>s);return t[n]}Ybe.exports={certificateForKey:Oht,findAsync:kht}});var e1e=y((t7t,Jbe)=>{f();"use strict";Gbe();k6();var Fl=dt(),{certificateForKey:qht,findAsync:Dht}=Xbe(),D0=ue(),{fromString:Qbe}=(ft(),ht),{toString:Nht}=(tt(),et),tC=new WeakMap,Zbe=class{constructor(e,r){if(!e)throw D0(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,tC.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw D0(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=tC.get(this).dek,o=Fl.pki.decryptRsaPrivateKey(n,s),a=await qht(i,o),c=Fl.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Fl.util.createBuffer(r),c.encrypt();let u=Fl.asn1.toDer(c.toAsn1()).getBytes();return Qbe(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw D0(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let r;try{let u=Fl.util.createBuffer(Nht(e,"ascii")),l=Fl.asn1.fromDer(u);r=Fl.pkcs7.messageFromAsn1(l)}catch(u){throw D0(new Error("Invalid CMS: "+u.message),"ERR_INVALID_CMS")}let i=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),n=await Dht(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!n){let u=i.map(l=>l.keyId);throw D0(new Error("Decryption needs one of the key(s): "+u.join(", ")),"ERR_MISSING_KEYS",{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw D0(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=tC.get(this).dek,c=Fl.pki.decryptRsaPrivateKey(o,a);return r.decrypt(n.recipient,c),Qbe(r.content.getBytes(),"ascii")}};Jbe.exports=Zbe});var a1e=y((r7t,o1e)=>{f();"use strict";var t1e=me(),r1e=Object.assign(t1e("libp2p:keychain"),{error:t1e("libp2p:keychain:err")}),Bht=Cbe(),Mht=gr(),qd=Na(),{Key:i1e}=Ut(),Lht=e1e(),Er=ue(),{toString:Dd}=(tt(),et),{fromString:hu}=(ft(),ht);Hv();var Uht="/pkcs8/",n1e="/info/",Kl=new WeakMap,Nd={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},rC={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function pu(t){return!t||typeof t!="string"?!1:t===Bht(t.trim())}async function $t(t){let e=200,r=1e3,i=Math.random()*(r-e)+e;throw await new Promise(n=>setTimeout(n,i)),t}function sc(t){return new i1e(Uht+t)}function jl(t){return new i1e(n1e+t)}var s1e=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=Mht(rC,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Nd.minKeyLength)throw new Error(`dek.keyLength must be least ${Nd.minKeyLength} bytes`);if(this.opts.dek.salt.length<Nd.minSaltLength)throw new Error(`dek.saltLength must be least ${Nd.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Nd.minIterationCount)throw new Error(`dek.iterationCount must be least ${Nd.minIterationCount}`);let i=this.opts.pass?qd.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Kl.set(this,{dek:i})}get cms(){return new Lht(this,Kl.get(this).dek)}static generateOptions(){let e=Object.assign({},rC),r=Math.ceil(Nd.minSaltLength/3)*3;return e.dek.salt=Dd(qd.randomBytes(r),"base64"),e}static get options(){return rC}async createKey(e,r,i=2048){let n=this;if(!pu(e)||e==="self")return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof r!="string")return $t(Er(new Error(`Invalid key type '${r}'`),"ERR_INVALID_KEY_TYPE"));let s=sc(e);if(await n.store.has(s))return $t(Er(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return $t(Er(new Error(`Invalid RSA key size ${i}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await qd.keys.generateKeyPair(r,i),u=await c.id(),l=Kl.get(this).dek,d=await c.export(l);a={name:e,id:u};let h=n.store.batch();h.put(s,hu(d)),h.put(jl(e),hu(JSON.stringify(a))),await h.commit()}catch(c){return $t(c)}return a}async listKeys(){let e=this,r={prefix:n1e},i=[];for await(let n of e.store.query(r))i.push(JSON.parse(Dd(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(r){return $t(r)}}async findKeyByName(e){if(!pu(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let r=jl(e);try{let i=await this.store.get(r);return JSON.parse(Dd(i))}catch(i){return $t(Er(new Error(`Key '${e}' does not exist. ${i.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let r=this;if(!pu(e)||e==="self")return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let i=sc(e),n=await r.findKeyByName(e),s=r.store.batch();return s.delete(i),s.delete(jl(e)),await s.commit(),n}async renameKey(e,r){let i=this;if(!pu(e)||e==="self")return $t(Er(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!pu(r)||r==="self")return $t(Er(new Error(`Invalid new key name '${r}'`),"ERR_NEW_KEY_NAME_INVALID"));let n=sc(e),s=sc(r),o=jl(e),a=jl(r);if(await i.store.has(s))return $t(Er(new Error(`Key '${r}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let u=await i.store.get(n),l=await i.store.get(o),d=JSON.parse(Dd(l));d.name=r;let h=i.store.batch();return h.put(s,u),h.put(a,hu(JSON.stringify(d))),h.delete(n),h.delete(o),await h.commit(),d}catch(u){return $t(u)}}async exportKey(e,r){if(!pu(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return $t(Er(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let i=sc(e);try{let n=await this.store.get(i),s=Dd(n),o=Kl.get(this).dek;return(await qd.keys.import(s,o)).export(r)}catch(n){return $t(n)}}async importKey(e,r,i){let n=this;if(!pu(e)||e==="self")return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return $t(Er(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=sc(e);if(await n.store.has(s))return $t(Er(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await qd.keys.import(r,i)}catch(d){return $t(Er(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let d=Kl.get(this).dek;r=await a.export(d)}catch(d){return $t(d)}let u={name:e,id:c},l=n.store.batch();return l.put(s,hu(r)),l.put(jl(e),hu(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let i=this;if(!pu(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r||!r.privKey)return $t(Er(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let n=r.privKey,s=sc(e);if(await i.store.has(s))return $t(Er(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await n.id(),c=Kl.get(this).dek,u=await n.export(c),l={name:e,id:a},d=i.store.batch();return d.put(s,hu(u)),d.put(jl(e),hu(JSON.stringify(l))),await d.commit(),l}catch(a){return $t(a)}}async _getPrivateKey(e){if(!pu(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let r=sc(e),i=await this.store.get(r);return Dd(i)}catch(r){return $t(Er(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,r){if(typeof e!="string")return $t(Er(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof r!="string")return $t(Er(new Error(`Invalid new pass type '${typeof r}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(r.length<20)return $t(Er(new Error(`Invalid pass length ${r.length}`),"ERR_INVALID_PASS_LENGTH"));r1e("recreating keychain");let i=Kl.get(this).dek;this.opts.pass=r;let n=r?qd.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Kl.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(sc(o.name)),c=Dd(a),u=await qd.keys.import(c,i),l=n.toString(),d=await u.export(l),h=this.store.batch(),p={name:o.name,id:o.id};h.put(sc(o.name),hu(d)),h.put(jl(o.name),hu(JSON.stringify(p))),await h.commit()}r1e("keychain reconstructed")}};o1e.exports=s1e});var u1e=y((i7t,c1e)=>{f();"use strict";var Fht=sb();c1e.exports=t=>{let e=Fht(t);return e.delete=e.remove,e}});var f1e=y((l1e,OS)=>{f();(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function p(q){var D,z,G,Y=X.prototype={constructor:X,toString:null,valueOf:null},P=new X(1),b=20,w=4,S=-7,C=21,B=-1e7,W=1e7,j=!1,M=1,_=0,L={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},ae="0123456789abcdefghijklmnopqrstuvwxyz";function X(k,K){var $,Z,I,U,V,N,Q,ee,J=this;if(!(J instanceof X))return new X(k,K);if(K==null){if(k&&k._isBigNumber===!0){J.s=k.s,!k.c||k.e>W?J.c=J.e=null:k.e<B?J.c=[J.e=0]:(J.e=k.e,J.c=k.c.slice());return}if((N=typeof k=="number")&&k*0==0){if(J.s=1/k<0?(k=-k,-1):1,k===~~k){for(U=0,V=k;V>=10;V/=10,U++);U>W?J.c=J.e=null:(J.e=U,J.c=[k]);return}ee=String(k)}else{if(!r.test(ee=String(k)))return G(J,ee,N);J.s=ee.charCodeAt(0)==45?(ee=ee.slice(1),-1):1}(U=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(V=ee.search(/e/i))>0?(U<0&&(U=V),U+=+ee.slice(V+1),ee=ee.substring(0,V)):U<0&&(U=ee.length)}else{if(v(K,2,ae.length,"Base"),K==10)return J=new X(k),pe(J,b+J.e+1,w);if(ee=String(k),N=typeof k=="number"){if(k*0!=0)return G(J,ee,N,K);if(J.s=1/k<0?(ee=ee.slice(1),-1):1,X.DEBUG&&ee.replace(/^0\.0*|\./,"").length>15)throw Error(o+k)}else J.s=ee.charCodeAt(0)===45?(ee=ee.slice(1),-1):1;for($=ae.slice(0,K),U=V=0,Q=ee.length;V<Q;V++)if($.indexOf(Z=ee.charAt(V))<0){if(Z=="."){if(V>U){U=Q;continue}}else if(!I&&(ee==ee.toUpperCase()&&(ee=ee.toLowerCase())||ee==ee.toLowerCase()&&(ee=ee.toUpperCase()))){I=!0,V=-1,U=0;continue}return G(J,String(k),N,K)}N=!1,ee=z(ee,K,10,J.s),(U=ee.indexOf("."))>-1?ee=ee.replace(".",""):U=ee.length}for(V=0;ee.charCodeAt(V)===48;V++);for(Q=ee.length;ee.charCodeAt(--Q)===48;);if(ee=ee.slice(V,++Q)){if(Q-=V,N&&X.DEBUG&&Q>15&&(k>u||k!==n(k)))throw Error(o+J.s*k);if((U=U-V-1)>W)J.c=J.e=null;else if(U<B)J.c=[J.e=0];else{if(J.e=U,J.c=[],V=(U+1)%c,U<0&&(V+=c),V<Q){for(V&&J.c.push(+ee.slice(0,V)),Q-=c;V<Q;)J.c.push(+ee.slice(V,V+=c));V=c-(ee=ee.slice(V)).length}else V-=Q;for(;V--;ee+="0");J.c.push(+ee)}}else J.c=[J.e=0]}X.clone=p,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(k){var K,$;if(k!=null)if(typeof k=="object"){if(k.hasOwnProperty(K="DECIMAL_PLACES")&&($=k[K],v($,0,h,K),b=$),k.hasOwnProperty(K="ROUNDING_MODE")&&($=k[K],v($,0,8,K),w=$),k.hasOwnProperty(K="EXPONENTIAL_AT")&&($=k[K],$&&$.pop?(v($[0],-h,0,K),v($[1],0,h,K),S=$[0],C=$[1]):(v($,-h,h,K),S=-(C=$<0?-$:$))),k.hasOwnProperty(K="RANGE"))if($=k[K],$&&$.pop)v($[0],-h,-1,K),v($[1],1,h,K),B=$[0],W=$[1];else if(v($,-h,h,K),$)B=-(W=$<0?-$:$);else throw Error(s+K+" cannot be zero: "+$);if(k.hasOwnProperty(K="CRYPTO"))if($=k[K],$===!!$)if($)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))j=$;else throw j=!$,Error(s+"crypto unavailable");else j=$;else throw Error(s+K+" not true or false: "+$);if(k.hasOwnProperty(K="MODULO_MODE")&&($=k[K],v($,0,9,K),M=$),k.hasOwnProperty(K="POW_PRECISION")&&($=k[K],v($,0,h,K),_=$),k.hasOwnProperty(K="FORMAT"))if($=k[K],typeof $=="object")L=$;else throw Error(s+K+" not an object: "+$);if(k.hasOwnProperty(K="ALPHABET"))if($=k[K],typeof $=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test($))ae=$;else throw Error(s+K+" invalid: "+$)}else throw Error(s+"Object expected: "+k);return{DECIMAL_PLACES:b,ROUNDING_MODE:w,EXPONENTIAL_AT:[S,C],RANGE:[B,W],CRYPTO:j,MODULO_MODE:M,POW_PRECISION:_,FORMAT:L,ALPHABET:ae}},X.isBigNumber=function(k){if(!k||k._isBigNumber!==!0)return!1;if(!X.DEBUG)return!0;var K,$,Z=k.c,I=k.e,U=k.s;e:if({}.toString.call(Z)=="[object Array]"){if((U===1||U===-1)&&I>=-h&&I<=h&&I===n(I)){if(Z[0]===0){if(I===0&&Z.length===1)return!0;break e}if(K=(I+1)%c,K<1&&(K+=c),String(Z[0]).length==K){for(K=0;K<Z.length;K++)if($=Z[K],$<0||$>=a||$!==n($))break e;if($!==0)return!0}}}else if(Z===null&&I===null&&(U===null||U===1||U===-1))return!0;throw Error(s+"Invalid BigNumber: "+k)},X.maximum=X.max=function(){return oe(arguments,Y.lt)},X.minimum=X.min=function(){return oe(arguments,Y.gt)},X.random=function(){var k=9007199254740992,K=Math.random()*k&2097151?function(){return n(Math.random()*k)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function($){var Z,I,U,V,N,Q=0,ee=[],J=new X(P);if($==null?$=b:v($,0,h),V=i($/c),j)if(crypto.getRandomValues){for(Z=crypto.getRandomValues(new Uint32Array(V*=2));Q<V;)N=Z[Q]*131072+(Z[Q+1]>>>11),N>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),Z[Q]=I[0],Z[Q+1]=I[1]):(ee.push(N%1e14),Q+=2);Q=V/2}else if(crypto.randomBytes){for(Z=crypto.randomBytes(V*=7);Q<V;)N=(Z[Q]&31)*281474976710656+Z[Q+1]*1099511627776+Z[Q+2]*4294967296+Z[Q+3]*16777216+(Z[Q+4]<<16)+(Z[Q+5]<<8)+Z[Q+6],N>=9e15?crypto.randomBytes(7).copy(Z,Q):(ee.push(N%1e14),Q+=7);Q=V/7}else throw j=!1,Error(s+"crypto unavailable");if(!j)for(;Q<V;)N=K(),N<9e15&&(ee[Q++]=N%1e14);for(V=ee[--Q],$%=c,V&&$&&(N=l[c-$],ee[Q]=n(V/N)*N);ee[Q]===0;ee.pop(),Q--);if(Q<0)ee=[U=0];else{for(U=-1;ee[0]===0;ee.splice(0,1),U-=c);for(Q=1,N=ee[0];N>=10;N/=10,Q++);Q<c&&(U-=c-Q)}return J.e=U,J.c=ee,J}}(),X.sum=function(){for(var k=1,K=arguments,$=new X(K[0]);k<K.length;)$=$.plus(K[k++]);return $},z=function(){var k="0123456789";function K($,Z,I,U){for(var V,N=[0],Q,ee=0,J=$.length;ee<J;){for(Q=N.length;Q--;N[Q]*=Z);for(N[0]+=U.indexOf($.charAt(ee++)),V=0;V<N.length;V++)N[V]>I-1&&(N[V+1]==null&&(N[V+1]=0),N[V+1]+=N[V]/I|0,N[V]%=I)}return N.reverse()}return function($,Z,I,U,V){var N,Q,ee,J,ce,ge,be,je,Re=$.indexOf("."),Ve=b,Je=w;for(Re>=0&&(J=_,_=0,$=$.replace(".",""),je=new X(Z),ge=je.pow($.length-Re),_=J,je.c=K(F(m(ge.c),ge.e,"0"),10,I,k),je.e=je.c.length),be=K($,Z,I,V?(N=ae,k):(N=k,ae)),ee=J=be.length;be[--J]==0;be.pop());if(!be[0])return N.charAt(0);if(Re<0?--ee:(ge.c=be,ge.e=ee,ge.s=U,ge=D(ge,je,Ve,Je,I),be=ge.c,ce=ge.r,ee=ge.e),Q=ee+Ve+1,Re=be[Q],J=I/2,ce=ce||Q<0||be[Q+1]!=null,ce=Je<4?(Re!=null||ce)&&(Je==0||Je==(ge.s<0?3:2)):Re>J||Re==J&&(Je==4||ce||Je==6&&be[Q-1]&1||Je==(ge.s<0?8:7)),Q<1||!be[0])$=ce?F(N.charAt(1),-Ve,N.charAt(0)):N.charAt(0);else{if(be.length=Q,ce)for(--I;++be[--Q]>I;)be[Q]=0,Q||(++ee,be=[1].concat(be));for(J=be.length;!be[--J];);for(Re=0,$="";Re<=J;$+=N.charAt(be[Re++]));$=F($,ee,N.charAt(0))}return $}}(),D=function(){function k(Z,I,U){var V,N,Q,ee,J=0,ce=Z.length,ge=I%d,be=I/d|0;for(Z=Z.slice();ce--;)Q=Z[ce]%d,ee=Z[ce]/d|0,V=be*Q+ee*ge,N=ge*Q+V%d*d+J,J=(N/U|0)+(V/d|0)+be*ee,Z[ce]=N%U;return J&&(Z=[J].concat(Z)),Z}function K(Z,I,U,V){var N,Q;if(U!=V)Q=U>V?1:-1;else for(N=Q=0;N<U;N++)if(Z[N]!=I[N]){Q=Z[N]>I[N]?1:-1;break}return Q}function $(Z,I,U,V){for(var N=0;U--;)Z[U]-=N,N=Z[U]<I[U]?1:0,Z[U]=N*V+Z[U]-I[U];for(;!Z[0]&&Z.length>1;Z.splice(0,1));}return function(Z,I,U,V,N){var Q,ee,J,ce,ge,be,je,Re,Ve,Je,He,ze,gt,Yt,ir,En,zt,At=Z.s==I.s?1:-1,Qr=Z.c,nt=I.c;if(!Qr||!Qr[0]||!nt||!nt[0])return new X(!Z.s||!I.s||(Qr?nt&&Qr[0]==nt[0]:!nt)?NaN:Qr&&Qr[0]==0||!nt?At*0:At/0);for(Re=new X(At),Ve=Re.c=[],ee=Z.e-I.e,At=U+ee+1,N||(N=a,ee=g(Z.e/c)-g(I.e/c),At=At/c|0),J=0;nt[J]==(Qr[J]||0);J++);if(nt[J]>(Qr[J]||0)&&ee--,At<0)Ve.push(1),ce=!0;else{for(Yt=Qr.length,En=nt.length,J=0,At+=2,ge=n(N/(nt[0]+1)),ge>1&&(nt=k(nt,ge,N),Qr=k(Qr,ge,N),En=nt.length,Yt=Qr.length),gt=En,Je=Qr.slice(0,En),He=Je.length;He<En;Je[He++]=0);zt=nt.slice(),zt=[0].concat(zt),ir=nt[0],nt[1]>=N/2&&ir++;do{if(ge=0,Q=K(nt,Je,En,He),Q<0){if(ze=Je[0],En!=He&&(ze=ze*N+(Je[1]||0)),ge=n(ze/ir),ge>1)for(ge>=N&&(ge=N-1),be=k(nt,ge,N),je=be.length,He=Je.length;K(be,Je,je,He)==1;)ge--,$(be,En<je?zt:nt,je,N),je=be.length,Q=1;else ge==0&&(Q=ge=1),be=nt.slice(),je=be.length;if(je<He&&(be=[0].concat(be)),$(Je,be,He,N),He=Je.length,Q==-1)for(;K(nt,Je,En,He)<1;)ge++,$(Je,En<He?zt:nt,He,N),He=Je.length}else Q===0&&(ge++,Je=[0]);Ve[J++]=ge,Je[0]?Je[He++]=Qr[gt]||0:(Je=[Qr[gt]],He=1)}while((gt++<Yt||Je[0]!=null)&&At--);ce=Je[0]!=null,Ve[0]||Ve.splice(0,1)}if(N==a){for(J=1,At=Ve[0];At>=10;At/=10,J++);pe(Re,U+(Re.e=J+ee*c-1)+1,V,ce)}else Re.e=ee,Re.r=+ce;return Re}}();function ne(k,K,$,Z){var I,U,V,N,Q;if($==null?$=w:v($,0,8),!k.c)return k.toString();if(I=k.c[0],V=k.e,K==null)Q=m(k.c),Q=Z==1||Z==2&&(V<=S||V>=C)?R(Q,V):F(Q,V,"0");else if(k=pe(new X(k),K,$),U=k.e,Q=m(k.c),N=Q.length,Z==1||Z==2&&(K<=U||U<=S)){for(;N<K;Q+="0",N++);Q=R(Q,U)}else if(K-=V,Q=F(Q,U,"0"),U+1>N){if(--K>0)for(Q+=".";K--;Q+="0");}else if(K+=U-N,K>0)for(U+1==N&&(Q+=".");K--;Q+="0");return k.s<0&&I?"-"+Q:Q}function oe(k,K){for(var $,Z=1,I=new X(k[0]);Z<k.length;Z++)if($=new X(k[Z]),$.s)K.call(I,$)&&(I=$);else{I=$;break}return I}function he(k,K,$){for(var Z=1,I=K.length;!K[--I];K.pop());for(I=K[0];I>=10;I/=10,Z++);return($=Z+$*c-1)>W?k.c=k.e=null:$<B?k.c=[k.e=0]:(k.e=$,k.c=K),k}G=function(){var k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,K=/^([^.]+)\.$/,$=/^\.([^.]+)$/,Z=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,V,N,Q){var ee,J=N?V:V.replace(I,"");if(Z.test(J))U.s=isNaN(J)?null:J<0?-1:1;else{if(!N&&(J=J.replace(k,function(ce,ge,be){return ee=(be=be.toLowerCase())=="x"?16:be=="b"?2:8,!Q||Q==ee?ge:ce}),Q&&(ee=Q,J=J.replace(K,"$1").replace($,"0.$1")),V!=J))return new X(J,ee);if(X.DEBUG)throw Error(s+"Not a"+(Q?" base "+Q:"")+" number: "+V);U.s=null}U.c=U.e=null}}();function pe(k,K,$,Z){var I,U,V,N,Q,ee,J,ce=k.c,ge=l;if(ce){e:{for(I=1,N=ce[0];N>=10;N/=10,I++);if(U=K-I,U<0)U+=c,V=K,Q=ce[ee=0],J=Q/ge[I-V-1]%10|0;else if(ee=i((U+1)/c),ee>=ce.length)if(Z){for(;ce.length<=ee;ce.push(0));Q=J=0,I=1,U%=c,V=U-c+1}else break e;else{for(Q=N=ce[ee],I=1;N>=10;N/=10,I++);U%=c,V=U-c+I,J=V<0?0:Q/ge[I-V-1]%10|0}if(Z=Z||K<0||ce[ee+1]!=null||(V<0?Q:Q%ge[I-V-1]),Z=$<4?(J||Z)&&($==0||$==(k.s<0?3:2)):J>5||J==5&&($==4||Z||$==6&&(U>0?V>0?Q/ge[I-V]:0:ce[ee-1])%10&1||$==(k.s<0?8:7)),K<1||!ce[0])return ce.length=0,Z?(K-=k.e+1,ce[0]=ge[(c-K%c)%c],k.e=-K||0):ce[0]=k.e=0,k;if(U==0?(ce.length=ee,N=1,ee--):(ce.length=ee+1,N=ge[c-U],ce[ee]=V>0?n(Q/ge[I-V]%ge[V])*N:0),Z)for(;;)if(ee==0){for(U=1,V=ce[0];V>=10;V/=10,U++);for(V=ce[0]+=N,N=1;V>=10;V/=10,N++);U!=N&&(k.e++,ce[0]==a&&(ce[0]=1));break}else{if(ce[ee]+=N,ce[ee]!=a)break;ce[ee--]=0,N=1}for(U=ce.length;ce[--U]===0;ce.pop());}k.e>W?k.c=k.e=null:k.e<B&&(k.c=[k.e=0])}return k}function _e(k){var K,$=k.e;return $===null?k.toString():(K=m(k.c),K=$<=S||$>=C?R(K,$):F(K,$,"0"),k.s<0?"-"+K:K)}return Y.absoluteValue=Y.abs=function(){var k=new X(this);return k.s<0&&(k.s=1),k},Y.comparedTo=function(k,K){return E(this,new X(k,K))},Y.decimalPlaces=Y.dp=function(k,K){var $,Z,I,U=this;if(k!=null)return v(k,0,h),K==null?K=w:v(K,0,8),pe(new X(U),k+U.e+1,K);if(!($=U.c))return null;if(Z=((I=$.length-1)-g(this.e/c))*c,I=$[I])for(;I%10==0;I/=10,Z--);return Z<0&&(Z=0),Z},Y.dividedBy=Y.div=function(k,K){return D(this,new X(k,K),b,w)},Y.dividedToIntegerBy=Y.idiv=function(k,K){return D(this,new X(k,K),0,1)},Y.exponentiatedBy=Y.pow=function(k,K){var $,Z,I,U,V,N,Q,ee,J,ce=this;if(k=new X(k),k.c&&!k.isInteger())throw Error(s+"Exponent not an integer: "+_e(k));if(K!=null&&(K=new X(K)),N=k.e>14,!ce.c||!ce.c[0]||ce.c[0]==1&&!ce.e&&ce.c.length==1||!k.c||!k.c[0])return J=new X(Math.pow(+_e(ce),N?2-A(k):+_e(k))),K?J.mod(K):J;if(Q=k.s<0,K){if(K.c?!K.c[0]:!K.s)return new X(NaN);Z=!Q&&ce.isInteger()&&K.isInteger(),Z&&(ce=ce.mod(K))}else{if(k.e>9&&(ce.e>0||ce.e<-1||(ce.e==0?ce.c[0]>1||N&&ce.c[1]>=24e7:ce.c[0]<8e13||N&&ce.c[0]<=9999975e7)))return U=ce.s<0&&A(k)?-0:0,ce.e>-1&&(U=1/U),new X(Q?1/U:U);_&&(U=i(_/c+2))}for(N?($=new X(.5),Q&&(k.s=1),ee=A(k)):(I=Math.abs(+_e(k)),ee=I%2),J=new X(P);;){if(ee){if(J=J.times(ce),!J.c)break;U?J.c.length>U&&(J.c.length=U):Z&&(J=J.mod(K))}if(I){if(I=n(I/2),I===0)break;ee=I%2}else if(k=k.times($),pe(k,k.e+1,1),k.e>14)ee=A(k);else{if(I=+_e(k),I===0)break;ee=I%2}ce=ce.times(ce),U?ce.c&&ce.c.length>U&&(ce.c.length=U):Z&&(ce=ce.mod(K))}return Z?J:(Q&&(J=P.div(J)),K?J.mod(K):U?pe(J,_,w,V):J)},Y.integerValue=function(k){var K=new X(this);return k==null?k=w:v(k,0,8),pe(K,K.e+1,k)},Y.isEqualTo=Y.eq=function(k,K){return E(this,new X(k,K))===0},Y.isFinite=function(){return!!this.c},Y.isGreaterThan=Y.gt=function(k,K){return E(this,new X(k,K))>0},Y.isGreaterThanOrEqualTo=Y.gte=function(k,K){return(K=E(this,new X(k,K)))===1||K===0},Y.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},Y.isLessThan=Y.lt=function(k,K){return E(this,new X(k,K))<0},Y.isLessThanOrEqualTo=Y.lte=function(k,K){return(K=E(this,new X(k,K)))===-1||K===0},Y.isNaN=function(){return!this.s},Y.isNegative=function(){return this.s<0},Y.isPositive=function(){return this.s>0},Y.isZero=function(){return!!this.c&&this.c[0]==0},Y.minus=function(k,K){var $,Z,I,U,V=this,N=V.s;if(k=new X(k,K),K=k.s,!N||!K)return new X(NaN);if(N!=K)return k.s=-K,V.plus(k);var Q=V.e/c,ee=k.e/c,J=V.c,ce=k.c;if(!Q||!ee){if(!J||!ce)return J?(k.s=-K,k):new X(ce?V:NaN);if(!J[0]||!ce[0])return ce[0]?(k.s=-K,k):new X(J[0]?V:w==3?-0:0)}if(Q=g(Q),ee=g(ee),J=J.slice(),N=Q-ee){for((U=N<0)?(N=-N,I=J):(ee=Q,I=ce),I.reverse(),K=N;K--;I.push(0));I.reverse()}else for(Z=(U=(N=J.length)<(K=ce.length))?N:K,N=K=0;K<Z;K++)if(J[K]!=ce[K]){U=J[K]<ce[K];break}if(U&&(I=J,J=ce,ce=I,k.s=-k.s),K=(Z=ce.length)-($=J.length),K>0)for(;K--;J[$++]=0);for(K=a-1;Z>N;){if(J[--Z]<ce[Z]){for($=Z;$&&!J[--$];J[$]=K);--J[$],J[Z]+=a}J[Z]-=ce[Z]}for(;J[0]==0;J.splice(0,1),--ee);return J[0]?he(k,J,ee):(k.s=w==3?-1:1,k.c=[k.e=0],k)},Y.modulo=Y.mod=function(k,K){var $,Z,I=this;return k=new X(k,K),!I.c||!k.s||k.c&&!k.c[0]?new X(NaN):!k.c||I.c&&!I.c[0]?new X(I):(M==9?(Z=k.s,k.s=1,$=D(I,k,0,3),k.s=Z,$.s*=Z):$=D(I,k,0,M),k=I.minus($.times(k)),!k.c[0]&&M==1&&(k.s=I.s),k)},Y.multipliedBy=Y.times=function(k,K){var $,Z,I,U,V,N,Q,ee,J,ce,ge,be,je,Re,Ve,Je=this,He=Je.c,ze=(k=new X(k,K)).c;if(!He||!ze||!He[0]||!ze[0])return!Je.s||!k.s||He&&!He[0]&&!ze||ze&&!ze[0]&&!He?k.c=k.e=k.s=null:(k.s*=Je.s,!He||!ze?k.c=k.e=null:(k.c=[0],k.e=0)),k;for(Z=g(Je.e/c)+g(k.e/c),k.s*=Je.s,Q=He.length,ce=ze.length,Q<ce&&(je=He,He=ze,ze=je,I=Q,Q=ce,ce=I),I=Q+ce,je=[];I--;je.push(0));for(Re=a,Ve=d,I=ce;--I>=0;){for($=0,ge=ze[I]%Ve,be=ze[I]/Ve|0,V=Q,U=I+V;U>I;)ee=He[--V]%Ve,J=He[V]/Ve|0,N=be*ee+J*ge,ee=ge*ee+N%Ve*Ve+je[U]+$,$=(ee/Re|0)+(N/Ve|0)+be*J,je[U--]=ee%Re;je[U]=$}return $?++Z:je.splice(0,1),he(k,je,Z)},Y.negated=function(){var k=new X(this);return k.s=-k.s||null,k},Y.plus=function(k,K){var $,Z=this,I=Z.s;if(k=new X(k,K),K=k.s,!I||!K)return new X(NaN);if(I!=K)return k.s=-K,Z.minus(k);var U=Z.e/c,V=k.e/c,N=Z.c,Q=k.c;if(!U||!V){if(!N||!Q)return new X(I/0);if(!N[0]||!Q[0])return Q[0]?k:new X(N[0]?Z:I*0)}if(U=g(U),V=g(V),N=N.slice(),I=U-V){for(I>0?(V=U,$=Q):(I=-I,$=N),$.reverse();I--;$.push(0));$.reverse()}for(I=N.length,K=Q.length,I-K<0&&($=Q,Q=N,N=$,K=I),I=0;K;)I=(N[--K]=N[K]+Q[K]+I)/a|0,N[K]=a===N[K]?0:N[K]%a;return I&&(N=[I].concat(N),++V),he(k,N,V)},Y.precision=Y.sd=function(k,K){var $,Z,I,U=this;if(k!=null&&k!==!!k)return v(k,1,h),K==null?K=w:v(K,0,8),pe(new X(U),k,K);if(!($=U.c))return null;if(I=$.length-1,Z=I*c+1,I=$[I]){for(;I%10==0;I/=10,Z--);for(I=$[0];I>=10;I/=10,Z++);}return k&&U.e+1>Z&&(Z=U.e+1),Z},Y.shiftedBy=function(k){return v(k,-u,u),this.times("1e"+k)},Y.squareRoot=Y.sqrt=function(){var k,K,$,Z,I,U=this,V=U.c,N=U.s,Q=U.e,ee=b+4,J=new X("0.5");if(N!==1||!V||!V[0])return new X(!N||N<0&&(!V||V[0])?NaN:V?U:1/0);if(N=Math.sqrt(+_e(U)),N==0||N==1/0?(K=m(V),(K.length+Q)%2==0&&(K+="0"),N=Math.sqrt(+K),Q=g((Q+1)/2)-(Q<0||Q%2),N==1/0?K="5e"+Q:(K=N.toExponential(),K=K.slice(0,K.indexOf("e")+1)+Q),$=new X(K)):$=new X(N+""),$.c[0]){for(Q=$.e,N=Q+ee,N<3&&(N=0);;)if(I=$,$=J.times(I.plus(D(U,I,ee,1))),m(I.c).slice(0,N)===(K=m($.c)).slice(0,N))if($.e<Q&&--N,K=K.slice(N-3,N+1),K=="9999"||!Z&&K=="4999"){if(!Z&&(pe(I,I.e+b+2,0),I.times(I).eq(U))){$=I;break}ee+=4,N+=4,Z=1}else{(!+K||!+K.slice(1)&&K.charAt(0)=="5")&&(pe($,$.e+b+2,1),k=!$.times($).eq(U));break}}return pe($,$.e+b+1,w,k)},Y.toExponential=function(k,K){return k!=null&&(v(k,0,h),k++),ne(this,k,K,1)},Y.toFixed=function(k,K){return k!=null&&(v(k,0,h),k=k+this.e+1),ne(this,k,K)},Y.toFormat=function(k,K,$){var Z,I=this;if($==null)k!=null&&K&&typeof K=="object"?($=K,K=null):k&&typeof k=="object"?($=k,k=K=null):$=L;else if(typeof $!="object")throw Error(s+"Argument not an object: "+$);if(Z=I.toFixed(k,K),I.c){var U,V=Z.split("."),N=+$.groupSize,Q=+$.secondaryGroupSize,ee=$.groupSeparator||"",J=V[0],ce=V[1],ge=I.s<0,be=ge?J.slice(1):J,je=be.length;if(Q&&(U=N,N=Q,Q=U,je-=U),N>0&&je>0){for(U=je%N||N,J=be.substr(0,U);U<je;U+=N)J+=ee+be.substr(U,N);Q>0&&(J+=ee+be.slice(U)),ge&&(J="-"+J)}Z=ce?J+($.decimalSeparator||"")+((Q=+$.fractionGroupSize)?ce.replace(new RegExp("\\d{"+Q+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):ce):J}return($.prefix||"")+Z+($.suffix||"")},Y.toFraction=function(k){var K,$,Z,I,U,V,N,Q,ee,J,ce,ge,be=this,je=be.c;if(k!=null&&(N=new X(k),!N.isInteger()&&(N.c||N.s!==1)||N.lt(P)))throw Error(s+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+_e(N));if(!je)return new X(be);for(K=new X(P),ee=$=new X(P),Z=Q=new X(P),ge=m(je),U=K.e=ge.length-be.e-1,K.c[0]=l[(V=U%c)<0?c+V:V],k=!k||N.comparedTo(K)>0?U>0?K:ee:N,V=W,W=1/0,N=new X(ge),Q.c[0]=0;J=D(N,K,0,1),I=$.plus(J.times(Z)),I.comparedTo(k)!=1;)$=Z,Z=I,ee=Q.plus(J.times(I=ee)),Q=I,K=N.minus(J.times(I=K)),N=I;return I=D(k.minus($),Z,0,1),Q=Q.plus(I.times(ee)),$=$.plus(I.times(Z)),Q.s=ee.s=be.s,U=U*2,ce=D(ee,Z,U,w).minus(be).abs().comparedTo(D(Q,$,U,w).minus(be).abs())<1?[ee,Z]:[Q,$],W=V,ce},Y.toNumber=function(){return+_e(this)},Y.toPrecision=function(k,K){return k!=null&&v(k,1,h),ne(this,k,K,2)},Y.toString=function(k){var K,$=this,Z=$.s,I=$.e;return I===null?Z?(K="Infinity",Z<0&&(K="-"+K)):K="NaN":(k==null?K=I<=S||I>=C?R(m($.c),I):F(m($.c),I,"0"):k===10?($=pe(new X($),b+I+1,w),K=F(m($.c),$.e,"0")):(v(k,2,ae.length,"Base"),K=z(F(m($.c),I,"0"),10,k,Z,!0)),Z<0&&$.c[0]&&(K="-"+K)),K},Y.valueOf=Y.toJSON=function(){return _e(this)},Y._isBigNumber=!0,q!=null&&X.set(q),X}function g(q){var D=q|0;return q>0||q===D?D:D-1}function m(q){for(var D,z,G=1,Y=q.length,P=q[0]+"";G<Y;){for(D=q[G++]+"",z=c-D.length;z--;D="0"+D);P+=D}for(Y=P.length;P.charCodeAt(--Y)===48;);return P.slice(0,Y+1||1)}function E(q,D){var z,G,Y=q.c,P=D.c,b=q.s,w=D.s,S=q.e,C=D.e;if(!b||!w)return null;if(z=Y&&!Y[0],G=P&&!P[0],z||G)return z?G?0:-w:b;if(b!=w)return b;if(z=b<0,G=S==C,!Y||!P)return G?0:!Y^z?1:-1;if(!G)return S>C^z?1:-1;for(w=(S=Y.length)<(C=P.length)?S:C,b=0;b<w;b++)if(Y[b]!=P[b])return Y[b]>P[b]^z?1:-1;return S==C?0:S>C^z?1:-1}function v(q,D,z,G){if(q<D||q>z||q!==n(q))throw Error(s+(G||"Argument")+(typeof q=="number"?q<D||q>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function A(q){var D=q.c.length-1;return g(q.e/c)==D&&q.c[D]%2!=0}function R(q,D){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(D<0?"e":"e+")+D}function F(q,D,z){var G,Y;if(D<0){for(Y=z+".";++D;Y+=z);q=Y+q}else if(G=q.length,++D>G){for(Y=z,D-=G;--D;Y+=z);q+=Y}else D<G&&(q=q.slice(0,D)+"."+q.slice(D));return q}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof OS!="undefined"&&OS.exports?OS.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(l1e)});var iC=y((d1e,h1e)=>{f();"use strict";var Kht=Math.exp;d1e=h1e.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,i=0,n=0,s=0,o,a={};function c(u,l){return 1-Kht(-(u-l)/e)}return a.push=function(l,d){if(o){let h=c(l,o),p=d-r,g=h*p;r=h*d+(1-h)*r,i=(1-h)*(i+p*g),n=Math.sqrt(i),s=r+h*p}else r=d;o=l},a.movingAverage=function(){return r},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var b1e=y((n7t,g1e)=>{f();"use strict";var{EventEmitter:jht}=yr(),{BigNumber:kS}=f1e(),p1e=iC(),Vht=BP(),y1e=class extends jht{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:kS(0),dataSent:kS(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=kS(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=p1e(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(r);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(r[s]))i.movingAverages[s][o]=r[s][o].movingAverage()}return i}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=Vht(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],d=a[l];d||(d=a[l]=p1e(l)),d.push(i,o)}}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,r)?n=this._stats[r]:n=this._stats[r]=kS(0),this._stats[r]=n.plus(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};g1e.exports=y1e});var w1e=y((s7t,v1e)=>{f();"use strict";var zht=gr(),{pipe:Hht}=Ar(),{tap:m1e}=Op(),$ht=u1e(),{METRICS:Ght}=gS(),nC=b1e(),sC=["dataReceived","dataSent"],Wht={in:"dataReceived",out:"dataSent"},qS=class{constructor(e){this._options=zht(Ght,e),this._globalStats=new nC(sC,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=$ht(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",r=>{this.onPeerDisconnected(r.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),i=this._peerStats.get(r);i&&(i.stop(),this._peerStats.delete(r),this._oldPeers.set(r,i))}_onMessage({remotePeer:e,protocol:r,direction:i,dataLength:n}){if(!this._running)return;let s=Wht[i],o=this.forPeer(e);if(o||(o=new nC(sC,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),r){let a=this.forProtocol(r);a||(a=new nC(sC,this._options),this._protocolStats.set(r,a)),a.push(s,n)}}updatePlaceholder(e,r){if(!this._running)return;let i=this.forPeer(e),n=r.toB58String(),s=this.forPeer(r),o=i;s&&(o=qS.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:i}){let n=this,s=e.source;e.source=m1e(a=>n._onMessage({remotePeer:r,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>Hht(a,m1e(c=>n._onMessage({remotePeer:r,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};v1e.exports=qS});var DS=y(Bd=>{f();"use strict";var _1e=gn(),E1e=Wo(),Yht=Ar(),Xht=ue(),{fromString:Qht}=(ft(),ht),Zht=Df(),S1e=Qht(`
`);Bd.encode=t=>E1e.encode.single(new _1e([t,S1e]));Bd.write=(t,e)=>t.push(Bd.encode(e));Bd.writeAll=(t,e)=>{t.push(e.reduce((r,i)=>r.append(Bd.encode(i)),new _1e))};Bd.read=async t=>{let e=1,r={[Symbol.asyncIterator](){return this},next:()=>t.next(e)},i=s=>{e=s},n=await Yht(r,E1e.decode({onLength:i}),Zht);if(n.get(n.length-1)!==S1e[0])throw Xht(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.shallowSlice(0,-1)}});var A1e=y((a7t,x1e)=>{f();"use strict";var N0=me()("mss:select"),Jht=ue(),B0=DS(),ept=P0();x1e.exports=async(t,e,r)=>{e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:n,rest:s,stream:o}=ept(t),a=e.shift();r?(N0('select: write ["%s", "%s"]',r,a),B0.writeAll(n,[r,a])):(N0('select: write "%s"',a),B0.write(n,a));let c=(await B0.read(i)).toString();if(N0('select: read "%s"',c),c===r&&(c=(await B0.read(i)).toString(),N0('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let u of e){N0('select: write "%s"',u),B0.write(n,u);let l=(await B0.read(i)).toString();if(N0('select: read "%s" for "%s"',l,u),l===u)return s(),{stream:o,protocol:u}}throw s(),Jht(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var oC=y(I1e=>{f();"use strict";I1e.PROTOCOL_ID="/multistream/1.0.0"});var R1e=y((u7t,T1e)=>{f();"use strict";var X1=me()("mss:handle"),tpt=gn(),M0=DS(),rpt=P0(),{PROTOCOL_ID:aC}=oC();T1e.exports=async(t,e)=>{e=Array.isArray(e)?e:[e];let{writer:r,reader:i,rest:n,stream:s}=rpt(t);for(;;){let o=(await M0.read(i)).toString();if(X1('read "%s"',o),o===aC){X1('respond with "%s" for "%s"',aC,o),M0.write(r,aC);continue}if(e.includes(o))return M0.write(r,o),X1('respond with "%s" for "%s"',o,o),n(),{stream:s,protocol:o};if(o==="ls"){M0.write(r,new tpt(e.map(a=>M0.encode(a)))),X1('respond with "%s" for %s',e,o);continue}M0.write(r,"na"),X1('respond with "na" for "%s"',o)}}});var O1e=y((l7t,C1e)=>{f();"use strict";var ipt=a2(),npt=me()("it-multistream-select:ls"),P1e=DS(),spt=P0(),opt=Wo(),apt=Ar();C1e.exports=async t=>{let{reader:e,writer:r,rest:i,stream:n}=spt(t);npt('write "ls"'),P1e.write(r,"ls"),i();let s=await P1e.read(e),o=ipt([s]),a=[];return await apt(o,opt.decode(),async c=>{for await(let u of c)a.push(u.shallowSlice(0,-1).toString())}),{stream:n,protocols:a}}});var N1e=y(NS=>{f();"use strict";var k1e=A1e(),cpt=R1e(),upt=O1e(),{PROTOCOL_ID:cC}=oC();NS.PROTOCOL_ID=cC;var uC=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await k1e(this._stream,cC);this._stream=e,this._shaken=!0}},q1e=class extends uC{select(e){return k1e(this._stream,e,this._shaken?null:cC)}async ls(){await this._handshake();let{stream:e,protocols:r}=await upt(this._stream);return this._stream=e,r}};NS.Dialer=q1e;var D1e=class extends uC{handle(e){return cpt(this._stream,e)}};NS.Listener=D1e});var M1e=y((d7t,B1e)=>{f();"use strict";var lpt={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};B1e.exports=lpt});var V1e=y((h7t,j1e)=>{f();"use strict";var L1e=rt(),{Multiaddr:fpt}=it(),bs=ue(),{OPEN:dpt,CLOSING:U1e,CLOSED:lC}=M1e(),F1e=Symbol.for("@libp2p/interface-connection/connection"),K1e=class{constructor({localAddr:e,remoteAddr:r,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){hpt(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:dpt},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[F1e](){return!0}static isConnection(e){return Boolean(e&&e[F1e])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===U1e)throw bs(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===lC)throw bs(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:i}=await this._newStream(e);return this.addStream(r,{protocol:i}),{stream:r,protocol:i}}addStream(e,{protocol:r,metadata:i={}}){this.registry.set(e.id,{protocol:r,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==lC){if(this._closing)return this._closing;this.stat.status=U1e,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=lC}}};j1e.exports=K1e;function hpt(t,e,r,i,n,s,o){if(t&&!fpt.isMultiaddr(t))throw bs(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!L1e.isPeerId(e))throw bs(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!L1e.isPeerId(r))throw bs(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw bs(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw bs(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw bs(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw bs(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw bs(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw bs(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw bs(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw bs(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var H1e=y(z1e=>{f();"use strict";z1e.Connection=V1e()});var G1e=y((y7t,$1e)=>{f();"use strict";function ppt(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}$1e.exports=function(e){var r=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,d=Array(l),h=0;h<l;h++)d[h]=arguments[h];return r[u].apply(null,[i].concat(ppt(d.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return r},proxy:new Proxy(i,o)}}});var Z1e=y((g7t,Q1e)=>{f();"use strict";var W1e=me(),Ai=Object.assign(W1e("libp2p:upgrader"),{error:W1e("libp2p:upgrader:err")}),Md=ue(),L0=N1e(),{Connection:ypt}=H1e(),gpt=rt(),{pipe:bpt}=Ar(),Y1e=G1e(),{codes:U0}=yi(),X1e=class{constructor({localPeer:e,metrics:r,cryptos:i=new Map,muxers:n=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=r,this.cryptos=i,this.muxers=n,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let r,i,n,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=Y1e());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}Ai("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:r,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(r,this.muxers):n=r}catch(l){throw Ai.error("Failed to upgrade inbound connection",l),await e.close(l),l}return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),Ai("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw Md(new Error("outbound connection must have a peer id"),U0.ERR_INVALID_MULTIADDR);let i=gpt.createFromB58String(r),n,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=Y1e());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:l})}Ai("Starting the outbound connection upgrade");let d=e;this.protector&&(d=await this.protector.protect(e));try{({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,d,i,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(h){throw Ai.error("Failed to upgrade outbound connection",h),await e.close(h),h}return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),Ai("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async h=>{if(!u)return;let p=new L0.Listener(h);try{let{stream:g,protocol:m}=await p.handle(Array.from(this.protocols.keys()));Ai("%s: incoming stream opened on %s",r,m),this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:m}),u.addStream(h,{protocol:m}),this._onStream({connection:u,stream:{...h,...g},protocol:m})}catch(g){Ai.error(g)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{Ai("%s: starting new stream on %s",r,h);let p=a.newStream(),g=new L0.Dialer(p);try{let{stream:m,protocol:E}=await g.select(h);return this.metrics&&this.metrics.trackStream({stream:m,remotePeer:o,protocol:E}),{stream:{...p,...m},protocol:E}}catch(m){throw Ai.error("could not create new stream",m),Md(m,U0.ERR_UNSUPPORTED_PROTOCOL)}},bpt(n,a,n).catch(Ai.error));let l=i.timeline;i.timeline=new Proxy(l,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){Ai.error(p)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...h))}),i.timeline.upgraded=Date.now();let d=()=>{throw Md(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return u=new ypt({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||d,getStreams:()=>a?a.streams:d(),close:async()=>{await i.close(),a&&a.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:i}){this.protocols.get(i)({connection:e,stream:r,protocol:i})}async _encryptInbound(e,r,i){let n=new L0.Listener(r),s=Array.from(i.keys());Ai("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(Ai("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Md(o,U0.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,i,n){let s=new L0.Dialer(r),o=Array.from(n.keys());Ai("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=n.get(c);if(Ai("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,i),protocol:c}}catch(a){throw Md(a,U0.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let i=new L0.Dialer(e),n=Array.from(r.keys());Ai("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);Ai("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw Md(s,U0.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let i=new L0.Listener(e),n=Array.from(r.keys());Ai("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw Md(s,U0.ERR_MUXER_UNAVAILABLE)}}};Q1e.exports=X1e});var Q1=y((b7t,rme)=>{f();"use strict";var fC=ue(),J1e=rt(),{codes:{ERR_INVALID_PARAMETERS:eme}}=yi(),mpt=t=>t,tme=class{constructor({peerStore:e,eventName:r,eventProperty:i,eventTransformer:n=mpt}){this._ps=e,this.eventName=r,this.eventProperty=i,this.eventTransformer=n,this.data=new Map}set(e,r){throw fC(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,r,{emit:i=!0}={}){let n=e.toB58String();this.data.set(n,r),i&&this._emit(e,r)}_emit(e,r){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(r)})}get(e){if(!J1e.isPeerId(e))throw fC(new Error("peerId must be an instance of peer-id"),eme);let r=this.data.get(e.toB58String());return r?[...r]:void 0}delete(e){if(!J1e.isPeerId(e))throw fC(new Error("peerId must be an instance of peer-id"),eme);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};rme.exports=tme});var ome=y((m7t,sme)=>{f();"use strict";var ime=me(),ea=Object.assign(ime("libp2p:peer-store:address-book"),{error:ime("libp2p:peer-store:address-book:err")}),F0=ue(),{Multiaddr:vpt}=it(),BS=rt(),wpt=Q1(),_pt=vS(),{codes:{ERR_INVALID_PARAMETERS:K0}}=yi(),Ept=M1(),nme=class extends wpt{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:r=>r.addresses?r.addresses.map(i=>i.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let r;try{r=_pt.createFromProtobuf(e.payload)}catch(c){return ea.error("invalid peer record received"),!1}if(!r.peerId.equals(e.peerId))return ea("signing key does not match PeerId in the PeerRecord"),!1;if(!r.multiaddrs||!r.multiaddrs.length)return!1;let i=r.peerId,n=i.toB58String(),o=(this.data.get(n)||{record:void 0}).record;if(o&&o.seqNumber>=r.seqNumber)return!1;let a=this._toAddresses(r.multiaddrs,!0);return this._setData(i,{addresses:a,record:{raw:e.marshal(),seqNumber:r.seqNumber}}),ea(`stored provided peer record for ${n}`),!0}getRawEnvelope(e){let r=this.data.get(e.toB58String());if(!(!r||!r.record||!r.record.raw))return r.record.raw}getPeerRecord(e){let r=this.getRawEnvelope(e);if(!!r)return Ept.createFromProtobuf(r)}set(e,r){if(!BS.isPeerId(e))throw ea.error("peerId must be an instance of peer-id to store data"),F0(new Error("peerId must be an instance of peer-id"),K0);let i=this._toAddresses(r);if(!i.length)return this;let n=e.toB58String(),s=this.data.get(n);return s&&s.addresses&&s.addresses.length===i.length&&s.addresses.filter(a=>i.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(ea(`the addresses provided to store are equal to the already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),ea(`stored provided multiaddrs for ${n}`),s||this._ps.emit("peer",e),this)}add(e,r){if(!BS.isPeerId(e))throw ea.error("peerId must be an instance of peer-id to store data"),F0(new Error("peerId must be an instance of peer-id"),K0);let i=this._toAddresses(r),n=e.toB58String();if(!i.length)return this;let s=this.data.get(n);return s&&s.addresses&&(s.addresses.forEach(o=>{i.find(a=>a.multiaddr.equals(o.multiaddr))||i.push(o)}),s.addresses.length===i.length)?(ea(`the addresses provided to store are already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),ea(`added provided multiaddrs for ${n}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!BS.isPeerId(e))throw F0(new Error("peerId must be an instance of peer-id"),K0);let r=this.data.get(e.toB58String());return r&&r.addresses?[...r.addresses]:void 0}_toAddresses(e,r=!1){if(!e)throw ea.error("multiaddrs must be provided to store data"),F0(new Error("multiaddrs must be provided"),K0);let i=[];return e.forEach(n=>{if(!vpt.isMultiaddr(n))throw ea.error(`multiaddr ${n} must be an instance of multiaddr`),F0(new Error(`multiaddr ${n} must be an instance of multiaddr`),K0);i.find(s=>s.multiaddr.equals(n))||i.push({multiaddr:n,isCertified:r})}),i}getMultiaddrsForPeer(e,r=i=>i){if(!BS.isPeerId(e))throw F0(new Error("peerId must be an instance of peer-id"),K0);let i=this.data.get(e.toB58String());if(!(!i||!i.addresses))return r(i.addresses||[]).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};sme.exports=nme});var pme=y((v7t,hme)=>{f();"use strict";var ame=me(),cme=Object.assign(ame("libp2p:peer-store:key-book"),{error:ame("libp2p:peer-store:key-book:err")}),ume=ue(),lme=rt(),Spt=Q1(),{codes:{ERR_INVALID_PARAMETERS:fme}}=yi(),dme=class extends Spt{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:r=>r.pubKey});this.data=new Map}set(e,r){if(!lme.isPeerId(e))throw cme.error("peerId must be an instance of peer-id to store data"),ume(new Error("peerId must be an instance of peer-id"),fme);let i=e.toB58String();return!this.data.get(i)&&r&&(e.pubKey=r,this._setData(e,e),cme(`stored provided public key for ${i}`)),this}get(e){if(!lme.isPeerId(e))throw ume(new Error("peerId must be an instance of peer-id"),fme);let r=this.data.get(e.toB58String());return r?r.pubKey:void 0}};hme.exports=dme});var mme=y((w7t,bme)=>{f();"use strict";var yme=me(),dC=Object.assign(yme("libp2p:peer-store:proto-book"),{error:yme("libp2p:peer-store:proto-book:err")}),j0=ue(),{equals:xpt}=(di(),fi),Z1=rt(),Apt=Q1(),{codes:{ERR_INVALID_PARAMETERS:V0}}=yi(),gme=class extends Apt{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,r,i){if(!Z1.isPeerId(e))throw dC.error("peerId must be an instance of peer-id to store data"),j0(new Error("peerId must be an instance of peer-id"),V0);if(typeof r!="string"||!(i instanceof Uint8Array))throw dC.error("valid key and value must be provided to store data"),j0(new Error("valid key and value must be provided"),V0);return this._setValue(e,r,i),this}_setValue(e,r,i,{emit:n=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(r);if(a&&xpt(i,a)){dC(`the metadata provided to store is equal to the already stored for ${s} on ${r}`);return}o.set(r,i),this.data.set(s,o),n&&this._emit(e,r)}get(e){if(!Z1.isPeerId(e))throw j0(new Error("peerId must be an instance of peer-id"),V0);return this.data.get(e.toB58String())}getValue(e,r){if(!Z1.isPeerId(e))throw j0(new Error("peerId must be an instance of peer-id"),V0);let i=this.data.get(e.toB58String());return i&&i.get(r)}delete(e){if(!Z1.isPeerId(e))throw j0(new Error("peerId must be an instance of peer-id"),V0);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,r){if(!Z1.isPeerId(e))throw j0(new Error("peerId must be an instance of peer-id"),V0);let i=this.data.get(e.toB58String());return!i||!i.delete(r)?!1:(this._emit(e,r),!0)}};bme.exports=gme});var Eme=y((_7t,_me)=>{f();"use strict";var vme=me(),ta=Object.assign(vme("libp2p:peer-store:proto-book"),{error:vme("libp2p:peer-store:proto-book:err")}),z0=ue(),hC=rt(),Ipt=Q1(),{codes:{ERR_INVALID_PARAMETERS:H0}}=yi(),wme=class extends Ipt{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:r=>Array.from(r)});this.data=new Map}set(e,r){if(!hC.isPeerId(e))throw ta.error("peerId must be an instance of peer-id to store data"),z0(new Error("peerId must be an instance of peer-id"),H0);if(!r)throw ta.error("protocols must be provided to store data"),z0(new Error("protocols must be provided"),H0);let i=e.toB58String(),n=this.data.get(i),s=new Set(r);return n&&((a,c)=>a.size===c.size&&[...a].every(u=>c.has(u)))(n,s)?(ta(`the protocols provided to store are equal to the already stored for ${i}`),this):(this._setData(e,s),ta(`stored provided protocols for ${i}`),this)}add(e,r){if(!hC.isPeerId(e))throw ta.error("peerId must be an instance of peer-id to store data"),z0(new Error("peerId must be an instance of peer-id"),H0);if(!r)throw ta.error("protocols must be provided to store data"),z0(new Error("protocols must be provided"),H0);let i=e.toB58String(),n=this.data.get(i)||new Set,s=new Set([...n,...r]);return n.size===s.size?(ta(`the protocols provided to store are already stored for ${i}`),this):(this._setData(e,s),ta(`added provided protocols for ${i}`),this)}remove(e,r){if(!hC.isPeerId(e))throw ta.error("peerId must be an instance of peer-id to store data"),z0(new Error("peerId must be an instance of peer-id"),H0);if(!r)throw ta.error("protocols must be provided to store data"),z0(new Error("protocols must be provided"),H0);let i=e.toB58String(),n=this.data.get(i);if(n){let s=new Set([...n].filter(o=>!r.includes(o)));if(n.size===s.size)return this;this._setData(e,s),ta(`removed provided protocols for ${i}`)}return this}};_me.exports=wme});var pC=y((E7t,Ame)=>{f();"use strict";var Tpt=ue(),{EventEmitter:Rpt}=yr(),Sme=rt(),Ppt=ome(),Cpt=pme(),Opt=mme(),kpt=Eme(),{codes:{ERR_INVALID_PARAMETERS:qpt}}=yi(),xme=class extends Rpt{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new Ppt(this),this.keyBook=new Cpt(this),this.metadataBook=new Opt(this),this.protoBook=new kpt(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let r=new Map;return e.forEach(i=>{r.set(i,this.get(Sme.createFromB58String(i)))}),r}delete(e){let r=this.addressBook.delete(e),i=this.keyBook.delete(e),n=this.protoBook.delete(e),s=this.metadataBook.delete(e);return r||i||n||s}get(e){if(!Sme.isPeerId(e))throw Tpt(new Error("peerId must be an instance of peer-id"),qpt);let r=this.keyBook.data.get(e.toB58String()),i=this.addressBook.get(e),n=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!r&&!i&&!n&&!s))return{id:r||e,addresses:i||[],protocols:s||[],metadata:n}}};Ame.exports=xme});var Tme=y((S7t,Ime)=>{f();"use strict";function Dpt(t,e,r){let i=new t(e,r);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}Ime.exports=Dpt});var Rme=y((x7t,$0)=>{f();"use strict";$0.exports.NAMESPACE_COMMON="/peers/";$0.exports.NAMESPACE_ADDRESS="/peers/addrs/";$0.exports.NAMESPACE_KEYS="/peers/keys/";$0.exports.NAMESPACE_METADATA="/peers/metadata/";$0.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var Cme=y((A7t,Pme)=>{f();"use strict";var Vl=ki(),G0=Vl.Reader,yC=Vl.Writer,Wr=Vl.util,Ii=Vl.roots["libp2p-address-book"]||(Vl.roots["libp2p-address-book"]={});Ii.Addresses=function(){function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.addrs=Wr.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,i){if(i||(i=yC.create()),r.addrs!=null&&r.addrs.length)for(var n=0;n<r.addrs.length;++n)Ii.Addresses.Address.encode(r.addrs[n],i.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&Ii.Addresses.CertifiedRecord.encode(r.certifiedRecord,i.uint32(18).fork()).ldelim(),i},t.decode=function(r,i){r instanceof G0||(r=G0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Ii.Addresses;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Ii.Addresses.Address.decode(r,r.uint32()));break;case 2:s.certifiedRecord=Ii.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Ii.Addresses)return r;var i=new Ii.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<r.addrs.length;++n){if(typeof r.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Ii.Addresses.Address.fromObject(r.addrs[n])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Ii.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),r.addrs&&r.addrs.length){n.addrs=[];for(var s=0;s<r.addrs.length;++s)n.addrs[s]=Ii.Addresses.Address.toObject(r.addrs[s],i)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Ii.Addresses.CertifiedRecord.toObject(r.certifiedRecord,i)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Vl.util.toJSONOptions)},t.Address=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=Wr.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(i,n){return n||(n=yC.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},e.decode=function(i,n){i instanceof G0||(i=G0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ii.Addresses.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ii.Addresses.Address)return i;var n=new Ii.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Wr.base64.decode(i.multiaddr,n.multiaddr=Wr.newBuffer(Wr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Wr.newBuffer(s.multiaddr))),s.isCertified=!1),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Wr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Vl.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.seq=Wr.Long?Wr.Long.fromBits(0,0,!0):0,e.prototype.raw=Wr.newBuffer([]),e.encode=function(i,n){return n||(n=yC.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof G0||(i=G0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ii.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ii.Addresses.CertifiedRecord)return i;var n=new Ii.Addresses.CertifiedRecord;return i.seq!=null&&(Wr.Long?(n.seq=Wr.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new Wr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?Wr.base64.decode(i.raw,n.raw=Wr.newBuffer(Wr.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(Wr.Long){var o=new Wr.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=Wr.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?Wr.Long.prototype.toString.call(i.seq):n.longs===Number?new Wr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?Wr.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Vl.util.toJSONOptions)},e}(),t}();Pme.exports=Ii});var qme=y((I7t,kme)=>{f();"use strict";var W0=ki(),Ome=W0.Reader,Npt=W0.Writer,Bpt=W0.util,J1=W0.roots["libp2p-proto-book"]||(W0.roots["libp2p-proto-book"]={});J1.Protocols=function(){function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocols=Bpt.emptyArray,t.encode=function(r,i){if(i||(i=Npt.create()),r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(10).string(r.protocols[n]);return i},t.decode=function(r,i){r instanceof Ome||(r=Ome.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new J1.Protocols;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof J1.Protocols)return r;var i=new J1.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,W0.util.toJSONOptions)},t}();kme.exports=J1});var Ume=y((T7t,Lme)=>{f();"use strict";var Dme=me(),$i=Object.assign(Dme("libp2p:persistent-peer-store"),{error:Dme("libp2p:persistent-peer-store:err")}),{Key:MS}=Ut(),{Multiaddr:Mpt}=it(),gC=rt(),{base32:Lpt}=(on(),sn),Upt=pC(),{NAMESPACE_ADDRESS:Fpt,NAMESPACE_COMMON:Kpt,NAMESPACE_KEYS:jpt,NAMESPACE_METADATA:Vpt,NAMESPACE_PROTOCOL:zpt}=Rme(),{Addresses:Nme}=Cme(),{Protocols:Bme}=qme(),Mme=class extends Upt{constructor({peerId:e,datastore:r,threshold:i=5}){super({peerId:e});this._datastore=r,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=i,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){$i("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:Kpt}))await this._processDatastoreEntry(e);$i("PeerStore started")}async stop(){$i("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),$i("PeerStore stopped")}_addDirtyPeer({peerId:e}){let r=e.toB58String();$i("add dirty peer",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{$i.error("error committing data",i)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let r=e.toB58String();$i("add dirty peer key",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{$i.error("error committing data",i)})}_addDirtyPeerMetadata({peerId:e,metadata:r}){let i=e.toB58String();$i("add dirty metadata peer",i),this._dirtyPeers.add(i);let n=this._dirtyMetadata.get(i)||new Set;n.add(r),this._dirtyMetadata.set(i,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{$i.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),$i("create batch commit");let r=this._datastore.batch();for(let i of e){let n=this.keyBook.data.get(i)||gC.createFromB58String(i);this._batchAddressBook(n,r),!n.hasInlinePublicKey()&&this._batchKeyBook(n,r),this._batchMetadataBook(n,r),this._batchProtoBook(n,r)}await r.commit(),$i("batch committed")}_batchAddressBook(e,r){let i=e.toString(),n=new MS(`${Fpt}${i}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){r.delete(n);return}let o=Nme.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();r.put(n,o)}catch(o){$i.error(o)}}_batchKeyBook(e,r){let i=e.toString(),n=new MS(`${jpt}${i}`);try{if(!e.pubKey){r.delete(n);return}let s=e.marshalPubKey();r.put(n,s)}catch(s){$i.error(s)}}_batchMetadataBook(e,r){let i=e.toString(),n=this._dirtyMetadata.get(e.toB58String())||[];try{n.forEach(s=>{let o=new MS(`${Vpt}${i}/${s}`),a=this.metadataBook.getValue(e,s);a?r.put(o,a):r.delete(o)})}catch(s){$i.error(s)}}_batchProtoBook(e,r){let i=e.toString(),n=new MS(`${zpt}${i}`),s=this.protoBook.get(e);try{if(!s){r.delete(n);return}let o=Bme.encode({protocols:s}).finish();r.put(n,o)}catch(o){$i.error(o)}}async _processDatastoreEntry({key:e,value:r}){try{let i=e.toString().split("/"),n=gC.createFromBytes(Lpt.decode(i[3])),s;switch(i[2]){case"addrs":s=Nme.decode(r),this.addressBook._setData(n,{addresses:s.addrs.map(o=>({multiaddr:new Mpt(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await gC.createFromPubKey(r),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,i[4],r,{emit:!1});break;case"protos":s=Bme.decode(r),this.protoBook._setData(n,new Set(s.protocols),{emit:!1});break;default:$i("invalid data persisted for: ",e.toString())}}catch(i){$i.error(i)}}};Lme.exports=Mme});var Vme=y((R7t,jme)=>{f();"use strict";var Fme=me(),Hpt=Object.assign(Fme("libp2p:registrar"),{error:Fme("libp2p:registrar:err")}),$pt=ue(),{codes:{ERR_INVALID_PARAMETERS:Gpt}}=yi(),Wpt=E8(),Kme=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!Wpt.isTopology(e))throw Hpt.error("topology must be an instance of interfaces/topology"),$pt(new Error("topology must be an instance of interfaces/topology"),Gpt);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),e.registrar=this,r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};jme.exports=Kme});var FS=y((P7t,em)=>{f();"use strict";var{Buffer:LS}=Vt(),US=gn();em.exports=async function*(t){for await(let e of t)LS.isBuffer(e)?yield e:US.isBufferList(e)?yield e.slice():yield LS.from(e)};em.exports.toBuffer=em.exports;em.exports.toList=async function*(t){for await(let e of t)LS.isBuffer(e)?yield new US().append(e):US.isBufferList(e)?yield e:yield new US().append(LS.from(e))}});var Hme=y((C7t,zme)=>{f();"use strict";zme.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var Yme=y((KS,Wme)=>{f();"use strict";var $me=me(),Ypt=Object.assign($me("libp2p:ping"),{error:$me("libp2p:ping:err")}),Xpt=ue(),Qpt=Na(),{pipe:Gme}=Ar(),{toBuffer:Zpt}=FS(),{collect:Jpt,take:e0t}=Op(),{equals:t0t}=(di(),fi),{PROTOCOL_NAME:bC,PING_LENGTH:r0t,PROTOCOL_VERSION:mC}=Hme();async function i0t(t,e){let r=`/${t._config.protocolPrefix}/${bC}/${mC}`;Ypt("dialing %s to %s",r,e.toB58String?e.toB58String():e);let i=await t.dial(e),{stream:n}=await i.newStream(r),s=Date.now(),o=Qpt.randomBytes(r0t),[a]=await Gme([o],n,u=>e0t(1,u),Zpt,Jpt),c=Date.now();if(!t0t(o,a))throw Xpt(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return c-s}function n0t(t){t.handle(`/${t._config.protocolPrefix}/${bC}/${mC}`,({stream:e})=>Gme(e,e))}function s0t(t){t.unhandle(`/${t._config.protocolPrefix}/${bC}/${mC}`)}KS=Wme.exports=i0t;KS.mount=n0t;KS.unmount=s0t});var Zme=y((O7t,Qme)=>{f();"use strict";var Y0=ki(),Xme=Y0.Reader,o0t=Y0.Writer,Sr=Y0.util,tm=Y0.roots["libp2p-identify"]||(Y0.roots["libp2p-identify"]={});tm.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=Sr.newBuffer([]),t.prototype.listenAddrs=Sr.emptyArray,t.prototype.observedAddr=Sr.newBuffer([]),t.prototype.protocols=Sr.emptyArray,t.prototype.signedPeerRecord=Sr.newBuffer([]),t.encode=function(r,i){if(i||(i=o0t.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var n=0;n<r.listenAddrs.length;++n)i.uint32(18).bytes(r.listenAddrs[n]);if(r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(26).string(r.protocols[n]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&i.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&i.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&i.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&i.uint32(66).bytes(r.signedPeerRecord),i},t.decode=function(r,i){r instanceof Xme||(r=Xme.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new tm.Identify;r.pos<n;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof tm.Identify)return r;var i=new tm.Identify;if(r.protocolVersion!=null&&(i.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(i.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?Sr.base64.decode(r.publicKey,i.publicKey=Sr.newBuffer(Sr.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<r.listenAddrs.length;++n)typeof r.listenAddrs[n]=="string"?Sr.base64.decode(r.listenAddrs[n],i.listenAddrs[n]=Sr.newBuffer(Sr.base64.length(r.listenAddrs[n])),0):r.listenAddrs[n].length&&(i.listenAddrs[n]=r.listenAddrs[n])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?Sr.base64.decode(r.observedAddr,i.observedAddr=Sr.newBuffer(Sr.base64.length(r.observedAddr)),0):r.observedAddr.length&&(i.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?Sr.base64.decode(r.signedPeerRecord,i.signedPeerRecord=Sr.newBuffer(Sr.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(i.signedPeerRecord=r.signedPeerRecord)),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Sr.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Sr.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Sr.newBuffer(n.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Sr.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Sr.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Sr.base64.encode(r.observedAddr,0,r.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(n.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(n.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Sr.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Y0.util.toJSONOptions)},t}();Qme.exports=tm});var ave=y((k7t,ove)=>{f();"use strict";var Jme=me(),oc=Object.assign(Jme("libp2p:identify"),{error:Jme("libp2p:identify:err")}),vC=ue(),jS=Wo(),{pipe:VS}=Ar(),{collect:eve,take:tve,consume:rve}=Op(),{fromString:X0}=(ft(),ht),a0t=rt(),{Multiaddr:wC}=it(),{toBuffer:ive}=FS(),rm=Zme(),nve=M1(),sve=vS(),{MULTICODEC_IDENTIFY:c0t,MULTICODEC_IDENTIFY_PUSH:u0t,IDENTIFY_PROTOCOL_VERSION:l0t,MULTICODEC_IDENTIFY_PROTOCOL_NAME:f0t,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:d0t,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:h0t,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:p0t}=xP(),{codes:_C}=yi(),Ld=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${f0t}/${h0t}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${d0t}/${p0t}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=Ld.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${l0t}`,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",X0(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",X0(this._host.protocolVersion)),this.connectionManager.on("peer:connect",i=>{this.identify(i).catch(oc.error)}),this.peerStore.on("change:multiaddrs",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await VS([rm.Identify.encode({listenAddrs:i,signedPeerRecord:r,protocols:n}).finish()],jS.encode(),a,rve)}catch(a){oc.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for(let i of this.peerStore.peers.values())i.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(i.id))&&e.push(r);this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[i]=await VS([],r,jS.decode(),tve(1),ive,eve);if(!i)throw vC(new Error("No data could be retrieved"),_C.ERR_CONNECTION_ENDED);let n;try{n=rm.Identify.decode(i)}catch(h){throw vC(h,_C.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=n,l=await a0t.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw vC(new Error("identified peer does not match the expected peer"),_C.ERR_INVALID_PEER);let d=Ld.getCleanMultiaddr(c);try{let h=await nve.openAndCertify(u,sve.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(h)){this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",X0(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",X0(n.protocolVersion));return}}catch(h){oc("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{this.peerStore.addressBook.set(l,o.map(h=>new wC(h)))}catch(h){oc.error("received invalid addrs",h)}this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",X0(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",X0(n.protocolVersion)),oc("received observed address of %s",d)}handleMessage({connection:e,stream:r,protocol:i}){switch(i){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:oc.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:r}){let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=rm.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await VS([o],jS.encode(),r,rve)}catch(a){oc.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:r}){let i;try{let[s]=await VS([],r,jS.decode(),tve(1),ive,eve);i=rm.Identify.decode(s)}catch(s){return oc.error("received invalid message",s)}let n=e.remotePeer;try{let s=await nve.openAndCertify(i.signedPeerRecord,sve.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){oc("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new wC(s)))}catch(s){oc.error("received invalid addrs",s)}this.peerStore.protoBook.set(n,i.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new wC(e)}catch(r){return null}return null}},y0t={IDENTIFY:c0t,IDENTIFY_PUSH:u0t};Ld.multicodecs=y0t;Ld.Messsage=rm;ove.exports=Ld});var cve=y(()=>{f()});var lve=y(EC=>{f();"use strict";Object.defineProperty(EC,"__esModule",{value:!0});EC.promisify=zS;var uve="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function zS(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[uve],r=zS.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(l){if(l)return c(l);for(var d=arguments.length,h=new Array(d>1?d-1:0),p=1;p<d;p++)h[p-1]=arguments[p];if(h.length===1||!e)return a(h[0]);var g={};h.forEach(function(m,E){var v=e[E];v&&(g[v]=m)}),a(g)}),t.apply(i,s)})}}zS.argumentNames=uve;zS.Promise=void 0});var dve=y((B7t,fve)=>{f();"use strict";var g0t=Dx(),HS=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,im=g0t(),b0t=HS&&!im,m0t=im&&!HS,v0t=im&&HS,w0t=typeof oa=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!im,_0t=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,E0t=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;fve.exports={isTest:E0t,isElectron:im,isElectronMain:m0t,isElectronRenderer:v0t,isNode:w0t,isBrowser:b0t,isWebWorker:_0t,isEnvWithDom:HS}});var pve=y((M7t,hve)=>{f();function ro(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}hve.exports=ro;ro.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};ro.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};ro.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},r),this._options.unref&&this._timer.unref(),!0};ro.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};ro.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};ro.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};ro.prototype.start=ro.prototype.try;ro.prototype.errors=function(){return this._errors};ro.prototype.attempts=function(){return this._attempts};ro.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=n,r=o)}return e}});var yve=y(Ud=>{f();var S0t=pve();Ud.operation=function(t){var e=Ud.timeouts(t);return new S0t(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};Ud.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return t&&t.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};Ud.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,i=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return i=Math.min(i,e.maxTimeout),i};Ud.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var i in t)typeof t[i]=="function"&&r.push(i)}for(var n=0;n<r.length;n++){var s=r[n],o=t[s];t[s]=function(c){var u=Ud.operation(e),l=Array.prototype.slice.call(arguments,1),d=l.pop();l.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),d.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,o),t[s].options=e}}});var bve=y((U7t,gve)=>{f();gve.exports=yve()});var vve=y((F7t,$S)=>{f();"use strict";var x0t=bve(),A0t=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],SC=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},I0t=(t,e,r)=>{let i=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=i,t},T0t=t=>A0t.includes(t),mve=(t,e)=>new Promise((r,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=x0t.operation(e);n.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof SC)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!T0t(o.message))n.stop(),i(o);else{I0t(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});$S.exports=mve;$S.exports.default=mve;$S.exports.AbortError=SC});var _ve=y((K7t,wve)=>{f();"use strict";function R0t(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}wve.exports=R0t});var Sve=y((j7t,Eve)=>{f();"use strict";var P0t=_ve();function C0t(t){let{address:e}=t.nodeAddress();return P0t(e)}Eve.exports=C0t});var Pve=y((V7t,Rve)=>{f();"use strict";var O0t=cve(),xve=me(),{promisify:xC}=lve(),{Multiaddr:k0t}=it(),Q0=Object.assign(xve("libp2p:nat"),{error:xve("libp2p:nat:err")}),{isBrowser:Ave}=dve(),AC=vve(),q0t=AP(),Ive=SP(),D0t=ue(),{codes:{ERR_INVALID_PARAMETERS:N0t}}=yi(),B0t=Sve(),IC=7200;function M0t(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var Tve=class{constructor({peerId:e,addressManager:r,transportManager:i,...n}){if(this._peerId=e,this._addressManager=r,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${Ive.name}@${Ive.version} ${this._peerId}`,ttl:n.ttl||IC,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<IC)throw D0t(new Error(`NatManager ttl should be at least ${IC} seconds`),N0t)}start(){Ave||!this._enabled||this._start().catch(e=>{Q0.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:i,host:n,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||B0t(r)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(q0t(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=M0t();Q0(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(k0t.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new O0t(this._options),r=xC(e.map.bind(e)),i=xC(e.destroy.bind(e)),n=xC(e.externalIp.bind(e));return this._client={map:(...s)=>AC(()=>r(...s),{onFailedAttempt:Q0.error,unref:!0}),destroy:(...s)=>AC(()=>i(...s),{onFailedAttempt:Q0.error,unref:!0}),externalIp:(...s)=>AC(()=>n(...s),{onFailedAttempt:Q0.error,unref:!0})},this._client}async stop(){if(!(Ave||!this._client))try{await this._client.destroy(),this._client=null}catch(e){Q0.error(e)}}};Rve.exports=Tve});var Nve=y((z7t,Dve)=>{f();"use strict";var Cve=me(),ms=Object.assign(Cve("libp2p"),{error:Cve("libp2p:err")}),{EventEmitter:L0t}=yr(),TC=ue(),U0t=rt(),{Multiaddr:F0t}=it(),K0t=U0e(),j0t=j0e(),RC=EP(),{validate:V0t}=Kye(),{codes:GS,messages:z0t}=yi(),H0t=zye(),$0t=oge(),Ove=Bge(),G0t=Yge(),W0t=_be(),kve=a1e(),Y0t=w1e(),X0t=qP(),Q0t=Z1e(),Z0t=pC(),J0t=Tme(),eyt=Ume(),tyt=Vme(),WS=Yme(),qve=ave(),ryt=Pve(),{updateSelfPeerRecord:iyt}=OP(),nm=class extends L0t{static async create(e){if(e.peerId)return new nm(e);let r=await U0t.create();return e.peerId=r,new nm(e)}constructor(e){super();if(this._options=V0t(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new eyt({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new Z0t({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new H0t(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{iyt(this).catch(i=>{ms.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new $0t(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new Y0t({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){ms("creating keychain");let i=kve.generateOptions();this.keychain=new kve(this._options.keychain.datastore,{...i,...this._options.keychain}),ms("keychain constructed")}if(this.upgrader=new Q0t({localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new X0t({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new ryt({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new tyt({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw TC(new Error(z0t.CONN_ENCRYPTION_REQUIRED),GS.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new W0t({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(Ove.prototype[Symbol.toStringTag],Ove),this.relay=new G0t(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new qve({libp2p:this}),this.handle(Object.values(qve.getProtocolStr(this)),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=new i({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=J0t(i,this,this._config.pubsub)}this.peerRouting=new K0t(this),this.contentRouting=new j0t(this),WS.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...r){return e==="error"&&!this._events.error?(ms.error(r),!1):super.emit(e,...r)}async start(){ms("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),ms("libp2p has started")}catch(e){throw this.emit("error",e),ms.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){ms("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),WS.unmount(this),this.dialer.destroy()}catch(e){e&&(ms.error(e),this.emit("error",e))}ms("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,i){if(!r||!r.length)throw TC(new Error("no protocols were provided to open a stream"),GS.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(r)}async _dial(e,r){let{id:i,multiaddrs:n}=RC(e);if(i.equals(this.peerId))throw TC(new Error("Cannot dial self"),GS.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let r=this._options.addresses.announceFilter,i=new Set(e);return r(Array.from(i).map(n=>new F0t(n)))}async hangUp(e){let{id:r}=RC(e),i=this.connectionManager.connections.get(r.toB58String());!i||await Promise.all(i.map(n=>n.close()))}ping(e){let{id:r,multiaddrs:i}=RC(e);return i?WS(this,i[0]):WS(this,r)}handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,r)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){ms.error(new Error(GS.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){ms("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){ms.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=r=>{let i={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(i={...i,...this._config.peerDiscovery[r.tag]}),i.enabled&&!this._discovery.has(r.tag)){let n;typeof r=="function"?n=new r(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=r,n.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,n)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};Dve.exports=nm});var Bve=y(()=>{f()});var Lve=y((G7t,Mve)=>{f();Mve.exports=typeof WebSocket=="undefined"?Bve():WebSocket});var Fve=y(YS=>{f();"use strict";Object.defineProperty(YS,"__esModule",{value:!0});var Uve=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let r={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(r)}else this.pushQueue.push(Promise.resolve(r)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let r of this.pullQueue)r.reject(e);this.pullQueue.length=0}else{let r=Promise.reject(e);r.catch(()=>{}),this.pushQueue.push(r)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let r=this.pushQueue.shift();return r?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),r):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},PC=class{constructor(e,{highWaterMark:r=100,lowWaterMark:i=1}={}){let n=new Uve;n.highWaterMark=r,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};YS.EventIterator=PC;YS.default=PC});var Kve=y(sm=>{f();"use strict";Object.defineProperty(sm,"__esModule",{value:!0});var CC=Fve();sm.EventIterator=CC.EventIterator;function nyt(t,e,r){return new CC.EventIterator(({push:i})=>(this.addEventListener(t,i,e),()=>this.removeEventListener(t,i,e)),r)}sm.subscribe=nyt;sm.default=CC.EventIterator});var Vve=y((X7t,jve)=>{f();var{Buffer:syt}=Vt(),{EventIterator:oyt}=Kve();function ayt(t){return t instanceof ArrayBuffer||t!=null&&t.constructor!=null&&t.constructor.name==="ArrayBuffer"&&typeof t.byteLength=="number"}jve.exports=t=>{let e=t.removeEventListener||t.removeListener,r=async function*(){let s=new oyt(({push:o,stop:a,fail:c})=>(t.addEventListener("message",o),t.addEventListener("error",c),t.addEventListener("close",a),()=>{e.call(t,"message",o),e.call(t,"error",c),e.call(t,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield ayt(o)?syt.from(o):o}(),i=t.readyState===1,n;return t.addEventListener("open",()=>{i=!0,n=null}),t.addEventListener("close",()=>{i=!1,n=null}),t.addEventListener("error",s=>{i||(n=s)}),r.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=l=>{e.call(t,"open",c),e.call(t,"error",u),l()},c=()=>a(s),u=l=>a(()=>o(l));t.addEventListener("open",c),t.addEventListener("error",u)}),r}});var Hve=y((Q7t,zve)=>{f();zve.exports=async t=>{if(t.readyState>=2)throw new Error("socket closed");if(t.readyState!==1)return new Promise((e,r)=>{let i=t&&(t.removeEventListener||t.removeListener);function n(){typeof i=="function"&&(i.call(t,"open",s),i.call(t,"error",o))}function s(){n(),e()}function o(a){n(),r(a)}t.addEventListener("open",s),t.addEventListener("error",o)})}});var Gve=y((Z7t,$ve)=>{f();var cyt=Hve();$ve.exports=(t,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async r=>{for await(let i of r){try{await cyt(t)}catch(n){if(n.message==="socket closed")break;throw n}t.send(i)}if(e.closeOnEnd&&t.readyState<=1)return new Promise((i,n)=>{t.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>t.close())})})});var Yve=y((J7t,Wve)=>{f();var uyt=Vve(),lyt=Gve();Wve.exports=(t,e)=>{e=e||{},e.binaryType?t.binaryType=e.binaryType:e.binary&&(t.binaryType="arraybuffer");let r={sink:lyt(t,e),source:uyt(t,e),connected:()=>r.source.connected()};return r}});var Qve=y((eLt,Xve)=>{f();var{relative:fyt}=cv(),dyt={http:"ws",https:"wss"},hyt="ws";Xve.exports=(t,e)=>fyt(t,e,dyt,hyt)});var Zve=y((tLt,XS)=>{f();"use strict";var pyt=Lve(),yyt=Yve(),gyt=Qve();XS.exports=function(t,e={}){let r=typeof window=="undefined"?{}:window.location,i=gyt(t,r),n=new pyt(i,e.websocket),s=yyt(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};XS.exports.connect=XS.exports});var ewe=y((rLt,Jve)=>{f();"use strict";Jve.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var OC=y(Fd=>{f();"use strict";Fd.CODE_P2P=421;Fd.CODE_CIRCUIT=290;Fd.CODE_TCP=6;Fd.CODE_WS=477;Fd.CODE_WSS=478;Fd.CLOSE_TIMEOUT=2e3});var kC=y(Z0=>{f();"use strict";Object.defineProperty(Z0,"__esModule",{value:!0});Z0.isCorrect=Z0.isInSubnet=void 0;function byt(t){return this.subnetMask<t.subnetMask?!1:this.mask(t.subnetMask)===t.mask()}Z0.isInSubnet=byt;function myt(t){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===t&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}Z0.isCorrect=myt});var qC=y(ac=>{f();"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.RE_SUBNET_STRING=ac.RE_ADDRESS=ac.GROUPS=ac.BITS=void 0;ac.BITS=32;ac.GROUPS=4;ac.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;ac.RE_SUBNET_STRING=/\/\d{1,2}$/});var QS=y(J0=>{f();"use strict";var vyt=J0&&J0.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(J0,"__esModule",{value:!0});J0.AddressError=void 0;var wyt=function(t){vyt(e,t);function e(r,i){var n=t.call(this,r)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);J0.AddressError=wyt});var DC=y((ZS,twe)=>{f();(function(){var t,e=244837814094590,r=(e&16777215)==15715070;function i(x,T,H){x!=null&&(typeof x=="number"?this.fromNumber(x,T,H):T==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,T))}function n(){return new i(null)}function s(x,T,H,ie,ye,Ee){for(;--Ee>=0;){var Be=T*this[x++]+H[ie]+ye;ye=Math.floor(Be/67108864),H[ie++]=Be&67108863}return ye}function o(x,T,H,ie,ye,Ee){for(var Be=T&32767,Ke=T>>15;--Ee>=0;){var hr=this[x]&32767,Pi=this[x++]>>15,Es=Ke*hr+Pi*Be;hr=Be*hr+((Es&32767)<<15)+H[ie]+(ye&1073741823),ye=(hr>>>30)+(Es>>>15)+Ke*Pi+(ye>>>30),H[ie++]=hr&1073741823}return ye}function a(x,T,H,ie,ye,Ee){for(var Be=T&16383,Ke=T>>14;--Ee>=0;){var hr=this[x]&16383,Pi=this[x++]>>14,Es=Ke*hr+Pi*Be;hr=Be*hr+((Es&16383)<<14)+H[ie]+ye,ye=(hr>>28)+(Es>>14)+Ke*Pi,H[ie++]=hr&268435455}return ye}var c=typeof navigator!="undefined";c&&r&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,t=30):c&&r&&navigator.appName!="Netscape"?(i.prototype.am=s,t=26):(i.prototype.am=a,t=28),i.prototype.DB=t,i.prototype.DM=(1<<t)-1,i.prototype.DV=1<<t;var u=52;i.prototype.FV=Math.pow(2,u),i.prototype.F1=u-t,i.prototype.F2=2*t-u;var l="0123456789abcdefghijklmnopqrstuvwxyz",d=new Array,h,p;for(h="0".charCodeAt(0),p=0;p<=9;++p)d[h++]=p;for(h="a".charCodeAt(0),p=10;p<36;++p)d[h++]=p;for(h="A".charCodeAt(0),p=10;p<36;++p)d[h++]=p;function g(x){return l.charAt(x)}function m(x,T){var H=d[x.charCodeAt(T)];return H??-1}function E(x){for(var T=this.t-1;T>=0;--T)x[T]=this[T];x.t=this.t,x.s=this.s}function v(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0}function A(x){var T=n();return T.fromInt(x),T}function R(x,T){var H;if(T==16)H=4;else if(T==8)H=3;else if(T==256)H=8;else if(T==2)H=1;else if(T==32)H=5;else if(T==4)H=2;else{this.fromRadix(x,T);return}this.t=0,this.s=0;for(var ie=x.length,ye=!1,Ee=0;--ie>=0;){var Be=H==8?x[ie]&255:m(x,ie);if(Be<0){x.charAt(ie)=="-"&&(ye=!0);continue}ye=!1,Ee==0?this[this.t++]=Be:Ee+H>this.DB?(this[this.t-1]|=(Be&(1<<this.DB-Ee)-1)<<Ee,this[this.t++]=Be>>this.DB-Ee):this[this.t-1]|=Be<<Ee,Ee+=H,Ee>=this.DB&&(Ee-=this.DB)}H==8&&(x[0]&128)!=0&&(this.s=-1,Ee>0&&(this[this.t-1]|=(1<<this.DB-Ee)-1<<Ee)),this.clamp(),ye&&i.ZERO.subTo(this,this)}function F(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t}function q(x){if(this.s<0)return"-"+this.negate().toString(x);var T;if(x==16)T=4;else if(x==8)T=3;else if(x==2)T=1;else if(x==32)T=5;else if(x==4)T=2;else return this.toRadix(x);var H=(1<<T)-1,ie,ye=!1,Ee="",Be=this.t,Ke=this.DB-Be*this.DB%T;if(Be-- >0)for(Ke<this.DB&&(ie=this[Be]>>Ke)>0&&(ye=!0,Ee=g(ie));Be>=0;)Ke<T?(ie=(this[Be]&(1<<Ke)-1)<<T-Ke,ie|=this[--Be]>>(Ke+=this.DB-T)):(ie=this[Be]>>(Ke-=T)&H,Ke<=0&&(Ke+=this.DB,--Be)),ie>0&&(ye=!0),ye&&(Ee+=g(ie));return ye?Ee:"0"}function D(){var x=n();return i.ZERO.subTo(this,x),x}function z(){return this.s<0?this.negate():this}function G(x){var T=this.s-x.s;if(T!=0)return T;var H=this.t;if(T=H-x.t,T!=0)return this.s<0?-T:T;for(;--H>=0;)if((T=this[H]-x[H])!=0)return T;return 0}function Y(x){var T=1,H;return(H=x>>>16)!=0&&(x=H,T+=16),(H=x>>8)!=0&&(x=H,T+=8),(H=x>>4)!=0&&(x=H,T+=4),(H=x>>2)!=0&&(x=H,T+=2),(H=x>>1)!=0&&(x=H,T+=1),T}function P(){return this.t<=0?0:this.DB*(this.t-1)+Y(this[this.t-1]^this.s&this.DM)}function b(x,T){var H;for(H=this.t-1;H>=0;--H)T[H+x]=this[H];for(H=x-1;H>=0;--H)T[H]=0;T.t=this.t+x,T.s=this.s}function w(x,T){for(var H=x;H<this.t;++H)T[H-x]=this[H];T.t=Math.max(this.t-x,0),T.s=this.s}function S(x,T){var H=x%this.DB,ie=this.DB-H,ye=(1<<ie)-1,Ee=Math.floor(x/this.DB),Be=this.s<<H&this.DM,Ke;for(Ke=this.t-1;Ke>=0;--Ke)T[Ke+Ee+1]=this[Ke]>>ie|Be,Be=(this[Ke]&ye)<<H;for(Ke=Ee-1;Ke>=0;--Ke)T[Ke]=0;T[Ee]=Be,T.t=this.t+Ee+1,T.s=this.s,T.clamp()}function C(x,T){T.s=this.s;var H=Math.floor(x/this.DB);if(H>=this.t){T.t=0;return}var ie=x%this.DB,ye=this.DB-ie,Ee=(1<<ie)-1;T[0]=this[H]>>ie;for(var Be=H+1;Be<this.t;++Be)T[Be-H-1]|=(this[Be]&Ee)<<ye,T[Be-H]=this[Be]>>ie;ie>0&&(T[this.t-H-1]|=(this.s&Ee)<<ye),T.t=this.t-H,T.clamp()}function B(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]-x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie-=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie-=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie-=x.s}T.s=ie<0?-1:0,ie<-1?T[H++]=this.DV+ie:ie>0&&(T[H++]=ie),T.t=H,T.clamp()}function W(x,T){var H=this.abs(),ie=x.abs(),ye=H.t;for(T.t=ye+ie.t;--ye>=0;)T[ye]=0;for(ye=0;ye<ie.t;++ye)T[ye+H.t]=H.am(0,ie[ye],T,ye,0,H.t);T.s=0,T.clamp(),this.s!=x.s&&i.ZERO.subTo(T,T)}function j(x){for(var T=this.abs(),H=x.t=2*T.t;--H>=0;)x[H]=0;for(H=0;H<T.t-1;++H){var ie=T.am(H,T[H],x,2*H,0,1);(x[H+T.t]+=T.am(H+1,2*T[H],x,2*H+1,ie,T.t-H-1))>=T.DV&&(x[H+T.t]-=T.DV,x[H+T.t+1]=1)}x.t>0&&(x[x.t-1]+=T.am(H,T[H],x,2*H,0,1)),x.s=0,x.clamp()}function M(x,T,H){var ie=x.abs();if(!(ie.t<=0)){var ye=this.abs();if(ye.t<ie.t){T!=null&&T.fromInt(0),H!=null&&this.copyTo(H);return}H==null&&(H=n());var Ee=n(),Be=this.s,Ke=x.s,hr=this.DB-Y(ie[ie.t-1]);hr>0?(ie.lShiftTo(hr,Ee),ye.lShiftTo(hr,H)):(ie.copyTo(Ee),ye.copyTo(H));var Pi=Ee.t,Es=Ee[Pi-1];if(Es!=0){var is=Es*(1<<this.F1)+(Pi>1?Ee[Pi-2]>>this.F2:0),mc=this.FV/is,Qm=(1<<this.F1)/is,ho=1<<this.F2,po=H.t,Zm=po-Pi,Au=T??n();for(Ee.dlShiftTo(Zm,Au),H.compareTo(Au)>=0&&(H[H.t++]=1,H.subTo(Au,H)),i.ONE.dlShiftTo(Pi,Au),Au.subTo(Ee,Ee);Ee.t<Pi;)Ee[Ee.t++]=0;for(;--Zm>=0;){var vx=H[--po]==Es?this.DM:Math.floor(H[po]*mc+(H[po-1]+ho)*Qm);if((H[po]+=Ee.am(0,vx,H,Zm,0,Pi))<vx)for(Ee.dlShiftTo(Zm,Au),H.subTo(Au,H);H[po]<--vx;)H.subTo(Au,H)}T!=null&&(H.drShiftTo(Pi,T),Be!=Ke&&i.ZERO.subTo(T,T)),H.t=Pi,H.clamp(),hr>0&&H.rShiftTo(hr,H),Be<0&&i.ZERO.subTo(H,H)}}}function _(x){var T=n();return this.abs().divRemTo(x,null,T),this.s<0&&T.compareTo(i.ZERO)>0&&x.subTo(T,T),T}function L(x){this.m=x}function ae(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}function X(x){return x}function ne(x){x.divRemTo(this.m,null,x)}function oe(x,T,H){x.multiplyTo(T,H),this.reduce(H)}function he(x,T){x.squareTo(T),this.reduce(T)}L.prototype.convert=ae,L.prototype.revert=X,L.prototype.reduce=ne,L.prototype.mulTo=oe,L.prototype.sqrTo=he;function pe(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var T=x&3;return T=T*(2-(x&15)*T)&15,T=T*(2-(x&255)*T)&255,T=T*(2-((x&65535)*T&65535))&65535,T=T*(2-x*T%this.DV)%this.DV,T>0?this.DV-T:-T}function _e(x){this.m=x,this.mp=x.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}function k(x){var T=n();return x.abs().dlShiftTo(this.m.t,T),T.divRemTo(this.m,null,T),x.s<0&&T.compareTo(i.ZERO)>0&&this.m.subTo(T,T),T}function K(x){var T=n();return x.copyTo(T),this.reduce(T),T}function $(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var T=0;T<this.m.t;++T){var H=x[T]&32767,ie=H*this.mpl+((H*this.mph+(x[T]>>15)*this.mpl&this.um)<<15)&x.DM;for(H=T+this.m.t,x[H]+=this.m.am(0,ie,x,T,0,this.m.t);x[H]>=x.DV;)x[H]-=x.DV,x[++H]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}function Z(x,T){x.squareTo(T),this.reduce(T)}function I(x,T,H){x.multiplyTo(T,H),this.reduce(H)}_e.prototype.convert=k,_e.prototype.revert=K,_e.prototype.reduce=$,_e.prototype.mulTo=I,_e.prototype.sqrTo=Z;function U(){return(this.t>0?this[0]&1:this.s)==0}function V(x,T){if(x>4294967295||x<1)return i.ONE;var H=n(),ie=n(),ye=T.convert(this),Ee=Y(x)-1;for(ye.copyTo(H);--Ee>=0;)if(T.sqrTo(H,ie),(x&1<<Ee)>0)T.mulTo(ie,ye,H);else{var Be=H;H=ie,ie=Be}return T.revert(H)}function N(x,T){var H;return x<256||T.isEven()?H=new L(T):H=new _e(T),this.exp(x,H)}i.prototype.copyTo=E,i.prototype.fromInt=v,i.prototype.fromString=R,i.prototype.clamp=F,i.prototype.dlShiftTo=b,i.prototype.drShiftTo=w,i.prototype.lShiftTo=S,i.prototype.rShiftTo=C,i.prototype.subTo=B,i.prototype.multiplyTo=W,i.prototype.squareTo=j,i.prototype.divRemTo=M,i.prototype.invDigit=pe,i.prototype.isEven=U,i.prototype.exp=V,i.prototype.toString=q,i.prototype.negate=D,i.prototype.abs=z,i.prototype.compareTo=G,i.prototype.bitLength=P,i.prototype.mod=_,i.prototype.modPowInt=N,i.ZERO=A(0),i.ONE=A(1);function Q(){var x=n();return this.copyTo(x),x}function ee(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function J(){return this.t==0?this.s:this[0]<<24>>24}function ce(){return this.t==0?this.s:this[0]<<16>>16}function ge(x){return Math.floor(Math.LN2*this.DB/Math.log(x))}function be(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function je(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var T=this.chunkSize(x),H=Math.pow(x,T),ie=A(H),ye=n(),Ee=n(),Be="";for(this.divRemTo(ie,ye,Ee);ye.signum()>0;)Be=(H+Ee.intValue()).toString(x).substr(1)+Be,ye.divRemTo(ie,ye,Ee);return Ee.intValue().toString(x)+Be}function Re(x,T){this.fromInt(0),T==null&&(T=10);for(var H=this.chunkSize(T),ie=Math.pow(T,H),ye=!1,Ee=0,Be=0,Ke=0;Ke<x.length;++Ke){var hr=m(x,Ke);if(hr<0){x.charAt(Ke)=="-"&&this.signum()==0&&(ye=!0);continue}Be=T*Be+hr,++Ee>=H&&(this.dMultiply(ie),this.dAddOffset(Be,0),Ee=0,Be=0)}Ee>0&&(this.dMultiply(Math.pow(T,Ee)),this.dAddOffset(Be,0)),ye&&i.ZERO.subTo(this,this)}function Ve(x,T,H){if(typeof T=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,H),this.testBit(x-1)||this.bitwiseTo(i.ONE.shiftLeft(x-1),zt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(T);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(i.ONE.shiftLeft(x-1),this);else{var ie=new Array,ye=x&7;ie.length=(x>>3)+1,T.nextBytes(ie),ye>0?ie[0]&=(1<<ye)-1:ie[0]=0,this.fromString(ie,256)}}function Je(){var x=this.t,T=new Array;T[0]=this.s;var H=this.DB-x*this.DB%8,ie,ye=0;if(x-- >0)for(H<this.DB&&(ie=this[x]>>H)!=(this.s&this.DM)>>H&&(T[ye++]=ie|this.s<<this.DB-H);x>=0;)H<8?(ie=(this[x]&(1<<H)-1)<<8-H,ie|=this[--x]>>(H+=this.DB-8)):(ie=this[x]>>(H-=8)&255,H<=0&&(H+=this.DB,--x)),(ie&128)!=0&&(ie|=-256),ye==0&&(this.s&128)!=(ie&128)&&++ye,(ye>0||ie!=this.s)&&(T[ye++]=ie);return T}function He(x){return this.compareTo(x)==0}function ze(x){return this.compareTo(x)<0?this:x}function gt(x){return this.compareTo(x)>0?this:x}function Yt(x,T,H){var ie,ye,Ee=Math.min(x.t,this.t);for(ie=0;ie<Ee;++ie)H[ie]=T(this[ie],x[ie]);if(x.t<this.t){for(ye=x.s&this.DM,ie=Ee;ie<this.t;++ie)H[ie]=T(this[ie],ye);H.t=this.t}else{for(ye=this.s&this.DM,ie=Ee;ie<x.t;++ie)H[ie]=T(ye,x[ie]);H.t=x.t}H.s=T(this.s,x.s),H.clamp()}function ir(x,T){return x&T}function En(x){var T=n();return this.bitwiseTo(x,ir,T),T}function zt(x,T){return x|T}function At(x){var T=n();return this.bitwiseTo(x,zt,T),T}function Qr(x,T){return x^T}function nt(x){var T=n();return this.bitwiseTo(x,Qr,T),T}function xr(x,T){return x&~T}function jm(x){var T=n();return this.bitwiseTo(x,xr,T),T}function Ir(){for(var x=n(),T=0;T<this.t;++T)x[T]=this.DM&~this[T];return x.t=this.t,x.s=~this.s,x}function Tr(x){var T=n();return x<0?this.rShiftTo(-x,T):this.lShiftTo(x,T),T}function Vm(x){var T=n();return x<0?this.lShiftTo(-x,T):this.rShiftTo(x,T),T}function Rr(x){if(x==0)return-1;var T=0;return(x&65535)==0&&(x>>=16,T+=16),(x&255)==0&&(x>>=8,T+=8),(x&15)==0&&(x>>=4,T+=4),(x&3)==0&&(x>>=2,T+=2),(x&1)==0&&++T,T}function Pr(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+Rr(this[x]);return this.s<0?this.t*this.DB:-1}function zm(x){for(var T=0;x!=0;)x&=x-1,++T;return T}function Cr(){for(var x=0,T=this.s&this.DM,H=0;H<this.t;++H)x+=zm(this[H]^T);return x}function Or(x){var T=Math.floor(x/this.DB);return T>=this.t?this.s!=0:(this[T]&1<<x%this.DB)!=0}function Hm(x,T){var H=i.ONE.shiftLeft(x);return this.bitwiseTo(H,T,H),H}function kr(x){return this.changeBit(x,zt)}function qr(x){return this.changeBit(x,xr)}function $m(x){return this.changeBit(x,Qr)}function Dr(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]+x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie+=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie+=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=x.s}T.s=ie<0?-1:0,ie>0?T[H++]=ie:ie<-1&&(T[H++]=this.DV+ie),T.t=H,T.clamp()}function Nr(x){var T=n();return this.addTo(x,T),T}function Gm(x){var T=n();return this.subTo(x,T),T}function Br(x){var T=n();return this.multiplyTo(x,T),T}function Mr(){var x=n();return this.squareTo(x),x}function Wm(x){var T=n();return this.divRemTo(x,T,null),T}function Lr(x){var T=n();return this.divRemTo(x,null,T),T}function Ur(x){var T=n(),H=n();return this.divRemTo(x,T,H),new Array(T,H)}function Ym(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()}function Fr(x,T){if(x!=0){for(;this.t<=T;)this[this.t++]=0;for(this[T]+=x;this[T]>=this.DV;)this[T]-=this.DV,++T>=this.t&&(this[this.t++]=0),++this[T]}}function nr(){}function Xd(x){return x}function Iy(x,T,H){x.multiplyTo(T,H)}function Ty(x,T){x.squareTo(T)}nr.prototype.convert=Xd,nr.prototype.revert=Xd,nr.prototype.mulTo=Iy,nr.prototype.sqrTo=Ty;function Ry(x){return this.exp(x,new nr)}function Py(x,T,H){var ie=Math.min(this.t+x.t,T);for(H.s=0,H.t=ie;ie>0;)H[--ie]=0;var ye;for(ye=H.t-this.t;ie<ye;++ie)H[ie+this.t]=this.am(0,x[ie],H,ie,0,this.t);for(ye=Math.min(x.t,T);ie<ye;++ie)this.am(0,x[ie],H,ie,0,T-ie);H.clamp()}function Cy(x,T,H){--T;var ie=H.t=this.t+x.t-T;for(H.s=0;--ie>=0;)H[ie]=0;for(ie=Math.max(T-this.t,0);ie<x.t;++ie)H[this.t+ie-T]=this.am(T-ie,x[ie],H,0,0,this.t+ie-T);H.clamp(),H.drShiftTo(1,H)}function lo(x){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}function Oy(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var T=n();return x.copyTo(T),this.reduce(T),T}function ky(x){return x}function qy(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}function Dy(x,T){x.squareTo(T),this.reduce(T)}function Ny(x,T,H){x.multiplyTo(T,H),this.reduce(H)}lo.prototype.convert=Oy,lo.prototype.revert=ky,lo.prototype.reduce=qy,lo.prototype.mulTo=Ny,lo.prototype.sqrTo=Dy;function By(x,T){var H=x.bitLength(),ie,ye=A(1),Ee;if(H<=0)return ye;H<18?ie=1:H<48?ie=3:H<144?ie=4:H<768?ie=5:ie=6,H<8?Ee=new L(T):T.isEven()?Ee=new lo(T):Ee=new _e(T);var Be=new Array,Ke=3,hr=ie-1,Pi=(1<<ie)-1;if(Be[1]=Ee.convert(this),ie>1){var Es=n();for(Ee.sqrTo(Be[1],Es);Ke<=Pi;)Be[Ke]=n(),Ee.mulTo(Es,Be[Ke-2],Be[Ke]),Ke+=2}var is=x.t-1,mc,Qm=!0,ho=n(),po;for(H=Y(x[is])-1;is>=0;){for(H>=hr?mc=x[is]>>H-hr&Pi:(mc=(x[is]&(1<<H+1)-1)<<hr-H,is>0&&(mc|=x[is-1]>>this.DB+H-hr)),Ke=ie;(mc&1)==0;)mc>>=1,--Ke;if((H-=Ke)<0&&(H+=this.DB,--is),Qm)Be[mc].copyTo(ye),Qm=!1;else{for(;Ke>1;)Ee.sqrTo(ye,ho),Ee.sqrTo(ho,ye),Ke-=2;Ke>0?Ee.sqrTo(ye,ho):(po=ye,ye=ho,ho=po),Ee.mulTo(ho,Be[mc],ye)}for(;is>=0&&(x[is]&1<<H)==0;)Ee.sqrTo(ye,ho),po=ye,ye=ho,ho=po,--H<0&&(H=this.DB-1,--is)}return Ee.revert(ye)}function My(x){var T=this.s<0?this.negate():this.clone(),H=x.s<0?x.negate():x.clone();if(T.compareTo(H)<0){var ie=T;T=H,H=ie}var ye=T.getLowestSetBit(),Ee=H.getLowestSetBit();if(Ee<0)return T;for(ye<Ee&&(Ee=ye),Ee>0&&(T.rShiftTo(Ee,T),H.rShiftTo(Ee,H));T.signum()>0;)(ye=T.getLowestSetBit())>0&&T.rShiftTo(ye,T),(ye=H.getLowestSetBit())>0&&H.rShiftTo(ye,H),T.compareTo(H)>=0?(T.subTo(H,T),T.rShiftTo(1,T)):(H.subTo(T,H),H.rShiftTo(1,H));return Ee>0&&H.lShiftTo(Ee,H),H}function Ly(x){if(x<=0)return 0;var T=this.DV%x,H=this.s<0?x-1:0;if(this.t>0)if(T==0)H=this[0]%x;else for(var ie=this.t-1;ie>=0;--ie)H=(T*H+this[ie])%x;return H}function Uy(x){var T=x.isEven();if(this.isEven()&&T||x.signum()==0)return i.ZERO;for(var H=x.clone(),ie=this.clone(),ye=A(1),Ee=A(0),Be=A(0),Ke=A(1);H.signum()!=0;){for(;H.isEven();)H.rShiftTo(1,H),T?((!ye.isEven()||!Ee.isEven())&&(ye.addTo(this,ye),Ee.subTo(x,Ee)),ye.rShiftTo(1,ye)):Ee.isEven()||Ee.subTo(x,Ee),Ee.rShiftTo(1,Ee);for(;ie.isEven();)ie.rShiftTo(1,ie),T?((!Be.isEven()||!Ke.isEven())&&(Be.addTo(this,Be),Ke.subTo(x,Ke)),Be.rShiftTo(1,Be)):Ke.isEven()||Ke.subTo(x,Ke),Ke.rShiftTo(1,Ke);H.compareTo(ie)>=0?(H.subTo(ie,H),T&&ye.subTo(Be,ye),Ee.subTo(Ke,Ee)):(ie.subTo(H,ie),T&&Be.subTo(ye,Be),Ke.subTo(Ee,Ke))}if(ie.compareTo(i.ONE)!=0)return i.ZERO;if(Ke.compareTo(x)>=0)return Ke.subtract(x);if(Ke.signum()<0)Ke.addTo(x,Ke);else return Ke;return Ke.signum()<0?Ke.add(x):Ke}var mi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Fy=(1<<26)/mi[mi.length-1];function Ky(x){var T,H=this.abs();if(H.t==1&&H[0]<=mi[mi.length-1]){for(T=0;T<mi.length;++T)if(H[0]==mi[T])return!0;return!1}if(H.isEven())return!1;for(T=1;T<mi.length;){for(var ie=mi[T],ye=T+1;ye<mi.length&&ie<Fy;)ie*=mi[ye++];for(ie=H.modInt(ie);T<ye;)if(ie%mi[T++]==0)return!1}return H.millerRabin(x)}function _Ae(x){var T=this.subtract(i.ONE),H=T.getLowestSetBit();if(H<=0)return!1;var ie=T.shiftRight(H);x=x+1>>1,x>mi.length&&(x=mi.length);for(var ye=n(),Ee=0;Ee<x;++Ee){ye.fromInt(mi[Math.floor(Math.random()*mi.length)]);var Be=ye.modPow(ie,this);if(Be.compareTo(i.ONE)!=0&&Be.compareTo(T)!=0){for(var Ke=1;Ke++<H&&Be.compareTo(T)!=0;)if(Be=Be.modPowInt(2,this),Be.compareTo(i.ONE)==0)return!1;if(Be.compareTo(T)!=0)return!1}}return!0}i.prototype.chunkSize=ge,i.prototype.toRadix=je,i.prototype.fromRadix=Re,i.prototype.fromNumber=Ve,i.prototype.bitwiseTo=Yt,i.prototype.changeBit=Hm,i.prototype.addTo=Dr,i.prototype.dMultiply=Ym,i.prototype.dAddOffset=Fr,i.prototype.multiplyLowerTo=Py,i.prototype.multiplyUpperTo=Cy,i.prototype.modInt=Ly,i.prototype.millerRabin=_Ae,i.prototype.clone=Q,i.prototype.intValue=ee,i.prototype.byteValue=J,i.prototype.shortValue=ce,i.prototype.signum=be,i.prototype.toByteArray=Je,i.prototype.equals=He,i.prototype.min=ze,i.prototype.max=gt,i.prototype.and=En,i.prototype.or=At,i.prototype.xor=nt,i.prototype.andNot=jm,i.prototype.not=Ir,i.prototype.shiftLeft=Tr,i.prototype.shiftRight=Vm,i.prototype.getLowestSetBit=Pr,i.prototype.bitCount=Cr,i.prototype.testBit=Or,i.prototype.setBit=kr,i.prototype.clearBit=qr,i.prototype.flipBit=$m,i.prototype.add=Nr,i.prototype.subtract=Gm,i.prototype.multiply=Br,i.prototype.divide=Wm,i.prototype.remainder=Lr,i.prototype.divideAndRemainder=Ur,i.prototype.modPow=By,i.prototype.modInverse=Uy,i.prototype.pow=Ry,i.prototype.gcd=My,i.prototype.isProbablePrime=Ky,i.prototype.square=Mr,i.prototype.Barrett=lo;var Xm,rs,Ri;function EAe(x){rs[Ri++]^=x&255,rs[Ri++]^=x>>8&255,rs[Ri++]^=x>>16&255,rs[Ri++]^=x>>24&255,Ri>=mx&&(Ri-=mx)}function Vk(){EAe(new Date().getTime())}if(rs==null){rs=new Array,Ri=0;var fo;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var zk=new Uint8Array(32);for(window.crypto.getRandomValues(zk),fo=0;fo<32;++fo)rs[Ri++]=zk[fo]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Hk=window.crypto.random(32);for(fo=0;fo<Hk.length;++fo)rs[Ri++]=Hk.charCodeAt(fo)&255}}for(;Ri<mx;)fo=Math.floor(65536*Math.random()),rs[Ri++]=fo>>>8,rs[Ri++]=fo&255;Ri=0,Vk()}function SAe(){if(Xm==null){for(Vk(),Xm=TAe(),Xm.init(rs),Ri=0;Ri<rs.length;++Ri)rs[Ri]=0;Ri=0}return Xm.next()}function xAe(x){var T;for(T=0;T<x.length;++T)x[T]=SAe()}function gx(){}gx.prototype.nextBytes=xAe;function bx(){this.i=0,this.j=0,this.S=new Array}function AAe(x){var T,H,ie;for(T=0;T<256;++T)this.S[T]=T;for(H=0,T=0;T<256;++T)H=H+this.S[T]+x[T%x.length]&255,ie=this.S[T],this.S[T]=this.S[H],this.S[H]=ie;this.i=0,this.j=0}function IAe(){var x;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,x=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=x,this.S[x+this.S[this.i]&255]}bx.prototype.init=AAe,bx.prototype.next=IAe;function TAe(){return new bx}var mx=256;typeof ZS!="undefined"?ZS=twe.exports={default:i,BigInteger:i,SecureRandom:gx}:this.jsbn={BigInteger:i,SecureRandom:gx}}).call(ZS)});var om=y(JS=>{f();(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function r(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,u=o.length,l,d="",h,p,g,m,E,v,A,R;for(h=0;h<u;h++)if(typeof o[h]=="string")d+=o[h];else if(typeof o[h]=="object"){if(g=o[h],g.keys)for(l=a[c],p=0;p<g.keys.length;p++){if(l==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[p],g.keys[p-1]));l=l[g.keys[p]]}else g.param_no?l=a[g.param_no]:l=a[c++];if(t.not_type.test(g.type)&&t.not_primitive.test(g.type)&&l instanceof Function&&(l=l()),t.numeric_arg.test(g.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(e("[sprintf] expecting number but found %T",l));switch(t.number.test(g.type)&&(A=l>=0),g.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,g.width?parseInt(g.width):0);break;case"e":l=g.precision?parseFloat(l).toExponential(g.precision):parseFloat(l).toExponential();break;case"f":l=g.precision?parseFloat(l).toFixed(g.precision):parseFloat(l);break;case"g":l=g.precision?String(Number(l.toPrecision(g.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=g.precision?l.substring(0,g.precision):l;break;case"t":l=String(!!l),l=g.precision?l.substring(0,g.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=g.precision?l.substring(0,g.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=g.precision?l.substring(0,g.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase();break}t.json.test(g.type)?d+=l:(t.number.test(g.type)&&(!A||g.sign)?(R=A?"+":"-",l=l.toString().replace(t.sign,"")):R="",E=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",v=g.width-(R+l).length,m=g.width&&v>0?E.repeat(v):"",d+=g.align?R+l+m:E==="0"?R+m+l:m+R+l)}return d}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,u=[],l=0;a;){if((c=t.text.exec(a))!==null)u.push(c[0]);else if((c=t.modulo.exec(a))!==null)u.push("%");else if((c=t.placeholder.exec(a))!==null){if(c[2]){l|=1;var d=[],h=c[2],p=[];if((p=t.key.exec(h))!==null)for(d.push(p[1]);(h=h.substring(p[0].length))!=="";)if((p=t.key_access.exec(h))!==null)d.push(p[1]);else if((p=t.index_access.exec(h))!==null)d.push(p[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=d}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=u}typeof JS!="undefined"&&(JS.sprintf=e,JS.vsprintf=r),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=r,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:r}}))})()});var NC=y(cc=>{f();"use strict";var _yt=cc&&cc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Eyt=cc&&cc.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rwe=cc&&cc.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_yt(e,t,r);return Eyt(e,t),e};Object.defineProperty(cc,"__esModule",{value:!0});cc.Address4=void 0;var iwe=rwe(kC()),ra=rwe(qC()),nwe=QS(),am=DC(),ey=om(),Syt=function(){function t(e){this.groups=ra.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=iwe.isCorrect(ra.BITS),this.isInSubnet=iwe.isInSubnet,this.address=e;var r=ra.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>ra.BITS)throw new nwe.AddressError("Invalid subnet mask.");e=e.replace(ra.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return t.isValid=function(e){try{return new t(e),!0}catch(r){return!1}},t.prototype.parse=function(e){var r=e.split(".");if(!e.match(ra.RE_ADDRESS))throw new nwe.AddressError("Invalid IPv4 address.");return r},t.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},t.fromHex=function(e){var r=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=r.slice(n,n+2);i.push(parseInt(s,16))}return new t(i.join("."))},t.fromInteger=function(e){return t.fromHex(e.toString(16))},t.fromArpa=function(e){var r=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=r.split(".").reverse().join(".");return new t(i)},t.prototype.toHex=function(){return this.parsedAddress.map(function(e){return ey.sprintf("%02x",parseInt(e,10))}).join(":")},t.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},t.prototype.toGroup6=function(){var e=[],r;for(r=0;r<ra.GROUPS;r+=2){var i=ey.sprintf("%02x%02x",parseInt(this.parsedAddress[r],10),parseInt(this.parsedAddress[r+1],10));e.push(ey.sprintf("%x",parseInt(i,16)))}return e.join(":")},t.prototype.bigInteger=function(){return new am.BigInteger(this.parsedAddress.map(function(e){return ey.sprintf("%02x",parseInt(e,10))}).join(""),16)},t.prototype._startAddress=function(){return new am.BigInteger(this.mask()+"0".repeat(ra.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new am.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new am.BigInteger(this.mask()+"1".repeat(ra.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new am.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.fromBigInteger=function(e){return t.fromInteger(parseInt(e.toString(),10))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.reverseForm=function(e){e||(e={});var r=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?r:ey.sprintf("%s.in-addr.arpa.",r)},t.prototype.isMulticast=function(){return this.isInSubnet(new t("224.0.0.0/4"))},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(ra.BITS,"0")},t.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(ra.RE_ADDRESS,ey.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},t}();cc.Address4=Syt});var BC=y(Yr=>{f();"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.RE_URL_WITH_PORT=Yr.RE_URL=Yr.RE_ZONE_STRING=Yr.RE_SUBNET_STRING=Yr.RE_BAD_ADDRESS=Yr.RE_BAD_CHARACTERS=Yr.TYPES=Yr.SCOPES=Yr.GROUPS=Yr.BITS=void 0;Yr.BITS=128;Yr.GROUPS=8;Yr.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};Yr.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};Yr.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;Yr.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;Yr.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;Yr.RE_ZONE_STRING=/%.*$/;Yr.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);Yr.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var MC=y(uc=>{f();"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.simpleGroup=uc.spanLeadingZeroes=uc.spanAll=uc.spanAllZeroes=void 0;var swe=om();function owe(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}uc.spanAllZeroes=owe;function xyt(t,e){e===void 0&&(e=0);var r=t.split("");return r.map(function(i,n){return swe.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,owe(i))}).join("")}uc.spanAll=xyt;function awe(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}function Ayt(t){var e=t.split(":");return e.map(function(r){return awe(r)}).join(":")}uc.spanLeadingZeroes=Ayt;function Iyt(t,e){e===void 0&&(e=0);var r=t.split(":");return r.map(function(i,n){return/group-v4/.test(i)?i:swe.sprintf('<span class="hover-group group-%d">%s</span>',n+e,awe(i))})}uc.simpleGroup=Iyt});var cwe=y(Gi=>{f();"use strict";var Tyt=Gi&&Gi.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Ryt=Gi&&Gi.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pyt=Gi&&Gi.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Tyt(e,t,r);return Ryt(e,t),e};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.possibleElisions=Gi.simpleRegularExpression=Gi.ADDRESS_BOUNDARY=Gi.padGroup=Gi.groupPossibilities=void 0;var Cyt=Pyt(BC()),ty=om();function e3(t){return ty.sprintf("(%s)",t.join("|"))}Gi.groupPossibilities=e3;function t3(t){return t.length<4?ty.sprintf("0{0,%d}%s",4-t.length,t):t}Gi.padGroup=t3;Gi.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function Oyt(t){var e=[];t.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var r=e.map(function(i){return t.map(function(n,s){if(s===i){var o=s===0||s===Cyt.GROUPS-1?":":"";return e3([t3(n),o])}return t3(n)}).join(":")});return r.push(t.map(t3).join(":")),e3(r)}Gi.simpleRegularExpression=Oyt;function kyt(t,e,r){var i=e?"":":",n=r?"":":",s=[];!e&&!r&&s.push("::"),e&&r&&s.push(""),(r&&!e||!r&&e)&&s.push(":"),s.push(ty.sprintf("%s(:0{1,4}){1,%d}",i,t-1)),s.push(ty.sprintf("(0{1,4}:){1,%d}%s",t-1,n)),s.push(ty.sprintf("(0{1,4}:){%d}0{1,4}",t-1));for(var o=1;o<t-1;o++)for(var a=1;a<t-o;a++)s.push(ty.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,t-a-o-1));return e3(s)}Gi.possibleElisions=kyt});var hwe=y(io=>{f();"use strict";var qyt=io&&io.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Dyt=io&&io.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r3=io&&io.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qyt(e,t,r);return Dyt(e,t),e},uwe=io&&io.__spreadArray||function(t,e){for(var r=0,i=e.length,n=t.length;r<i;r++,n++)t[n]=e[r];return t};Object.defineProperty(io,"__esModule",{value:!0});io.Address6=void 0;var lwe=r3(kC()),LC=r3(qC()),fr=r3(BC()),UC=r3(MC()),Kd=NC(),jd=cwe(),yu=QS(),Dn=DC(),Nn=om();function i3(t){if(!t)throw new Error("Assertion failed.")}function Nyt(t){for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}function Byt(t){return t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),t=t.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),t}function Myt(t,e){var r=[],i=[],n;for(n=0;n<t.length;n++)n<e[0]?r.push(t[n]):n>e[1]&&i.push(t[n]);return r.concat(["compact"]).concat(i)}function fwe(t){return Nn.sprintf("%04x",parseInt(t,16))}function dwe(t){return t&255}var Lyt=function(){function t(e,r){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=lwe.isInSubnet,this.isCorrect=lwe.isCorrect(fr.BITS),r===void 0?this.groups=fr.GROUPS:this.groups=r,this.address=e;var i=fr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>fr.BITS)throw new yu.AddressError("Invalid subnet mask.");e=e.replace(fr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new yu.AddressError("Invalid subnet mask.");var n=fr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(fr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return t.isValid=function(e){try{return new t(e),!0}catch(r){return!1}},t.fromBigInteger=function(e){var r=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<fr.GROUPS;n++)i.push(r.slice(n*4,(n+1)*4));return new t(i.join(":"))},t.fromURL=function(e){var r,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=fr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};r=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=fr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new t(r),port:i}},t.fromAddress4=function(e){var r=new Kd.Address4(e),i=fr.BITS-(LC.BITS-r.subnetMask);return new t("::ffff:"+r.correctForm()+"/"+i)},t.fromArpa=function(e){var r=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(r.length!==63)throw new yu.AddressError("Invalid 'ip6.arpa' form.");for(var n=r.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return r=n.join(""),new t(r)},t.prototype.microsoftTranscription=function(){return Nn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var r=fr.BITS-this.subnetMask,i=Math.abs(e-fr.BITS),n=r-i;return n<0?"0":Nyt(new Dn.BigInteger("2",10).pow(n).toString(10))},t.prototype._startAddress=function(){return new Dn.BigInteger(this.mask()+"0".repeat(fr.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new Dn.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new Dn.BigInteger(this.mask()+"1".repeat(fr.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new Dn.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.prototype.getScope=function(){var e=fr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},t.prototype.getType=function(){for(var e=0,r=Object.keys(fr.TYPES);e<r.length;e++){var i=r[e];if(this.isInSubnet(new t(i)))return fr.TYPES[i]}return"Global unicast"},t.prototype.getBits=function(e,r){return new Dn.BigInteger(this.getBitsBase2(e,r),2)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.getBitsBase16=function(e,r){var i=r-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,r).toString(16).padStart(i/4,"0")},t.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,fr.BITS)},t.prototype.reverseForm=function(e){e||(e={});var r=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,r).reverse().join(".");return r>0?e.omitSuffix?i:Nn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},t.prototype.correctForm=function(){var e,r=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(u){return u[1]-u[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));r=Myt(this.parsedAddress,n[a])}else r=this.parsedAddress;for(e=0;e<r.length;e++)r[e]!=="compact"&&(r[e]=parseInt(r[e],16).toString(16));var c=r.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(fr.BITS,"0")},t.prototype.parse4in6=function(e){var r=e.split(":"),i=r.slice(-1)[0],n=i.match(LC.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new Kd.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new yu.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(LC.RE_ADDRESS,this.address4.parsedAddress.map(Byt).join(".")));this.v4=!0,r[r.length-1]=this.address4.toGroup6(),e=r.join(":")}return e},t.prototype.parse=function(e){e=this.parse4in6(e);var r=e.match(fr.RE_BAD_CHARACTERS);if(r)throw new yu.AddressError(Nn.sprintf("Bad character%s detected in address: %s",r.length>1?"s":"",r.join("")),e.replace(fr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(fr.RE_BAD_ADDRESS);if(i)throw new yu.AddressError(Nn.sprintf("Address failed regex: %s",i.join("")),e.replace(fr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new yu.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new yu.AddressError("Too many :: groups found");if(n=n.map(function(l){return Nn.sprintf("%x",parseInt(l,16))}),n.length!==this.groups)throw new yu.AddressError("Incorrect number of groups found");return n},t.prototype.canonicalForm=function(){return this.parsedAddress.map(fwe).join(":")},t.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Nn.sprintf("%05d",parseInt(e,16))}).join(":")},t.prototype.bigInteger=function(){return new Dn.BigInteger(this.parsedAddress.map(fwe).join(""),16)},t.prototype.to4=function(){var e=this.binaryZeroPad().split("");return Kd.Address4.fromHex(new Dn.BigInteger(e.slice(96,128).join(""),2).toString(16))},t.prototype.to4in6=function(){var e=this.to4(),r=new t(this.parsedAddress.slice(0,6).join(":"),6),i=r.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},t.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),r=this.getBits(80,96).xor(new Dn.BigInteger("ffff",16)).toString(),i=Kd.Address4.fromHex(this.getBitsBase16(32,64)),n=Kd.Address4.fromHex(this.getBits(96,128).xor(new Dn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),l=s.testBit(9),d=new Dn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Nn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:l,groupIndividual:u,nonce:d},udpPort:r}},t.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),r=Kd.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Nn.sprintf("%s",e.slice(0,4)),gateway:r.address}},t.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new t(e)},t.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},t.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(dwe)},t.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(dwe))},t.fromUnsignedByteArray=function(e){for(var r=new Dn.BigInteger("256",10),i=new Dn.BigInteger("0",10),n=new Dn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Dn.BigInteger(e[s].toString(10),10))),n=n.multiply(r);return t.fromBigInteger(i)},t.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},t.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},t.prototype.isMulticast=function(){return this.getType()==="Multicast"},t.prototype.is4=function(){return this.v4},t.prototype.isTeredo=function(){return this.isInSubnet(new t("2001::/32"))},t.prototype.is6to4=function(){return this.isInSubnet(new t("2002::/16"))},t.prototype.isLoopback=function(){return this.getType()==="Loopback"},t.prototype.href=function(e){return e===void 0?e="":e=Nn.sprintf(":%s",e),Nn.sprintf("http://[%s]%s/",this.correctForm(),e)},t.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var r=this.correctForm;return e.v4&&(r=this.to4in6),e.className?Nn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,r.call(this),e.className):Nn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,r.call(this))},t.prototype.group=function(){if(this.elidedGroups===0)return UC.simpleGroup(this.address).join(":");i3(typeof this.elidedGroups=="number"),i3(typeof this.elisionBegin=="number");var e=[],r=this.address.split("::"),i=r[0],n=r[1];i.length?e.push.apply(e,UC.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Nn.sprintf("group-%d",o));return e.push(Nn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,UC.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(i3(this.address4 instanceof Kd.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},t.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var r=[],i=new t(this.correctForm());if(i.elidedGroups===0)r.push(jd.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===fr.GROUPS)r.push(jd.possibleElisions(fr.GROUPS));else{var n=i.address.split("::");n[0].length&&r.push(jd.simpleRegularExpression(n[0].split(":"))),i3(typeof i.elidedGroups=="number"),r.push(jd.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&r.push(jd.simpleRegularExpression(n[1].split(":"))),r=[r.join(":")]}return e||(r=uwe(uwe(["(?=^|",jd.ADDRESS_BOUNDARY,"|[^\\w\\:])("],r),[")(?=[^\\w\\:]|",jd.ADDRESS_BOUNDARY,"|$)"])),r.join("")},t.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},t}();io.Address6=Lyt});var pwe=y(vn=>{f();"use strict";var Uyt=vn&&vn.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Fyt=vn&&vn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kyt=vn&&vn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Uyt(e,t,r);return Fyt(e,t),e};Object.defineProperty(vn,"__esModule",{value:!0});vn.v6=vn.AddressError=vn.Address6=vn.Address4=void 0;var jyt=NC();Object.defineProperty(vn,"Address4",{enumerable:!0,get:function(){return jyt.Address4}});var Vyt=hwe();Object.defineProperty(vn,"Address6",{enumerable:!0,get:function(){return Vyt.Address6}});var zyt=QS();Object.defineProperty(vn,"AddressError",{enumerable:!0,get:function(){return zyt.AddressError}});var Hyt=Kyt(MC());vn.v6={helpers:Hyt}});var VC=y((pLt,jC)=>{f();"use strict";var ywe=me(),$yt=Object.assign(ywe("libp2p:ip-port-to-multiaddr"),{error:ywe("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:FC}=it(),KC=ue(),{Address4:Gyt,Address6:Wyt}=pwe(),n3={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function Yyt(t,e){if(typeof t!="string")throw KC(new Error(`invalid ip provided: ${t}`),n3.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw KC(new Error(`invalid port provided: ${e}`),n3.ERR_INVALID_PORT_PARAMETER);try{return new Gyt(t),new FC(`/ip4/${t}/tcp/${e}`)}catch{}try{let r=new Wyt(t);return r.is4()?new FC(`/ip4/${r.to4().correctForm()}/tcp/${e}`):new FC(`/ip6/${t}/tcp/${e}`)}catch(r){let i=`invalid ip:port for creating a multiaddr: ${t}:${e}`;throw $yt.error(i),KC(new Error(i),n3.ERR_INVALID_IP)}}jC.exports=Yyt;jC.exports.Errors=n3});var Vd=y((yLt,s3)=>{f();"use strict";var zC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},gwe=(t,e,r,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(t);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(l){a(l)}return}let c=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,u=r instanceof Error?r:new zC(c);typeof t.cancel=="function"&&t.cancel(),a(u)},e),(async()=>{try{o(await t)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};s3.exports=gwe;s3.exports.default=gwe;s3.exports.TimeoutError=zC});var _we=y((gLt,wwe)=>{f();"use strict";var bwe=tc(),{CLOSE_TIMEOUT:Xyt}=OC(),mwe=VC(),Qyt=Vd(),vwe=me(),HC=vwe("libp2p:websockets:socket");HC.error=vwe("libp2p:websockets:socket:error");wwe.exports=(t,e={})=>{let r={async sink(i){e.signal&&(i=bwe(i,e.signal));try{await t.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&HC.error(n)}},source:e.signal?bwe(t.source,e.signal):t.source,conn:t,localAddr:e.localAddr||(t.localAddress&&t.localPort?mwe(t.localAddress,t.localPort):void 0),remoteAddr:e.remoteAddr||mwe(t.remoteAddress,t.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await Qyt(t.close(),Xyt)}catch(n){let{host:s,port:o}=r.remoteAddr.toOptions();HC("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),t.destroy()}finally{r.timeline.close=Date.now()}}};return t.socket.once&&t.socket.once("close",()=>{r.timeline.close||(r.timeline.close=Date.now())}),r}});var xwe=y((bLt,Swe)=>{f();"use strict";var zl=Tf(),{CODE_CIRCUIT:$C,CODE_P2P:GC,CODE_TCP:WC,CODE_WS:Zyt,CODE_WSS:Ewe}=OC();Swe.exports={all:t=>t.filter(e=>{if(e.protoCodes().includes($C))return!1;let r=e.decapsulateCode(GC);return zl.WebSockets.matches(r)||zl.WebSocketsSecure.matches(r)}),dnsWss:t=>t.filter(e=>{if(e.protoCodes().includes($C))return!1;let r=e.decapsulateCode(GC);return zl.WebSocketsSecure.matches(r)&&zl.DNS.matches(r.decapsulateCode(WC).decapsulateCode(Ewe))}),dnsWsOrWss:t=>t.filter(e=>{if(e.protoCodes().includes($C))return!1;let r=e.decapsulateCode(GC);return zl.WebSockets.matches(r)?zl.DNS.matches(r.decapsulateCode(WC).decapsulateCode(Zyt)):zl.WebSocketsSecure.matches(r)&&zl.DNS.matches(r.decapsulateCode(WC).decapsulateCode(Ewe))})}});var Owe=y((mLt,Cwe)=>{f();"use strict";var Jyt=Zve(),egt=ww(),tgt=D2(),{AbortError:Awe}=tc(),rgt=ul(),Iwe=me(),Hl=Iwe("libp2p:websockets");Hl.error=Iwe("libp2p:websockets:error");var Twe=zy(),igt=ewe(),ngt=_we(),Rwe=xwe(),Pwe=class{constructor({upgrader:e,filter:r}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=r}async dial(e,r={}){Hl("dialing %s",e);let i=await this._connect(e,r),n=ngt(i,{remoteAddr:e,signal:r.signal});Hl("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Hl("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,r={}){if(r.signal&&r.signal.aborted)throw new Awe;let i=e.toOptions();Hl("dialing %s:%s",i.host,i.port);let n=rgt(),s=u=>{let l=`connection error: ${u.message}`;Hl.error(l),n.reject(u)},o=Jyt(tgt(e),Object.assign({binary:!0},r));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!r.signal)return await Promise.race([o.connected(),n.promise]),Hl("connected %s",e),o;let a,c=new Promise((u,l)=>{if(a=()=>{l(new Awe),setTimeout(()=>{o.close()})},r.signal.aborted)return a();r.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{r.signal.removeEventListener("abort",a)}return Hl("connected %s",e),o}createListener(e={},r){return typeof e=="function"&&(r=e,e={}),igt({handler:r,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):Twe.isBrowser||Twe.isWebWorker?Rwe.dnsWss(e):Rwe.all(e)}};Cwe.exports=egt(Pwe,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var qwe=y((vLt,kwe)=>{f();kwe.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var QC=y((wLt,XC)=>{f();"use strict";var YC=65536,sgt=4294967295;function ogt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var agt=KR().Buffer,o3=globalThis.crypto||globalThis.msCrypto;o3&&o3.getRandomValues?XC.exports=cgt:XC.exports=ogt;function cgt(t,e){if(t>sgt)throw new RangeError("requested too many random bytes");var r=agt.allocUnsafe(t);if(t>0)if(t>YC)for(var i=0;i<t;i+=YC)o3.getRandomValues(r.slice(i,i+YC));else o3.getRandomValues(r);return typeof e=="function"?process.nextTick(function(){e(null,r)}):r}});var Bwe=y((_Lt,Nwe)=>{f();"use strict";function Dwe(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function ugt(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=void 0),e!=null&&(r.code=e);try{return Dwe(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),Dwe(new n,r)}}Nwe.exports=ugt});var eO=y((ELt,Fwe)=>{f();var lgt=me()("simple-peer"),Mwe=qwe(),Lwe=QC(),fgt=i8(),ZC=gE(),dr=Bwe(),JC=64*1024,dgt=5*1e3,hgt=5*1e3;function Uwe(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function pgt(t){console.warn(t)}var $l=class extends fgt.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=Lwe(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Lwe(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||$l.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},$l.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||dgt,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Mwe(),!this._wrtc)throw typeof window=="undefined"?dr(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):dr(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(r){ZC(()=>this.destroy(dr(r,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this.streams&&this.streams.forEach(r=>{this.addStream(r)}),this._pc.ontrack=r=>{this._onTrack(r)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw dr(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(r){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.destroy(dr(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var r=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(r).catch(i=>{!r.address||r.address.endsWith(".local")?pgt("Ignoring unsupported ICE candidate."):this.destroy(dr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,r){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,r),this._needsNegotiation()}catch(i){this.destroy(dr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:r}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(r=>{this.addTrack(r,e)})}addTrack(e,r){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(r);if(!n)n=this._pc.addTrack(e,r),i.set(r,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,r,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");r&&this._senderMap.set(r,n),s.replaceTrack!=null?s.replaceTrack(r):this.destroy(dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,r){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(r):null;if(!n)throw dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(r=>{this.removeTrack(r,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,ZC(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,r){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,r(e)}_setupData(e){if(!e.channel)return this.destroy(dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=JC),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(dr(i,"ERR_DATA_CHANNEL"))};var r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},hgt)}_read(){}_write(e,r,i){if(this.destroyed)return i(dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(dr(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>JC?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Uwe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Uwe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let r=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(r(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(r(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((r,i)=>{if(this.destroyed)return;r&&(i=[]);var n={},s={},o={},a=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(n[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(o[l.id]=l)});let c=l=>{a=!0;var d=s[l.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof l.googLocalAddress=="string"&&(d=l.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var h=n[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(o[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.destroy(dr(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>JC||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var r=e.data;r instanceof ArrayBuffer&&(r=new Uint8Array(r)),this.push(r)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(r=>{this._debug("on track"),this.emit("track",e.track,r),this._remoteTracks.push({track:e.track,stream:r}),!this._remoteStreams.some(i=>i.id===r.id)&&(this._remoteStreams.push(r),ZC(()=>{this.emit("stream",r)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],lgt.apply(null,e)}};$l.WEBRTC_SUPPORT=!!Mwe();$l.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};$l.channelConfig={};Fwe.exports=$l});var jwe=y((SLt,Kwe)=>{f();"use strict";Kwe.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var c3=y(a3=>{f();"use strict";a3.CODE_P2P=421;a3.CODE_CIRCUIT=290;a3.CLOSE_TIMEOUT=2e3});var tO=y((ALt,Vwe)=>{f();var ygt=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ggt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];Vwe.exports=function(e){var r=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=ygt.exec(e||""),o={},a=14;a--;)o[ggt[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=r,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=bgt(o,o.path),o.queryKey=mgt(o,o.query),o};function bgt(t,e){var r=/\/{2,9}/g,i=e.replace(r,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function mgt(t,e){var r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(r[n]=s)}),r}});var Hwe=y(u3=>{f();"use strict";Object.defineProperty(u3,"__esModule",{value:!0});u3.url=void 0;var vgt=tO(),zwe=me()("socket.io-client:url");function wgt(t,e="",r){let i=t;r=r||typeof location!="undefined"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(zwe("protocol-less url %s",t),typeof r!="undefined"?t=r.protocol+"//"+t:t="https://"+t),zwe("parse %s",t),i=vgt(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(r&&r.port===i.port?"":":"+i.port),i}u3.url=wgt});var $we=y((TLt,rO)=>{f();try{rO.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){rO.exports=!1}});var cm=y((RLt,Gwe)=>{f();Gwe.exports=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var iO=y((PLt,Wwe)=>{f();var _gt=$we(),Egt=cm();Wwe.exports=function(t){let e=t.xdomain,r=t.xscheme,i=t.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!e||_gt))return new XMLHttpRequest}catch(n){}try{if(typeof XDomainRequest!="undefined"&&!r&&i)return new XDomainRequest}catch(n){}if(!e)try{return new Egt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}});var nO=y((CLt,Xwe)=>{f();var lc=Object.create(null);lc.open="0";lc.close="1";lc.ping="2";lc.pong="3";lc.message="4";lc.upgrade="5";lc.noop="6";var Ywe=Object.create(null);Object.keys(lc).forEach(t=>{Ywe[lc[t]]=t});var Sgt={type:"error",data:"parser error"};Xwe.exports={PACKET_TYPES:lc,PACKET_TYPES_REVERSE:Ywe,ERROR_PACKET:Sgt}});var Jwe=y((OLt,Zwe)=>{f();var{PACKET_TYPES:xgt}=nO(),Agt=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Igt=typeof ArrayBuffer=="function",Tgt=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Rgt=({type:t,data:e},r,i)=>Agt&&e instanceof Blob?r?i(e):Qwe(e,i):Igt&&(e instanceof ArrayBuffer||Tgt(e))?r?i(e instanceof ArrayBuffer?e:e.buffer):Qwe(new Blob([e]),i):i(xgt[t]+(e||"")),Qwe=(t,e)=>{let r=new FileReader;return r.onload=function(){let i=r.result.split(",")[1];e("b"+i)},r.readAsDataURL(t)};Zwe.exports=Rgt});var e_e=y(sO=>{f();(function(t){"use strict";sO.encode=function(e){var r=new Uint8Array(e),i,n=r.length,s="";for(i=0;i<n;i+=3)s+=t[r[i]>>2],s+=t[(r[i]&3)<<4|r[i+1]>>4],s+=t[(r[i+1]&15)<<2|r[i+2]>>6],s+=t[r[i+2]&63];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},sO.decode=function(e){var r=e.length*.75,i=e.length,n,s=0,o,a,c,u;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);var l=new ArrayBuffer(r),d=new Uint8Array(l);for(n=0;n<i;n+=4)o=t.indexOf(e[n]),a=t.indexOf(e[n+1]),c=t.indexOf(e[n+2]),u=t.indexOf(e[n+3]),d[s++]=o<<2|a>>4,d[s++]=(a&15)<<4|c>>2,d[s++]=(c&3)<<6|u&63;return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")});var i_e=y((qLt,r_e)=>{f();var{PACKET_TYPES_REVERSE:oO,ERROR_PACKET:Pgt}=nO(),Cgt=typeof ArrayBuffer=="function",aO;Cgt&&(aO=e_e());var Ogt=(t,e)=>{if(typeof t!="string")return{type:"message",data:t_e(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:kgt(t.substring(1),e)}:oO[r]?t.length>1?{type:oO[r],data:t.substring(1)}:{type:oO[r]}:Pgt},kgt=(t,e)=>{if(aO){let r=aO.decode(t);return t_e(r,e)}else return{base64:!0,data:t}},t_e=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};r_e.exports=Ogt});var ry=y((DLt,a_e)=>{f();var n_e=Jwe(),s_e=i_e(),o_e=String.fromCharCode(30),qgt=(t,e)=>{let r=t.length,i=new Array(r),n=0;t.forEach((s,o)=>{n_e(s,!1,a=>{i[o]=a,++n===r&&e(i.join(o_e))})})},Dgt=(t,e)=>{let r=t.split(o_e),i=[];for(let n=0;n<r.length;n++){let s=s_e(r[n],e);if(i.push(s),s.type==="error")break}return i};a_e.exports={protocol:4,encodePacket:n_e,encodePayload:qgt,decodePacket:s_e,decodePayload:Dgt}});var iy=y((NLt,cO)=>{f();typeof cO!="undefined"&&(cO.exports=vs);function vs(t){if(t)return Ngt(t)}function Ngt(t){for(var e in vs.prototype)t[e]=vs.prototype[e];return t}vs.prototype.on=vs.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};vs.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};vs.prototype.off=vs.prototype.removeListener=vs.prototype.removeAllListeners=vs.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,n=0;n<r.length;n++)if(i=r[n],i===e||i.fn===e){r.splice(n,1);break}return r.length===0&&delete this._callbacks["$"+t],this};vs.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(r){r=r.slice(0);for(var i=0,n=r.length;i<n;++i)r[i].apply(this,e)}return this};vs.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};vs.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var l3=y((BLt,u_e)=>{f();var Bgt=ry(),Mgt=iy(),Lgt=me()("engine.io-client:transport"),c_e=class extends Mgt{constructor(e){super();this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,r){let i=new Error(e);return i.type="TransportError",i.description=r,this.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):Lgt("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){let r=Bgt.decodePacket(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}};u_e.exports=c_e});var f3=y(uO=>{f();uO.encode=function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e};uO.decode=function(t){for(var e={},r=t.split("&"),i=0,n=r.length;i<n;i++){var s=r[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var dO=y((LLt,p_e)=>{f();"use strict";var l_e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),d3=64,f_e={},d_e=0,Gl=0,h_e;function lO(t){var e="";do e=l_e[t%d3]+e,t=Math.floor(t/d3);while(t>0);return e}function Ugt(t){var e=0;for(Gl=0;Gl<t.length;Gl++)e=e*d3+f_e[t.charAt(Gl)];return e}function fO(){var t=lO(+new Date);return t!==h_e?(d_e=0,h_e=t):t+"."+lO(d_e++)}for(;Gl<d3;Gl++)f_e[l_e[Gl]]=Gl;fO.encode=lO;fO.decode=Ugt;p_e.exports=fO});var hO=y((ULt,b_e)=>{f();var Fgt=l3(),Kgt=f3(),y_e=ry(),jgt=dO(),ia=me()("engine.io-client:polling"),g_e=class extends Fgt{get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{ia("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(ia("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){ia("pre-pause polling complete"),--i||r()})),this.writable||(ia("we are currently writing - waiting to pause"),i++,this.once("drain",function(){ia("pre-pause writing complete"),--i||r()}))}else r()}poll(){ia("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){ia("polling got data %s",e);let r=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};y_e.decodePayload(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():ia('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{ia("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(ia("transport open - closing"),e()):(ia("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,y_e.encodePayload(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},r=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=jgt()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=Kgt.encode(e),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}};b_e.exports=g_e});var pO=y((FLt,m_e)=>{f();m_e.exports.pick=(t,...e)=>e.reduce((r,i)=>(t.hasOwnProperty(i)&&(r[i]=t[i]),r),{})});var S_e=y((KLt,gO)=>{f();var v_e=iO(),Vgt=hO(),zgt=iy(),{pick:Hgt}=pO(),$gt=cm(),yO=me()("engine.io-client:polling-xhr");function w_e(){}var Ggt=function(){return new v_e({xdomain:!1}).responseType!=null}(),__e=class extends Vgt{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?443:80),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let r=e&&e.forceBase64;this.supportsBinary=Ggt&&!r}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new no(this.uri(),e)}doWrite(e,r){let i=this.request({method:"POST",data:e});i.on("success",r),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){yO("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",r=>{this.onError("xhr poll error",r)}),this.pollXhr=e}},no=class extends zgt{constructor(e,r){super();this.opts=r,this.method=r.method||"GET",this.uri=e,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let e=Hgt(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let r=this.xhr=new v_e(e);try{yO("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{r.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),this.hasXDR()?(r.onload=()=>{this.onLoad()},r.onerror=()=>{this.onError(r.responseText)}):r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},yO("xhr data %s",this.data),r.send(this.data)}catch(i){setTimeout(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=no.requestsCount++,no.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=w_e:this.xhr.onreadystatechange=w_e,e)try{this.xhr.abort()}catch(r){}typeof document!="undefined"&&delete no.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}};no.requestsCount=0;no.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",E_e);else if(typeof addEventListener=="function"){let t="onpagehide"in $gt?"pagehide":"unload";addEventListener(t,E_e,!1)}}function E_e(){for(let t in no.requests)no.requests.hasOwnProperty(t)&&no.requests[t].abort()}gO.exports=__e;gO.exports.Request=no});var T_e=y((jLt,I_e)=>{f();var Wgt=hO(),x_e=cm(),Ygt=/\n/g,Xgt=/\\n/g,h3,A_e=class extends Wgt{constructor(e){super(e);this.query=this.query||{},h3||(h3=x_e.___eio=x_e.___eio||[]),this.index=h3.length,h3.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){let e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=n=>{this.onError("jsonp poll error",n)};let r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){let n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)}doWrite(e,r){let i;if(!this.form){let o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri();function n(){s(),r()}let s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(o){this.onError("jsonp polling iframe removal error",o)}try{let o='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(o)}catch(o){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};s(),e=e.replace(Xgt,`\\
`),this.area.value=e.replace(Ygt,"\\n");try{this.form.submit()}catch(o){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&n()}:this.iframe.onload=n}};I_e.exports=A_e});var C_e=y((VLt,P_e)=>{f();var R_e=cm(),Qgt=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):e=>setTimeout(e,0))();P_e.exports={WebSocket:R_e.WebSocket||R_e.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:Qgt}});var D_e=y((zLt,q_e)=>{f();var O_e=l3(),Zgt=ry(),Jgt=f3(),ebt=dO(),{pick:tbt}=pO(),{WebSocket:um,usingBrowserWebSocket:bO,defaultBinaryType:rbt,nextTick:ibt}=C_e(),nbt=me()("engine.io-client:websocket"),k_e=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",p3=class extends O_e{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,i=k_e?{}:tbt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=bO&&!k_e?r?new um(e,r):new um(e):new um(e,r,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||rbt,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let i=e[r],n=r===e.length-1;Zgt.encodePacket(i,this.supportsBinary,s=>{let o={};bO||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{bO?this.ws.send(s):this.ws.send(s,o)}catch(a){nbt("websocket closed before onclose event")}n&&ibt(()=>{this.writable=!0,this.emit("drain")})})}}onClose(){O_e.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},r=this.opts.secure?"wss":"ws",i="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=ebt()),this.supportsBinary||(e.b64=1),e=Jgt.encode(e),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}check(){return!!um&&!("__initialize"in um&&this.name===p3.prototype.name)}};q_e.exports=p3});var vO=y(mO=>{f();var sbt=iO(),obt=S_e(),abt=T_e(),cbt=D_e();mO.polling=ubt;mO.websocket=cbt;function ubt(t){let e,r=!1,i=!1,n=t.jsonp!==!1;if(typeof location!="undefined"){let s=location.protocol==="https:",o=location.port;o||(o=s?443:80),r=t.hostname!==location.hostname||o!==t.port,i=t.secure!==s}if(t.xdomain=r,t.xscheme=i,e=new sbt(t),"open"in e&&!t.forceJSONP)return new obt(t);if(!n)throw new Error("JSONP disabled");return new abt(t)}});var L_e=y(($Lt,M_e)=>{f();var lbt=vO(),fbt=iy(),oi=me()("engine.io-client:socket"),N_e=ry(),B_e=tO(),dbt=f3(),fc=class extends fbt{constructor(e,r={}){super();e&&typeof e=="object"&&(r=e,e=null),e?(e=B_e(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=B_e(r.host).host),this.secure=r.secure!=null?r.secure:typeof location!="undefined"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=r.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=dbt.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){oi('creating transport "%s"',e);let r=hbt(this.opts.query);r.EIO=N_e.protocol,r.transport=e,this.id&&(r.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return oi("options: %j",i),new lbt[e](i)}open(){let e;if(this.opts.rememberUpgrade&&fc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(r){oi("error while creating transport: %s",r),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){oi("setting transport %s",e.name),this.transport&&(oi("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){oi('probing transport "%s"',e);let r=this.createTransport(e,{probe:1}),i=!1;fc.priorWebsocketSuccess=!1;let n=()=>{i||(oi('probe transport "%s" opened',e),r.send([{type:"ping",data:"probe"}]),r.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(oi('probe transport "%s" pong',e),this.upgrading=!0,this.emit("upgrading",r),!r)return;fc.priorWebsocketSuccess=r.name==="websocket",oi('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(oi("changing transport and sending upgrade packet"),l(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emit("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{oi('probe transport "%s" failed',e);let h=new Error("probe error");h.transport=r.name,this.emit("upgradeError",h)}}))};function s(){i||(i=!0,l(),r.close(),r=null)}let o=d=>{let h=new Error("probe error: "+d);h.transport=r.name,s(),oi('probe transport "%s" failed because of error: %s',e,d),this.emit("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function u(d){r&&d.name!==r.name&&(oi('"%s" works - aborting "%s"',d.name,r.name),s())}let l=()=>{r.removeListener("open",n),r.removeListener("error",o),r.removeListener("close",a),this.removeListener("close",c),this.removeListener("upgrading",u)};r.once("open",n),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",u),r.open()}onOpen(){if(oi("socket open"),this.readyState="open",fc.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){oi("starting upgrade probes");let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(oi('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else oi('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(oi("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,r,i){return this.sendPacket("message",e,r,i),this}send(e,r,i){return this.sendPacket("message",e,r,i),this}sendPacket(e,r,i,n){if(typeof r=="function"&&(n=r,r=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:r,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),oi("socket closing - telling transport to close"),this.transport.close()},r=()=>{this.removeListener("upgrade",r),this.removeListener("upgradeError",r),e()},i=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){oi("socket error %j",e),fc.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(oi('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&r.push(e[i]);return r}};fc.priorWebsocketSuccess=!1;fc.protocol=N_e.protocol;function hbt(t){let e={};for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}M_e.exports=fc});var U_e=y((GLt,zd)=>{f();var wO=L_e();zd.exports=(t,e)=>new wO(t,e);zd.exports.Socket=wO;zd.exports.protocol=wO.protocol;zd.exports.Transport=l3();zd.exports.transports=vO();zd.exports.parser=ry()});var _O=y(ny=>{f();"use strict";Object.defineProperty(ny,"__esModule",{value:!0});ny.hasBinary=ny.isBinary=void 0;var pbt=typeof ArrayBuffer=="function",ybt=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,F_e=Object.prototype.toString,gbt=typeof Blob=="function"||typeof Blob!="undefined"&&F_e.call(Blob)==="[object BlobConstructor]",bbt=typeof File=="function"||typeof File!="undefined"&&F_e.call(File)==="[object FileConstructor]";function K_e(t){return pbt&&(t instanceof ArrayBuffer||ybt(t))||gbt&&t instanceof Blob||bbt&&t instanceof File}ny.isBinary=K_e;function y3(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,i=t.length;r<i;r++)if(y3(t[r]))return!0;return!1}if(K_e(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return y3(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&y3(t[r]))return!0;return!1}ny.hasBinary=y3});var j_e=y(sy=>{f();"use strict";Object.defineProperty(sy,"__esModule",{value:!0});sy.reconstructPacket=sy.deconstructPacket=void 0;var mbt=_O();function vbt(t){let e=[],r=t.data,i=t;return i.data=EO(r,e),i.attachments=e.length,{packet:i,buffers:e}}sy.deconstructPacket=vbt;function EO(t,e){if(!t)return t;if(mbt.isBinary(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let i=0;i<t.length;i++)r[i]=EO(t[i],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let i in t)t.hasOwnProperty(i)&&(r[i]=EO(t[i],e));return r}return t}function wbt(t,e){return t.data=SO(t.data,e),t.attachments=void 0,t}sy.reconstructPacket=wbt;function SO(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=SO(t[r],e);else if(typeof t=="object")for(let r in t)t.hasOwnProperty(r)&&(t[r]=SO(t[r],e));return t}});var b3=y(na=>{f();"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.Decoder=na.Encoder=na.PacketType=na.protocol=void 0;var _bt=iy(),V_e=j_e(),z_e=_O(),xO=me()("socket.io-parser");na.protocol=5;var gi;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(gi=na.PacketType||(na.PacketType={}));var H_e=class{encode(e){return xO("encoding packet %j",e),(e.type===gi.EVENT||e.type===gi.ACK)&&z_e.hasBinary(e)?(e.type=e.type===gi.EVENT?gi.BINARY_EVENT:gi.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===gi.BINARY_EVENT||e.type===gi.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data)),xO("encoded %j as %s",e,r),r}encodeAsBinary(e){let r=V_e.deconstructPacket(e),i=this.encodeAsString(r.packet),n=r.buffers;return n.unshift(i),n}};na.Encoder=H_e;var g3=class extends _bt{constructor(){super()}add(e){let r;if(typeof e=="string")r=this.decodeString(e),r.type===gi.BINARY_EVENT||r.type===gi.BINARY_ACK?(this.reconstructor=new $_e(r),r.attachments===0&&super.emit("decoded",r)):super.emit("decoded",r);else if(z_e.isBinary(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emit("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,i={type:Number(e.charAt(0))};if(gi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===gi.BINARY_EVENT||i.type===gi.BINARY_ACK){let s=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let o=e.substring(s,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(r+1)==="/"){let s=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););i.nsp=e.substring(s,r)}else i.nsp="/";let n=e.charAt(r+1);if(n!==""&&Number(n)==n){let s=r+1;for(;++r;){let o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}i.id=Number(e.substring(s,r+1))}if(e.charAt(++r)){let s=Ebt(e.substr(r));if(g3.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return xO("decoded %s as %j",e,i),i}static isPayloadValid(e,r){switch(e){case gi.CONNECT:return typeof r=="object";case gi.DISCONNECT:return r===void 0;case gi.CONNECT_ERROR:return typeof r=="string"||typeof r=="object";case gi.EVENT:case gi.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case gi.ACK:case gi.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};na.Decoder=g3;function Ebt(t){try{return JSON.parse(t)}catch(e){return!1}}var $_e=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=V_e.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var AO=y(m3=>{f();"use strict";Object.defineProperty(m3,"__esModule",{value:!0});m3.on=void 0;function Sbt(t,e,r){return t.on(e,r),function(){t.off(e,r)}}m3.on=Sbt});var IO=y(v3=>{f();"use strict";Object.defineProperty(v3,"__esModule",{value:!0});v3.StrictEventEmitter=void 0;var xbt=iy(),G_e=class extends xbt{on(e,r){return super.on(e,r),this}once(e,r){return super.once(e,r),this}emit(e,...r){return super.emit(e,...r),this}emitReserved(e,...r){return super.emit(e,...r),this}listeners(e){return super.listeners(e)}};v3.StrictEventEmitter=G_e});var TO=y(_3=>{f();"use strict";Object.defineProperty(_3,"__esModule",{value:!0});_3.Socket=void 0;var so=b3(),w3=AO(),Abt=IO(),oo=me()("socket.io-client:socket"),Ibt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),W_e=class extends Abt.StrictEventEmitter{constructor(e,r,i){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[w3.on(e,"open",this.onopen.bind(this)),w3.on(e,"packet",this.onpacket.bind(this)),w3.on(e,"error",this.onerror.bind(this)),w3.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(Ibt.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');r.unshift(e);let i={type:so.PacketType.EVENT,data:r};i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"&&(oo("emitting packet with ack id %d",this.ids),this.acks[this.ids]=r.pop(),i.id=this.ids++);let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?oo("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){oo("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:so.PacketType.CONNECT,data:e})}):this.packet({type:so.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){oo("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case so.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case so.PacketType.EVENT:this.onevent(e);break;case so.PacketType.BINARY_EVENT:this.onevent(e);break;case so.PacketType.ACK:this.onack(e);break;case so.PacketType.BINARY_ACK:this.onack(e);break;case so.PacketType.DISCONNECT:this.ondisconnect();break;case so.PacketType.CONNECT_ERROR:let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let r=e.data||[];oo("emitting event %j",r),e.id!=null&&(oo("attaching ack callback to event"),r.push(this.ack(e.id))),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let i of r)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let r=this,i=!1;return function(...n){i||(i=!0,oo("sending ack %j",n),r.packet({type:so.PacketType.ACK,id:e,data:n}))}}onack(e){let r=this.acks[e.id];typeof r=="function"?(oo("calling ack %s with %j",e.id,e.data),r.apply(this,e.data),delete this.acks[e.id]):oo("bad ack %s",e.id)}onconnect(e){oo("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){oo("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(oo("performing disconnect (%s)",this.nsp),this.packet({type:so.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let i=0;i<r.length;i++)if(e===r[i])return r.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};_3.Socket=W_e});var X_e=y((e9t,Y_e)=>{f();Y_e.exports=oy;function oy(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}oy.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};oy.prototype.reset=function(){this.attempts=0};oy.prototype.setMin=function(t){this.ms=t};oy.prototype.setMax=function(t){this.max=t};oy.prototype.setJitter=function(t){this.jitter=t}});var RO=y(E3=>{f();"use strict";Object.defineProperty(E3,"__esModule",{value:!0});E3.Manager=void 0;var Tbt=U_e(),Rbt=TO(),Pbt=b3(),Hd=AO(),Cbt=X_e(),Obt=IO(),en=me()("socket.io-client:manager"),Q_e=class extends Obt.StrictEventEmitter{constructor(e,r){super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor(r.randomizationFactor||.5),this.backoff=new Cbt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||Pbt;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(en("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;en("opening %s",this.uri),this.engine=Tbt(this.uri,this.opts);let r=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=Hd.on(r,"open",function(){i.onopen(),e&&e()}),s=Hd.on(r,"error",o=>{en("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;en("connect attempt will timeout after %d",o),o===0&&n();let a=setTimeout(()=>{en("connect attempt timed out after %d",o),n(),r.close(),r.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){en("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Hd.on(e,"ping",this.onping.bind(this)),Hd.on(e,"data",this.ondata.bind(this)),Hd.on(e,"error",this.onerror.bind(this)),Hd.on(e,"close",this.onclose.bind(this)),Hd.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){en("error",e),this.emitReserved("error",e)}socket(e,r){let i=this.nsps[e];return i||(i=new Rbt.Socket(this,e,r),this.nsps[e]=i),i}_destroy(e){let r=Object.keys(this.nsps);for(let i of r)if(this.nsps[i].active){en("socket %s is still active, skipping close",i);return}this._close()}_packet(e){en("writing packet %j",e);let r=this.encoder.encode(e);for(let i=0;i<r.length;i++)this.engine.write(r[i],e.options)}cleanup(){en("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){en("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){en("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)en("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();en("will wait %dms before reconnect attempt",r),this._reconnecting=!0;let i=setTimeout(()=>{e.skipReconnect||(en("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(en("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(en("reconnect success"),e.onreconnect())}))},r);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};E3.Manager=Q_e});var t2e=y((Jn,e2e)=>{f();"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.io=Jn.Socket=Jn.Manager=Jn.protocol=void 0;var kbt=Hwe(),Z_e=RO(),J_e=me()("socket.io-client");e2e.exports=Jn=S3;var lm=Jn.managers={};function S3(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=kbt.url(t,e.path||"/socket.io"),i=r.source,n=r.id,s=r.path,o=lm[n]&&s in lm[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(J_e("ignoring socket cache for %s",i),c=new Z_e.Manager(i,e)):(lm[n]||(J_e("new io instance for %s",i),lm[n]=new Z_e.Manager(i,e)),c=lm[n]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Jn.io=S3;var qbt=b3();Object.defineProperty(Jn,"protocol",{enumerable:!0,get:function(){return qbt.protocol}});Jn.connect=S3;var Dbt=RO();Object.defineProperty(Jn,"Manager",{enumerable:!0,get:function(){return Dbt.Manager}});var Nbt=TO();Object.defineProperty(Jn,"Socket",{enumerable:!0,get:function(){return Nbt.Socket}});Jn.default=S3});var PO=y((r9t,r2e)=>{f();var Bbt=YE();r2e.exports=t=>async e=>{e=Bbt(e);let r=v=>{typeof v.return=="function"&&v.return()},i=null,n=null,s=v=>{i=v,n&&n(v),r(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,l=!1,d=()=>{l=!0,u&&u()},h=null,p=()=>{h&&h()},g=()=>new Promise((v,A)=>{o=h=v,n=A,t.once("drain",p)}),m=()=>(r(e),new Promise((v,A)=>{if(a||l||i)return v();u=o=v,n=A})),E=()=>{t.removeListener("error",s),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("drain",p)};t.once("error",s),t.once("close",c),t.once("finish",d);try{for await(let v of e){if(!t.writable||t.destroyed||i)break;t.write(v)===!1&&await g()}}catch(v){i||t.destroy(),i=v}try{if(t.writable&&t.end(),await m(),i)throw i}finally{E()}}});var CO=y((i9t,i2e)=>{f();var Mbt=PO(),Lbt=U1();i2e.exports=t=>({sink:Mbt(t),source:Lbt(t)})});var s2e=y((n9t,n2e)=>{f();var Ubt=CO();n2e.exports=t=>async function*(e){let r=Ubt(t),i;if(r.sink(e).catch(n=>{i=n}),yield*r.source,i)throw i}});var o2e=y((s9t,ay)=>{f();ay.exports=U1();ay.exports.source=U1();ay.exports.sink=PO();ay.exports.transform=s2e();ay.exports.duplex=CO()});var OO=y((o9t,f2e)=>{f();"use strict";var a2e=tc(),Fbt=o2e(),{CLOSE_TIMEOUT:Kbt}=c3(),c2e=VC(),u2e=me(),x3=u2e("libp2p:webrtc-star:socket");x3.error=u2e("libp2p:webrtc-star:socket:error");var l2e=(t,e)=>{if(!(!t||!e))try{return c2e(t,e)}catch(r){return x3.error(r),c2e("0.0.0.0",e)}};f2e.exports=(t,e={})=>{let{sink:r,source:i}=Fbt.duplex(t),n=e.remoteAddr||l2e(t.remoteAddress,t.remotePort),s=l2e(t.localAddress,t.localPort),o={async sink(a){e.signal&&(a=a2e(a,e.signal));try{await r(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&x3.error(c)}},source:e.signal?a2e(i,e.signal):i,conn:t,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!t.destroyed)return new Promise((a,c)=>{let u=Date.now(),l=setTimeout(()=>{if(o.remoteAddr){let{host:d,port:h}=o.remoteAddr.toOptions();x3("timeout closing socket to %s:%s after %dms, destroying it manually",d,h,Date.now()-u)}t.destroyed||t.destroy()},Kbt);t.once("close",()=>{a()}),t.end(d=>{if(clearTimeout(l),o.timeline.close=Date.now(),d)return c(d)})})}};return t.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var kO=y((a9t,h2e)=>{f();"use strict";var{Multiaddr:d2e}=it();function jbt(t){let e=t.toString().split("/"),r=t.protos()[1].name,i=t.protos()[2].name,n=t.stringTuples()[1][1];if(r!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+t.toString());if(!d2e.isName(t))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function Vbt(t){let e="/libp2p-webrtc-star";if(t.indexOf(e)!==-1){t=t.substring(e.length,t.length);let r=new d2e(t),i=r.stringTuples().filter(n=>n[0]===421)[0];r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${i[1]}`),t=r.toString()}return t}h2e.exports={cleanUrlSIO:jbt,cleanMultiaddr:Vbt}});var b2e=y((c9t,g2e)=>{f();"use strict";var zbt=yr(),p2e=me(),$d=p2e("libp2p:webrtc-star:listener");$d.error=p2e("libp2p:webrtc-star:listener:error");var Hbt=ue(),$bt=t2e(),Gbt=eO(),Wbt=ul(),Ybt=OO(),{cleanUrlSIO:Xbt}=kO(),{CODE_P2P:y2e}=c3(),Qbt={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};g2e.exports=({handler:t,upgrader:e},r,i={})=>{let n=new zbt,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw Hbt(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=Wbt();s=a;let u;!a.protoCodes().includes(y2e)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,n.on("error",()=>c.reject()),o=Xbt(a),$d("Dialing to Signalling Server on: "+o),n.io=$bt.connect(o,Qbt);let l=d=>{if(d.answer||d.err||!d.intentId)return;let h=d.intentId,p=n.__pendingIntents.get(h);p||(p=[],n.__pendingIntents.set(h,p));let g=n.__spChannels.get(h);if(g){g.signal(d.signal);return}else if(d.signal.type!=="offer"){p.push(d);return}let m={trickle:!1,...i};r.wrtc&&(m.wrtc=r.wrtc),g=new Gbt(m);let E=v=>{$d.error("incoming connection errored",v)};g.on("error",E),g.once("close",(...v)=>{g.removeListener("error",E)}),g.on("signal",v=>{d.signal=v,d.answer=!0,n.io.emit("ss-handshake",d)}),g.signal(d.signal);for(let v of p)g.signal(v.signal);n.__pendingIntents.set(h,[]),g.once("connect",async()=>{let v=Ybt(g);$d("new inbound connection %s",v.remoteAddr);let A;try{A=await e.upgradeInbound(v)}catch(R){return $d.error("inbound connection failed to upgrade",R),v.close()}if(!A.remoteAddr)try{A.remoteAddr=a.decapsulateCode(y2e).encapsulate(`/p2p/${A.remotePeer.toB58String()}`)}catch(R){$d.error("could not determine remote address",R)}$d("inbound connection %s upgraded",v.remoteAddr),Zbt(n,v,h),n.emit("connection",A),t(A)}),n.__spChannels.set(h,g)};return n.io.once("connect_error",d=>c.reject(d)),n.io.once("error",d=>{n.emit("error",d),n.emit("close")}),n.io.on("ws-handshake",l),n.io.on("ws-peer",r._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",u.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),r.sigReferences.set(o,{listener:n,signallingAddr:u}),c.promise},n.close=async()=>{let a=r.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,r.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function Zbt(t,e,r){t.__connections.push(e);let i=()=>{t.__connections=t.__connections.filter(n=>n!==e),t.__spChannels.delete(r),t.__pendingIntents.delete(r)};e.conn.once("close",i)}});var E2e=y((u9t,_2e)=>{f();"use strict";var m2e=me(),gu=m2e("libp2p:webrtc-star");gu.error=m2e("libp2p:webrtc-star:error");var{EventEmitter:Jbt}=yr(),A3=ue(),e1t=ww(),{AbortError:v2e}=tc(),t1t=eO(),{supportsWebRTCDataChannels:r1t}=jwe(),{Multiaddr:i1t}=it(),n1t=Tf(),s1t=rt(),{CODE_CIRCUIT:o1t}=c3(),a1t=b2e(),c1t=OO(),{cleanMultiaddr:u1t,cleanUrlSIO:l1t}=kO();function f1t(){}var w2e=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new Jbt,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,r={}){let i=await this._connect(e,r),n=c1t(i,{remoteAddr:e,signal:r.signal});gu("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return gu("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,r={}){if(r.signal&&r.signal.aborted)throw new v2e;let i={initiator:!0,trickle:!1,...r.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(l1t(e));if(!c||!c.listener)return a(A3(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,l=Date.now(),d;gu("dialing %s:%s",n.host,n.port);let h=new t1t(i),p=A=>{if(!d){let R=`connection error ${n.host}:${n.port}: ${A.message}`;gu.error(R),v(A)}},g=()=>{gu("connnection timeout %s:%s",n.host,n.port);let A=A3(new Error(`connection timeout after ${Date.now()-l}ms`),"ERR_CONNECT_TIMEOUT");h.emit("error",A)},m=()=>{d=!0,gu("connection opened %s:%s",n.host,n.port),v(null)},E=()=>{gu.error("connection aborted %s:%s",n.host,n.port),h.destroy(),v(new v2e)},v=A=>{h.removeListener("timeout",g),h.removeListener("connect",m),r.signal&&r.signal.removeEventListener("abort",E),A?a(A):o(h)};h.on("error",p),h.once("timeout",g),h.once("connect",m),h.on("close",()=>{h.removeListener("error",p)}),r.signal&&r.signal.addEventListener("abort",E),h.on("signal",A=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:A})}),u.on("ws-handshake",A=>{A.intentId===s&&A.err&&(h.destroy(),a(A3(A.err instanceof Error?A.err:new Error(A.err),"ERR_SIGNALLING_FAILED"))),!(A.intentId!==s||!A.answer||h.destroyed)&&h.signal(A.signal)})})}createListener(e={},r){if(!r1t&&!this.wrtc)throw A3(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(r=e,e={}),r=r||f1t,a1t({handler:r,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>r.protoCodes().includes(o1t)?!1:n1t.WebRTCStar.matches(r))}_peerDiscovered(e){if(!this.discovery._isStarted)return;gu("Peer Discovered:",e),e=u1t(e);let r=new i1t(e),i=s1t.createFromB58String(r.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[r]})}};_2e.exports=e1t(w2e,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var T2e=y((l9t,I2e)=>{f();"use strict";var I3=ss(),S2e=gn(),qO=10*1024,x2e=class{constructor(){this._pool=new Uint8Array(qO),this._poolOffset=0}write(e){let r=this._pool,i=this._poolOffset;I3.encode(e.id<<3|e.type,r,i),i+=I3.encode.bytes,I3.encode(e.data?e.data.length:0,r,i),i+=I3.encode.bytes;let n=r.subarray(this._poolOffset,i);return qO-i<100?(this._pool=new Uint8Array(qO),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},A2e=new x2e;I2e.exports=t=>async function*(){for await(let r of t)Array.isArray(r)?yield new S2e(r.map(i=>A2e.write(i))):yield new S2e(A2e.write(r))}()});var C2e=y((f9t,P2e)=>{f();"use strict";var T3=ss(),d1t=gn();P2e.exports=t=>async function*(){let r=new R2e;for await(let i of t){let n=r.write(i);n.length&&(yield n)}}();var R2e=class{constructor(){this._buffer=new d1t,this._bufferProxy=new Proxy({},{get:(e,r)=>r[0]==="l"?this._buffer[r]:this._buffer.get(parseInt(r))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let r=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;r.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return r}_decodeHeader(e){let r=T3.decode(e),i=T3.decode.bytes,n=T3.decode(e,i);return i+=T3.decode.bytes,{id:r>>3,type:r&7,offset:i,length:n}}}});var O2e=y(DO=>{f();"use strict";DO.encode=T2e();DO.decode=C2e()});var BO=y((h9t,NO)=>{f();"use strict";var k2e=1<<20;NO.exports=t=>{t=t||k2e;let e=r=>{if(r.data&&r.data.length>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return r=>async function*(){for await(let n of r)Array.isArray(n)?n.forEach(e):e(n),yield n}()};NO.exports.MAX_MSG_SIZE=k2e});var MO=y(fm=>{f();"use strict";var bu=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});fm.MessageTypes=bu;fm.InitiatorMessageTypes=Object.freeze({NEW_STREAM:bu.NEW_STREAM,MESSAGE:bu.MESSAGE_INITIATOR,CLOSE:bu.CLOSE_INITIATOR,RESET:bu.RESET_INITIATOR});fm.ReceiverMessageTypes=Object.freeze({MESSAGE:bu.MESSAGE_RECEIVER,CLOSE:bu.CLOSE_RECEIVER,RESET:bu.RESET_RECEIVER});fm.MessageTypeNames=Object.freeze(Object.entries(bu).reduce((t,e)=>(t[e[1]]=e[0],t),{}))});var B2e=y((y9t,N2e)=>{f();"use strict";var h1t=tc(),q2e=nf(),dm=me()("libp2p:mplex:stream"),p1t=ja(),D2e=gn(),y1t=ue(),{MAX_MSG_SIZE:g1t}=BO(),{InitiatorMessageTypes:b1t,ReceiverMessageTypes:m1t}=MO(),LO="ERR_MPLEX_STREAM_RESET",v1t="ERR_MPLEX_STREAM_ABORT";N2e.exports=({id:t,name:e,send:r,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=g1t})=>{let o=new q2e,a=new q2e,c=n==="initiator"?b1t:m1t,u=n==="initiator"?`i${t}`:`r${t}`;e=String(e??t);let l=!1,d=!1,h,p=E=>{l||(l=!0,dm("%s stream %s source end",n,e,E),E&&!h&&(h=E),d&&(m.timeline.close=Date.now(),i(h)))},g=E=>{d||(d=!0,dm("%s stream %s sink end",n,e,E),E&&!h&&(h=E),l&&(m.timeline.close=Date.now(),i(h)))},m={close:()=>m.source.end(),abort:E=>{dm("%s stream %s abort",n,e,E),m.source.end(E),o.abort(),g(E)},reset:()=>{let E=y1t(new Error("stream reset"),LO);a.abort(),m.source.end(E),g(E)},sink:async E=>{E=h1t(E,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:v1t}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:LO}}]),n==="initiator"&&r({id:t,type:c.NEW_STREAM,data:e});try{for await(let v of E)for(;v.length;){if(v.length<=s){r({id:t,type:c.MESSAGE,data:v});break}v=D2e.isBufferList(v)?v:new D2e(v),r({id:t,type:c.MESSAGE,data:v.shallowSlice(0,s)}),v.consume(s)}}catch(v){return v.code===LO?dm("%s stream %s reset",n,e):(dm("%s stream %s error",n,e,v),r({id:t,type:c.RESET})),m.source.end(v),g(v)}r({id:t,type:c.CLOSE}),g()},source:p1t(p),timeline:{open:Date.now(),close:null},id:u};return m}});var F2e=y((g9t,U2e)=>{f();"use strict";var w1t=Ar(),_1t=ja(),mu=me()("libp2p:mplex"),E1t=tc(),M2e=O2e(),S1t=BO(),{MessageTypes:Gd,MessageTypeNames:L2e}=MO(),x1t=B2e(),UO=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(r=>{e.push(r)}),this._streams.receivers.forEach(r=>{e.push(r)}),e}newStream(e){let r=this._streamId++;e=e==null?r.toString():String(e);let i=this._streams.initiators;return this._newStream({id:r,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:r}){let i=this._streams.receivers;return this._newStream({id:e,name:r,type:"receiver",registry:i})}_newStream({id:e,name:r,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);mu("new %s stream %s %s",i,e,r);let a=x1t({id:e,name:r,send:c=>(mu.enabled&&mu("%s stream %s %s send",i,e,r,{...c,type:L2e[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{mu("%s stream %s %s ended",i,e,r),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=E1t(e,this._options.signal));try{await w1t(e,M2e.decode,S1t(this._options.maxMsgSize),async r=>{for await(let i of r)for(let n of i)this._handleIncoming(n)})}catch(r){return mu("error in sink",r),this.source.end(r)}this.source.end()}}_createSource(){let r=_1t({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(M2e.encode(r),{push:r.push,end:r.end,return:r.return})}_handleIncoming({id:e,type:r,data:i}){if(mu.enabled&&mu("incoming message",{id:e,type:L2e[r],data:i.slice()}),r===Gd.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(r&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return mu("missing stream %s",e);switch(r){case Gd.MESSAGE_INITIATOR:case Gd.MESSAGE_RECEIVER:s.source.push(i);break;case Gd.CLOSE_INITIATOR:case Gd.CLOSE_RECEIVER:s.close();break;case Gd.RESET_INITIATOR:case Gd.RESET_RECEIVER:s.reset();break;default:mu("unknown message type %s",r)}}};UO.multicodec="/mplex/6.7.0";U2e.exports=UO});var j2e=y((b9t,K2e)=>{f();"use strict";K2e.exports=F2e()});var z2e=y(FO=>{f();"use strict";Object.defineProperty(FO,"__esModule",{value:!0});var V2e=65536,A1t=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),i=0;i<r.length;i+=V2e)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,V2e)));return r},t}();FO.BrowserRandomSource=A1t});var dc=y(KO=>{f();"use strict";Object.defineProperty(KO,"__esModule",{value:!0});function I1t(t){for(var e=0;e<t.length;e++)t[e]=0;return t}KO.wipe=I1t});var H2e=y(jO=>{f();"use strict";Object.defineProperty(jO,"__esModule",{value:!0});var T1t=dc(),R1t=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof oa!="undefined"){var e=ph();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=r[n];return T1t.wipe(r),i},t}();jO.NodeRandomSource=R1t});var $2e=y(VO=>{f();"use strict";Object.defineProperty(VO,"__esModule",{value:!0});var P1t=z2e(),C1t=H2e(),O1t=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new P1t.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new C1t.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();VO.SystemRandomSource=O1t});var G2e=y(ws=>{f();"use strict";Object.defineProperty(ws,"__esModule",{value:!0});function k1t(t,e){var r=t>>>16&65535,i=t&65535,n=e>>>16&65535,s=e&65535;return i*s+(r*s+i*n<<16>>>0)|0}ws.mul=Math.imul||k1t;function q1t(t,e){return t+e|0}ws.add=q1t;function D1t(t,e){return t-e|0}ws.sub=D1t;function N1t(t,e){return t<<e|t>>>32-e}ws.rotl=N1t;function B1t(t,e){return t<<32-e|t>>>e}ws.rotr=B1t;function M1t(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}ws.isInteger=Number.isInteger||M1t;ws.MAX_SAFE_INTEGER=9007199254740991;ws.isSafeInteger=function(t){return ws.isInteger(t)&&t>=-ws.MAX_SAFE_INTEGER&&t<=ws.MAX_SAFE_INTEGER}});var hm=y(mt=>{f();"use strict";Object.defineProperty(mt,"__esModule",{value:!0});var W2e=G2e();function L1t(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}mt.readInt16BE=L1t;function U1t(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}mt.readUint16BE=U1t;function F1t(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}mt.readInt16LE=F1t;function K1t(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}mt.readUint16LE=K1t;function Y2e(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}mt.writeUint16BE=Y2e;mt.writeInt16BE=Y2e;function X2e(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}mt.writeUint16LE=X2e;mt.writeInt16LE=X2e;function zO(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}mt.readInt32BE=zO;function HO(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}mt.readUint32BE=HO;function $O(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}mt.readInt32LE=$O;function GO(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}mt.readUint32LE=GO;function R3(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}mt.writeUint32BE=R3;mt.writeInt32BE=R3;function P3(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}mt.writeUint32LE=P3;mt.writeInt32LE=P3;function j1t(t,e){e===void 0&&(e=0);var r=zO(t,e),i=zO(t,e+4);return r*4294967296+i-(i>>31)*4294967296}mt.readInt64BE=j1t;function V1t(t,e){e===void 0&&(e=0);var r=HO(t,e),i=HO(t,e+4);return r*4294967296+i}mt.readUint64BE=V1t;function z1t(t,e){e===void 0&&(e=0);var r=$O(t,e),i=$O(t,e+4);return i*4294967296+r-(r>>31)*4294967296}mt.readInt64LE=z1t;function H1t(t,e){e===void 0&&(e=0);var r=GO(t,e),i=GO(t,e+4);return i*4294967296+r}mt.readUint64LE=H1t;function Q2e(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),R3(t/4294967296>>>0,e,r),R3(t>>>0,e,r+4),e}mt.writeUint64BE=Q2e;mt.writeInt64BE=Q2e;function Z2e(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),P3(t>>>0,e,r),P3(t/4294967296>>>0,e,r+4),e}mt.writeUint64LE=Z2e;mt.writeInt64LE=Z2e;function $1t(t,e,r){if(r===void 0&&(r=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}mt.readUintBE=$1t;function G1t(t,e,r){if(r===void 0&&(r=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}mt.readUintLE=G1t;function W1t(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!W2e.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}mt.writeUintBE=W1t;function Y1t(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!W2e.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}mt.writeUintLE=Y1t;function X1t(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}mt.readFloat32BE=X1t;function Q1t(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}mt.readFloat32LE=Q1t;function Z1t(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}mt.readFloat64BE=Z1t;function J1t(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}mt.readFloat64LE=J1t;function emt(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}mt.writeFloat32BE=emt;function tmt(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}mt.writeFloat32LE=tmt;function rmt(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}mt.writeFloat64BE=rmt;function imt(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}mt.writeFloat64LE=imt});var rEe=y(sa=>{f();"use strict";Object.defineProperty(sa,"__esModule",{value:!0});var nmt=$2e(),smt=hm(),J2e=dc();sa.defaultRandomSource=new nmt.SystemRandomSource;function WO(t,e){return e===void 0&&(e=sa.defaultRandomSource),e.randomBytes(t)}sa.randomBytes=WO;function omt(t){t===void 0&&(t=sa.defaultRandomSource);var e=WO(4,t),r=smt.readUint32LE(e);return J2e.wipe(e),r}sa.randomUint32=omt;var eEe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function tEe(t,e,r){if(e===void 0&&(e=eEe),r===void 0&&(r=sa.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;t>0;){for(var o=WO(Math.ceil(t*256/s),r),a=0;a<o.length&&t>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),t--)}J2e.wipe(o)}return i}sa.randomString=tEe;function amt(t,e,r){e===void 0&&(e=eEe),r===void 0&&(r=sa.defaultRandomSource);var i=Math.ceil(t/(Math.log(e.length)/Math.LN2));return tEe(i,e,r)}sa.randomStringForEntropy=amt});var k3=y(es=>{f();"use strict";Object.defineProperty(es,"__esModule",{value:!0});var cmt=rEe(),umt=dc();es.PUBLIC_KEY_LENGTH=32;es.SECRET_KEY_LENGTH=32;es.SHARED_KEY_LENGTH=32;function hc(t){var e=new Float64Array(16);if(t)for(var r=0;r<t.length;r++)e[r]=t[r];return e}var iEe=new Uint8Array(32);iEe[0]=9;var lmt=hc([56129,1]);function YO(t){for(var e=1,r=0;r<16;r++){var i=t[r]+e+65535;e=Math.floor(i/65536),t[r]=i-e*65536}t[0]+=e-1+37*(e-1)}function pm(t,e,r){for(var i=~(r-1),n=0;n<16;n++){var s=i&(t[n]^e[n]);t[n]^=s,e[n]^=s}}function fmt(t,e){for(var r=hc(),i=hc(),n=0;n<16;n++)i[n]=e[n];YO(i),YO(i),YO(i);for(var s=0;s<2;s++){r[0]=i[0]-65517;for(var n=1;n<15;n++)r[n]=i[n]-65535-(r[n-1]>>16&1),r[n-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);var o=r[15]>>16&1;r[14]&=65535,pm(i,r,1-o)}for(var n=0;n<16;n++)t[2*n]=i[n]&255,t[2*n+1]=i[n]>>8}function dmt(t,e){for(var r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function C3(t,e,r){for(var i=0;i<16;i++)t[i]=e[i]+r[i]}function O3(t,e,r){for(var i=0;i<16;i++)t[i]=e[i]-r[i]}function vu(t,e,r){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,p=0,g=0,m=0,E=0,v=0,A=0,R=0,F=0,q=0,D=0,z=0,G=0,Y=0,P=0,b=0,w=0,S=0,C=0,B=0,W=0,j=0,M=0,_=0,L=r[0],ae=r[1],X=r[2],ne=r[3],oe=r[4],he=r[5],pe=r[6],_e=r[7],k=r[8],K=r[9],$=r[10],Z=r[11],I=r[12],U=r[13],V=r[14],N=r[15];i=e[0],s+=i*L,o+=i*ae,a+=i*X,c+=i*ne,u+=i*oe,l+=i*he,d+=i*pe,h+=i*_e,p+=i*k,g+=i*K,m+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*N,i=e[1],o+=i*L,a+=i*ae,c+=i*X,u+=i*ne,l+=i*oe,d+=i*he,h+=i*pe,p+=i*_e,g+=i*k,m+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*N,i=e[2],a+=i*L,c+=i*ae,u+=i*X,l+=i*ne,d+=i*oe,h+=i*he,p+=i*pe,g+=i*_e,m+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,D+=i*N,i=e[3],c+=i*L,u+=i*ae,l+=i*X,d+=i*ne,h+=i*oe,p+=i*he,g+=i*pe,m+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,D+=i*V,z+=i*N,i=e[4],u+=i*L,l+=i*ae,d+=i*X,h+=i*ne,p+=i*oe,g+=i*he,m+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,D+=i*U,z+=i*V,G+=i*N,i=e[5],l+=i*L,d+=i*ae,h+=i*X,p+=i*ne,g+=i*oe,m+=i*he,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,D+=i*I,z+=i*U,G+=i*V,Y+=i*N,i=e[6],d+=i*L,h+=i*ae,p+=i*X,g+=i*ne,m+=i*oe,E+=i*he,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,D+=i*Z,z+=i*I,G+=i*U,Y+=i*V,P+=i*N,i=e[7],h+=i*L,p+=i*ae,g+=i*X,m+=i*ne,E+=i*oe,v+=i*he,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,D+=i*$,z+=i*Z,G+=i*I,Y+=i*U,P+=i*V,b+=i*N,i=e[8],p+=i*L,g+=i*ae,m+=i*X,E+=i*ne,v+=i*oe,A+=i*he,R+=i*pe,F+=i*_e,q+=i*k,D+=i*K,z+=i*$,G+=i*Z,Y+=i*I,P+=i*U,b+=i*V,w+=i*N,i=e[9],g+=i*L,m+=i*ae,E+=i*X,v+=i*ne,A+=i*oe,R+=i*he,F+=i*pe,q+=i*_e,D+=i*k,z+=i*K,G+=i*$,Y+=i*Z,P+=i*I,b+=i*U,w+=i*V,S+=i*N,i=e[10],m+=i*L,E+=i*ae,v+=i*X,A+=i*ne,R+=i*oe,F+=i*he,q+=i*pe,D+=i*_e,z+=i*k,G+=i*K,Y+=i*$,P+=i*Z,b+=i*I,w+=i*U,S+=i*V,C+=i*N,i=e[11],E+=i*L,v+=i*ae,A+=i*X,R+=i*ne,F+=i*oe,q+=i*he,D+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,P+=i*$,b+=i*Z,w+=i*I,S+=i*U,C+=i*V,B+=i*N,i=e[12],v+=i*L,A+=i*ae,R+=i*X,F+=i*ne,q+=i*oe,D+=i*he,z+=i*pe,G+=i*_e,Y+=i*k,P+=i*K,b+=i*$,w+=i*Z,S+=i*I,C+=i*U,B+=i*V,W+=i*N,i=e[13],A+=i*L,R+=i*ae,F+=i*X,q+=i*ne,D+=i*oe,z+=i*he,G+=i*pe,Y+=i*_e,P+=i*k,b+=i*K,w+=i*$,S+=i*Z,C+=i*I,B+=i*U,W+=i*V,j+=i*N,i=e[14],R+=i*L,F+=i*ae,q+=i*X,D+=i*ne,z+=i*oe,G+=i*he,Y+=i*pe,P+=i*_e,b+=i*k,w+=i*K,S+=i*$,C+=i*Z,B+=i*I,W+=i*U,j+=i*V,M+=i*N,i=e[15],F+=i*L,q+=i*ae,D+=i*X,z+=i*ne,G+=i*oe,Y+=i*he,P+=i*pe,b+=i*_e,w+=i*k,S+=i*K,C+=i*$,B+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*N,s+=38*q,o+=38*D,a+=38*z,c+=38*G,u+=38*Y,l+=38*P,d+=38*b,h+=38*w,p+=38*S,g+=38*C,m+=38*B,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=d,t[7]=h,t[8]=p,t[9]=g,t[10]=m,t[11]=E,t[12]=v,t[13]=A,t[14]=R,t[15]=F}function ym(t,e){vu(t,e,e)}function hmt(t,e){for(var r=hc(),i=0;i<16;i++)r[i]=e[i];for(var i=253;i>=0;i--)ym(r,r),i!==2&&i!==4&&vu(r,r,e);for(var i=0;i<16;i++)t[i]=r[i]}function XO(t,e){for(var r=new Uint8Array(32),i=new Float64Array(80),n=hc(),s=hc(),o=hc(),a=hc(),c=hc(),u=hc(),l=0;l<31;l++)r[l]=t[l];r[31]=t[31]&127|64,r[0]&=248,dmt(i,e);for(var l=0;l<16;l++)s[l]=i[l];n[0]=a[0]=1;for(var l=254;l>=0;--l){var d=r[l>>>3]>>>(l&7)&1;pm(n,s,d),pm(o,a,d),C3(c,n,o),O3(n,n,o),C3(o,s,a),O3(s,s,a),ym(a,c),ym(u,n),vu(n,o,n),vu(o,s,c),C3(c,n,o),O3(n,n,o),ym(s,n),O3(o,a,u),vu(n,o,lmt),C3(n,n,a),vu(o,o,n),vu(n,a,u),vu(a,s,i),ym(s,c),pm(n,s,d),pm(o,a,d)}for(var l=0;l<16;l++)i[l+16]=n[l],i[l+32]=o[l],i[l+48]=s[l],i[l+64]=a[l];var h=i.subarray(32),p=i.subarray(16);hmt(h,h),vu(p,p,h);var g=new Uint8Array(32);return fmt(g,p),g}es.scalarMult=XO;function nEe(t){return XO(t,iEe)}es.scalarMultBase=nEe;function sEe(t){if(t.length!==es.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+es.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(t),r=nEe(e);return{publicKey:r,secretKey:e}}es.generateKeyPairFromSeed=sEe;function pmt(t){var e=cmt.randomBytes(32,t),r=sEe(e);return umt.wipe(e),r}es.generateKeyPair=pmt;function ymt(t,e,r){if(r===void 0&&(r=!1),t.length!==es.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==es.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=XO(t,e);if(r){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}es.sharedKey=ymt});var cEe=y((I9t,aEe)=>{f();"use strict";var gmt=SR(),bmt=P0(),oEe=Wo();aEe.exports=(t,e={})=>{let r=bmt(t),i=oEe.decode.fromReader(r.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await r.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=gmt(a)?a:a.slice();return o.decode(c)},write:o=>{r.writer.push(o)},writeLP:o=>{s.write(oEe.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(r.rest(),r.stream)};return s}});var lEe=y((T9t,uEe)=>{f();"use strict";var mmt=YE();uEe.exports=function(){let e,r,i=async s=>{if(e)throw new Error("already piped");e=mmt(s),r&&r(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{r=o=>{r=null,s(o.next())}})}};return{sink:i,source:n}}});var hEe=y((R9t,dEe)=>{f();var fEe=lEe();dEe.exports=function(){var t=fEe(),e=fEe();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}});var pEe=y(QO=>{f();"use strict";Object.defineProperty(QO,"__esModule",{value:!0});function vmt(t){return typeof t.saveState!="undefined"&&typeof t.restoreState!="undefined"&&typeof t.cleanSavedState!="undefined"}QO.isSerializableHash=vmt});var q3=y(cy=>{f();"use strict";Object.defineProperty(cy,"__esModule",{value:!0});function wmt(t,e,r){return~(t-1)&e|t-1&r}cy.select=wmt;function _mt(t,e){return(t|0)-(e|0)-1>>>31&1}cy.lessOrEqual=_mt;function yEe(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}cy.compare=yEe;function Emt(t,e){return t.length===0||e.length===0?!1:yEe(t,e)!==0}cy.equal=Emt});var bEe=y(gm=>{f();"use strict";Object.defineProperty(gm,"__esModule",{value:!0});var pc=pEe(),Smt=q3(),xmt=dc(),gEe=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),pc.isSerializableHash(this._inner)&&pc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),xmt.wipe(i)}return t.prototype.reset=function(){if(!pc.isSerializableHash(this._inner)||!pc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){pc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),pc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!pc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!pc.isSerializableHash(this._inner)||!pc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!pc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();gm.HMAC=gEe;function Amt(t,e,r){var i=new gEe(t,e);i.update(r);var n=i.digest();return i.clean(),n}gm.hmac=Amt;gm.equal=Smt.equal});var wEe=y(ZO=>{f();"use strict";Object.defineProperty(ZO,"__esModule",{value:!0});var mEe=bEe(),vEe=dc(),Imt=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=mEe.hmac(this._hash,i,r);this._hmac=new mEe.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),vEe.wipe(this._buffer),vEe.wipe(this._counter),this._bufpos=0},t}();ZO.HKDF=Imt});var ek=y(Wl=>{f();"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});var D3=hm(),N3=dc();Wl.DIGEST_LENGTH=32;Wl.BLOCK_SIZE=64;var _Ee=function(){function t(){this.digestLength=Wl.DIGEST_LENGTH,this.blockSize=Wl.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return t.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},t.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},t.prototype.clean=function(){N3.wipe(this._buffer),N3.wipe(this._temp),this.reset()},t.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[i++],r--;this._bufferLength===this.blockSize&&(JO(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(i=JO(this._temp,this._state,e,i,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[i++],r--;return this},t.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,i=this._bufferLength,n=r/536870912|0,s=r<<3,o=r%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;D3.writeUint32BE(n,this._buffer,o-8),D3.writeUint32BE(s,this._buffer,o-4),JO(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)D3.writeUint32BE(this._state[a],e,a*4);return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},t.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},t.prototype.cleanSavedState=function(e){N3.wipe(e.state),e.buffer&&N3.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},t}();Wl.SHA256=_Ee;var Tmt=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function JO(t,e,r,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],l=e[5],d=e[6],h=e[7],p=0;p<16;p++){var g=i+p*4;t[p]=D3.readUint32BE(r,g)}for(var p=16;p<64;p++){var m=t[p-2],E=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=t[p-15];var v=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;t[p]=(E+t[p-7]|0)+(v+t[p-16]|0)}for(var p=0;p<64;p++){var E=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&l^~u&d)|0)+(h+(Tmt[p]+t[p]|0)|0)|0,v=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;h=d,d=l,l=u,u=c+E|0,c=a,a=o,o=s,s=E+v|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=l,e[6]+=d,e[7]+=h,i+=64,n-=64}return i}function Rmt(t){var e=new _Ee;e.update(t);var r=e.digest();return e.clean(),r}Wl.hash=Rmt});var SEe=y((EEe,bm)=>{f();"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof oa=="function"&&typeof bm=="object"&&bm&&bm.exports&&(bm.exports=e(ki()))})(EEe,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots["libp2p-noise"]||(t.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=r.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.pb.NoiseHandshakePayload;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.identityKey=c.bytes();break;case 2:d.identitySig=c.bytes();break;case 3:d.data=c.bytes();break;default:c.skipType(h&7);break}}return d},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var u=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,u.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,u.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,u.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var l={};return u.defaults&&(u.bytes===String?l.identityKey="":(l.identityKey=[],u.bytes!==Array&&(l.identityKey=i.newBuffer(l.identityKey))),u.bytes===String?l.identitySig="":(l.identitySig=[],u.bytes!==Array&&(l.identitySig=i.newBuffer(l.identitySig))),u.bytes===String?l.data="":(l.data=[],u.bytes!==Array&&(l.data=i.newBuffer(l.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(l.identityKey=u.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(l.identitySig=u.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(l.data=u.bytes===String?i.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s}(),n})});var Yl=y(Gt=>{f();"use strict";var Pmt=Gt&&Gt.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Cmt=Gt&&Gt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Omt=Gt&&Gt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Pmt(e,t,r);return Cmt(e,t),e},kmt=Gt&&Gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.isValidPublicKey=Gt.getHkdf=Gt.verifySignedPayload=Gt.getHandshakePayload=Gt.decodePayload=Gt.getPeerIdFromPayload=Gt.signPayload=Gt.createHandshakePayload=Gt.getPayload=Gt.generateKeypair=void 0;var qmt=wEe(),Dmt=ek(),Nmt=Omt(k3()),ts=Vt(),tk=kmt(rt()),Bmt=Na(),Mmt=SEe(),Lmt=(di(),fi),B3=Mmt.pb.NoiseHandshakePayload;function Umt(){let t=Nmt.generateKeyPair();return{publicKey:ts.Buffer.from(t.publicKey.buffer,t.publicKey.byteOffset,t.publicKey.length),privateKey:ts.Buffer.from(t.secretKey.buffer,t.secretKey.byteOffset,t.secretKey.length)}}Gt.generateKeypair=Umt;async function Fmt(t,e,r){let i=await AEe(t,rk(e)),n=r??ts.Buffer.alloc(0);return xEe(t.marshalPubKey(),i,n)}Gt.getPayload=Fmt;function xEe(t,e,r){let i=B3.create({identityKey:ts.Buffer.from(t),identitySig:e,data:r??null});return ts.Buffer.from(B3.encode(i).finish())}Gt.createHandshakePayload=xEe;async function AEe(t,e){return ts.Buffer.from(await t.privKey.sign(e))}Gt.signPayload=AEe;async function Kmt(t){return await tk.default.createFromPubKey(ts.Buffer.from(t.identityKey))}Gt.getPeerIdFromPayload=Kmt;function jmt(t){return B3.toObject(B3.decode(ts.Buffer.from(t)))}Gt.decodePayload=jmt;function rk(t){return ts.Buffer.concat([ts.Buffer.from("noise-libp2p-static-key:"),t])}Gt.getHandshakePayload=rk;async function Vmt(t,e){let r=await tk.default.createFromPubKey(e);return Lmt.equals(r.id,t)}async function zmt(t,e,r){let i=ts.Buffer.from(e.identityKey);if(!await Vmt(r.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=rk(t),s=Bmt.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,ts.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await tk.default.createFromPubKey(i)}Gt.verifySignedPayload=zmt;function Hmt(t,e){let i=new qmt.HKDF(Dmt.SHA256,e,t).expand(96),n=ts.Buffer.from(i.buffer,i.byteOffset,i.length),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}Gt.getHkdf=Hmt;function $mt(t){return!(!ts.Buffer.isBuffer(t)||t.length!==32)}Gt.isValidPublicKey=$mt});var TEe=y(M3=>{f();"use strict";Object.defineProperty(M3,"__esModule",{value:!0});var wn=hm(),ik=dc(),Gmt=20;function Wmt(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],d=r[19]<<24|r[18]<<16|r[17]<<8|r[16],h=r[23]<<24|r[22]<<16|r[21]<<8|r[20],p=r[27]<<24|r[26]<<16|r[25]<<8|r[24],g=r[31]<<24|r[30]<<16|r[29]<<8|r[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],E=e[7]<<24|e[6]<<16|e[5]<<8|e[4],v=e[11]<<24|e[10]<<16|e[9]<<8|e[8],A=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=i,F=n,q=s,D=o,z=a,G=c,Y=u,P=l,b=d,w=h,S=p,C=g,B=m,W=E,j=v,M=A,_=0;_<Gmt;_+=2)R=R+z|0,B^=R,B=B>>>32-16|B<<16,b=b+B|0,z^=b,z=z>>>32-12|z<<12,F=F+G|0,W^=F,W=W>>>32-16|W<<16,w=w+W|0,G^=w,G=G>>>32-12|G<<12,q=q+Y|0,j^=q,j=j>>>32-16|j<<16,S=S+j|0,Y^=S,Y=Y>>>32-12|Y<<12,D=D+P|0,M^=D,M=M>>>32-16|M<<16,C=C+M|0,P^=C,P=P>>>32-12|P<<12,q=q+Y|0,j^=q,j=j>>>32-8|j<<8,S=S+j|0,Y^=S,Y=Y>>>32-7|Y<<7,D=D+P|0,M^=D,M=M>>>32-8|M<<8,C=C+M|0,P^=C,P=P>>>32-7|P<<7,F=F+G|0,W^=F,W=W>>>32-8|W<<8,w=w+W|0,G^=w,G=G>>>32-7|G<<7,R=R+z|0,B^=R,B=B>>>32-8|B<<8,b=b+B|0,z^=b,z=z>>>32-7|z<<7,R=R+G|0,M^=R,M=M>>>32-16|M<<16,S=S+M|0,G^=S,G=G>>>32-12|G<<12,F=F+Y|0,B^=F,B=B>>>32-16|B<<16,C=C+B|0,Y^=C,Y=Y>>>32-12|Y<<12,q=q+P|0,W^=q,W=W>>>32-16|W<<16,b=b+W|0,P^=b,P=P>>>32-12|P<<12,D=D+z|0,j^=D,j=j>>>32-16|j<<16,w=w+j|0,z^=w,z=z>>>32-12|z<<12,q=q+P|0,W^=q,W=W>>>32-8|W<<8,b=b+W|0,P^=b,P=P>>>32-7|P<<7,D=D+z|0,j^=D,j=j>>>32-8|j<<8,w=w+j|0,z^=w,z=z>>>32-7|z<<7,F=F+Y|0,B^=F,B=B>>>32-8|B<<8,C=C+B|0,Y^=C,Y=Y>>>32-7|Y<<7,R=R+G|0,M^=R,M=M>>>32-8|M<<8,S=S+M|0,G^=S,G=G>>>32-7|G<<7;wn.writeUint32LE(R+i|0,t,0),wn.writeUint32LE(F+n|0,t,4),wn.writeUint32LE(q+s|0,t,8),wn.writeUint32LE(D+o|0,t,12),wn.writeUint32LE(z+a|0,t,16),wn.writeUint32LE(G+c|0,t,20),wn.writeUint32LE(Y+u|0,t,24),wn.writeUint32LE(P+l|0,t,28),wn.writeUint32LE(b+d|0,t,32),wn.writeUint32LE(w+h|0,t,36),wn.writeUint32LE(S+p|0,t,40),wn.writeUint32LE(C+g|0,t,44),wn.writeUint32LE(B+m|0,t,48),wn.writeUint32LE(W+E|0,t,52),wn.writeUint32LE(j+v|0,t,56),wn.writeUint32LE(M+A|0,t,60)}function IEe(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<r.length;c+=64){Wmt(a,s,t);for(var u=c;u<c+64&&u<r.length;u++)i[u]=r[u]^a[u-c];Xmt(s,0,o)}return ik.wipe(a),n===0&&ik.wipe(s),i}M3.streamXOR=IEe;function Ymt(t,e,r,i){return i===void 0&&(i=0),ik.wipe(r),IEe(t,e,r,r,i)}M3.stream=Ymt;function Xmt(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var PEe=y(wu=>{f();"use strict";Object.defineProperty(wu,"__esModule",{value:!0});var Qmt=q3(),L3=dc();wu.DIGEST_LENGTH=16;var REe=function(){function t(e){this.digestLength=wu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var i=e[2]|e[3]<<8;this._r[1]=(r>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return t.prototype._blocks=function(e,r,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],l=this._h[5],d=this._h[6],h=this._h[7],p=this._h[8],g=this._h[9],m=this._r[0],E=this._r[1],v=this._r[2],A=this._r[3],R=this._r[4],F=this._r[5],q=this._r[6],D=this._r[7],z=this._r[8],G=this._r[9];i>=16;){var Y=e[r+0]|e[r+1]<<8;s+=Y&8191;var P=e[r+2]|e[r+3]<<8;o+=(Y>>>13|P<<3)&8191;var b=e[r+4]|e[r+5]<<8;a+=(P>>>10|b<<6)&8191;var w=e[r+6]|e[r+7]<<8;c+=(b>>>7|w<<9)&8191;var S=e[r+8]|e[r+9]<<8;u+=(w>>>4|S<<12)&8191,l+=S>>>1&8191;var C=e[r+10]|e[r+11]<<8;d+=(S>>>14|C<<2)&8191;var B=e[r+12]|e[r+13]<<8;h+=(C>>>11|B<<5)&8191;var W=e[r+14]|e[r+15]<<8;p+=(B>>>8|W<<8)&8191,g+=W>>>5|n;var j=0,M=j;M+=s*m,M+=o*(5*G),M+=a*(5*z),M+=c*(5*D),M+=u*(5*q),j=M>>>13,M&=8191,M+=l*(5*F),M+=d*(5*R),M+=h*(5*A),M+=p*(5*v),M+=g*(5*E),j+=M>>>13,M&=8191;var _=j;_+=s*E,_+=o*m,_+=a*(5*G),_+=c*(5*z),_+=u*(5*D),j=_>>>13,_&=8191,_+=l*(5*q),_+=d*(5*F),_+=h*(5*R),_+=p*(5*A),_+=g*(5*v),j+=_>>>13,_&=8191;var L=j;L+=s*v,L+=o*E,L+=a*m,L+=c*(5*G),L+=u*(5*z),j=L>>>13,L&=8191,L+=l*(5*D),L+=d*(5*q),L+=h*(5*F),L+=p*(5*R),L+=g*(5*A),j+=L>>>13,L&=8191;var ae=j;ae+=s*A,ae+=o*v,ae+=a*E,ae+=c*m,ae+=u*(5*G),j=ae>>>13,ae&=8191,ae+=l*(5*z),ae+=d*(5*D),ae+=h*(5*q),ae+=p*(5*F),ae+=g*(5*R),j+=ae>>>13,ae&=8191;var X=j;X+=s*R,X+=o*A,X+=a*v,X+=c*E,X+=u*m,j=X>>>13,X&=8191,X+=l*(5*G),X+=d*(5*z),X+=h*(5*D),X+=p*(5*q),X+=g*(5*F),j+=X>>>13,X&=8191;var ne=j;ne+=s*F,ne+=o*R,ne+=a*A,ne+=c*v,ne+=u*E,j=ne>>>13,ne&=8191,ne+=l*m,ne+=d*(5*G),ne+=h*(5*z),ne+=p*(5*D),ne+=g*(5*q),j+=ne>>>13,ne&=8191;var oe=j;oe+=s*q,oe+=o*F,oe+=a*R,oe+=c*A,oe+=u*v,j=oe>>>13,oe&=8191,oe+=l*E,oe+=d*m,oe+=h*(5*G),oe+=p*(5*z),oe+=g*(5*D),j+=oe>>>13,oe&=8191;var he=j;he+=s*D,he+=o*q,he+=a*F,he+=c*R,he+=u*A,j=he>>>13,he&=8191,he+=l*v,he+=d*E,he+=h*m,he+=p*(5*G),he+=g*(5*z),j+=he>>>13,he&=8191;var pe=j;pe+=s*z,pe+=o*D,pe+=a*q,pe+=c*F,pe+=u*R,j=pe>>>13,pe&=8191,pe+=l*A,pe+=d*v,pe+=h*E,pe+=p*m,pe+=g*(5*G),j+=pe>>>13,pe&=8191;var _e=j;_e+=s*G,_e+=o*z,_e+=a*D,_e+=c*q,_e+=u*F,j=_e>>>13,_e&=8191,_e+=l*R,_e+=d*A,_e+=h*v,_e+=p*E,_e+=g*m,j+=_e>>>13,_e&=8191,j=(j<<2)+j|0,j=j+M|0,M=j&8191,j=j>>>13,_+=j,s=M,o=_,a=L,c=ae,u=X,l=ne,d=oe,h=he,p=pe,g=_e,r+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=l,this._h[6]=d,this._h[7]=h,this._h[8]=p,this._h[9]=g},t.prototype.finish=function(e,r){r===void 0&&(r=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var r=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];if(i-=n,r+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,r,n),r+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=i}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return L3.wipe(this._buffer),L3.wipe(this._r),L3.wipe(this._h),L3.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();wu.Poly1305=REe;function Zmt(t,e){var r=new REe(t);r.update(e);var i=r.digest();return r.clean(),i}wu.oneTimeAuth=Zmt;function Jmt(t,e){return t.length!==wu.DIGEST_LENGTH||e.length!==wu.DIGEST_LENGTH?!1:Qmt.equal(t,e)}wu.equal=Jmt});var kEe=y(_u=>{f();"use strict";Object.defineProperty(_u,"__esModule",{value:!0});var U3=TEe(),evt=PEe(),mm=dc(),CEe=hm(),tvt=q3();_u.KEY_LENGTH=32;_u.NONCE_LENGTH=12;_u.TAG_LENGTH=16;var OEe=new Uint8Array(16),rvt=function(){function t(e){if(this.nonceLength=_u.NONCE_LENGTH,this.tagLength=_u.TAG_LENGTH,e.length!==_u.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return t.prototype.seal=function(e,r,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);U3.stream(this._key,s,o,4);var a=r.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return U3.streamXOR(this._key,s,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),mm.wipe(s),c},t.prototype.open=function(e,r,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);U3.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,r.subarray(0,r.length-this.tagLength),i),!tvt.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,u;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=n}else u=new Uint8Array(c);return U3.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),u,4),mm.wipe(s),u},t.prototype.clean=function(){return mm.wipe(this._key),this},t.prototype._authenticate=function(e,r,i,n){var s=new evt.Poly1305(r);n&&(s.update(n),n.length%16>0&&s.update(OEe.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(OEe.subarray(i.length%16));var o=new Uint8Array(8);n&&CEe.writeUint64LE(n.length,o),s.update(o),CEe.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),mm.wipe(a),mm.wipe(o)},t}();_u.ChaCha20Poly1305=rvt});var F3=y(Eu=>{f();"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});Eu.DUMP_SESSION_KEYS=Eu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Eu.NOISE_MSG_MAX_LENGTH_BYTES=void 0;Eu.NOISE_MSG_MAX_LENGTH_BYTES=65535;Eu.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Eu.NOISE_MSG_MAX_LENGTH_BYTES-16;Eu.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var uy=y(tn=>{f();"use strict";var ivt=tn&&tn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(tn,"__esModule",{value:!0});tn.logCipherState=tn.logRemoteEphemeralKey=tn.logRemoteStaticKey=tn.logLocalEphemeralKeys=tn.logLocalStaticKeys=tn.logger=void 0;var nvt=ivt(me()),svt=F3();tn.logger=nvt.default("libp2p:noise");var ao;svt.DUMP_SESSION_KEYS?ao=tn.logger:ao=()=>{};function ovt(t){ao(`LOCAL_STATIC_PUBLIC_KEY ${t.publicKey.toString("hex")}`),ao(`LOCAL_STATIC_PRIVATE_KEY ${t.privateKey.toString("hex")}`)}tn.logLocalStaticKeys=ovt;function avt(t){t?(ao(`LOCAL_PUBLIC_EPHEMERAL_KEY ${t.publicKey.toString("hex")}`),ao(`LOCAL_PRIVATE_EPHEMERAL_KEY ${t.privateKey.toString("hex")}`)):ao("Missing local ephemeral keys.")}tn.logLocalEphemeralKeys=avt;function cvt(t){ao(`REMOTE_STATIC_PUBLIC_KEY ${t.toString("hex")}`)}tn.logRemoteStaticKey=cvt;function uvt(t){ao(`REMOTE_EPHEMERAL_PUBLIC_KEY ${t.toString("hex")}`)}tn.logRemoteEphemeralKey=uvt;function lvt(t){t.cs1&&t.cs2?(ao(`CIPHER_STATE_1 ${t.cs1.n} ${t.cs1.k.toString("hex")}`),ao(`CIPHER_STATE_2 ${t.cs2.n} ${t.cs2.k.toString("hex")}`)):ao("Missing cipher state.")}tn.logCipherState=lvt});var nk=y(_s=>{f();"use strict";var fvt=_s&&_s.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),dvt=_s&&_s.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),qEe=_s&&_s.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fvt(e,t,r);return dvt(e,t),e};Object.defineProperty(_s,"__esModule",{value:!0});_s.AbstractHandshake=_s.MIN_NONCE=void 0;var rn=Vt(),hvt=qEe(k3()),pvt=qEe(ek()),DEe=kEe(),NEe=Yl(),yvt=uy();_s.MIN_NONCE=0;var BEe=class{encryptWithAd(e,r,i){let n=this.encrypt(e.k,e.n,r,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,r,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,r,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,r){e.n=r}createEmptyKey(){return rn.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let r=rn.Buffer.alloc(12);return r.writeUInt32LE(e,4),r}encrypt(e,r,i,n){let s=this.nonceToBytes(r),a=new DEe.ChaCha20Poly1305(e).seal(s,n,i);return rn.Buffer.from(a.buffer,a.byteOffset,a.length)}encryptAndHash(e,r){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,r):i=r,this.mixHash(e,i),i}decrypt(e,r,i,n){let s=this.nonceToBytes(r),a=new DEe.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:rn.Buffer.from(a.buffer,a.byteOffset,a.length),valid:!0}:{plaintext:rn.Buffer.from(""),valid:!1}}decryptAndHash(e,r){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,r):i=r,this.mixHash(e,r),{plaintext:i,valid:n}}dh(e,r){try{let i=hvt.sharedKey(e,r),n=rn.Buffer.from(i.buffer,i.byteOffset,i.length),s=rn.Buffer.alloc(32);return n.copy(s),s}catch(i){return yvt.logger(i.message),rn.Buffer.alloc(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){let i=pvt.hash(rn.Buffer.from([...e,...r]));return rn.Buffer.from(i.buffer,i.byteOffset,i.length)}mixKey(e,r){let[i,n]=NEe.getHkdf(e.ck,r);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let r=_s.MIN_NONCE;return{k:e,n:r}}initializeSymmetric(e){let r=rn.Buffer.from(e,"utf-8"),i=this.hashProtocolName(r),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let r=rn.Buffer.alloc(32);return e.copy(r),r}else return this.getHash(e,rn.Buffer.alloc(0))}split(e){let[r,i]=NEe.getHkdf(e.ck,rn.Buffer.alloc(0)),n=this.initializeKey(r),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,r){let i=this.encryptWithAd(e,rn.Buffer.alloc(0),r),n=this.createEmptyKey(),s=rn.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,r){return this.decryptWithAd(e,rn.Buffer.alloc(0),r.ciphertext)}};_s.AbstractHandshake=BEe});var LEe=y(K3=>{f();"use strict";Object.defineProperty(K3,"__esModule",{value:!0});K3.XX=void 0;var Wd=Vt(),ly=Yl(),gvt=nk(),MEe=class extends gvt.AbstractHandshake{initializeInitiator(e,r,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=Wd.Buffer.alloc(32);return{ss:o,s:r,rs:i,psk:n,re:a}}initializeResponder(e,r,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=Wd.Buffer.alloc(32);return{ss:o,s:r,rs:i,psk:n,re:a}}writeMessageA(e,r,i){let n=Wd.Buffer.alloc(0);i!==void 0?e.e=i:e.e=ly.generateKeypair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,r);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,r){e.e=ly.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=Wd.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,r){let i=Wd.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,r){return ly.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(ly.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);n&&i.length===32&&ly.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,r){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);if(n&&i.length===32&&ly.isValidPublicKey(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,r,i){let n=this.createEmptyKey(),s=Wd.Buffer.alloc(32),o;return e?o=this.initializeInitiator(r,i,s,n):o=this.initializeResponder(r,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,r,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,r,i);else if(e.mc===1)n=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,r){let i=Wd.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,r);i=o,n=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}};K3.XX=MEe});var vm=y(bi=>{f();"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.decode2=bi.decode1=bi.decode0=bi.encode2=bi.encode1=bi.encode0=bi.uint16BEDecode=bi.uint16BEEncode=void 0;var fy=Vt(),bvt=(t,e,r)=>(e=e||fy.Buffer.allocUnsafe(2),e.writeUInt16BE(t,r),e);bi.uint16BEEncode=bvt;bi.uint16BEEncode.bytes=2;var mvt=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t.readUInt16BE(0)};bi.uint16BEDecode=mvt;bi.uint16BEDecode.bytes=2;function vvt(t){return fy.Buffer.concat([t.ne,t.ciphertext])}bi.encode0=vvt;function wvt(t){return fy.Buffer.concat([t.ne,t.ns,t.ciphertext])}bi.encode1=wvt;function _vt(t){return fy.Buffer.concat([t.ns,t.ciphertext])}bi.encode2=_vt;function Evt(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.slice(0,32),ciphertext:t.slice(32,t.length),ns:fy.Buffer.alloc(0)}}bi.decode0=Evt;function Svt(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.slice(0,32),ns:t.slice(32,80),ciphertext:t.slice(80,t.length)}}bi.decode1=Svt;function xvt(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:fy.Buffer.alloc(0),ns:t.slice(0,48),ciphertext:t.slice(48,t.length)}}bi.decode2=xvt});var sk=y(j3=>{f();"use strict";Object.defineProperty(j3,"__esModule",{value:!0});j3.XXHandshake=void 0;var wm=Vt(),Avt=LEe(),dy=Yl(),ai=uy(),hy=vm(),UEe=class{constructor(e,r,i,n,s,o,a){this.isInitiator=e,this.payload=r,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new Avt.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=wm.Buffer.alloc(0)}async propose(){if(ai.logLocalStaticKeys(this.session.hs.s),this.isInitiator){ai.logger("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,wm.Buffer.alloc(0));this.connection.writeLP(hy.encode0(e)),ai.logger("Stage 0 - Initiator finished sending first message."),ai.logLocalEphemeralKeys(this.session.hs.e)}else{ai.logger("Stage 0 - Responder waiting to receive first message...");let e=hy.decode0((await this.connection.readLP()).slice()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Error("xx handshake stage 0 validation fail");ai.logger("Stage 0 - Responder received first message."),ai.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){ai.logger("Stage 1 - Initiator waiting to receive first message from responder...");let e=hy.decode1((await this.connection.readLP()).slice()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");ai.logger("Stage 1 - Initiator received the message."),ai.logRemoteEphemeralKey(this.session.hs.re),ai.logRemoteStaticKey(this.session.hs.rs),ai.logger("Initiator going to check remote's signature...");try{let n=await dy.decodePayload(r);this.remotePeer=this.remotePeer||await dy.getPeerIdFromPayload(n),this.remotePeer=await dy.verifySignedPayload(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}ai.logger("All good with the signature!")}else{ai.logger("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(hy.encode1(e)),ai.logger("Stage 1 - Responder sent the second handshake message with signed payload."),ai.logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){ai.logger("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(hy.encode2(e)),ai.logger("Stage 2 - Initiator sent message with signed payload.")}else{ai.logger("Stage 2 - Responder waiting for third handshake message...");let e=hy.decode2((await this.connection.readLP()).slice()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");ai.logger("Stage 2 - Responder received the message, finished handshake.");try{let n=await dy.decodePayload(r);this.remotePeer=this.remotePeer||await dy.getPeerIdFromPayload(n),await dy.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}ai.logCipherState(this.session)}encrypt(e,r){let i=this.getCS(r);return this.xx.encryptWithAd(i,wm.Buffer.alloc(0),e)}decrypt(e,r){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,wm.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=wm.Buffer.from(e.buffer,e.byteOffset,e.length))}};j3.XXHandshake=UEe});var KEe=y(z3=>{f();"use strict";Object.defineProperty(z3,"__esModule",{value:!0});z3.IK=void 0;var V3=Vt(),_m=Yl(),Ivt=nk(),FEe=class extends Ivt.AbstractHandshake{initSession(e,r,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(r,i,n,s):o=this.initializeResponder(r,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,r){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,r);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let i=V3.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,r)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,r);i=s,n=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,r){e.e=_m.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=V3.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,r);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,r){e.e=_m.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,r),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,r){_m.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);n&&i.length===32&&_m.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,r){if(_m.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,r,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=V3.Buffer.alloc(32);return{ss:o,s:r,rs:i,re:a,psk:n}}initializeResponder(e,r,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,r.publicKey);let a=V3.Buffer.alloc(32);return{ss:o,s:r,rs:i,re:a,psk:n}}};z3.IK=FEe});var VEe=y(H3=>{f();"use strict";Object.defineProperty(H3,"__esModule",{value:!0});H3.FailedIKError=void 0;var jEe=class extends Error{constructor(e,r){super(r);this.initialMsg=e,this.name="FailedIKhandshake"}};H3.FailedIKError=jEe});var $Ee=y(G3=>{f();"use strict";Object.defineProperty(G3,"__esModule",{value:!0});G3.IKHandshake=void 0;var Tvt=KEe(),py=Vt(),$3=vm(),yy=Yl(),zEe=VEe(),Ti=uy(),HEe=class{constructor(e,r,i,n,s,o,a,c){this.isInitiator=e,this.payload=py.Buffer.from(r),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new Tvt.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=py.Buffer.alloc(0)}async stage0(){if(Ti.logLocalStaticKeys(this.session.hs.s),Ti.logRemoteStaticKey(this.session.hs.rs),this.isInitiator){Ti.logger("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP($3.encode1(e)),Ti.logger("IK Stage 0 - Initiator sent message."),Ti.logLocalEphemeralKeys(this.session.hs.e)}else{Ti.logger("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let r=$3.decode1(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,r);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");Ti.logger("IK Stage 0 - Responder got message, going to verify payload.");let s=await yy.decodePayload(i);this.remotePeer=this.remotePeer||await yy.getPeerIdFromPayload(s),await yy.verifySignedPayload(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),Ti.logger("IK Stage 0 - Responder successfully verified payload!"),Ti.logRemoteEphemeralKey(this.session.hs.re)}catch(r){let i=r;throw Ti.logger("Responder breaking up with IK handshake in stage 0."),new zEe.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){Ti.logger("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),r=$3.decode0(py.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,r);Ti.logger("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await yy.decodePayload(i);this.remotePeer=this.remotePeer||await yy.getPeerIdFromPayload(s),await yy.verifySignedPayload(r.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),Ti.logger("IK Stage 1 - Initiator successfully verified payload!"),Ti.logRemoteEphemeralKey(this.session.hs.re)}catch(s){let o=s;throw Ti.logger("Initiator breaking up with IK handshake in stage 1."),new zEe.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{Ti.logger("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP($3.encode0(e)),Ti.logger("IK Stage 1 - Responder sent message..."),Ti.logLocalEphemeralKeys(this.session.hs.e)}Ti.logCipherState(this.session)}decrypt(e,r){let i=this.getCS(r,!1);return this.ik.decryptWithAd(i,py.Buffer.alloc(0),e)}encrypt(e,r){let i=this.getCS(r);return this.ik.encryptWithAd(i,py.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=py.Buffer.from(e.buffer,e.byteOffset,e.length))}};G3.IKHandshake=HEe});var YEe=y(W3=>{f();"use strict";Object.defineProperty(W3,"__esModule",{value:!0});W3.XXFallbackHandshake=void 0;var ok=Vt(),Rvt=sk(),ak=Yl(),co=uy(),GEe=vm(),WEe=class extends Rvt.XXHandshake{constructor(e,r,i,n,s,o,a,c,u){super(e,r,i,n,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,ok.Buffer.alloc(0),this.ephemeralKeys),co.logger("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),co.logLocalEphemeralKeys(this.session.hs.e);else{co.logger("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=GEe.decode0(this.initialMsg),{valid:r}=this.xx.recvMessage(this.session,{ne:e.ne,ns:ok.Buffer.alloc(0),ciphertext:ok.Buffer.alloc(0)});if(!r)throw new Error("xx fallback stage 0 decryption validation fail");co.logger("XX Fallback Stage 0 - Responder used received message from IK."),co.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=GEe.decode1(this.initialMsg),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");co.logger("XX Fallback Stage 1 - Initiator used received message from IK."),co.logRemoteEphemeralKey(this.session.hs.re),co.logRemoteStaticKey(this.session.hs.rs),co.logger("Initiator going to check remote's signature...");try{let n=await ak.decodePayload(r);this.remotePeer=this.remotePeer||await ak.getPeerIdFromPayload(n),await ak.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}co.logger("All good with the signature!")}else co.logger("XX Fallback Stage 1 - Responder start"),await super.exchange(),co.logger("XX Fallback Stage 1 - Responder end")}};W3.XXFallbackHandshake=WEe});var QEe=y(gy=>{f();"use strict";Object.defineProperty(gy,"__esModule",{value:!0});gy.decryptStream=gy.encryptStream=void 0;var XEe=Vt(),Y3=F3();function Pvt(t){return async function*(e){for await(let r of e){let i=XEe.Buffer.from(r.buffer,r.byteOffset,r.length);for(let n=0;n<i.length;n+=Y3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let s=n+Y3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;s>i.length&&(s=i.length),yield t.encrypt(i.slice(n,s),t.session)}}}}gy.encryptStream=Pvt;function Cvt(t){return async function*(e){for await(let r of e){let i=XEe.Buffer.from(r.buffer,r.byteOffset,r.length);for(let n=0;n<i.length;n+=Y3.NOISE_MSG_MAX_LENGTH_BYTES){let s=n+Y3.NOISE_MSG_MAX_LENGTH_BYTES;s>i.length&&(s=i.length);let o=i.slice(n,s),{plaintext:a,valid:c}=await t.decrypt(o,t.session);if(!c)throw new Error("Failed to validate decrypted chunk");yield a}}}}gy.decryptStream=Cvt});var JEe=y(X3=>{f();"use strict";Object.defineProperty(X3,"__esModule",{value:!0});X3.KeyCache=void 0;var ZEe=class{constructor(){this.storage=new Map}store(e,r){this.storage.set(e.id,r)}load(e){var r;return e&&(r=this.storage.get(e.id))!==null&&r!==void 0?r:null}resetStorage(){this.storage.clear()}},Ovt=new ZEe;X3.KeyCache=Ovt});var uk=y(uo=>{f();"use strict";var kvt=uo&&uo.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),qvt=uo&&uo.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Dvt=uo&&uo.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&kvt(e,t,r);return qvt(e,t),e},Q3=uo&&uo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(uo,"__esModule",{value:!0});uo.Noise=void 0;var Nvt=Dvt(k3()),Em=Vt(),eSe=Q3(cEe()),Bvt=Q3(hEe()),tSe=Q3(FS()),Mvt=Q3(Ar()),rSe=Wo(),Lvt=sk(),Uvt=$Ee(),Fvt=YEe(),iSe=Yl(),by=vm(),nSe=QEe(),ck=JEe(),Kvt=uy(),sSe=F3(),oSe=class{constructor(e,r){if(this.protocol="/noise",this.prologue=Em.Buffer.alloc(0),this.earlyData=r??Em.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=Nvt.generateKeyPairFromSeed(e);this.staticKeys={privateKey:Em.Buffer.from(i.secretKey.buffer,i.secretKey.byteOffset,i.secretKey.length),publicKey:Em.Buffer.from(i.publicKey.buffer,i.publicKey.byteOffset,i.publicKey.length)}}else this.staticKeys=iSe.generateKeypair()}async secureOutbound(e,r,i){let n=eSe.default(r,{lengthEncoder:by.uint16BEEncode,lengthDecoder:by.uint16BEDecode,maxDataLength:sSe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,r,i){let n=eSe.default(r,{lengthEncoder:by.uint16BEEncode,lengthDecoder:by.uint16BEDecode,maxDataLength:sSe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var r;let i=await iSe.getPayload(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&ck.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new Uvt.IKHandshake(a,i,this.prologue,this.staticKeys,o,(r=ck.KeyCache.load(e.remotePeer))!==null&&r!==void 0?r:Em.Buffer.alloc(32),s);try{return await this.performIKHandshake(c)}catch(u){let l;return e.isInitiator&&(l=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,u.initialMsg,l)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,r,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new Fvt.XXFallbackHandshake(s,r,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){Kvt.logger(u);let l=u;throw new Error(`Error occurred during XX Fallback handshake: ${l.message}`)}return c}async performXXHandshake(e,r){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new Lvt.XXHandshake(i,r,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&ck.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,r){let[i,n]=Bvt.default(),s=e.unwrap();return await Mvt.default(i,tSe.default,nSe.encryptStream(r),rSe.encode({lengthEncoder:by.uint16BEEncode}),s,rSe.decode({lengthDecoder:by.uint16BEDecode}),tSe.default,nSe.decryptStream(r),i),n}};uo.Noise=oSe});var aSe=y(Su=>{f();"use strict";var jvt=Su&&Su.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Vvt=Su&&Su.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&jvt(e,t,r)};Object.defineProperty(Su,"__esModule",{value:!0});Su.NOISE=void 0;var zvt=uk();Vvt(uk(),Su);Su.NOISE=new zvt.Noise});var lSe=y((Z9t,uSe)=>{f();"use strict";var Hvt=QC(),{EventEmitter:$vt}=yr();function cSe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0,i=t.length;r<i;++r)if(t[r]!==e[r])return!1;return!0}function lk(){return{contacts:[],dontSplit:!1,left:null,right:null}}function Sm(t,e){if(!(e instanceof Uint8Array))throw new TypeError(t+" is not a Uint8Array")}var xm=class extends $vt{constructor(e={}){super();this.localNodeId=e.localNodeId||Hvt(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||xm.distance,this.arbiter=e.arbiter||xm.arbiter,this.metadata=Object.assign({},e.metadata),Sm("option.localNodeId as parameter 1",this.localNodeId),this.root=lk()}static arbiter(e,r){return e.vectorClock>r.vectorClock?e:r}static distance(e,r){let i=0,n=0,s=Math.min(e.length,r.length),o=Math.max(e.length,r.length);for(;n<s;++n)i=i*256+(e[n]^r[n]);for(;n<o;++n)i=i*256+255;return i}add(e){Sm("contact.id",(e||{}).id);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,r++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,r),this.add(e))}closest(e,r=1/0){if(Sm("id",e),!Number.isInteger(r)&&r!==1/0||r<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<r;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,r).map(n=>n[1])}count(){let e=0;for(let r=[this.root];r.length>0;){let i=r.pop();i.contacts===null?r.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,r,i){let n=i>>3,s=i%8;return r.length<=n&&s!==0?e.left:r[n]&1<<7-s?e.right:e.left}get(e){Sm("id",e);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,r++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,r){for(let i=0;i<e.contacts.length;++i)if(cSe(e.contacts[i].id,r))return i;return-1}remove(e){Sm("the id as parameter 1",e);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,r++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,r){e.left=lk(),e.right=lk();for(let s of e.contacts)this._determineNode(e,s.id,r).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,r),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let r=[this.root];r.length>0;){let i=r.pop();i.contacts===null?r.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let r=e.pop();r.contacts===null?e.push(r.right,r.left):yield*r.contacts}}_update(e,r,i){if(!cSe(e.contacts[r].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[r],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(r,1),e.contacts.push(s),this.emit("updated",n,s))}};uSe.exports=xm});var Z3=y((J9t,fSe)=>{f();fSe.exports=Xl;function Xl(t,e){if(t.length!==e.length)throw new Error("Inputs should have the same length");for(var r=Buffer.allocUnsafe(t.length),i=0;i<t.length;i++)r[i]=t[i]^e[i];return r}Xl.compare=function(e,r){if(e.length!==r.length)throw new Error("Inputs should have the same length");for(var i=0;i<e.length;i++)if(e[i]!==r[i])return e[i]<r[i]?-1:1;return 0};Xl.gt=function(e,r){return Xl.compare(e,r)===1};Xl.lt=function(e,r){return Xl.compare(e,r)===-1};Xl.eq=function(e,r){return Xl.compare(e,r)===0}});var fk=y((eUt,dSe)=>{f();"use strict";var Gvt=IS();dSe.exports=async(t,e,{concurrency:r=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===1/0)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);let o=[],a=[],c=t[Symbol.iterator](),u=!1,l=!1,d=0,h=0,p=()=>{if(u)return;let g=c.next(),m=h;if(h++,g.done){l=!0,d===0&&(!i&&a.length!==0?s(new Gvt(a)):n(o));return}d++,(async()=>{try{let E=await g.value;o[m]=await e(E,m),d--,p()}catch(E){i?(u=!0,s(E)):(a.push(E),d--,p())}})()};for(let g=0;g<r&&(p(),!l);g++);})});var ui=y(ci=>{f();"use strict";var dk=me(),{sha256:hSe}=(ri(),li),{base58btc:Wvt}=(ei(),Jr),{Key:Yvt}=Ut(),pSe=Z3(),Xvt=fk(),{Record:Qvt}=jf(),Zvt=rt(),Jvt=ue(),{fromString:ySe}=(ft(),ht),{toString:gSe}=(tt(),et),{concat:ewt}=(un(),cn),bSe=Vd();ci.convertBuffer=async t=>(await hSe.digest(t)).digest;ci.convertPeerId=async t=>(await hSe.digest(t.id)).digest;ci.bufferToKey=t=>new Yvt("/"+ci.encodeBase32(t),!1);ci.keyForPublicKey=t=>ewt([ySe("/pk/"),t.id]);ci.isPublicKeyKey=t=>gSe(t.slice(0,4))==="/pk/";ci.fromPublicKeyKey=t=>new Zvt(t.slice(4));ci.now=()=>Date.now();ci.encodeBase32=t=>gSe(t,"base32");ci.decodeBase32=t=>ySe(t,"base32");ci.sortClosestPeers=async(t,e)=>(await Xvt(t,async i=>{let n=await ci.convertPeerId(i);return{peer:i,distance:pSe(n,e)}})).sort(ci.xorCompare).map(i=>i.peer);ci.xorCompare=(t,e)=>pSe.compare(t.distance,e.distance);ci.pathSize=(t,e)=>Math.ceil(t/e);ci.createPutRecord=(t,e)=>{let r=new Date;return new Qvt(t,e,r).serialize()};ci.logger=(t,e)=>{let r=["libp2p","dht"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),dk.formatters.b=n=>Wvt.baseEncode(n),Object.assign(dk(r.join(":")),{error:dk(r.concat(["error"]).join(":"))})};ci.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}};ci.withTimeout=(t,e)=>{async function r(...i){if(!e)return t(...i);let n;try{n=await bSe(t(...i),e)}catch(s){throw s instanceof bSe.TimeoutError?Jvt(s,"ETIMEDOUT"):s}return n}return r};ci.mapParallel=async function(t,e){let r=[];for await(let i of t)r.push(e(i));return Promise.all(r)}});var wSe=y((iUt,vSe)=>{f();"use strict";var twt=lSe(),J3=ui(),mSe=class{constructor(e,r){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(r)}async _onInit(e){let r=await J3.convertPeerId(this.self);this.kb=new twt({localNodeId:r,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,r){let i=e[0];i&&this.kb.remove(i.id),this.kb.add(r)}get size(){return this.kb.count()}async find(e){let r=await J3.convertPeerId(e),i=this.closestPeer(r);if(i&&e.equals(i))return i}closestPeer(e){let r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,r){return this.kb.closest(e,r).map(n=>n.peer)}async add(e){let r=await J3.convertPeerId(e);this.kb.add({id:r,peer:e})}async remove(e){let r=await J3.convertPeerId(e);this.kb.remove(r)}};vSe.exports=mSe});var Ql=y(Bn=>{f();"use strict";var ex=Bn.second=1e3,_Se=Bn.minute=60*ex,hk=Bn.hour=60*_Se;Bn.MAX_RECORD_AGE=36*hk;Bn.PROTOCOL_DHT="/kad/1.0.0";Bn.PROVIDERS_KEY_PREFIX="/providers/";Bn.PROVIDERS_LRU_CACHE_SIZE=256;Bn.PROVIDERS_VALIDITY=24*hk;Bn.PROVIDERS_CLEANUP_INTERVAL=hk;Bn.READ_MESSAGE_TIMEOUT=10*ex;Bn.GET_MANY_RECORD_COUNT=16;Bn.K=20;Bn.ALPHA=3;Bn.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*_Se,timeout:10*ex,delay:10*ex}});var SSe=y((sUt,ESe)=>{f();"use strict";var Zl=ki(),my=Zl.Reader,pk=Zl.Writer,Ge=Zl.util,Xr=Zl.roots["libp2p-dht-message"]||(Zl.roots["libp2p-dht-message"]={});Xr.Record=function(){function t(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.key=null,t.prototype.value=null,t.prototype.author=null,t.prototype.signature=null,t.prototype.timeReceived=null;var e;return Object.defineProperty(t.prototype,"_key",{get:Ge.oneOfGetter(e=["key"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_value",{get:Ge.oneOfGetter(e=["value"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_author",{get:Ge.oneOfGetter(e=["author"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_signature",{get:Ge.oneOfGetter(e=["signature"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_timeReceived",{get:Ge.oneOfGetter(e=["timeReceived"]),set:Ge.oneOfSetter(e)}),t.encode=function(i,n){return n||(n=pk.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},t.decode=function(i,n){i instanceof my||(i=my.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Xr.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},t.fromObject=function(i){if(i instanceof Xr.Record)return i;var n=new Xr.Record;return i.key!=null&&(typeof i.key=="string"?Ge.base64.decode(i.key,n.key=Ge.newBuffer(Ge.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?Ge.base64.decode(i.value,n.value=Ge.newBuffer(Ge.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?Ge.base64.decode(i.author,n.author=Ge.newBuffer(Ge.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?Ge.base64.decode(i.signature,n.signature=Ge.newBuffer(Ge.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},t.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?Ge.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?Ge.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?Ge.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?Ge.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zl.util.toJSONOptions)},t}();Xr.Message=function(){function t(r){if(this.closerPeers=[],this.providerPeers=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.type=null,t.prototype.clusterLevelRaw=null,t.prototype.key=null,t.prototype.record=null,t.prototype.closerPeers=Ge.emptyArray,t.prototype.providerPeers=Ge.emptyArray;var e;return Object.defineProperty(t.prototype,"_type",{get:Ge.oneOfGetter(e=["type"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_clusterLevelRaw",{get:Ge.oneOfGetter(e=["clusterLevelRaw"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_key",{get:Ge.oneOfGetter(e=["key"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_record",{get:Ge.oneOfGetter(e=["record"]),set:Ge.oneOfSetter(e)}),t.encode=function(i,n){if(n||(n=pk.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)Xr.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)Xr.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},t.decode=function(i,n){i instanceof my||(i=my.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Xr.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(Xr.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(Xr.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},t.fromObject=function(i){if(i instanceof Xr.Message)return i;var n=new Xr.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?Ge.base64.decode(i.key,n.key=Ge.newBuffer(Ge.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?Ge.base64.decode(i.record,n.record=Ge.newBuffer(Ge.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=Xr.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=Xr.Message.Peer.fromObject(i.providerPeers[s])}}return n},t.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Xr.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?Ge.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?Ge.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=Xr.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=Xr.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zl.util.toJSONOptions)},t.MessageType=function(){var r={},i=Object.create(r);return i[r[0]="PUT_VALUE"]=0,i[r[1]="GET_VALUE"]=1,i[r[2]="ADD_PROVIDER"]=2,i[r[3]="GET_PROVIDERS"]=3,i[r[4]="FIND_NODE"]=4,i[r[5]="PING"]=5,i}(),t.ConnectionType=function(){var r={},i=Object.create(r);return i[r[0]="NOT_CONNECTED"]=0,i[r[1]="CONNECTED"]=1,i[r[2]="CAN_CONNECT"]=2,i[r[3]="CANNOT_CONNECT"]=3,i}(),t.Peer=function(){function r(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}r.prototype.id=null,r.prototype.addrs=Ge.emptyArray,r.prototype.connection=null;var i;return Object.defineProperty(r.prototype,"_id",{get:Ge.oneOfGetter(i=["id"]),set:Ge.oneOfSetter(i)}),Object.defineProperty(r.prototype,"_connection",{get:Ge.oneOfGetter(i=["connection"]),set:Ge.oneOfSetter(i)}),r.encode=function(s,o){if(o||(o=pk.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},r.decode=function(s,o){s instanceof my||(s=my.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new Xr.Message.Peer;s.pos<a;){var u=s.uint32();switch(u>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(u&7);break}}return c},r.fromObject=function(s){if(s instanceof Xr.Message.Peer)return s;var o=new Xr.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?Ge.base64.decode(s.id,o.id=Ge.newBuffer(Ge.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?Ge.base64.decode(s.addrs[a],o.addrs[a]=Ge.newBuffer(Ge.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},r.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?Ge.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?Ge.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?Xr.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},r.prototype.toJSON=function(){return this.constructor.toObject(this,Zl.util.toJSONOptions)},r}(),t}();ESe.exports=Xr});var yc=y((oUt,TSe)=>{f();"use strict";var rwt=rt(),{Multiaddr:iwt}=it(),{Record:nwt}=jf(),tx=SSe(),swt=tx.Message.MessageType,xSe=tx.Message.ConnectionType,vy=class{constructor(e,r,i){if(r&&!(r instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=r,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(ASe),providerPeers:this.providerPeers.map(ASe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),tx.Message.encode(e).finish()}static deserialize(e){let r=tx.Message.decode(e),i=new vy(r.type||0,r.key||Uint8Array.from([]),r.clusterLevelRaw||0);return i.closerPeers=r.closerPeers.map(ISe),i.providerPeers=r.providerPeers.map(ISe),r.record&&r.record.length&&(i.record=nwt.deserialize(r.record)),i}};vy.TYPES=swt;vy.CONNECTION_TYPES=xSe;function ASe(t){return{id:t.id.id,addrs:(t.multiaddrs||[]).map(r=>r.bytes),connection:xSe.CONNECTED}}function ISe(t){return{id:new rwt(t.id),multiaddrs:(t.addrs||[]).map(e=>new iwt(e))}}TSe.exports=vy});var CSe=y((aUt,PSe)=>{f();"use strict";var{Record:owt}=jf(),awt=ue(),RSe=yc(),yk=ui();PSe.exports=t=>{let e=yk.logger(t.peerId,"rpc:get-value");async function r(i,n){let s=n.key;if(e("key: %b",s),!s||s.length===0)throw awt(new Error("Invalid key"),"ERR_INVALID_KEY");let o=new RSe(RSe.TYPES.GET_VALUE,s,n.clusterLevel);if(yk.isPublicKeyKey(s)){e("is public key");let u=yk.fromPublicKeyKey(s),l;if(t._isSelf(u))l=t.peerId;else{let d=t.peerStore.get(u);l=d&&d.id}if(l&&l.pubKey)return e("returning found public key"),o.record=new owt(s,l.pubKey.bytes),o}let[a,c]=await Promise.all([t._checkLocalDatastore(s),t._betterPeersToQuery(n,i)]);return a&&(e("got record"),o.record=a),c.length>0&&(e("got closer %s",c.length),o.closerPeers=c),o}return r}});var qSe=y((cUt,kSe)=>{f();"use strict";var OSe=ui(),cwt=ue();kSe.exports=t=>{let e=OSe.logger(t.peerId,"rpc:put-value");async function r(i,n){let s=n.key;e("key: %b",s);let o=n.record;if(!o){let c=`Empty record from: ${i.toB58String()}`;throw e.error(c),cwt(new Error(c),"ERR_EMPTY_RECORD")}await t._verifyRecordLocally(o),o.timeReceived=new Date;let a=OSe.bufferToKey(o.key);return await t.datastore.put(a,o.serialize()),t.onPut(o,i),n}return r}});var NSe=y((uUt,DSe)=>{f();"use strict";var{equals:uwt}=(di(),fi),lwt=yc(),fwt=ui();DSe.exports=t=>{let e=fwt.logger(t.peerId,"rpc:find-node");async function r(i,n){e("start");let s;uwt(n.key,t.peerId.id)?s=[{id:t.peerId,multiaddrs:t.libp2p.multiaddrs}]:s=await t._betterPeersToQuery(n,i);let o=new lwt(n.type,new Uint8Array(0),n.clusterLevel);return s.length>0?o.closerPeers=s:e("handle FindNode %s: could not find anything",i.toB58String()),o}return r}});var LSe=y((lUt,MSe)=>{f();"use strict";var{CID:dwt}=(Ie(),Ne),BSe=ue(),hwt=ui();MSe.exports=t=>{let e=hwt.logger(t.peerId,"rpc:add-provider");async function r(i,n){if(e("start"),!n.key||n.key.length===0)throw BSe(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=dwt.decode(n.key)}catch(o){let a=`Invalid CID: ${o.message}`;throw BSe(new Error(a),"ERR_INVALID_CID")}return n.providerPeers.forEach(o=>{if(!o.id.isEqual(i)){e("invalid provider peer %s from %s",o.id.toB58String(),i.toB58String());return}if(o.multiaddrs.length<1){e("no valid addresses for provider %s. Ignore",i.toB58String());return}if(e("received provider %s for %s (addrs %s)",i.toB58String(),s.toString(),o.multiaddrs.map(a=>a.toString())),!t._isSelf(o.id))return t.peerStore.addressBook.add(o.id,o.multiaddrs),t.providers.addProvider(s,o.id)}),t.providers.addProvider(s,i)}return r}});var KSe=y((fUt,FSe)=>{f();"use strict";var{CID:pwt}=(Ie(),Ne),ywt=ue(),gwt=yc(),USe=ui();FSe.exports=t=>{let e=USe.logger(t.peerId,"rpc:get-providers");async function r(i,n){let s;try{s=pwt.decode(n.key)}catch(p){throw ywt(new Error(`Invalid CID: ${p.message}`),"ERR_INVALID_CID")}e("%s",s.toString());let o=USe.bufferToKey(s.bytes),[a,c,u]=await Promise.all([t.datastore.has(o),t.providers.getProviders(s),t._betterPeersToQuery(n,i)]),l=c.map(p=>({id:p,multiaddrs:[]})),d=u.map(p=>({id:p.id,multiaddrs:[]}));a&&l.push({id:t.peerId,multiaddrs:[]});let h=new gwt(n.type,n.key,n.clusterLevel);return l.length>0&&(h.providerPeers=l),d.length>0&&(h.closerPeers=d),e("got %s providers %s closerPeers",l.length,d.length),h}return r}});var VSe=y((dUt,jSe)=>{f();"use strict";var bwt=ui();jSe.exports=t=>{let e=bwt.logger(t.peerId,"rpc:ping");function r(i,n){return e("from %s",i.toB58String()),n}return r}});var HSe=y((hUt,zSe)=>{f();"use strict";var wy=yc().TYPES;zSe.exports=t=>{let e={[wy.GET_VALUE]:CSe()(t),[wy.PUT_VALUE]:qSe()(t),[wy.FIND_NODE]:NSe()(t),[wy.ADD_PROVIDER]:LSe()(t),[wy.GET_PROVIDERS]:KSe()(t),[wy.PING]:VSe()(t)};function r(i){return e[i]}return r}});var WSe=y((pUt,GSe)=>{f();"use strict";var{pipe:mwt}=Ar(),$Se=Wo(),vwt=yc(),wwt=HSe(),_wt=ui();GSe.exports=t=>{let e=_wt.logger(t.peerId,"rpc"),r=wwt(t);async function i(s,o){let a=r(o.type);try{await t._add(s)}catch(c){e.error("Failed to update the kbucket store",c)}if(!a){e.error(`no handler found for message type: ${o.type}`);return}return a(s,o)}async function n({stream:s,connection:o}){let a=o.remotePeer;try{await t._add(a)}catch(u){e.error(u)}let c=a.toB58String();e("from: %s",c),await mwt(s.source,$Se.decode(),u=>async function*(){for await(let l of u){let d=vwt.deserialize(l.slice()),h=await i(a,d);h&&(yield h.serialize())}}(),$Se.encode(),s.sink)}return n}});var ZSe=y((yUt,QSe)=>{f();"use strict";var rx=ue(),{pipe:YSe}=Ar(),gk=Wo(),Ewt=Vd(),{consume:Swt}=Op(),xwt=Df(),Awt=HE(),Iwt=WSe(),Twt=Ql(),Rwt=yc(),Pwt=ui(),XSe=class{constructor(e){this.dht=e,this.readMessageTimeout=Twt.READ_MESSAGE_TIMEOUT,this._log=Pwt.logger(this.dht.peerId,"net"),this._rpc=Iwt(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}start(){if(this._running)return;if(!this.dht.isStarted)throw rx(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,this.dht._clientMode===!1&&this.dht.registrar.handle(this.dht.protocol,this._rpc);let e=new Awt({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=this.dht.registrar.register(e)}stop(){!this.dht.isStarted&&!this.isStarted||(this._running=!1,this._registrarId&&this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,r){if(!this.isConnected)throw rx(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeReadMessage(s,r.serialize())}async sendMessage(e,r){if(!this.isConnected)throw rx(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeMessage(s,r.serialize())}async _writeReadMessage(e,r){return Ewt(Cwt(e,r),this.readMessageTimeout)}_writeMessage(e,r){return YSe([r],gk.encode(),e,Swt)}};async function Cwt(t,e){let r=await YSe([e],gk.encode(),t,gk.decode(),async i=>{let n=await xwt(i);if(n)return n.slice()});if(r.length===0)throw rx(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return Rwt.deserialize(r)}QSe.exports=XSe});var r3e=y((gUt,t3e)=>{f();"use strict";var ix=Z3(),JSe=ui(),Owt=fk(),{equals:kwt}=(di(),fi),e3e=class{constructor(e,r){this.originDhtKey=e,this.capacity=r,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>kwt(n.peerId.id,e.id)))return;let r=await JSe.convertPeerId(e),i={peerId:e,distance:ix(this.originDhtKey,r)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>ix.compare(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let r=await Owt(e,n=>JSe.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of r){let s=ix(this.originDhtKey,n);if(ix.compare(s,i)<0)return!0}return!1}};t3e.exports=e3e});var n3e=y((bk,i3e)=>{f();(function(){var t,e,r,i,n,s,o,a,c,u,l,d,h,p,g;r=Math.floor,u=Math.min,e=function(m,E){return m<E?-1:m>E?1:0},c=function(m,E,v,A,R){var F;if(v==null&&(v=0),R==null&&(R=e),v<0)throw new Error("lo must be non-negative");for(A==null&&(A=m.length);v<A;)F=r((v+A)/2),R(E,m[F])<0?A=F:v=F+1;return[].splice.apply(m,[v,v-v].concat(E)),E},s=function(m,E,v){return v==null&&(v=e),m.push(E),p(m,0,m.length-1,v)},n=function(m,E){var v,A;return E==null&&(E=e),v=m.pop(),m.length?(A=m[0],m[0]=v,g(m,0,E)):A=v,A},a=function(m,E,v){var A;return v==null&&(v=e),A=m[0],m[0]=E,g(m,0,v),A},o=function(m,E,v){var A;return v==null&&(v=e),m.length&&v(m[0],E)<0&&(A=[m[0],E],E=A[0],m[0]=A[1],g(m,0,v)),E},i=function(m,E){var v,A,R,F,q,D,z,G;for(E==null&&(E=e),D=function(){G=[];for(var Y=0,P=r(m.length/2);0<=P?Y<P:Y>P;0<=P?Y++:Y--)G.push(Y);return G}.apply(this).reverse(),z=[],A=0,F=D.length;A<F;A++)v=D[A],z.push(g(m,v,E));return z},h=function(m,E,v){var A;if(v==null&&(v=e),A=m.indexOf(E),A!==-1)return p(m,0,A,v),g(m,A,v)},l=function(m,E,v){var A,R,F,q,D;if(v==null&&(v=e),R=m.slice(0,E),!R.length)return R;for(i(R,v),D=m.slice(E),F=0,q=D.length;F<q;F++)A=D[F],o(R,A,v);return R.sort(v).reverse()},d=function(m,E,v){var A,R,F,q,D,z,G,Y,P,b;if(v==null&&(v=e),E*10<=m.length){if(q=m.slice(0,E).sort(v),!q.length)return q;for(F=q[q.length-1],Y=m.slice(E),D=0,G=Y.length;D<G;D++)A=Y[D],v(A,F)<0&&(c(q,A,0,null,v),q.pop(),F=q[q.length-1]);return q}for(i(m,v),b=[],R=z=0,P=u(E,m.length);0<=P?z<P:z>P;R=0<=P?++z:--z)b.push(n(m,v));return b},p=function(m,E,v,A){var R,F,q;for(A==null&&(A=e),R=m[v];v>E;){if(q=v-1>>1,F=m[q],A(R,F)<0){m[v]=F,v=q;continue}break}return m[v]=R},g=function(m,E,v){var A,R,F,q,D;for(v==null&&(v=e),R=m.length,D=E,F=m[E],A=2*E+1;A<R;)q=A+1,q<R&&!(v(m[A],m[q])<0)&&(A=q),m[E]=m[A],E=A,A=2*E+1;return m[E]=F,p(m,D,E,v)},t=function(){m.push=s,m.pop=n,m.replace=a,m.pushpop=o,m.heapify=i,m.updateItem=h,m.nlargest=l,m.nsmallest=d;function m(E){this.cmp=E??e,this.nodes=[]}return m.prototype.push=function(E){return s(this.nodes,E,this.cmp)},m.prototype.pop=function(){return n(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(E){return this.nodes.indexOf(E)!==-1},m.prototype.replace=function(E){return a(this.nodes,E,this.cmp)},m.prototype.pushpop=function(E){return o(this.nodes,E,this.cmp)},m.prototype.heapify=function(){return i(this.nodes,this.cmp)},m.prototype.updateItem=function(E){return h(this.nodes,E,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return this.nodes.length===0},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var E;return E=new m,E.nodes=this.nodes.slice(0),E},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m}(),function(m,E){return typeof define=="function"&&define.amd?define([],E):typeof bk=="object"?i3e.exports=E():m.Heap=E()}(this,function(){return t})}).call(bk)});var o3e=y((bUt,s3e)=>{f();s3e.exports=n3e()});var c3e=y((mUt,a3e)=>{f();"use strict";var qwt=o3e(),Dwt=Z3(),Nwt=me(),nx=ui(),mk=Nwt("libp2p:dht:peer-queue"),Am=class{static async fromPeerId(e){let r=await nx.convertPeerId(e);return new Am(r)}static async fromKey(e){let r=await nx.convertBuffer(e);return new Am(r)}constructor(e){mk("create: %b",e),this.from=e,this.heap=new qwt(nx.xorCompare)}async enqueue(e){mk("enqueue %s",e.toB58String());let r=await nx.convertPeerId(e),i={id:e,distance:Dwt(this.from,r)};this.heap.push(i)}dequeue(){let e=this.heap.pop();return mk("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}};a3e.exports=Am});var f3e=y((vUt,l3e)=>{f();"use strict";var Bwt=c3e(),Mwt=ui(),Lwt=3e4,u3e=class{constructor(e,r){if(this.run=e,this.queryFunc=Mwt.withTimeout(r,Lwt),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if(typeof this.queryFunc!="function")throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){let e=await Bwt.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(r=>this.addPeerToQuery(r))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}};l3e.exports=u3e});var p3e=y((wUt,h3e)=>{f();"use strict";var{default:Uwt}=$c(),d3e=class{constructor(e,r,i,n){this.dht=e,this.run=r,this.path=i,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){let e=new Uwt({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{!this.running||e.pending<this.concurrency&&this.fill()}),e}stop(e){!this.running||(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(r=>r.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;let e=new Promise((r,i)=>{this.execution={resolve:r,reject:i}});this.fill(),await e}fill(){if(!!this.path.peersToQuery)for(;this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0;){let e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(r=>{this.log.error("queue",r),this.stop(r)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running||this.run.peersSeen.has(e.toB58String()))return;let r,i;try{r=await this.run.continueQuerying(this)}catch(o){i=o}if(!this.running)return;if(i)throw i;if(!r){this.stop();return}if(this.run.peersSeen.has(e.toB58String()))return;this.run.peersSeen.add(e.toB58String()),this.log("queue:work");let n,s;try{n=await this.execQuery(e)}catch(o){s=o}if(!!this.running){if(this.log("queue:work:done",s,n),s)throw s;if(n&&n.queryComplete){this.log("query:complete"),this.run.stop();return}n&&n.pathComplete&&this.stop()}}async execQuery(e){let r,i;try{r=await this.path.queryFunc(e)}catch(n){i=n}if(!!this.running){if(i){this.run.errors.push(i);return}if(this.run.peersQueried&&await this.run.peersQueried.add(e),!!r){if(r.pathComplete||r.queryComplete)return this.path.res=r,{pathComplete:r.pathComplete,queryComplete:r.queryComplete};if(r.closerPeers&&r.closerPeers.length>0){let n=async s=>{this.dht._isSelf(s.id)||(this.dht._peerDiscovered(s.id,s.multiaddrs),await this.path.addPeerToQuery(s.id))};await Promise.all(r.closerPeers.map(n))}}}}};h3e.exports=d3e});var b3e=y((_Ut,g3e)=>{f();"use strict";var Fwt=r3e(),Kwt=yr(),jwt=f3e(),Vwt=p3e(),zwt=ui(),y3e=class extends Kwt{constructor(e){super();this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(!!this.running){this.running=!1;for(let e of this.workers)e.stop()}}async execute(e){let r=[],i=Math.min(this.query.dht.disjointPaths,e.length);for(let s=0;s<i;s++)r.push(new jwt(this,this.query.makePath(s,i)));e.forEach((s,o)=>{r[o%i].addInitialPeer(s)}),await this.executePaths(r);let n={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(let s of r)s.res&&(s.res.pathComplete||s.res.queryComplete)&&(s.res.success=!0,n.paths.push(s.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(r=>r.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){let r=new Vwt(this.query.dht,this,e,this.query._log);this.workers.push(r),await r.execute()}async init(){if(!this.peersQueried){if(this.peersQueriedPromise){await this.peersQueriedPromise;return}this.peersQueriedPromise=(async()=>{let e=await zwt.convertBuffer(this.query.key);this.peersQueried=new Fwt(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise}}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;let r=Array.from(e.queuedPeerIds);return!!(this.peersQueried&&await this.peersQueried.anyCloser(r))}};g3e.exports=y3e});var sx=y((EUt,v3e)=>{f();"use strict";var{base58btc:Hwt}=(ei(),Jr),$wt=ui(),Gwt=b3e(),m3e=class{constructor(e,r,i){this.dht=e,this.key=r,this.makePath=i,this._log=$wt.logger(this.dht.peerId,"query:"+Hwt.baseEncode(r)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?e.length===0?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new Gwt(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),!!this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}};v3e.exports=m3e});var S3e=y((SUt,E3e)=>{f();"use strict";var vk=ue(),Wwt=Vd(),{equals:Ywt}=(di(),fi),{toString:w3e}=(tt(),et),_3e=jf(),wk=Ql(),Xwt=sx(),Yd=ui(),Qwt=_3e.Record;E3e.exports=t=>{let e=async(n,s)=>t.datastore.put(Yd.bufferToKey(n),s),r=async n=>{t._log(`getLocal ${w3e(n,"base32")}`);let s=await t.datastore.get(Yd.bufferToKey(n));t._log(`found ${w3e(n,"base32")} in local datastore`);let o=Qwt.deserialize(s);return await t._verifyRecordLocally(o),o},i=async(n,s,o)=>{let a=await Yd.createPutRecord(n,o);return Promise.all(s.map(async c=>{if(!Ywt(c.val,o)){if(t._isSelf(c.from)){try{await t._putLocal(n,a)}catch(u){t._log.error("Failed error correcting self",u)}return}try{await t._putValueToPeer(n,a,c.from)}catch(u){t._log.error("Failed error correcting entry",u)}}}))};return{async _putLocal(n,s){return e(n,s)},async put(n,s,o={}){t._log("PutValue %b",n);let a=await Yd.createPutRecord(n,s);await e(n,a);let c=0,u=0;await Yd.mapParallel(t.getClosestPeers(n,{shallow:!0}),async d=>{try{c+=1,await t._putValueToPeer(n,a,d),u+=1}catch(h){t._log.error("Failed to put to peer (%b): %s",d.id,h)}});let l=o.minPeers||c;if(l>u){let d=vk(new Error(`Failed to put value to enough peers: ${u}/${l}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw t._log.error(d),d}},async get(n,s={}){s.timeout=s.timeout||wk.minute,t._log("_get %b",n);let o=await t.getMany(n,wk.GET_MANY_RECORD_COUNT,s),a=o.map(l=>l.val),c=0;try{c=_3e.selection.bestRecord(t.selectors,n,a)}catch(l){if(l.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw l}let u=a[c];if(t._log("GetValue %b %s",n,u),!u)throw vk(new Error("best value was not found"),"ERR_NOT_FOUND");return await i(n,o,u),u},async getMany(n,s,o={}){o.timeout=o.timeout||wk.minute,t._log("getMany %b (%s)",n,s);let a=[],c;try{c=await r(n)}catch(g){if(s===0)throw g}if(c&&a.push({val:c.value,from:t.peerId}),a.length>=s)return a;let u=await Yd.convertBuffer(n),l=t.routingTable.closestPeers(u,t.kBucketSize);if(t._log("peers in rt: %d",l.length),l.length===0){let g="Failed to lookup key! No peers from routing table!";if(t._log.error(g),a.length===0)throw vk(new Error(g),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}let d=a.length;function h(g,m){let E=Yd.pathSize(s-d,m),v=0;async function A(R){let F,q,D;try{let G=await t._getValueOrPeers(R,n);F=G.record,q=G.peers}catch(G){if(G.code!=="ERR_INVALID_RECORD")throw G;D=G}let z={closerPeers:q};return F&&F.value?(a.push({val:F.value,from:R}),v++):D&&(a.push({err:D,from:R}),v++),v>=E&&(z.pathComplete=!0),z}return A}let p=new Xwt(t,n,h);try{await Wwt(p.run(l),o.timeout)}catch(g){if(a.length===0)throw g}finally{p.stop()}return a}}}});var I3e=y((xUt,A3e)=>{f();"use strict";var x3e=class{constructor(){this.list=[]}push(e){return this.has(e.id)?!1:(this.list.push(e),!0)}has(e){let r=this.list.find(i=>i.id.equals(e));return Boolean(r)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}};A3e.exports=x3e});var P3e=y((AUt,R3e)=>{f();"use strict";var Zwt=I3e(),T3e=class extends Zwt{constructor(e){super();this.limit=e}push(e){return this.length<this.limit?super.push(e):!1}};R3e.exports=T3e});var N3e=y((IUt,D3e)=>{f();"use strict";var Jwt=ue(),C3e=Vd(),O3e=Ql(),k3e=P3e(),ox=yc(),e_t=sx(),q3e=ui();D3e.exports=t=>{let e=async(r,i)=>{let n=new ox(ox.TYPES.GET_PROVIDERS,i.bytes,0);return t.network.sendRequest(r,n)};return{async provide(r){t._log(`provide: ${r}`);let i=[];await t.providers.addProvider(r,t.peerId);let n=t.libp2p?t.libp2p.multiaddrs:[],s=new ox(ox.TYPES.ADD_PROVIDER,r.bytes,0);s.providerPeers=[{id:t.peerId,multiaddrs:n}];async function o(a){t._log(`putProvider ${r} to ${a.toB58String()}`);try{await t.network.sendMessage(a,s)}catch(c){i.push(c)}}if(await q3e.mapParallel(t.getClosestPeers(r.bytes),o),i.length)throw Jwt(new Error(`Failed to provide to ${i.length} of ${t.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:i})},async*findProviders(r,i={timeout:6e4,maxNumProviders:5}){let n=i.timeout||O3e.minute,s=i.maxNumProviders||O3e.K;t._log(`findProviders ${r}`);let o=new k3e(s);if((await t.providers.getProviders(r)).forEach(h=>{let p=t.peerStore.get(h);p?o.push({id:p.id,multiaddrs:p.addresses.map(g=>g.multiaddr)}):o.push({id:h,multiaddrs:[]})}),o.length>=s){for(let h of o.toArray())yield h;return}let c=[];function u(h,p){let g=q3e.pathSize(s-o.length,p),m=new k3e(g);c.push(m);async function E(v){let A=await e(v,r),R=A.providerPeers;return t._log(`Found ${R.length} provider entries for ${r}`),R.forEach(F=>{m.push({...F})}),m.length>=g?{pathComplete:!0}:{closerPeers:A.closerPeers}}return E}let l=new e_t(t,r.bytes,u),d=t.routingTable.closestPeers(r.bytes,t.kBucketSize);try{await C3e(l.run(d),n)}catch(h){if(h.name!==C3e.TimeoutError.name)throw h}finally{l.stop()}c.forEach(h=>{h.toArray().forEach(p=>{o.push(p)})});for(let h of o.toArray())yield h}}}});var L3e=y((TUt,M3e)=>{f();"use strict";var Im=ue(),t_t=Vd(),_k=rt(),r_t=Na(),{toString:i_t}=(tt(),et),n_t=Ql(),ax=yc(),B3e=sx(),Tm=ui();M3e.exports=t=>{let e=async s=>{t._log(`findPeerLocal ${s.toB58String()}`);let o=await t.routingTable.find(s),a=o&&t.peerStore.get(o);if(a)return{id:a.id,multiaddrs:a.addresses.map(c=>c.multiaddr)}},r=async(s,o)=>{let a=new ax(ax.TYPES.GET_VALUE,o,0);return t.network.sendRequest(s,a)},i=async(s,o)=>(t._log(`closerPeersSingle ${i_t(s,"base32")} from ${o.toB58String()}`),(await t.peerRouting._findPeerSingle(o,new _k(s))).closerPeers.filter(c=>!t._isSelf(c.id)).map(c=>(t.peerStore.addressBook.add(c.id,c.multiaddrs),c))),n=async s=>{let o=Tm.keyForPublicKey(s),a=await r(s,o);if(!a.record||!a.record.value)throw Im(new Error(`Node not responding with its public key: ${s.toB58String()}`),"ERR_INVALID_RECORD");let c=await _k.createFromPubKey(a.record.value);if(!c.equals(s))throw Im(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return c.pubKey};return{async _findPeerSingle(s,o){t._log("findPeerSingle %s",s.toB58String());let a=new ax(ax.TYPES.FIND_NODE,o.id,0);return t.network.sendRequest(s,a)},async findPeer(s,o={timeout:6e4}){o.timeout=o.timeout||n_t.minute,t._log("findPeer %s",s.toB58String());let a=await e(s);if(a!=null)return t._log("found local"),a;let c=await Tm.convertPeerId(s),u=t.routingTable.closestPeers(c,t.kBucketSize);if(u.length===0)throw Im(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");if(u.find(m=>m.isEqual(s))){let m=t.peerStore.get(s);if(m)return t._log("found in peerStore"),{id:m.id,multiaddrs:m.addresses.map(E=>E.multiaddr)}}let d=new B3e(t,s.id,()=>async E=>{let v=await this._findPeerSingle(E,s),A=v.closerPeers.find(R=>R.id.isEqual(s));return A?{peer:A,queryComplete:!0}:{closerPeers:v.closerPeers}}),h;try{h=await t_t(d.run(u),o.timeout)}finally{d.stop()}let p=!1;if(h.paths.forEach(m=>{m.success&&m.peer&&(p=!0,t.peerStore.addressBook.add(m.peer.id,m.peer.multiaddrs))}),t._log("findPeer %s: %s",s.toB58String(),p),!p)throw Im(new Error("No peer found"),"ERR_NOT_FOUND");let g=t.peerStore.get(s);if(!g)throw Im(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(m=>m.multiaddr)}},async*getClosestPeers(s,o={shallow:!1}){t._log("getClosestPeers to %b",s);let a=await Tm.convertBuffer(s),c=t.routingTable.closestPeers(a,t.kBucketSize),l=await new B3e(t,s,()=>async h=>({closerPeers:await i(s,h),pathComplete:o.shallow?!0:void 0})).run(c);if(!l||!l.finalSet)return[];let d=await Tm.sortClosestPeers(Array.from(l.finalSet),a);for(let h of d.slice(0,t.kBucketSize))yield h},async getPublicKey(s){t._log("getPublicKey %s",s.toB58String());let o=t.peerStore.get(s);if(o&&o.id.pubKey)return t._log("getPublicKey: found local copy"),o.id.pubKey;let a;try{a=await n(s)}catch(l){let d=Tm.keyForPublicKey(s),h=await t.get(d);a=r_t.keys.unmarshalPublicKey(h)}let c=new _k(s.id,void 0,a),u=(o&&o.addresses||[]).map(l=>l.multiaddr);return t.peerStore.addressBook.add(c,u),t.peerStore.keyBook.set(c,a),a}}}});var z3e=y((RUt,V3e)=>{f();"use strict";var s_t=sb(),U3e=ss(),o_t=rt(),{Key:a_t}=Ut(),{default:c_t}=$c(),Rm=Ql(),Pm=ui(),F3e=class{constructor(e,r,i){this.datastore=e,this._log=Pm.logger(r,"providers"),this.cleanupInterval=Rm.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=Rm.PROVIDERS_VALIDITY,this.lruCacheSize=i||Rm.PROVIDERS_LRU_CACHE_SIZE,this.providers=s_t(this.lruCacheSize),this.syncQueue=new c_t({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");let e=Date.now(),r=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:Rm.PROVIDERS_KEY_PREFIX});for await(let a of o)try{let{cid:c,peerId:u}=K3e(a.key),l=j3e(a.value),d=Date.now(),h=d-l,p=h>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",d,l,h,this.provideValidity,p?"(expired)":""),p){i++,s.delete(a.key);let g=n.get(c)||new Set;g.add(u),n.set(c,g)}r++}catch(c){this._log.error(c.message)}this._log("deleting %d / %d entries",i,r),n.size&&await s.commit();for(let[a,c]of n){let u=Cm(a),l=this.providers.get(u);if(l){for(let d of c)l.delete(d);l.size===0?this.providers.remove(u):this.providers.set(u,l)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let r=Cm(e),i=this.providers.get(r);return i||(i=await l_t(this.datastore,e),this.providers.set(r,i)),i}async addProvider(e,r){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toString());let i=await this._getProvidersMap(e);this._log("loaded %s provs",i.size);let n=new Date;i.set(Pm.encodeBase32(r.id),n);let s=Cm(e);return this.providers.set(s,i),u_t(this.datastore,e,r,n)})}async getProviders(e){return this.syncQueue.add(async()=>(this._log("getProviders %s",e.toString()),[...(await this._getProvidersMap(e)).keys()].map(i=>new o_t(Pm.decodeBase32(i)))))}};function Cm(t){return t=typeof t=="string"?t:Pm.encodeBase32(t.bytes),Rm.PROVIDERS_KEY_PREFIX+t}async function u_t(t,e,r,i){let n=[Cm(e),"/",Pm.encodeBase32(r.id)].join(""),s=new a_t(n),o=Uint8Array.from(U3e.encode(i.getTime()));return t.put(s,o)}function K3e(t){let e=t.toString().split("/");if(e.length!==4)throw new Error("incorrectly formatted provider entry key in datastore: "+t);return{cid:e[2],peerId:e[3]}}async function l_t(t,e){let r=new Map,i=t.query({prefix:Cm(e)});for await(let n of i){let{peerId:s}=K3e(n.key);r.set(s,j3e(n.value))}return r}function j3e(t){return U3e.decode(t)}V3e.exports=F3e});var $3e=y((PUt,H3e)=>{f();"use strict";var f_t=IS();H3e.exports=async(t,e,{concurrency:r=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===1/0)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);let o=[],a=[],c=t[Symbol.iterator](),u=!1,l=!1,d=0,h=0,p=()=>{if(u)return;let g=c.next(),m=h;if(h++,g.done){l=!0,d===0&&(!i&&a.length!==0?s(new f_t(a)):n(o));return}d++,(async()=>{try{let E=await g.value;o[m]=await e(E,m),d--,p()}catch(E){i?(u=!0,s(E)):(a.push(E),d--,p())}})()};for(let g=0;g<r&&(p(),!l);g++);})});var W3e=y((CUt,Ek)=>{f();"use strict";var d_t=$3e(),G3e=async(t,e,r)=>d_t(new Array(t).fill(),(i,n)=>e(n),r);Ek.exports=G3e;Ek.exports.default=G3e});var Q3e=y((OUt,X3e)=>{f();"use strict";var h_t=Na(),{sha256:p_t}=(ri(),li),y_t=rt(),{AbortController:g_t}=nf(),b_t=ue(),m_t=W3e(),v_t=Ql(),{logger:w_t}=ui(),Y3e=class{constructor(e,r){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...v_t.defaultRandomWalk,...r},this.log=w_t(e.peerId,"random-walk"),this._timeoutId=void 0}start(){this._running||(this._running=!0,!(this._timeoutId||!this._options.enabled)&&(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay)))}stop(){this._running=!1,this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}if(!this._running)return;await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,r){this.log("start"),this._controller=new g_t;try{await m_t(e,async i=>{this.log("running query %d",i);try{let n=await this._randomPeerId();if(!this._controller)return;await this._query(n,{timeout:r,signal:this._controller.signal})}catch(n){if(n&&n.code!=="ETIMEDOUT")throw this.log.error("query %d finished with error",i,n),n}this.log("finished query %d",i)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,r){this.log("query:%s",e.toB58String());let i;try{i=await this._kadDHT.findPeer(e,r)}catch(n){if(n&&n.code==="ERR_NOT_FOUND")return;throw n}throw this.log("query:found",i),b_t(new Error(`random-walk: ACTUALLY FOUND PEER: ${i}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){let e=await p_t.digest(h_t.randomBytes(16));return new y_t(e.bytes)}};X3e.exports=Y3e});var exe=y((kUt,J3e)=>{f();"use strict";var Z3e=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(let e of this.queries)e.stop();this.queries.clear()}};J3e.exports=Z3e});var ixe=y((qUt,Ak)=>{f();"use strict";var{EventEmitter:__t}=yr(),cx=ue(),Om=jf(),{MemoryDatastore:E_t}=Ut(),{equals:txe}=(di(),fi),{toString:Sk}=(tt(),et),S_t=wSe(),_y=ui(),km=Ql(),x_t=ZSe(),A_t=S3e(),I_t=N3e(),T_t=L3e(),ux=yc(),R_t=z3e(),P_t=Q3e(),C_t=exe(),xk=Om.Record,rxe=class extends __t{constructor({libp2p:e,dialer:r,peerId:i,peerStore:n,registrar:s,protocolPrefix:o="/ipfs",forceProtocolLegacy:a=!1,datastore:c=new E_t,kBucketSize:u=km.K,clientMode:l=!1,concurrency:d=km.ALPHA,validators:h={},selectors:p={},randomWalk:g={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:m=()=>{},onRemove:E=()=>{}}){super();if(!r)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=r,this.peerId=i,this.peerStore=n,this.registrar=s,this.protocol=o+(a?"":km.PROTOCOL_DHT),this.kBucketSize=u,this._clientMode=l,this.concurrency=d,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new S_t(this.peerId,this.kBucketSize),this.datastore=c,this.providers=new R_t(this.datastore,this.peerId),this.validators={pk:Om.validator.validators.pk,...h},this.selectors={pk:Om.selection.selectors.pk,...p},this.network=new x_t(this),this._log=_y.logger(this.peerId),this.randomWalk=new P_t(this,g),this._queryManager=new C_t,this._running=!1,this.contentFetching=A_t(this),this.contentRouting=I_t(this),this.peerRouting=T_t(this),this.onPut=m,this.onRemove=E}get isStarted(){return this._running}start(){this._running||(this._running=!0,this.providers.start(),this._queryManager.start(),this.network.start(),this.randomWalk.start())}stop(){this._running=!1,this.randomWalk.stop(),this.network.stop(),this._queryManager.stop(),this.providers.stop()}async put(e,r,i={}){return this.contentFetching.put(e,r,i)}async get(e,r={}){return this.contentFetching.get(e,r)}async getMany(e,r,i={}){return this.contentFetching.getMany(e,r,i)}async removeLocal(e){this._log(`removeLocal: ${Sk(e,"base32")}`);let r=_y.bufferToKey(e);try{await this.datastore.delete(r)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}}async _putLocal(e,r){this._log(`_putLocal: ${Sk(e,"base32")}`);let i=_y.bufferToKey(e);await this.datastore.put(i,r)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,r={timeout:6e3,maxNumProviders:5}){for await(let i of this.contentRouting.findProviders(e,r))yield i}async findPeer(e,r={timeout:6e4}){return this.peerRouting.findPeer(e,r)}async*getClosestPeers(e,r={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,r)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,r){this.emit("peer",{id:e,multiaddrs:r})}async _nearestPeersToQuery(e){let r=await _y.convertBuffer(e.key);return this.routingTable.closestPeers(r,this.kBucketSize).map(n=>{let s=this.peerStore.get(n);return{id:n,multiaddrs:s?s.addresses.map(o=>o.multiaddr):[]}})}async _betterPeersToQuery(e,r){return this._log("betterPeersToQuery"),(await this._nearestPeersToQuery(e)).filter(n=>this._isSelf(n.id)?(this._log.error("trying to return self as closer"),!1):!n.id.isEqual(r))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${Sk(e)} %b`,e);let r=_y.bufferToKey(e),i;try{i=await this.datastore.get(r)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=xk.deserialize(i);if(!n)throw cx(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||_y.now()-n.timeReceived.getTime()>km.MAX_RECORD_AGE){await this.datastore.delete(r),this.onRemove(n);return}return n}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await Om.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&txe(this.peerId.id,e.id)}async _putValueToPeer(e,r,i){let n=new ux(ux.TYPES.PUT_VALUE,e,0);n.record=xk.deserialize(r);let s=await this.network.sendRequest(i,n);if(s.record&&!txe(s.record.value,xk.deserialize(r).value))throw cx(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,r){let i=await this._getValueSingle(e,r),n=i.closerPeers,s=i.record;if(s){try{await this._verifyRecordOnline(s)}catch(o){let a="invalid record received, discarded";throw this._log(a),cx(new Error(a),"ERR_INVALID_RECORD")}return{record:s,peers:n}}if(n.length>0)return{peers:n};throw cx(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,r){let i=new ux(ux.TYPES.GET_VALUE,r,0);return this.network.sendRequest(e,i)}async _verifyRecordOnline(e){await Om.validator.verifyRecord(this.validators,e)}};Ak.exports=rxe;Ak.exports.multicodec="/ipfs"+km.PROTOCOL_DHT});var oxe=y((DUt,sxe)=>{f();"use strict";var O_t=Owe(),k_t=E2e(),q_t=j2e(),{NOISE:D_t}=aSe(),N_t=ixe(),B_t=X8(),nxe=fT();sxe.exports=()=>({dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[O_t,k_t],streamMuxer:[q_t],connEncryption:[D_t],peerDiscovery:[],dht:N_t,pubsub:B_t},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:nxe.validator},selectors:{ipns:nxe.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}})});var lxe=y((Ik,uxe)=>{f();"use strict";var M_t=rt(),{Multiaddr:L_t}=it(),U_t=Tf(),{EventEmitter:F_t}=yr(),axe=me(),lx=Object.assign(axe("libp2p:bootstrap"),{error:axe("libp2p:bootstrap:error")}),cxe=class extends F_t{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),lx("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!U_t.P2P.matches(e))return lx.error("Invalid multiaddr");let r=new L_t(e),i=r.getPeerId();if(!i){lx.error("Invalid bootstrap multiaddr without peer id");return}let n=M_t.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[r]})}catch(s){lx.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};Ik=uxe.exports=cxe;Ik.tag="bootstrap"});var Tk=y((NUt,dxe)=>{f();"use strict";var Kt=xb(),K_t=gr().bind({ignoreUndefined:!0}),j_t=ue(),fxe=Uue(),V_t=Hue(),z_t=Que(),{create:H_t}=C0e(),{Multiaddr:$_t}=it(),G_t=A2().version;dxe.exports=({options:t={},peerId:e,multiaddrs:r=[],repo:i,keychainConfig:n={},config:s={}})=>{let{datastore:o,keys:a}=i,c=W_t({options:t,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:r});return typeof t.libp2p=="function"?t.libp2p({libp2pOptions:c,options:t,config:s,datastore:o,peerId:e}):Nve().create(c)};function W_t({options:t,config:e,datastore:r,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let m=Kt(e,"Pubsub.Router")||"gossipsub";if(!fxe[m])throw j_t(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${m} router.`),"ERR_NOT_SUPPORTED");return fxe[m]},c={datastore:r,peerId:s,modules:{}},u={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:Kt(t,"config.Discovery.MDNS.Enabled",Kt(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:Kt(t,"config.Discovery.webRTCStar.Enabled",Kt(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:Kt(t,"config.Bootstrap",Kt(e,"Bootstrap",[]))}},relay:{enabled:Kt(t,"relay.enabled",Kt(e,"relay.enabled",!0)),hop:{enabled:Kt(t,"relay.hop.enabled",Kt(e,"relay.hop.enabled",!1)),active:Kt(t,"relay.hop.active",Kt(e,"relay.hop.active",!1))}},dht:{enabled:Kt(e,"Routing.Type","none")!=="none",clientMode:Kt(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:Kt(t,"dht.kBucketSize",20)},pubsub:{enabled:Kt(t,"config.Pubsub.Enabled",Kt(e,"Pubsub.Enabled",!0))},nat:{enabled:!Kt(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(m=>m.toString()),announce:Kt(t,"addresses.announce",Kt(e,"Addresses.Announce",[])),noAnnounce:Kt(t,"addresses.noAnnounce",Kt(e,"Addresses.NoAnnounce",[]))},connectionManager:Kt(t,"connectionManager",{maxConnections:Kt(t,"config.Swarm.ConnMgr.HighWater",Kt(e,"Swarm.ConnMgr.HighWater")),minConnections:Kt(t,"config.Swarm.ConnMgr.LowWater",Kt(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${G_t}`}},l=oxe(),d=Kt(t,"libp2p",void 0);typeof d=="function"&&(d=void 0);let h=K_t(c,l(),u,d);Kt(h,"config.peerDiscovery.bootstrap.list",[]).length>0&&h.modules.peerDiscovery.push(lxe());let g=Kt(t,"config.Addresses.Delegates",Kt(e,"Addresses.Delegates",[]));if(g.length>0){let m=g[Math.floor(Math.random()*g.length)],E=new $_t(m).toOptions(),v={host:E.host,protocol:parseInt(E.port)===443?"https":"http",port:E.port},A=H_t(v);u.modules.contentRouting=u.modules.contentRouting||[],u.modules.contentRouting.push(new z_t(s,A)),u.modules.peerRouting=u.modules.peerRouting||[],u.modules.peerRouting.push(new V_t(A))}return h}});var mxe=y((BUt,bxe)=>{f();"use strict";var qm=me()("ipfs:components:peer:storage"),Y_t=zae(),X_t=U_(),{ERR_REPO_NOT_INITIALIZED:Q_t}=Bf().errors,{fromString:Z_t}=(ft(),ht),{toString:J_t}=(tt(),et),Rk=rt(),hxe=gr().bind({ignoreUndefined:!0}),e2t=k5(),{NotEnabledError:t2t,NotInitializedError:r2t}=tl(),pxe=Tk(),fx=class{constructor(e,r,i,n,s){this.print=n,this.peerId=e,this.keychain=r,this.repo=i,this.print=n,this.isNew=s}static async start(e,r,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?Y_t(e,r,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:u,isNew:l}=await i2t(e,a,i);return new fx(c,u,a,e,l)}};bxe.exports=fx;var i2t=async(t,e,r)=>{if(!e.closed)return{...await yxe(e,r),isNew:!1};try{return await e.open(),{...await yxe(e,r),isNew:!1}}catch(i){if(i.code!==Q_t)throw i;if(r.init&&r.init.allowNew===!1)throw new t2t("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await n2t(t,e,r),isNew:!0}}},n2t=async(t,e,r)=>{let i=r.init||{},n=await e.exists();if(qm("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await s2t(i.privateKey):await o2t(t,i),o=a2t(s);qm("peer identity: %s",o.PeerID);let a={...hxe(gxe(X_t(),i.profiles),r.config),Identity:o};await e.init(a),await e.open(),qm("repo opened");let c={pass:r.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let u=await pxe({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return u.keychain&&u.keychain.opts&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.opts.dek})),{peerId:s,keychain:u.keychain}},s2t=t=>(qm("using user-supplied private-key"),typeof t=="object"?t:Rk.createFromPrivKey(Z_t(t,"base64pad"))),o2t=(t,{algorithm:e="Ed25519",bits:r=2048})=>(t("generating %s keypair...",e),Rk.create({keyType:e,bits:r})),a2t=t=>({PeerID:t.toB58String(),PrivKey:J_t(t.privKey.bytes,"base64pad")}),yxe=async(t,e)=>{let r=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await t.config.getAll(),o=c2t(gxe(s,i),r);if(s!==o&&await t.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new r2t("No private key was found in the config, please intialize the repo");let a=await Rk.createFromPrivKey(o.Identity.PrivKey),c=await pxe({options:void 0,multiaddrs:void 0,peerId:a,repo:t,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},c2t=(t,e)=>e?hxe(t,e):t,gxe=(t,e)=>(e||[]).reduce((r,i)=>{let n=e2t.profiles[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return qm("applying profile %s",i),n.transform(r)},t)});var Exe=y((MUt,_xe)=>{f();_xe.exports=wxe;var vxe=128,u2t=127,l2t=~u2t,f2t=Math.pow(2,31);function wxe(t,e,r){e=e||[],r=r||0;for(var i=r;t>=f2t;)e[r++]=t&255|vxe,t/=128;for(;t&l2t;)e[r++]=t&255|vxe,t>>>=7;return e[r]=t|0,wxe.bytes=r-i+1,e}});var Axe=y((LUt,xxe)=>{f();xxe.exports=Pk;var d2t=128,Sxe=127;function Pk(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw Pk.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Sxe)<<i:(s&Sxe)*Math.pow(2,i),i+=7}while(s>=d2t);return Pk.bytes=n-e,r}});var Txe=y((UUt,Ixe)=>{f();var h2t=Math.pow(2,7),p2t=Math.pow(2,14),y2t=Math.pow(2,21),g2t=Math.pow(2,28),b2t=Math.pow(2,35),m2t=Math.pow(2,42),v2t=Math.pow(2,49),w2t=Math.pow(2,56),_2t=Math.pow(2,63);Ixe.exports=function(t){return t<h2t?1:t<p2t?2:t<y2t?3:t<g2t?4:t<b2t?5:t<m2t?6:t<v2t?7:t<w2t?8:t<_2t?9:10}});var Pxe=y((FUt,Rxe)=>{f();Rxe.exports={encode:Exe(),decode:Axe(),encodingLength:Txe()}});var kxe=y((KUt,Oxe)=>{f();"use strict";var Cxe=Pxe();Oxe.exports=t=>{if(!(t instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;t.length>0;){let r=Cxe.decode(t);e.push(r),t=t.slice(Cxe.decode.bytes)}return e}});var Nxe=y((jUt,Dxe)=>{f();"use strict";var{base58btc:E2t}=(ei(),Jr),qxe=class{constructor(e,r,i){this._refCounter=1,this.cid=e,this.priority=r||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(E2t)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};Dxe.exports=qxe});var Dm=y((VUt,Mxe)=>{f();"use strict";var Bxe=Nxe(),{base58btc:dx}=(ei(),Jr),S2t=(t,e)=>Array.prototype.slice.call(e,0).sort((r,i)=>{let n=t(r),s=t(i);return n<s?-1:n>s?1:0}),Ck=class{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,r,i){let n=Ey(),s=e.toString(dx),o=this.set.get(s);o?(o.inc(),o.priority=r,o.wantType===n.WantType.Have&&i===n.WantType.Block&&(o.wantType=i)):(this.set.set(s,new Bxe(e,r,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let r=e.toString(dx),i=this.set.get(r);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(r),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(S2t(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let r=e.toString(dx);return this.set.has(r)}get(e){let r=e.toString(dx);return this.set.get(r)}};Ck.Entry=Bxe;Mxe.exports=Ck});var Ok=y((HUt,Lxe)=>{f();"use strict";var x2t=Dm().Entry,{base58btc:A2t}=(ei(),Jr);Lxe.exports=class{constructor(e,r,i,n,s){this.entry=new x2t(e,r,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(A2t)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var Jl=y(($Ut,Kxe)=>{f();"use strict";var Uxe=me(),{equals:I2t}=(di(),fi),Fxe=Ok(),T2t=(t,e)=>{let r=["bitswap"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),Object.assign(Uxe(r.join(":")),{error:Uxe(r.concat(["error"]).join(":"))})},kk=(t,e,r)=>{let i=0,n=r.length;for(;i<n;){if(t(e,r[i]))return!0;i+=1}return!1},R2t=(t,e)=>{let r=0,i=e.length,n=[],s;for(;r<i;)s=e[r],kk(t,s,n)||(n[n.length]=s),r+=1;return n},P2t=(t,e)=>e.reduce((r,i)=>{let n=t(i);return r[n]?r[n].push(i):r[n]=[i],r},{}),C2t=(t,e,r)=>e.filter(i=>!kk(t,i,r)),O2t=(t,e)=>Array.prototype.slice.call(e,0).sort((r,i)=>{let n=t(r),s=t(i);return n<s?-1:n>s?1:0}),k2t=(t,e)=>{if(t.size!==e.size)return!1;for(let[r,i]of t){let n=e.get(r);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!I2t(i,n)||i instanceof Fxe&&n instanceof Fxe&&!i.equals(n))return!1}return!0};Kxe.exports={logger:T2t,includesWith:kk,uniqWith:R2t,groupBy:P2t,pullAllWith:C2t,sortBy:O2t,isMapEqual:k2t}});var Vxe=y((GUt,jxe)=>{f();"use strict";var gc=ki(),bc=gc.Reader,Nm=gc.Writer,jt=gc.util,Rt=gc.roots["ipfs-bitswap"]||(gc.roots["ipfs-bitswap"]={});Rt.Message=function(){function t(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.wantlist=null,t.prototype.blocks=jt.emptyArray,t.prototype.payload=jt.emptyArray,t.prototype.blockPresences=jt.emptyArray,t.prototype.pendingBytes=0,t.encode=function(r,i){if(i||(i=Nm.create()),r.wantlist!=null&&Object.hasOwnProperty.call(r,"wantlist")&&Rt.Message.Wantlist.encode(r.wantlist,i.uint32(10).fork()).ldelim(),r.blocks!=null&&r.blocks.length)for(var n=0;n<r.blocks.length;++n)i.uint32(18).bytes(r.blocks[n]);if(r.payload!=null&&r.payload.length)for(var n=0;n<r.payload.length;++n)Rt.Message.Block.encode(r.payload[n],i.uint32(26).fork()).ldelim();if(r.blockPresences!=null&&r.blockPresences.length)for(var n=0;n<r.blockPresences.length;++n)Rt.Message.BlockPresence.encode(r.blockPresences[n],i.uint32(34).fork()).ldelim();return r.pendingBytes!=null&&Object.hasOwnProperty.call(r,"pendingBytes")&&i.uint32(40).int32(r.pendingBytes),i},t.decode=function(r,i){r instanceof bc||(r=bc.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Rt.Message;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.wantlist=Rt.Message.Wantlist.decode(r,r.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(r.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Rt.Message.Block.decode(r,r.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Rt.Message.BlockPresence.decode(r,r.uint32()));break;case 5:s.pendingBytes=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Rt.Message)return r;var i=new Rt.Message;if(r.wantlist!=null){if(typeof r.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=Rt.Message.Wantlist.fromObject(r.wantlist)}if(r.blocks){if(!Array.isArray(r.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<r.blocks.length;++n)typeof r.blocks[n]=="string"?jt.base64.decode(r.blocks[n],i.blocks[n]=jt.newBuffer(jt.base64.length(r.blocks[n])),0):r.blocks[n].length&&(i.blocks[n]=r.blocks[n])}if(r.payload){if(!Array.isArray(r.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<r.payload.length;++n){if(typeof r.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=Rt.Message.Block.fromObject(r.payload[n])}}if(r.blockPresences){if(!Array.isArray(r.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<r.blockPresences.length;++n){if(typeof r.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=Rt.Message.BlockPresence.fromObject(r.blockPresences[n])}}return r.pendingBytes!=null&&(i.pendingBytes=r.pendingBytes|0),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),r.wantlist!=null&&r.hasOwnProperty("wantlist")&&(n.wantlist=Rt.Message.Wantlist.toObject(r.wantlist,i)),r.blocks&&r.blocks.length){n.blocks=[];for(var s=0;s<r.blocks.length;++s)n.blocks[s]=i.bytes===String?jt.base64.encode(r.blocks[s],0,r.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(r.blocks[s]):r.blocks[s]}if(r.payload&&r.payload.length){n.payload=[];for(var s=0;s<r.payload.length;++s)n.payload[s]=Rt.Message.Block.toObject(r.payload[s],i)}if(r.blockPresences&&r.blockPresences.length){n.blockPresences=[];for(var s=0;s<r.blockPresences.length;++s)n.blockPresences[s]=Rt.Message.BlockPresence.toObject(r.blockPresences[s],i)}return r.pendingBytes!=null&&r.hasOwnProperty("pendingBytes")&&(n.pendingBytes=r.pendingBytes),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,gc.util.toJSONOptions)},t.Wantlist=function(){function e(r){if(this.entries=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.entries=jt.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=Nm.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)Rt.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof bc||(i=bc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Rt.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Rt.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Rt.Message.Wantlist)return i;var n=new Rt.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=Rt.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=Rt.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,gc.util.toJSONOptions)},e.WantType=function(){var r={},i=Object.create(r);return i[r[0]="Block"]=0,i[r[1]="Have"]=1,i}(),e.Entry=function(){function r(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return r.prototype.block=jt.newBuffer([]),r.prototype.priority=0,r.prototype.cancel=!1,r.prototype.wantType=0,r.prototype.sendDontHave=!1,r.encode=function(n,s){return s||(s=Nm.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},r.decode=function(n,s){n instanceof bc||(n=bc.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Rt.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},r.fromObject=function(n){if(n instanceof Rt.Message.Wantlist.Entry)return n;var s=new Rt.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?jt.base64.decode(n.block,s.block=jt.newBuffer(jt.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},r.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=jt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?jt.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Rt.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,gc.util.toJSONOptions)},r}(),e}(),t.Block=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.prefix=jt.newBuffer([]),e.prototype.data=jt.newBuffer([]),e.encode=function(i,n){return n||(n=Nm.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof bc||(i=bc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Rt.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Rt.Message.Block)return i;var n=new Rt.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?jt.base64.decode(i.prefix,n.prefix=jt.newBuffer(jt.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?jt.base64.decode(i.data,n.data=jt.newBuffer(jt.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=jt.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=jt.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?jt.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?jt.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,gc.util.toJSONOptions)},e}(),t.BlockPresenceType=function(){var e={},r=Object.create(e);return r[e[0]="Have"]=0,r[e[1]="DontHave"]=1,r}(),t.BlockPresence=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.cid=jt.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=Nm.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof bc||(i=bc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Rt.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Rt.Message.BlockPresence)return i;var n=new Rt.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?jt.base64.decode(i.cid,n.cid=jt.newBuffer(jt.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=jt.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?jt.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Rt.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,gc.util.toJSONOptions)},e}(),t}();jxe.exports=Rt});var Ey=y((WUt,Hxe)=>{f();"use strict";var{CID:Sy}=(kc(),mh),{sha256:qk}=(ri(),li),{base58btc:Bm}=(ei(),Jr),q2t=kxe(),{isMapEqual:Dk}=Jl(),{Message:xu}=Vxe(),zxe=Ok(),{concat:D2t}=(un(),cn),N2t=ue(),_n=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,r,i,n,s){i==null&&(i=_n.WantType.Block);let o=e.toString(Bm),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=r),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===_n.WantType.Block&&a.wantType===_n.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new zxe(e,r,i,n,s))}addBlock(e,r){let i=e.toString(Bm);this.blocks.set(i,r)}addHave(e){let r=e.toString(Bm);this.blockPresences.has(r)||this.blockPresences.set(r,_n.BlockPresenceType.Have)}addDontHave(e){let r=e.toString(Bm);this.blockPresences.has(r)||this.blockPresences.set(r,_n.BlockPresenceType.DontHave)}cancel(e){let r=e.toString(Bm);this.wantlist.delete(r),this.addEntry(e,0,_n.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),cancel:Boolean(r.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return xu.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),wantType:r.wantType,cancel:Boolean(r.cancel),sendDontHave:Boolean(r.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[r,i]of this.blocks.entries()){let n=Sy.parse(r),s=Uint8Array.from([n.code]),o=n.multihash.bytes.subarray(0,2),a=D2t([[n.version],s,o],1+s.byteLength+o.byteLength);e.payload.push(new xu.Block({prefix:a,data:i}))}for(let[r,i]of this.blockPresences)e.blockPresences.push(new xu.BlockPresence({cid:Sy.parse(r).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),xu.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!Dk(this.wantlist,e.wantlist)||!Dk(this.blocks,e.blocks)||!Dk(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),r=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${r}>`}};_n.deserialize=async(t,e={})=>{let r=xu.decode(t),i=r.wantlist&&r.wantlist.full||!1,n=new _n(i);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach(s=>{if(!s.block)return;let o=Sy.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),r.blockPresences&&r.blockPresences.forEach(s=>{if(!s.cid)return;let o=Sy.decode(s.cid);s.type===_n.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),r.blocks.length>0?(await Promise.all(r.blocks.map(async s=>{let o=await qk.digest(s),a=Sy.createV0(o);n.addBlock(a,s)})),n):(r.payload.length>0&&(await Promise.all(r.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=q2t(s.prefix),a=o[0],c=o[1],u=o[2],l=u===qk.code?qk:e[u];if(!l)throw N2t(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let d=await l.digest(s.data),h=Sy.create(a,c,d);n.addBlock(h,s.data)})),n.setPendingBytes(r.pendingBytes)),n)};_n.blockPresenceSize=t=>t.bytes.length+1;_n.Entry=zxe;_n.WantType={Block:xu.Wantlist.WantType.Block,Have:xu.Wantlist.WantType.Have};_n.BlockPresenceType={Have:xu.BlockPresenceType.Have,DontHave:xu.BlockPresenceType.DontHave};Hxe.exports=_n});var Mm=y((YUt,$xe)=>{f();"use strict";var Nk=1e3;$xe.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*Nk,hasBlockTimeout:15*Nk,provideTimeout:15*Nk,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}});var Wxe=y((XUt,Gxe)=>{f();Gxe.exports=B2t;function B2t(t,e,r){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return t.apply(this,arguments);var c=this,u=arguments,l=r&&!i;if(s(),n=function(){t.apply(c,u)},i=setTimeout(function(){if(i=null,!l){var d=n;return n=null,d()}},e),l)return n()};return a.cancel=s,a.flush=o,a}});var Xxe=y((ZUt,Yxe)=>{f();"use strict";var M2t=Wxe(),L2t=Ey(),U2t=Jl().logger,{wantlistSendDebounceMs:F2t}=Mm();Yxe.exports=class{constructor(e,r,i){this.peerId=r,this.network=i,this.refcnt=1,this._entries=[],this._log=U2t(e,"msgqueue"),this.sendEntries=M2t(this._sendEntries.bind(this),F2t)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new L2t(!1);this._entries.forEach(r=>{r.cancel?e.cancel(r.cid):e.addEntry(r.cid,r.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(r){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),r.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(r=>{this._log.error("send error: %s",r.message)})}}});var Zxe=y((eFt,Qxe)=>{f();"use strict";var Bk=Ey(),K2t=Dm(),j2t=Mm(),V2t=Xxe(),z2t=Jl().logger,{base58btc:H2t}=(ei(),Jr);Qxe.exports=class{constructor(e,r,i){this.peers=new Map,this.wantlist=new K2t(i),this.network=r,this._stats=i,this._peerId=e,this._log=z2t(e,"want")}_addEntries(e,r,i){let n=e.map((s,o)=>new Bk.Entry(s,j2t.kMaxPriority-o,Bk.WantType.Block,r));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(H2t)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let r=this.peers.get(e.toB58String());if(r){r.refcnt++;return}r=new V2t(this._peerId,e,this.network);let i=new Bk(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return r.addMessage(i),this.peers.set(e.toB58String(),r),r}_stopPeerHandler(e){let r=this.peers.get(e.toB58String());!r||(r.refcnt--,!(r.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,r={}){this._addEntries(e,!1),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});var n6e=y((tFt,i6e)=>{f();"use strict";var Jxe=Wo(),{pipe:e6e}=Ar(),$2t=HE(),G2t=Ey(),t6e=Mm(),W2t=Jl().logger,Mk="/ipfs/bitswap/1.0.0",Lk="/ipfs/bitswap/1.1.0",Uk="/ipfs/bitswap/1.2.0",r6e=class{constructor(e,r,i,n={}){this._log=W2t(e.peerId,"network"),this._libp2p=e,this._bitswap=r,this._protocols=[Mk],n.b100Only||(this._protocols.unshift(Lk),this._protocols.unshift(Uk)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashers=n.hashers||{}}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);let e=new $2t({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(let r of this._libp2p.peerStore.peers.values()){let i=this._libp2p.connectionManager.get(r.id);i&&this._onPeerConnect(i.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:r,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await e6e(r,Jxe.decode(),async n=>{for await(let s of n)try{let o=await G2t.deserialize(s.slice(),this._hashers);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,r,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:t6e.providerRequestTimeout,maxNumProviders:r})}async findAndConnect(e,r){let i=[];for await(let n of this.findProviders(e,t6e.maxProvidersPerRequest,r))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,r).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,r){await this._libp2p.contentRouting.provide(e,r)}async sendMessage(e,r){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,r);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([Uk,Lk,Mk]),a;switch(o){case Mk:a=r.serializeToBitswap100();break;case Lk:case Uk:a=r.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}Y2t(s,a,this._log),this._updateSentStats(e,r.blocks)}async connectTo(e,r){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,r)}_updateSentStats(e,r){let i=e.toB58String();if(this._stats){for(let n of r.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",r.size)}}};async function Y2t(t,e,r){try{await e6e([e],Jxe.encode(),t)}catch(i){r(i)}}i6e.exports=r6e});var a6e=y((rFt,o6e)=>{f();"use strict";var X2t=Dm(),s6e=class{constructor(e){this.partner=e,this.wantlist=new X2t,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,r,i){this.wantlist.add(e,r,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};o6e.exports=s6e});var l6e=y((iFt,u6e)=>{f();"use strict";var c6e=class extends Map{constructor(e,r){super();this._cmp=r||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let r=this._keys[e];this._keys.splice(e,1);let i=this._find(r);this._keys.splice(i,0,r)}set(e,r){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,r);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let r=this.indexOf(e);return this._keys.splice(r,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let r=this._find(e);if(this._keys[r]===e)return r;for(let i=1;i<this._keys.length;i++){if(this._keys[r+i]===e)return r+i;if(this._keys[r-i]===e)return r-i}return-1}_find(e){let r=0,i=this._keys.length;for(;r<i;){let n=r+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)r=n+1;else if(s>0)i=n;else return n}return r}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,r){if(!!e)for(let i of this._keys)e.apply(r,[[i,this.get(i)]])}_defaultSort(e,r){return e[0]<r[0]?-1:r[0]<e[0]?1:0}_kCmp(e,r){return this._cmp([e,this.get(e)],[r,this.get(r)])}};u6e.exports=c6e});var y6e=y((nFt,p6e)=>{f();"use strict";var f6e=l6e(),Q2t={hasNewInfo(){return!1},merge(){}},d6e=class{constructor(e=Q2t){this._taskMerger=e,this._byPeer=new f6e([],Fk.compare)}pushTasks(e,r){let i=this._byPeer.get(e.toB58String());i||(i=new Fk(e,this._taskMerger)),i.pushTasks(r),this._byPeer.set(e.toB58String(),i)}popTasks(e){let r=this._head();if(r===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=r.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=r.peerId;return r.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,r){let i=this._byPeer.get(r.toB58String());i&&i.remove(e)}tasksDone(e,r){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of r)i.taskDone(s);this._byPeer.update(n)}},Fk=class{constructor(e,r){this.peerId=e,this._taskMerger=r,this._activeTotalSize=0,this._pending=new h6e,this._active=new Set}pushTasks(e){for(let r of e)this._pushTask(r)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let r=this._pending.get(e.topic);if(r){e.priority>r.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,r);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let r=[];for(let i of this._active)i.topic===e.topic&&r.push(i);return r.length===0?!0:this._taskMerger.hasNewInfo(e,r)}popTasks(e){let r=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&r<e;s++){let o=n[s];i.push(o),r+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,r){return e[1]._pending.length===0?1:r[1]._pending.length===0?-1:e[1]._activeTotalSize===r[1]._activeTotalSize?r[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-r[1]._activeTotalSize}},h6e=class{constructor(){this._tasks=new f6e([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,r)=>e+r.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,r){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=r,this._tasks.update(n)}_compare(e,r){return e[1].task.priority===r[1].task.priority?e[1].created-r[1].created:r[1].task.priority-e[1].task.priority}};p6e.exports=d6e});var b6e=y((sFt,g6e)=>{f();"use strict";var Z2t={hasNewInfo(t,e){let r=!1,i=!1;for(let n of e)n.data.haveBlock&&(r=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&t.data.isWantBlock||!r&&t.data.haveBlock)},merge(t,e){let r=t.data,i=e.data;!i.haveBlock&&r.haveBlock&&(i.haveBlock=r.haveBlock,i.blockSize=r.blockSize),!i.isWantBlock&&r.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||r.haveBlock)&&(i.haveBlock=r.haveBlock,e.size=t.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};g6e.exports=Z2t});var _6e=y((oFt,w6e)=>{f();"use strict";var{CID:Kk}=(kc(),mh),{base58btc:hx}=(ei(),Jr),Lm=Ey(),m6e=Lm.WantType,J2t=Dm(),eEt=a6e(),tEt=y6e(),rEt=b6e(),{logger:iEt}=Jl(),nEt=16*1024,sEt=1024,v6e=class{constructor(e,r,i,n,s={}){this._log=iEt(e,"engine"),this.blockstore=r,this.network=i,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new tEt(rEt)}_processOpts(e){return{maxSizeReplaceHasWithBlock:sEt,targetMessageSize:nEt,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:r,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(r.length===0)return;let n=new Lm(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of r){let u=Kk.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):n.addHave(u):n.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let l=Kk.parse(c),d=a.get(c);d?n.addBlock(l,d):u.sendDontHave&&n.addDontHave(l)}if(n.empty){e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,u]of a.entries())e&&this.messageSent(e,Kk.parse(c),u)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks()}wantlistForPeer(e){let r=e.toB58String(),i=this.ledgerMap.get(r);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let r=e.toB58String(),i=this.ledgerMap.get(r);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let r of this.ledgerMap.values())for(let i of e){let n=r.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=Lm.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(r.partner,[{topic:n.cid.toString(hx),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,r){let i=this._findOrCreate(e);if(r.empty)return;if(r.full&&(i.wantlist=new J2t),this._updateBlockAccounting(r.blocks,i),r.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];r.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,r){for(let i of r)this._requestQueue.remove(i.toString(hx),e)}async _addWants(e,r){let i=await this._getBlockSizes(r.map(s=>s.cid)),n=[];for(let s of r){let o=s.cid.toString(hx),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:Lm.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===m6e.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=Lm.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,r){return e===m6e.Block||r<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let r=await this._getBlocks(e);return new Map([...r].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let r=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);r.set(i.toString(hx),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),r}_updateBlockAccounting(e,r){for(let i of e.values())this._log("got block (%s bytes)",i.length),r.receivedBytes(i.length)}messageSent(e,r,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(r)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){let r=e.toB58String(),i=this.ledgerMap.get(r);if(i)return i;let n=new eEt(e);return this.ledgerMap.set(r,n),this._stats&&this._stats.push(r,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};w6e.exports=v6e});var T6e=y((aFt,I6e)=>{f();"use strict";var{EventEmitter:oEt}=yr(),{toString:E6e}=(tt(),et),aEt=Mm(),cEt=Jl().logger,S6e=t=>`unwant:${E6e(t.multihash.bytes,"base64")}`,x6e=t=>`block:${E6e(t.multihash.bytes,"base64")}`,A6e=class extends oEt{constructor(e){super();this.setMaxListeners(aEt.maxListeners),this._log=cEt(e,"notif")}hasBlock(e,r){let i=x6e(e);this._log(i),this.emit(i,r)}wantBlock(e,r={}){if(!e)throw new Error("Not a valid cid");let i=x6e(e),n=S6e(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(n,a),s(u)};this.once(n,a),this.once(i,c),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let r=S6e(e);this._log(r),this.emit(r)}};I6e.exports=A6e});var O6e=y((cFt,C6e)=>{f();"use strict";var{EventEmitter:uEt}=yr(),R6e=iC(),P6e=class extends uEt{constructor(e,r){super();this._options=r,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=R6e(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,r){this._enabled&&(this._queue.push([e,r,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let r=e=this._queue.shift();r&&this._applyOp(r)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;r&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/r*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=R6e(a)),c.push(i,s)})}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,r)||(this._stats[r]=BigInt(0)),this._stats[r]=BigInt(this._stats[r])+BigInt(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};C6e.exports=P6e});var B6e=y((uFt,N6e)=>{f();"use strict";var{EventEmitter:lEt}=yr(),k6e=O6e(),q6e={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},D6e=class extends lEt{constructor(e=[],r=q6e){super();let i=Object.assign({},q6e,r);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=i,this._enabled=this._options.enabled,this._global=new k6e(e,i),this._global.on("update",n=>this.emit("update",n)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let r=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(r)}push(e,r,i){if(this._enabled&&(this._global.push(r,i),e)){let n=this._peers.get(e);n||(n=new k6e(this._initialCounters,this._options),this._peers.set(e,n)),n.push(r,i)}}disconnected(e){let r=e.toB58String(),i=this._peers.get(r);i&&(i.stop(),this._peers.delete(r))}};N6e.exports=D6e});var U6e=y((lFt,L6e)=>{f();"use strict";var fEt=Zxe(),dEt=n6e(),hEt=_6e(),pEt=T6e(),yEt=Jl().logger,gEt=B6e(),{AbortController:bEt}=nn(),{anySignal:mEt}=Tu(),{BlockstoreAdapter:vEt}=zE(),{CID:wEt}=(kc(),mh),_Et={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},EEt=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],M6e=class extends vEt{constructor(e,r,i={}){super();this._libp2p=e,this._log=yEt(this.peerId),this._options=Object.assign({},_Et,i),this._stats=new gEt(EEt,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new dEt(e,this,this._stats,{hashers:i.hashers}),this.blockstore=r,this.engine=new hEt(this.peerId,r,this.network,this._stats),this.wm=new fEt(this.peerId,this.network,this._stats),this.notifications=new pEt(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,r){try{await this.engine.messageReceived(e,r)}catch(n){this._log("failed to receive message",r)}if(r.blocks.size===0)return;let i=[];for(let[n,s]of r.blocks.entries()){let o=wEt.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,r,i,n){this._log("received block");let s=await this.blockstore.has(r);this._updateReceiveCounters(e.toB58String(),r,i,s),!!n&&await this.put(r,i)}_updateReceiveCounters(e,r,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,r){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,r={}){let i=(u,l)=>(this.wm.wantBlocks([u],l),this.notifications.wantBlock(u,l)),n=!1,s=async(u,l)=>{try{return await this.blockstore.get(u,l)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;return n||(n=!0,this.network.findAndConnect(u).catch(h=>this._log.error(h))),i(u,l)}},o=new bEt,a=r.signal?mEt([r.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}unwant(e){let r=Array.isArray(e)?e:[e];this.wm.unwantBlocks(r),r.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,r,i){await this.blockstore.put(e,r),this._sendHaveBlockNotifications(e,r)}async*putMany(e,r){for await(let{key:i,value:n}of this.blockstore.putMany(e,r))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,r){this.notifications.hasBlock(e,r),this.engine.receivedBlocks([{cid:e,data:r}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start(),this.started=!0}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};L6e.exports=M6e});var K6e=y((fFt,F6e)=>{f();"use strict";var SEt=U6e(),xEt=(t,e,r={})=>new SEt(t,e,r);F6e.exports={createBitswap:xEt}});var H6e=y((dFt,z6e)=>{f();"use strict";var{BlockstoreAdapter:AEt}=zE(),IEt=mp(),j6e=ja(),TEt=Fa(),V6e=class extends AEt{constructor(e,r){super();this.child=e,this.bitswap=r}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,r,i={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,r,i):await this.child.put(e,r,i))}async*putMany(e,r={}){let i=TEt(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(i,r):yield*this.child.putMany(i,r)}async get(e,r={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,r):this.child.get(e,r)}async*getMany(e,r={}){let i=j6e(),n=j6e();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*IEt(this.bitswap.getMany(i,r),this.child.getMany(n,r))}async delete(e,r){await this.child.delete(e,r)}async*deleteMany(e,r){yield*this.child.deleteMany(e,r)}async has(e,r={}){return this.child.has(e,r)}async*query(e,r={}){yield*this.child.query(e,r)}async*queryKeys(e,r={}){yield*this.child.queryKeys(e,r)}};z6e.exports=V6e});var G6e=y((hFt,$6e)=>{f();"use strict";var{createBitswap:REt}=K6e(),PEt=Tk(),{Multiaddr:CEt}=it(),OEt=ue(),kEt=H6e(),px=class{constructor(e,r,i,n,s){this.peerId=e,this.libp2p=r,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:r,print:i,options:n}){r.closed&&await r.open();let s=await r.config.getAll(),o=await PEt({options:n,repo:r,peerId:e,multiaddrs:qEt(e,s),config:s,keychainConfig:void 0});o.keychain&&await o.loadKeychain(),await o.start();for(let u of o.multiaddrs)i(`Swarm listening on ${u}/p2p/${e.toB58String()}`);let a=REt(o,r.blocks,{statsEnabled:!0});await a.start();let c=new kEt(r.blocks,a);return r.blocks=c,r.pins.blockstore=c,new px(e,o,a,r,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}};$6e.exports=px;var qEt=(t,e)=>{let r=t.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new CEt(s);if(o.protoCodes().includes(DEt))throw OEt(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==r&&(o=o.encapsulate(`/p2p/${r}`)),i.push(o)}return i},DEt=479});var Y6e=y((pFt,W6e)=>{f();"use strict";var NEt=qe();W6e.exports=({network:t})=>{async function e(r={}){let i=[],{libp2p:n}=await t.use(r);for(let[s,o]of n.peerStore.peers.entries())i.push({id:s,addrs:o.addresses.map(a=>a.multiaddr)});return i}return NEt(e)}});var Q6e=y((yFt,X6e)=>{f();"use strict";var BEt=qe();X6e.exports=({network:t})=>{async function e(r,i={}){let{libp2p:n}=await t.use(i);await n.dial(r,i)}return BEt(e)}});var J6e=y((gFt,Z6e)=>{f();"use strict";var MEt=qe();Z6e.exports=({network:t})=>{async function e(r,i={}){let{libp2p:n}=await t.use(i);await n.hangUp(r)}return MEt(e)}});var tAe=y((bFt,eAe)=>{f();"use strict";var LEt=qe();eAe.exports=({network:t})=>{async function e(r={}){let{libp2p:i}=await t.use(r);return i.multiaddrs}return LEt(e)}});var iAe=y((mFt,rAe)=>{f();"use strict";var UEt=qe();rAe.exports=({network:t})=>{async function e(r={}){let{libp2p:i}=await t.use(r),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(r.verbose||r.direction)&&(c.direction=a.stat.direction),r.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return UEt(e)}});var oAe=y((vFt,sAe)=>{f();"use strict";var FEt=Y6e(),KEt=Q6e(),jEt=J6e(),VEt=tAe(),zEt=iAe(),nAe=class{constructor({network:e}){this.addrs=FEt({network:e}),this.connect=KEt({network:e}),this.disconnect=jEt({network:e}),this.localAddrs=VEt({network:e}),this.peers=zEt({network:e})}};sAe.exports=nAe});var cAe=y((wFt,aAe)=>{f();"use strict";var HEt=rt(),Um={success:!0,time:0,text:""},$Et=qe();aAe.exports=({network:t})=>{async function*e(r,i={}){let{libp2p:n}=await t.use();i.count=i.count||10;let s=HEt.createFromB58String(r),o=n.peerStore.get(s),a=o&&o.id;if(!a){yield{...Um,text:`Looking up peer ${r}`};let l=await n.peerRouting.findPeer(s);a=l&&l.id}if(!a)throw new Error("Peer was not found");yield{...Um,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let l=0;l<i.count;l++)try{let d=await n.ping(a);u+=d,c++,yield{...Um,time:d}}catch(d){yield{...Um,success:!1,text:d.toString()}}if(c){let l=u/c;yield{...Um,text:`Average latency: ${l}ms`}}}return $Et(e)}});var dAe=y((_Ft,fAe)=>{f();"use strict";var uAe=rt(),lAe=ue(),{NotEnabledError:GEt}=tl(),WEt=xb(),xy=qe();fAe.exports=({network:t,repo:e})=>{let{get:r,put:i,findProvs:n,findPeer:s,provide:o,query:a}={async get(c,u={}){let{libp2p:l}=await Ay(t,u);return l._dht.get(c,u)},async*put(c,u,l){let{libp2p:d}=await Ay(t,l);yield*d._dht.put(c,u)},async*findProvs(c,u={numProviders:20}){let{libp2p:l}=await Ay(t,u);for await(let d of l._dht.findProviders(c,{maxNumProviders:u.numProviders,signal:u.signal}))yield{id:d.id.toB58String(),addrs:d.addrs}},async findPeer(c,u){let{libp2p:l}=await Ay(t,u),d=await l._dht.findPeer(uAe.parse(c));return{id:d.id.toB58String(),addrs:d.multiaddrs}},async*provide(c,u={recursive:!1}){let{libp2p:l}=await Ay(t,u),d=Array.isArray(c)?c:[c];if(!(await Promise.all(d.map(g=>e.blocks.has(g)))).every(g=>g))throw lAe(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(u.recursive)throw lAe(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(let g of d)yield l._dht.provide(g)},async*query(c,u){let{libp2p:l}=await Ay(t,u);for await(let d of l._dht.getClosestPeers(uAe.parse(c).toBytes()))yield{id:d.toB58String(),addrs:[]}}};return{get:xy(r),put:xy(i),findProvs:xy(n),findPeer:xy(s),provide:xy(o),query:xy(a)}};var Ay=async(t,e)=>{let r=await t.use(e);if(WEt(r.libp2p,"_config.dht.enabled",!1))return r;throw new GEt("dht not enabled")}});var pAe=y((EFt,hAe)=>{f();"use strict";var Fm=qe(),YEt=ue(),{NotEnabledError:XEt}=tl(),QEt=xb();hAe.exports=({network:t,config:e})=>{let r=QEt(e||{},"Pubsub.Enabled",!0);return{subscribe:r?Fm(i):Km,unsubscribe:r?Fm(n):Km,publish:r?Fm(s):Km,ls:r?Fm(o):Km,peers:r?Fm(a):Km};async function i(c,u,l={}){let{libp2p:d}=await t.use(l);return d.pubsub.subscribe(c,u,l)}async function n(c,u,l={}){let{libp2p:d}=await t.use(l);d.pubsub.unsubscribe(c,u,l)}async function s(c,u,l={}){let{libp2p:d}=await t.use(l);if(!u)throw YEt(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await d.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await t.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:l}=await t.use(u);return l.pubsub.getSubscribers(c)}};var Km=async()=>{throw new XEt("pubsub not enabled")}});var vAe=y((SFt,mAe)=>{f();"use strict";var ZEt=gr().bind({ignoreUndefined:!0}),{isTest:JEt}=zy(),jk=me()("ipfs"),yAe=ue(),{UnixFS:eSt}=(pi(),as),gAe=(_t(),Mt),tSt=(zc(),Xw),{identity:bAe}=(Cc(),Pc),{bases:rSt,hashes:iSt,codecs:nSt}=(Vv(),F6),sSt=YF(),{AlreadyInitializedError:oSt}=tl(),{fromString:aSt}=(ft(),ht),cSt=BK(),uSt=LK(),lSt=ij(),fSt=sj(),dSt=cj(),hSt=mH(),pSt=HG(),ySt=mW(),gSt=_W(),bSt=SW(),mSt=qW(),vSt=YW(),wSt=uY(),_St=dee(),ESt=pee(),SSt=gee(),xSt=k5(),ASt=Wee(),ISt=ite(),TSt=ote(),RSt=Mre(),PSt=rie(),CSt=Tie(),OSt=Nie(),kSt=Kie(),qSt=mxe(),DSt=G6e(),NSt=Jw(),BSt=oAe(),MSt=cAe(),LSt=dAe(),USt=pAe(),FSt=Z8(),KSt=J8(),jSt=eP(),yx=class{constructor({print:e,storage:r,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=r,c=NSt.create(DSt),u=ISt(n.preload),l=lSt(),d=fSt({network:c}),h=new pSt(n),p=Object.values(iSt);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(C=>p.push(C)),this.hashers=new KSt({hashers:p,loadHasher:n.ipld&&n.ipld.loadHasher});let g=Object.values(rSt);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(C=>g.push(C)),this.bases=new jSt({bases:g,loadBase:n.ipld&&n.ipld.loadBase});let m=new hSt({repo:o,codecs:i}),E=new wSt({codecs:i,hashers:this.hashers,preload:u,repo:o}),v=new ySt({dns:l,ipns:h,repo:o,codecs:i,peerId:s,isOnline:d,keychain:a,options:n}),A=dSt({repo:o,codecs:i,bases:this.bases,name:v}),R=new ASt({repo:o,codecs:i,hashers:this.hashers,preload:u}),F=Object.assign(gSt({repo:o,codecs:i,resolve:A,preload:u}),{local:bSt({repo:r.repo})}),{add:q,addAll:D,cat:z,get:G,ls:Y}=new _St({preload:u,repo:o,options:n.EXPERIMENTAL}),P=RSt({repo:o,preload:u,hashers:this.hashers,options:n}),b=TSt({files:P,preload:u,options:n.preload});this.preload=u,this.name=v,this.ipns=h,this.pin=m,this.resolve=A,this.block=E,this.refs=F,this.start=cSt({network:c,peerId:s,repo:o,preload:u,ipns:h,mfsPreload:b,print:e,keychain:a,options:n}),this.stop=uSt({network:c,preload:u,mfsPreload:b,ipns:h,repo:o}),this.dht=LSt({network:c,repo:o}),this.pubsub=USt({network:c,config:n.config}),this.dns=l,this.isOnline=d,this.id=SSt({network:c,peerId:s}),this.version=ESt({repo:o}),this.bitswap=new mSt({network:c}),this.bootstrap=new vSt({repo:o}),this.config=xSt({repo:o}),this.ping=MSt({network:c}),this.add=q,this.addAll=D,this.cat=z,this.get=G,this.ls=Y,this.dag=R,this.files=P,this.key=new PSt({keychain:a}),this.object=new CSt({preload:u,codecs:i,repo:o}),this.repo=new OSt({repo:o,hashers:this.hashers}),this.stats=new kSt({repo:o,network:c}),this.swarm=new BSt({network:c}),Object.defineProperty(this,"libp2p",{get(){let C=c.try();return C?C.libp2p:void 0}});let w=()=>Promise.reject(yAe(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),S=async function*(){throw yAe(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=w,this.diag={cmds:w,net:w,sys:w},this.log={level:w,ls:w,tail:S},this.mount=w,this.codecs=i}async init(){throw new oSt}static async create(e={}){e=ZEt(zSt(),e);let r=e.init||{},i={name:bAe.name,code:bAe.code,encode:l=>l,decode:l=>l},n=Object.values(nSt);[gAe,tSt,i].concat(e.ipld&&e.ipld.codecs||[]).forEach(l=>n.push(l));let s=new FSt({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),o=e.silent?jk:console.log,a=await qSt.start(o,s,e),c=await a.repo.config.getAll(),u=new yx({storage:a,print:o,codecs:s,options:{...e,config:c}});if(await u.preload.start(),u.ipns.startOffline(a),a.isNew&&!r.emptyRepo){let l=await VSt(u);jk("adding default assets"),await sSt({addAll:u.addAll,print:o}),jk("initializing IPNS keyspace"),await u.ipns.initializeKeyspace(a.peerId.privKey,aSt(`/ipfs/${l}`))}return e.start!==!1&&await u.start(),u}};mAe.exports=yx;var VSt=async t=>{let e=gAe.encode({Data:new eSt({type:"directory"}).marshal(),Links:[]}),r=await t.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await t.pin.add(r),r},zSt=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!JEt,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var JSt=y((xFt,wAe)=>{f();"use strict";var HSt=kx(),$St=Vx(),GSt=rt(),WSt=Na(),YSt=Yh(),{multiaddr:XSt}=it(),{CID:QSt}=(Ie(),Ne),{create:ZSt}=vAe();wAe.exports={create:ZSt,crypto:WSt,isIPFS:YSt,CID:QSt,multiaddr:XSt,PeerId:GSt,globSource:HSt,urlSource:$St}});return JSt();})();
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return IpfsCore}));
